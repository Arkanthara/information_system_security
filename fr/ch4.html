<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ch4 – ISS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-96c1bb8b336142dcc39f931773fab1b9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-9ee82e006983bafa07c9ac29a901142c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-96c1bb8b336142dcc39f931773fab1b9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ISS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-langage" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text">Langage</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-langage">    
        <li>
    <a class="dropdown-item" href="./../index.html">
 <span class="dropdown-text">Anglais</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./index.html">
 <span class="dropdown-text">Français</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch1.html">Cours</a></li><li class="breadcrumb-item"><a href="./ch4.html">Cryptographie Asymétrique (à Clés Publiques)</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Cours</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notions de base en cryptographie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cryptographie symétrique</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Cryptographie Asymétrique (à Clés Publiques)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fonctions de Hachage Cryptographiques et MACs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Signatures Digitales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Authentification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Protocoles d’Établissement de Clés (KEP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tiers de Confiance et Certification (Trusted Third Parties - TTP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch91.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Document de Révision : Cryptographie Quantique et Post-Quantique</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch92.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cryptographie Quantique &amp; Post-Quantique - Support de révision oral</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch93.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cryptographie Quantique et Post-Quantique</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./presentations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentations</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cryptographie-asymétrique-à-clés-publiques" id="toc-cryptographie-asymétrique-à-clés-publiques" class="nav-link active" data-scroll-target="#cryptographie-asymétrique-à-clés-publiques">Cryptographie Asymétrique (à Clés Publiques)</a>
  <ul class="collapse">
  <li><a href="#fondements-mathématiques" id="toc-fondements-mathématiques" class="nav-link" data-scroll-target="#fondements-mathématiques">Fondements Mathématiques</a>
  <ul class="collapse">
  <li><a href="#théorème-fondamental-de-larithmétique-et-fonction-phi-deuler" id="toc-théorème-fondamental-de-larithmétique-et-fonction-phi-deuler" class="nav-link" data-scroll-target="#théorème-fondamental-de-larithmétique-et-fonction-phi-deuler">Théorème Fondamental de l’Arithmétique et Fonction Phi d’Euler</a></li>
  <li><a href="#théorèmes-deuler-et-de-fermat" id="toc-théorèmes-deuler-et-de-fermat" class="nav-link" data-scroll-target="#théorèmes-deuler-et-de-fermat">Théorèmes d’Euler et de Fermat</a></li>
  <li><a href="#groupes-multiplicatifs-et-générateurs" id="toc-groupes-multiplicatifs-et-générateurs" class="nav-link" data-scroll-target="#groupes-multiplicatifs-et-générateurs">Groupes Multiplicatifs et Générateurs</a></li>
  <li><a href="#fast-exponentiation-exponentiation-rapide" id="toc-fast-exponentiation-exponentiation-rapide" class="nav-link" data-scroll-target="#fast-exponentiation-exponentiation-rapide">Fast Exponentiation (Exponentiation Rapide)</a></li>
  <li><a href="#théorème-des-restes-chinois-crt" id="toc-théorème-des-restes-chinois-crt" class="nav-link" data-scroll-target="#théorème-des-restes-chinois-crt">Théorème des Restes Chinois (CRT)</a></li>
  </ul></li>
  <li><a href="#problèmes-de-base-et-complexité" id="toc-problèmes-de-base-et-complexité" class="nav-link" data-scroll-target="#problèmes-de-base-et-complexité">Problèmes de Base et Complexité</a>
  <ul class="collapse">
  <li><a href="#classification-des-problèmes-difficiles" id="toc-classification-des-problèmes-difficiles" class="nav-link" data-scroll-target="#classification-des-problèmes-difficiles">Classification des Problèmes Difficiles</a></li>
  <li><a href="#techniques-de-factorisation" id="toc-techniques-de-factorisation" class="nav-link" data-scroll-target="#techniques-de-factorisation">Techniques de Factorisation</a></li>
  </ul></li>
  <li><a href="#lalgorithme-rsa" id="toc-lalgorithme-rsa" class="nav-link" data-scroll-target="#lalgorithme-rsa">L’Algorithme RSA</a>
  <ul class="collapse">
  <li><a href="#fonctionnement-de-rsa-encryptiondecryption" id="toc-fonctionnement-de-rsa-encryptiondecryption" class="nav-link" data-scroll-target="#fonctionnement-de-rsa-encryptiondecryption">Fonctionnement de RSA (Encryption/Decryption)</a></li>
  <li><a href="#sécurité-de-rsa" id="toc-sécurité-de-rsa" class="nav-link" data-scroll-target="#sécurité-de-rsa">Sécurité de RSA</a></li>
  <li><a href="#attaques-sur-rsa" id="toc-attaques-sur-rsa" class="nav-link" data-scroll-target="#attaques-sur-rsa">Attaques sur RSA</a></li>
  </ul></li>
  <li><a href="#lalgorithme-elgamal" id="toc-lalgorithme-elgamal" class="nav-link" data-scroll-target="#lalgorithme-elgamal">L’Algorithme ElGamal</a>
  <ul class="collapse">
  <li><a href="#remarques-essentielles" id="toc-remarques-essentielles" class="nav-link" data-scroll-target="#remarques-essentielles">Remarques essentielles</a></li>
  </ul></li>
  <li><a href="#algorithme-de-rabin" id="toc-algorithme-de-rabin" class="nav-link" data-scroll-target="#algorithme-de-rabin">Algorithme de Rabin</a>
  <ul class="collapse">
  <li><a href="#remarques-essentielles-1" id="toc-remarques-essentielles-1" class="nav-link" data-scroll-target="#remarques-essentielles-1">Remarques essentielles</a></li>
  </ul></li>
  <li><a href="#comparaison-rsa---elgamal---rabin" id="toc-comparaison-rsa---elgamal---rabin" class="nav-link" data-scroll-target="#comparaison-rsa---elgamal---rabin">Comparaison RSA - ElGamal - Rabin</a></li>
  <li><a href="#courbes-elliptiques-idée-de-base" id="toc-courbes-elliptiques-idée-de-base" class="nav-link" data-scroll-target="#courbes-elliptiques-idée-de-base">Courbes Elliptiques (Idée de base)</a>
  <ul class="collapse">
  <li><a href="#concept-fondamental" id="toc-concept-fondamental" class="nav-link" data-scroll-target="#concept-fondamental">Concept fondamental</a></li>
  <li><a href="#addition-sur-courbes-elliptiques" id="toc-addition-sur-courbes-elliptiques" class="nav-link" data-scroll-target="#addition-sur-courbes-elliptiques">Addition sur courbes elliptiques</a></li>
  <li><a href="#ecdlp-et-avantages-cryptographiques" id="toc-ecdlp-et-avantages-cryptographiques" class="nav-link" data-scroll-target="#ecdlp-et-avantages-cryptographiques">ECDLP et avantages cryptographiques</a></li>
  <li><a href="#tableau-de-comparaison-des-tailles-de-clés" id="toc-tableau-de-comparaison-des-tailles-de-clés" class="nav-link" data-scroll-target="#tableau-de-comparaison-des-tailles-de-clés">Tableau de comparaison des tailles de clés</a></li>
  </ul></li>
  <li><a href="#elgamal-sur-courbes-elliptiques" id="toc-elgamal-sur-courbes-elliptiques" class="nav-link" data-scroll-target="#elgamal-sur-courbes-elliptiques">ElGamal sur Courbes Elliptiques</a>
  <ul class="collapse">
  <li><a href="#adaptation-directe" id="toc-adaptation-directe" class="nav-link" data-scroll-target="#adaptation-directe">Adaptation directe</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="ch4.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch1.html">Cours</a></li><li class="breadcrumb-item"><a href="./ch4.html">Cryptographie Asymétrique (à Clés Publiques)</a></li></ol></nav></header>





<section id="cryptographie-asymétrique-à-clés-publiques" class="level1">
<h1>Cryptographie Asymétrique (à Clés Publiques)</h1>
<section id="fondements-mathématiques" class="level2">
<h2 class="anchored" data-anchor-id="fondements-mathématiques">Fondements Mathématiques</h2>
<section id="théorème-fondamental-de-larithmétique-et-fonction-phi-deuler" class="level3">
<h3 class="anchored" data-anchor-id="théorème-fondamental-de-larithmétique-et-fonction-phi-deuler">Théorème Fondamental de l’Arithmétique et Fonction Phi d’Euler</h3>
<p>La cryptographie asymétrique repose sur des fondements mathématiques solides issus de la théorie des nombres. Deux concepts sont essentiels :</p>
<p><strong>Théorème Fondamental de l’Arithmétique</strong> : Tout nombre entier strictement positif <span class="math inline">\(n\)</span> s’écrit de façon unique (à l’ordre près) comme produit de puissances de nombres premiers :</p>
<p><span class="math display">\[n = p_1^{e_1} \cdot p_2^{e_2} \cdot p_3^{e_3} \cdots p_m^{e_m}\]</span></p>
<p><strong>Fonction Phi d’Euler <span class="math inline">\(\phi(n)\)</span></strong> : Nombre d’entiers positifs plus petits que <span class="math inline">\(n\)</span> qui sont premiers avec <span class="math inline">\(n\)</span>.</p>
<p>Pour calculer <span class="math inline">\(\phi(n)\)</span> :</p>
<p><span class="math display">\[\phi(n) = \prod_{i=1}^{m} p_i^{e_i} \cdot \left(1 - \frac{1}{p_i}\right)\]</span></p>
<p><strong>Cas particulier important</strong> : Si <span class="math inline">\(n = p \cdot q\)</span> avec <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> premiers, alors :</p>
<p><span class="math display">\[\phi(n) = (p-1)(q-1)\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<section id="fondements-mathématiques-1" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="fondements-mathématiques-1">Fondements Mathématiques</h3>
<p><strong>Théorème Fondamental de l’Arithmétique</strong> : Tout nombre entier strictement positif <span class="math inline">\(n\)</span> s’écrit de façon unique (à l’ordre près) comme un produit de puissances de nombres premiers <span class="math inline">\(p_i\)</span> distincts :</p>
<p><span class="math display">\[n = p_1^{e_1} \cdot p_2^{e_2} \cdot p_3^{e_3} \cdots p_m^{e_m}\]</span></p>
<p><strong>Fonction Phi d’Euler</strong> : Soit <span class="math inline">\(n \in \mathbb{Z}^+\)</span>, la <strong>fonction phi d’Euler</strong> <span class="math inline">\(\phi(n)\)</span> est égale au nombre d’entiers positifs plus petits que <span class="math inline">\(n\)</span> qui sont <strong>relativement premiers</strong> à <span class="math inline">\(n\)</span>.</p>
<p><strong>Calcul de la fonction phi d’Euler</strong> : D’après le théorème fondamental de l’arithmétique, tout nombre entier <span class="math inline">\(n &gt; 1\)</span> s’écrit :</p>
<p><span class="math display">\[n = \prod_{i=1}^{m} p_i^{e_i}\]</span></p>
<p>alors <span class="math inline">\(\phi(n)\)</span> se calcule :</p>
<p><span class="math display">\[\phi(n) = \prod_{i=1}^{m} \left(p_i^{e_i} - p_i^{e_i-1}\right)\]</span></p>
<p>En particulier, si <span class="math inline">\(n = p \cdot q\)</span> avec <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> premiers, alors :</p>
<p><span class="math display">\[\phi(n) = (p-1)(q-1)\]</span></p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Décomposition unique</strong> : tout entier = produit de nombres premiers</li>
<li><strong><span class="math inline">\(\phi(n)\)</span></strong> : compte les entiers <span class="math inline">\(&lt; n\)</span> premiers avec <span class="math inline">\(n\)</span></li>
<li><strong>Clé pour RSA</strong> : si <span class="math inline">\(n = pq\)</span> (premiers) alors <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span></li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="théorèmes-deuler-et-de-fermat" class="level3">
<h3 class="anchored" data-anchor-id="théorèmes-deuler-et-de-fermat">Théorèmes d’Euler et de Fermat</h3>
<p>Ces théorèmes sont au cœur du fonctionnement de RSA et d’autres algorithmes asymétriques.</p>
<p><strong>Théorème d’Euler</strong> : Si <span class="math inline">\(n \in \mathbb{Z}^+\)</span> et <span class="math inline">\(a \in \mathbb{Z}\)</span> avec <span class="math inline">\(\text{pgcd}(a,n) = 1\)</span>, alors :</p>
<p><span class="math display">\[a^{\phi(n)} \equiv 1 \pmod{n}\]</span></p>
<p><strong>Petit Théorème de Fermat</strong> (cas particulier si <span class="math inline">\(n = p\)</span> premier) : Si <span class="math inline">\(a \in \mathbb{Z}\)</span> et <span class="math inline">\(p\)</span> premier ne divise pas <span class="math inline">\(a\)</span> :</p>
<p><span class="math display">\[a^{p-1} \equiv 1 \pmod{p}\]</span></p>
<p><strong>Applications importantes</strong> :</p>
<ol type="1">
<li><p><strong>Réduction des exposants</strong> : Si <span class="math inline">\(n\)</span> est produit de premiers distincts et <span class="math inline">\(r \equiv s \pmod{\phi(n)}\)</span>, alors : <span class="math display">\[a^r \equiv a^s \pmod{n}\]</span></p></li>
<li><p><strong>Calcul des inverses</strong> : <span class="math inline">\(a^{\phi(n)-1}\)</span> est l’inverse de <span class="math inline">\(a\)</span> modulo <span class="math inline">\(n\)</span>. En particulier, si <span class="math inline">\(p\)</span> est premier, <span class="math inline">\(a^{p-2}\)</span> est l’inverse de <span class="math inline">\(a\)</span> modulo <span class="math inline">\(p\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<section id="fondements-mathématiques-ii" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="fondements-mathématiques-ii">Fondements Mathématiques (II)</h3>
<p><strong>Théorème d’Euler</strong> : Soient <span class="math inline">\(n \in \mathbb{Z}^+\)</span> et <span class="math inline">\(a \in \mathbb{Z}\)</span> avec <span class="math inline">\(\text{pgcd}(a,n) = 1\)</span>, alors on a :</p>
<p><span class="math display">\[a^{\phi(n)} \equiv 1 \pmod{n}\]</span></p>
<p><strong>Petit Théorème de Fermat</strong> (cas particulier du théorème d’Euler si <span class="math inline">\(n\)</span> est premier) : Soient <span class="math inline">\(a \in \mathbb{Z}\)</span> et <span class="math inline">\(p\)</span> un nombre premier tel que <span class="math inline">\(p\)</span> ne divise pas <span class="math inline">\(a\)</span>, alors on a :</p>
<p><span class="math display">\[a^{p-1} \equiv 1 \pmod{p}\]</span></p>
<p>À noter que puisque <span class="math inline">\(p\)</span> est premier, on a <span class="math inline">\(\phi(p) = p-1\)</span>.</p>
<p><strong>Réduction des exposants</strong> <span class="math inline">\(\bmod \phi(n)\)</span> : Si <span class="math inline">\(n\)</span> est le produit de premiers distincts et <span class="math inline">\(r, s \in \mathbb{Z}\)</span> t.q. <span class="math inline">\(r \equiv s \pmod{\phi(n)}\)</span> alors <span class="math inline">\(\forall a \in \mathbb{Z}\)</span> :</p>
<p><span class="math display">\[a^r \equiv a^s \pmod{n}\]</span></p>
<p><strong>Application du Théorème d’Euler au calcul des inverses</strong> : Suite au théorème d’Euler, on a que :</p>
<p><span class="math display">\[a \cdot a^{\phi(n)-1} \equiv 1 \pmod{n}\]</span></p>
<p>ce qui signifie que <span class="math inline">\(a^{\phi(n)-1}\)</span> est l’<strong>inverse de <span class="math inline">\(a\)</span> modulo <span class="math inline">\(n\)</span></strong>. En particulier, <span class="math inline">\(a^{p-2}\)</span> est l’inverse de <span class="math inline">\(a\)</span> modulo <span class="math inline">\(n\)</span> si <span class="math inline">\(p\)</span> est premier.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Théorème d’Euler</strong> : <span class="math inline">\(a^{\phi(n)} \equiv 1 \pmod{n}\)</span></li>
<li><strong>Fermat</strong> : cas spécial si <span class="math inline">\(p\)</span> premier : <span class="math inline">\(a^{p-1} \equiv 1 \pmod{p}\)</span></li>
<li><strong>Inverse modulaire</strong> : <span class="math inline">\(a^{-1} \equiv a^{\phi(n)-1} \pmod{n}\)</span></li>
<li><strong>Base de RSA</strong> : permet encryption/decryption avec exposants</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="groupes-multiplicatifs-et-générateurs" class="level3">
<h3 class="anchored" data-anchor-id="groupes-multiplicatifs-et-générateurs">Groupes Multiplicatifs et Générateurs</h3>
<p><strong>Groupe multiplicatif <span class="math inline">\(\mathbb{Z}_n^*\)</span></strong> : Ensemble des éléments de <span class="math inline">\(\mathbb{Z}_n\)</span> premiers avec <span class="math inline">\(n\)</span> :</p>
<p><span class="math display">\[\mathbb{Z}_n^* = \{a \in \mathbb{Z}_n \mid \text{pgcd}(a,n) = 1\}\]</span></p>
<p>Si <span class="math inline">\(n\)</span> est premier : <span class="math inline">\(\mathbb{Z}_n^* = \{1, 2, \ldots, n-1\}\)</span></p>
<p><strong>Ordre d’un élément</strong> : Plus petit entier positif <span class="math inline">\(t\)</span> tel que <span class="math inline">\(a^t \equiv 1 \pmod{n}\)</span></p>
<p><strong>Générateur</strong> : Un élément <span class="math inline">\(\alpha\)</span> est un générateur de <span class="math inline">\(\mathbb{Z}_n^*\)</span> si son ordre est <span class="math inline">\(\phi(n)\)</span>. On dit alors que <span class="math inline">\(\mathbb{Z}_n^*\)</span> est <strong>cyclique</strong>.</p>
<p><strong>Propriétés des générateurs</strong> :</p>
<ol type="1">
<li><span class="math inline">\(\mathbb{Z}_n^*\)</span> a un générateur ssi <span class="math inline">\(n = 2, 4, p^k\)</span> ou <span class="math inline">\(2p^k\)</span> (avec <span class="math inline">\(p\)</span> premier, <span class="math inline">\(p \neq 2\)</span> et <span class="math inline">\(k \geq 1\)</span>)</li>
<li>Si <span class="math inline">\(p\)</span> est premier, <span class="math inline">\(\mathbb{Z}_p^*\)</span> a toujours un générateur</li>
<li>Si <span class="math inline">\(\alpha\)</span> est générateur, tous les éléments s’écrivent : <span class="math inline">\(\mathbb{Z}_n^* = \{\alpha^i \bmod n \mid 0 \leq i &lt; \phi(n)\}\)</span></li>
<li>Le nombre de générateurs est <span class="math inline">\(\phi(\phi(n))\)</span></li>
</ol>
<p><strong>Test de générateur</strong></p>
<ul>
<li><span class="math inline">\(\alpha\)</span> est un générateur de <span class="math inline">\(\mathbb{Z}_n^*\)</span> ssi <span class="math inline">\(\forall\)</span> premier <span class="math inline">\(p\)</span> divisant <span class="math inline">\(\phi(n)\)</span>, <span class="math inline">\(\alpha^{\phi(n)/p} \not\equiv 1 \pmod{n}\)</span></li>
<li>si <span class="math inline">\(n = 2p+1\)</span> est un “safe prime” avec <span class="math inline">\(p\)</span> premier : <span class="math inline">\(\alpha\)</span> est générateur ssi <span class="math inline">\(\alpha^2 \not\equiv 1 \pmod{n}\)</span> et <span class="math inline">\(\alpha^p \not\equiv 1 \pmod{n}\)</span></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<section id="fondements-mathématiques-iii" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="fondements-mathématiques-iii">Fondements Mathématiques (III)</h3>
<p><strong>Définition</strong> : Le <strong>groupe multiplicatif de <span class="math inline">\(\mathbb{Z}_n\)</span></strong>, noté <span class="math inline">\(\mathbb{Z}_n^*\)</span> est :</p>
<p><span class="math display">\[\mathbb{Z}_n^* = \{a \in \mathbb{Z}_n \mid \text{pgcd}(a,n) = 1\}\]</span></p>
<p>En particulier, si <span class="math inline">\(n\)</span> est premier : <span class="math inline">\(\mathbb{Z}_n^* = \{a \mid 1 \leq a \leq n-1\}\)</span></p>
<p>Le <strong>nombre d’éléments ou ordre</strong> du groupe multiplicatif <span class="math inline">\(\mathbb{Z}_n^*\)</span> est <span class="math inline">\(\phi(n)\)</span> (par définition de <span class="math inline">\(\phi\)</span>).</p>
<p><strong>Définition</strong> : Soit <span class="math inline">\(a \in \mathbb{Z}_n\)</span>, l’<strong>ordre de <span class="math inline">\(a\)</span></strong> est le plus petit entier positif <span class="math inline">\(t\)</span> pour lequel :</p>
<p><span class="math display">\[a^t \equiv 1 \pmod{n}\]</span></p>
<p><strong>Définition</strong> : Soit <span class="math inline">\(\alpha \in \mathbb{Z}_n^*\)</span>, si l’ordre de <span class="math inline">\(\alpha\)</span> est <span class="math inline">\(\phi(n)\)</span>, alors <span class="math inline">\(\alpha\)</span> est un <strong>générateur de <span class="math inline">\(\mathbb{Z}_n^*\)</span></strong>. Lorsqu’un groupe <span class="math inline">\(\mathbb{Z}_n^*\)</span> a un générateur, on dit qu’il est <strong>cyclique</strong>.</p>
<p><strong>Propriétés des générateurs</strong> :</p>
<ul>
<li><p><span class="math inline">\(\mathbb{Z}_n^*\)</span> a un générateur ssi <span class="math inline">\(n = 2, 4, p^k\)</span> ou <span class="math inline">\(2p^k\)</span>, avec <span class="math inline">\(p\)</span> premier, <span class="math inline">\(p \neq 2\)</span> et <span class="math inline">\(k \geq 1\)</span>. En particulier, si <span class="math inline">\(p\)</span> est premier, <span class="math inline">\(\mathbb{Z}_p^*\)</span> a un générateur.</p></li>
<li><p>Si <span class="math inline">\(\alpha\)</span> est un générateur de <span class="math inline">\(\mathbb{Z}_n^*\)</span>, alors tous les éléments de <span class="math inline">\(\mathbb{Z}_n^*\)</span> s’écrivent : <span class="math display">\[\mathbb{Z}_n^* = \{\alpha^i \bmod n \mid 0 \leq i \leq \phi(n)-1\}\]</span></p></li>
<li><p>Le nombre de générateurs de <span class="math inline">\(\mathbb{Z}_n^*\)</span> est <span class="math inline">\(\phi(\phi(n))\)</span>.</p></li>
<li><p><span class="math inline">\(\alpha\)</span> est un générateur de <span class="math inline">\(\mathbb{Z}_n^*\)</span> ssi pour tout premier <span class="math inline">\(p\)</span> divisant <span class="math inline">\(\phi(n)\)</span>, on a : <span class="math display">\[\alpha^{\phi(n)/p} \not\equiv 1 \pmod{n}\]</span></p></li>
</ul>
<p>En particulier si <span class="math inline">\(n\)</span> est un premier de la forme <span class="math inline">\(n = 2p+1\)</span> avec <span class="math inline">\(p\)</span> premier (un tel <span class="math inline">\(n\)</span> est appelé un <strong>safe prime</strong>), <span class="math inline">\(\alpha\)</span> est générateur de <span class="math inline">\(\mathbb{Z}_n^*\)</span> ssi <span class="math inline">\(\alpha^2 \not\equiv 1 \pmod{n}\)</span> et <span class="math inline">\(\alpha^p \not\equiv 1 \pmod{n}\)</span>.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong><span class="math inline">\(\mathbb{Z}_n^*\)</span></strong> : éléments premiers avec <span class="math inline">\(n\)</span>, cardinal = <span class="math inline">\(\phi(n)\)</span></li>
<li><strong>Générateur</strong> : élément d’ordre <span class="math inline">\(\phi(n)\)</span> (génère tout le groupe)</li>
<li><strong>Crucial pour DH et ElGamal</strong> : sécurité basée sur logarithme discret dans groupe cyclique</li>
<li><strong>Safe prime</strong> : <span class="math inline">\(n = 2p+1\)</span> avec <span class="math inline">\(p\)</span> et <span class="math inline">\(n\)</span> premiers</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="fast-exponentiation-exponentiation-rapide" class="level3">
<h3 class="anchored" data-anchor-id="fast-exponentiation-exponentiation-rapide">Fast Exponentiation (Exponentiation Rapide)</h3>
<p>Calcul efficace de <span class="math inline">\(a^k \bmod n\)</span> en temps polynomial, essentiel pour tous les algorithmes asymétriques.</p>
<p><strong>Principe</strong> : Utiliser la représentation binaire de l’exposant <span class="math inline">\(k\)</span>.</p>
<p><strong>Exemple</strong> : Calcul de <span class="math inline">\(2^{644} \bmod 645\)</span></p>
<ol type="1">
<li><p>Représentation binaire : <span class="math inline">\((644)_{10} = (1010000100)_2\)</span></p></li>
<li><p>Calculer les puissances de 2 successives modulo 645 :</p>
<ul>
<li><span class="math inline">\(2^1 \bmod 645\)</span></li>
<li><span class="math inline">\(2^2 \bmod 645\)</span></li>
<li><span class="math inline">\(2^4 \bmod 645\)</span></li>
<li><span class="math inline">\(2^8 \bmod 645\)</span></li>
<li>…</li>
<li><span class="math inline">\(2^{512} \bmod 645\)</span></li>
</ul></li>
<li><p>Combiner selon les bits à 1 : <span class="math inline">\(2^{644} = 2^{512} \cdot 2^{128} \cdot 2^4\)</span></p></li>
</ol>
<p><strong>Complexité</strong> : <span class="math inline">\(O(\log^3 n)\)</span> - très efficace !</p>
<p><strong>Application</strong> : Calcul de l’inverse avec le théorème d’Euler en temps polynomial.</p>
<p>Alternative : <strong>Algorithme d’Euclide étendu</strong> pour trouver <span class="math inline">\(x\)</span> tel que <span class="math inline">\(ax \equiv 1 \pmod{n}\)</span> en résolvant <span class="math inline">\(ax - kn = 1 = \text{pgcd}(a,n)\)</span>. Complexité également <span class="math inline">\(O(\log^3 n)\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<section id="fast-exponentiation" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="fast-exponentiation">Fast Exponentiation</h3>
<p><strong>Fast exponentiation</strong> : En utilisant la représentation binaire d’un nombre, on peut calculer des puissances très efficacement.</p>
<p><strong>Exemple</strong> : calcul de <span class="math inline">\(2^{644} \bmod 645\)</span></p>
<p><span class="math inline">\((644)_{10} = (1010000100)_2\)</span></p>
<p>Maintenant, on calcule les exposants correspondants aux puissances de 2, soient :</p>
<p><span class="math display">\[2^1 \bmod 645, \quad 2^2 \bmod 645, \quad 2^4 \bmod 645, \quad \ldots, \quad 2^{512} \bmod 645\]</span></p>
<p>D’après la représentation binaire, on calcule :</p>
<p><span class="math display">\[2^{644} = 2^{512+128+4} = 2^{512} \cdot 2^{128} \cdot 2^4 = 160 \cdot 153 \cdot 6 \bmod 645\]</span></p>
<p><strong>La complexité de cet algorithme</strong> fast exponentiation est <span class="math inline">\(O(\log^3 n)\)</span>.</p>
<p>En s’appuyant sur le <strong>théorème d’Euler</strong>, le calcul de l’<strong>inverse d’un nombre</strong> dans un tel groupe est donc effectué en temps polynomial.</p>
<p><strong>L’algorithme d’Euclide étendu</strong> peut être également utilisé pour trouver un <span class="math inline">\(x\)</span> tel que :</p>
<p><span class="math display">\[ax \equiv 1 \pmod{n}\]</span></p>
<p>puisque cette congruence s’écrit : <span class="math inline">\(ax - 1 = kn\)</span> et donc :</p>
<p><span class="math display">\[ax - kn = 1 = \text{pgcd}(a,n)\]</span></p>
<p>La complexité de cet algorithme est également <span class="math inline">\(O(\log^3 n)\)</span>.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Idée</strong> : représentation binaire de l’exposant</li>
<li><strong>Complexité</strong> : <span class="math inline">\(O(\log^3 n)\)</span> - polynomial !</li>
<li><strong>Essentiel</strong> : rend RSA, ElGamal, DH praticables</li>
<li><strong>Alternative</strong> : algorithme d’Euclide étendu pour inverses</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="théorème-des-restes-chinois-crt" class="level3">
<h3 class="anchored" data-anchor-id="théorème-des-restes-chinois-crt">Théorème des Restes Chinois (CRT)</h3>
<p>Le CRT permet de résoudre des systèmes de congruences simultanées, avec des applications importantes en cryptographie.</p>
<p><strong>Théorème</strong> : Soient <span class="math inline">\(n_1, n_2, \ldots, n_t \in \mathbb{Z}^+\)</span> premiers deux à deux (pgcd<span class="math inline">\((n_i, n_j) = 1\)</span> si <span class="math inline">\(i \neq j\)</span>) et <span class="math inline">\(a_1, a_2, \ldots, a_t \in \mathbb{Z}\)</span>. Alors le système :</p>
<p><span class="math display">\[\begin{cases}
x \equiv a_1 \pmod{n_1} \\
x \equiv a_2 \pmod{n_2} \\
\vdots \\
x \equiv a_t \pmod{n_t}
\end{cases}\]</span></p>
<p>a une solution unique <span class="math inline">\(x \bmod N\)</span> avec <span class="math inline">\(N := n_1 \cdot n_2 \cdots n_t\)</span>.</p>
<p><strong>Algorithme de Gauss</strong> (1801) pour calculer <span class="math inline">\(x\)</span> :</p>
<p><span class="math display">\[x = \sum_{i=1}^{t} a_i N_i M_i \bmod N\]</span></p>
<p>avec :</p>
<ul>
<li><span class="math inline">\(N_i = N/n_i\)</span></li>
<li><span class="math inline">\(M_i = N_i^{-1} \bmod n_i\)</span> (inverse modulaire)</li>
</ul>
<p><strong>Complexité</strong> : <span class="math inline">\(O(\log^3 n)\)</span> - polynomial !</p>
<p><strong>Applications cryptographiques</strong> :</p>
<ol type="1">
<li>Accélération des calculs RSA (utiliser <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> séparément)</li>
<li>Partage de secret (secret sharing schemes)</li>
<li>Certaines attaques sur RSA (si exposant petit et messages multiples)</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<section id="théorème-des-restes-chinois" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="théorème-des-restes-chinois">Théorème des Restes Chinois</h3>
<p>Le <strong>Théorème des Restes Chinois</strong> (IIIe siècle!) permet de résoudre des systèmes linéaires de congruences simultanées. Il résout des problèmes soulevés dans des anciens puzzles chinois. Il s’agissait, par exemple, de trouver un nombre qui produit un reste de 1 lorsqu’il est divisé par 3, de 2 lorsqu’il est divisé par 5 et de 3 lorsqu’il est divisé par 7… Il fut également utilisé pour calculer le moment exact d’alignement de plusieurs astres ayant des orbites (et donc des périodes) différentes.</p>
<p><strong>Théorème des Restes Chinois</strong> : Soient <span class="math inline">\(n_1, n_2, \ldots, n_t \in \mathbb{Z}^+\)</span> premiers deux à deux (c.à.d. pgcd<span class="math inline">\((n_i, n_j) = 1\)</span>, <span class="math inline">\(\forall i \neq j\)</span>) et <span class="math inline">\(a_1, a_2, \ldots, a_t \in \mathbb{Z}\)</span>. Alors, le système de congruences :</p>
<p><span class="math display">\[\begin{cases}
x \equiv a_1 \pmod{n_1} \\
x \equiv a_2 \pmod{n_2} \\
\vdots \\
x \equiv a_t \pmod{n_t}
\end{cases}\]</span></p>
<p>a une solution unique <span class="math inline">\(x \bmod N := n_1 n_2 \cdots n_t\)</span></p>
<p><strong>Algorithme de Gauss</strong> (1801) pour le calcul de <span class="math inline">\(x\)</span> :</p>
<p><span class="math display">\[x = \sum_{i=1}^{t} a_i N_i M_i \bmod N\]</span></p>
<p>avec <span class="math inline">\(N_i = N/n_i\)</span> et <span class="math inline">\(M_i = N_i^{-1} \bmod n_i\)</span>.</p>
<p>La <strong>complexité</strong> de cet algorithme est <span class="math inline">\(O(\log^3 n)\)</span>.</p>
<p>Il est donc possible en <strong>temps polynomial</strong> de passer des congruences mod <span class="math inline">\(n_i\)</span> aux congruences mod <span class="math inline">\(N\)</span> !</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Résout</strong> : systèmes de congruences avec moduli premiers entre eux</li>
<li><strong>Solution unique</strong> : modulo produit des moduli</li>
<li><strong>Complexité</strong> : <span class="math inline">\(O(\log^3 n)\)</span> (polynomial)</li>
<li><strong>Usage crypto</strong> : optimisation RSA, attaques si petit exposant</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="problèmes-de-base-et-complexité" class="level2">
<h2 class="anchored" data-anchor-id="problèmes-de-base-et-complexité">Problèmes de Base et Complexité</h2>
<section id="classification-des-problèmes-difficiles" class="level3">
<h3 class="anchored" data-anchor-id="classification-des-problèmes-difficiles">Classification des Problèmes Difficiles</h3>
<p>La sécurité de la cryptographie asymétrique repose sur des problèmes mathématiques réputés difficiles :</p>
<p><strong>Problèmes génériques</strong> :</p>
<ol type="1">
<li><strong>Factorisation (FACTP)</strong> : Étant donné <span class="math inline">\(n\)</span>, trouver sa factorisation en nombres premiers
<ul>
<li>Base de <strong>RSA</strong> et <strong>Rabin</strong></li>
</ul></li>
<li><strong>Logarithmes discrets (DLP)</strong> : Étant donné <span class="math inline">\(p\)</span> premier, un générateur <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span> et <span class="math inline">\(\beta \in \mathbb{Z}_p^*\)</span>, trouver <span class="math inline">\(x\)</span> tel que : <span class="math display">\[\alpha^x \equiv \beta \pmod{p}\]</span>
<ul>
<li>Base de <strong>ElGamal</strong> et <strong>Diffie-Hellman</strong></li>
</ul></li>
<li><strong>Racine carrée modulo composite (SQROOTP)</strong> : Étant donné <span class="math inline">\(n\)</span> composite et un résidu quadratique <span class="math inline">\(a\)</span>, trouver <span class="math inline">\(\sqrt{a} \bmod n\)</span>
<ul>
<li>Base de <strong>Rabin</strong></li>
</ul></li>
</ol>
<p><strong>Problèmes spécifiques</strong> :</p>
<ol type="1">
<li><p><strong>RSA Problem (RSAP)</strong> : Étant donné <span class="math inline">\(n = pq\)</span>, <span class="math inline">\(e\)</span> avec pgcd<span class="math inline">\((e, \phi(n)) = 1\)</span> et <span class="math inline">\(c\)</span>, trouver <span class="math inline">\(m\)</span> tel que <span class="math inline">\(m^e \equiv c \pmod{n}\)</span></p></li>
<li><p><strong>Diffie-Hellman Problem (DHP)</strong> : Étant donné <span class="math inline">\(p\)</span> premier, <span class="math inline">\(\alpha\)</span> générateur, <span class="math inline">\(\alpha^a \bmod p\)</span> et <span class="math inline">\(\alpha^b \bmod p\)</span>, trouver <span class="math inline">\(\alpha^{ab} \bmod p\)</span></p></li>
</ol>
<p><strong>Équivalences prouvées</strong> :</p>
<ul>
<li><strong>DHP ⟺ DLP</strong> (équivalent sous certaines conditions)</li>
<li><strong>RSAP ⟺ FACTP</strong> (prouvé équivalent pour le cas générique)</li>
<li><strong>SQROOTP ⟺ FACTP</strong></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<section id="problèmes-de-base" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="problèmes-de-base">Problèmes de Base</h3>
<p><strong>Problèmes génériques principaux</strong> :</p>
<ul>
<li><p><strong>Factorisation (FACTP)</strong> : Étant donné un entier positif <span class="math inline">\(n\)</span>, trouver sa factorisation en nombres premiers.</p></li>
<li><p><strong>Logarithmes discrets (DLP)</strong> : Étant donné un nombre premier <span class="math inline">\(p\)</span>, un générateur <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span> et un élément <span class="math inline">\(\beta \in \mathbb{Z}_p^*\)</span>, trouver l’entier <span class="math inline">\(x\)</span>, <span class="math inline">\(0 \leq x \leq p-2\)</span>, tel que : <span class="math inline">\(\alpha^x \equiv \beta \pmod{p}\)</span>.</p></li>
<li><p><strong>Racine carrée dans <span class="math inline">\(\mathbb{Z}_n\)</span> si <span class="math inline">\(n\)</span> est composite (SQROOTP)</strong> : Étant donné un entier composite <span class="math inline">\(n\)</span> et un résidu quadratique <span class="math inline">\(a\)</span>, trouver la racine carrée de <span class="math inline">\(a\)</span> mod <span class="math inline">\(n\)</span>.</p></li>
</ul>
<p><strong>Problèmes spécifiques</strong> (propres à un système de cryptage) :</p>
<ul>
<li><p><strong>RSA (RSAP)</strong> : Étant donné un entier positif <span class="math inline">\(n = pq\)</span>, un entier positif <span class="math inline">\(e\)</span> avec gcd<span class="math inline">\((e, (p-1)(q-1)) = 1\)</span> et un entier <span class="math inline">\(c\)</span>, trouver un entier <span class="math inline">\(m\)</span> avec <span class="math inline">\(m^e \equiv c \pmod{n}\)</span>.</p></li>
<li><p><strong>Diffie-Hellman (DHP)</strong> : Étant donné un nombre premier <span class="math inline">\(p\)</span>, un générateur <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span> et les éléments <span class="math inline">\(\alpha^a \bmod p\)</span> et <span class="math inline">\(\alpha^b \bmod p\)</span>, trouver <span class="math inline">\(\alpha^{ab} \bmod p\)</span>.</p></li>
</ul>
<p><strong>Résultats prouvés</strong> :</p>
<ul>
<li><strong>DHP ⟺ DLP</strong> (Équivalent sous certaines conditions)</li>
<li><strong>RSAP ⟺ FACTP</strong> (Prouvé équivalent pour le problème générique)</li>
<li><strong>SQROOTP ⟺ FACTP</strong></li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>FACTP</strong> : factoriser <span class="math inline">\(n\)</span> → base de RSA/Rabin</li>
<li><strong>DLP</strong> : trouver logarithme discret → base ElGamal/DH</li>
<li><strong>SQROOTP</strong> : racine carrée mod composite → Rabin</li>
<li><strong>Équivalences</strong> : cassage = résolution du problème de base</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="techniques-de-factorisation" class="level3">
<h3 class="anchored" data-anchor-id="techniques-de-factorisation">Techniques de Factorisation</h3>
<p>La sécurité de RSA dépend de la difficulté de factoriser de grands nombres.</p>
<p><strong>Méthodes à temps exponentiel</strong> : <span class="math inline">\(O(\exp(c \cdot \ln(n)))\)</span></p>
<ul>
<li>Trial Division (division successive)</li>
<li>Crible d’Ératosthène (IIe siècle av. J.-C.)</li>
<li>Méthode de Fermat (~1650)</li>
<li>Méthode <span class="math inline">\(\rho\)</span> de Pollard (1975)</li>
<li>Méthode <span class="math inline">\(p-1\)</span> de Pollard (1974)</li>
</ul>
<p><strong>Méthodes à temps sous-exponentiel</strong> : <span class="math inline">\(O(\exp(c \cdot (\ln(n))^{1/3}))\)</span></p>
<ul>
<li>Continued Fractions (1975)</li>
<li><strong>Quadratic Sieve (1981)</strong> - très efficace en pratique</li>
<li><strong>Number Field Sieve - NFS (1990)</strong> - le plus rapide actuellement</li>
<li>General Number Field Sieve - GNFS (2006)</li>
</ul>
<p><strong>Méthodes à temps polynomial</strong> :</p>
<ul>
<li><strong>Algorithme de Shor</strong> (1994) : <span class="math inline">\(O(\log^c n)\)</span> sur <strong>ordinateur quantique</strong></li>
</ul>
<p><strong>Records actuels (2020)</strong> :</p>
<ul>
<li>Plus grand nombre factorisé : <strong>RSA-829</strong> (250 chiffres, 829 bits)</li>
<li>Temps de calcul : 2700 années-cœur (CPUs Intel Xeon Gold 6130)</li>
<li>Méthode : General Number Field Sieve</li>
</ul>
<p><strong>Implications</strong> :</p>
<ul>
<li>Clés RSA &lt; 1024 bits : <strong>vulnérables</strong></li>
<li>Clés RSA 1024 bits : <strong>limites</strong> (états avec ressources importantes)</li>
<li>Recommandation : <strong>2048 bits minimum</strong> (3072-4096 pour long terme)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<section id="classical-factoring-techniques-et-new-developments" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="classical-factoring-techniques-et-new-developments">Classical Factoring Techniques et New Developments</h3>
<p><strong>Temps exponentiel</strong> : <span class="math inline">\(O(\exp(c \cdot \ln(n)))\)</span></p>
<ul>
<li>Trial Division</li>
<li>Eratosthenes’ Sieve (II B.C.)</li>
<li>Fermat’s Difference of Squares Method (~1650)</li>
<li>Square Form Factorization (1971)</li>
<li>Pollard’s p-1 method (1974)</li>
<li>Pollard’s Rho Method (1975)</li>
</ul>
<p><strong>Temps sous-exponentiel</strong> : <span class="math inline">\(O(\exp(c \cdot (\ln(n))^{1/3}))\)</span></p>
<ul>
<li>Continued Fractions (1975)</li>
<li><strong>Quadratic Sieve (1981)</strong></li>
<li><strong>Number Field Sieve - NFS (1990)</strong></li>
<li><strong>General Number Field Sieve - GNFS (2006)</strong></li>
</ul>
<p><strong>Temps polynomial</strong> :</p>
<ul>
<li><strong>Shor’s Algorithm in a Quantum Computer (1994)</strong> : <span class="math inline">\(O(\log^c n)\)</span></li>
</ul>
<p><strong>Développements récents</strong> :</p>
<ul>
<li>L’ordinateur NFS spécifique de Bernstein pour factoriser un nombre de 1536 bits prendrait le même temps qu’un calcul 512 bits sur machine conventionnelle</li>
<li><strong>Plus grande factorisation à ce jour (2020)</strong> : RSA-829 (nombre de 250 chiffres) utilisant NFS</li>
<li>Temps de calcul total : <strong>2700 années-cœur</strong> (CPUs Intel Xeon Gold 6130 à 2.1GHz)</li>
</ul>
<p><strong>Factorisation sur ordinateur quantique</strong> :</p>
<ul>
<li>Problèmes significatifs (erreurs, dispersion, etc.)</li>
<li>2001 : ordinateur 7 qubits (IBM Almaden)</li>
<li>Faisabilité d’un ordinateur avec millions de qubits… ?</li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Sous-exponentiel</strong> : NFS actuellement le plus rapide</li>
<li><strong>Record 2020</strong> : RSA-829 (829 bits) en 2700 années-cœur</li>
<li><strong>Recommandation</strong> : clés ≥ 2048 bits pour RSA</li>
<li><strong>Menace future</strong> : ordinateurs quantiques (Shor)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="lalgorithme-rsa" class="level2">
<h2 class="anchored" data-anchor-id="lalgorithme-rsa">L’Algorithme RSA</h2>
<section id="fonctionnement-de-rsa-encryptiondecryption" class="level3">
<h3 class="anchored" data-anchor-id="fonctionnement-de-rsa-encryptiondecryption">Fonctionnement de RSA (Encryption/Decryption)</h3>
<p>RSA (Rivest-Shamir-Adleman, 1978) est l’algorithme asymétrique le plus utilisé.</p>
<p><strong>Génération des clés</strong> :</p>
<ol type="1">
<li>Choisir deux nombres premiers <strong>grands</strong> <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> (≥ 1024 bits chacun)</li>
<li>Calculer <span class="math inline">\(n := p \cdot q\)</span> et <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span></li>
<li>Choisir exposant d’encryption <span class="math inline">\(e\)</span> avec :
<ul>
<li><span class="math inline">\(1 &lt; e &lt; \phi(n)\)</span></li>
<li>pgcd<span class="math inline">\((e, \phi(n)) = 1\)</span></li>
</ul></li>
<li>Calculer exposant de décryption <span class="math inline">\(d\)</span> tel que : <span class="math display">\[e \cdot d \equiv 1 \pmod{\phi(n)}\]</span> (avec algorithme d’Euclide étendu ou fast exponentiation)</li>
</ol>
<p><strong>Clés résultantes</strong> :</p>
<ul>
<li>Clé <strong>publique</strong> : <span class="math inline">\((n, e)\)</span></li>
<li>Clé <strong>privée</strong> : <span class="math inline">\(d\)</span> (garder <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> secrets aussi !)</li>
</ul>
<p><strong>Encryption</strong> (par Bob, vers Alice) :</p>
<ol type="1">
<li>Obtenir clé publique authentique <span class="math inline">\((n, e)\)</span> d’Alice</li>
<li>Transformer plaintext en entiers <span class="math inline">\(m_i \in [0, n-1]\)</span></li>
<li>Calculer ciphertexts : <span class="math inline">\(c_i := m_i^e \bmod n\)</span></li>
<li>Envoyer les <span class="math inline">\(c_i\)</span> à Alice</li>
</ol>
<p><strong>Decryption</strong> (par Alice) :</p>
<ul>
<li>Utiliser clé privée <span class="math inline">\(d\)</span> pour calculer : <span class="math display">\[m_i = c_i^d \bmod n\]</span></li>
</ul>
<p><strong>Preuve de fonctionnement</strong> :</p>
<p><span class="math display">\[c^d \equiv (m^e)^d \equiv m^{ed} \pmod{n}\]</span></p>
<p>Comme <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span>, il existe <span class="math inline">\(k\)</span> tel que <span class="math inline">\(ed = 1 + k\phi(n)\)</span>, donc :</p>
<p><span class="math display">\[c^d \equiv m^{1+k\phi(n)} \equiv m \cdot (m^{\phi(n)})^k \equiv m \cdot 1^k \equiv m \pmod{n}\]</span></p>
<p>(par le théorème d’Euler)</p>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<section id="procédé-dencryptiondecryption-de-rsa-et-preuve" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="procédé-dencryptiondecryption-de-rsa-et-preuve">Procédé d’Encryption/Decryption de RSA et Preuve</h3>
<p><strong>Génération des clés</strong> :</p>
<ul>
<li>Chaque entité (A) crée une paire de clés (publique et privée) comme suit :
<ul>
<li>A choisit la taille du modulus <span class="math inline">\(n\)</span> (p.ex. taille<span class="math inline">\((n) = 1024\)</span> ou taille<span class="math inline">\((n) = 2048\)</span>).</li>
<li>A génère deux nombres premiers <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> de grande taille <span class="math inline">\((n/2)\)</span>.</li>
<li>A calcule <span class="math inline">\(n := pq\)</span> et <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span>.</li>
<li>A génère l’exposant d’encryption <span class="math inline">\(e\)</span>, avec <span class="math inline">\(1 &lt; e &lt; \phi(n)\)</span> t.q. pgcd<span class="math inline">\((e, \phi(n)) = 1\)</span>.</li>
<li>A calcule l’exposant de decryption <span class="math inline">\(d\)</span>, t.q. : <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span> avec l’algorithme d’Euclide étendu ou avec l’algorithme fast exponentiation.</li>
</ul></li>
<li>Le couple <span class="math inline">\((n,e)\)</span> est la clé <strong>publique</strong> de A ; <span class="math inline">\(d\)</span> est la clé <strong>privée</strong> de A.</li>
</ul>
<p><strong>Encryption</strong> :</p>
<ul>
<li>L’entité B obtient <span class="math inline">\((n,e)\)</span>, la clé publique <strong>authentique</strong> de A.</li>
<li>B transforme son plaintext en une série d’entiers <span class="math inline">\(m_i\)</span>, t.q. <span class="math inline">\(m_i \in [0, n-1]\)</span> <span class="math inline">\(\forall i\)</span>.</li>
<li>B calcule le ciphertext <span class="math inline">\(c_i := m_i^e \bmod n\)</span>, <span class="math inline">\(\forall i\)</span> avec l’algorithme fast exponentiation.</li>
<li>B envoie à A tous les ciphertext <span class="math inline">\(c_i\)</span>.</li>
</ul>
<p><strong>Decryption</strong> :</p>
<ul>
<li>A utilise sa clé privée pour calculer les plaintexts <span class="math inline">\(m_i = c_i^d \bmod n\)</span>.</li>
</ul>
<p><strong>Preuve</strong> : Soit <span class="math inline">\(m\)</span> le plaintext et <span class="math inline">\(c\)</span> le ciphertext avec <span class="math inline">\(c := m^e \bmod n\)</span>, il s’agit de prouver : <span class="math inline">\(m \stackrel{!}{=} c^d \bmod n\)</span></p>
<p>En substituant <span class="math inline">\(c\)</span> par sa valeur on obtient : <span class="math display">\[c^d \bmod n = m^{ed} \bmod n \quad (*)\]</span></p>
<p>mais, on sait que : <span class="math display">\[ed \equiv 1 \pmod{\phi(n)}\]</span></p>
<p>et donc par définition des congruences, il existe un entier <span class="math inline">\(k\)</span> avec : <span class="math display">\[ed - 1 = k\phi(n)\]</span></p>
<p>en substituant dans (*) : <span class="math display">\[c^d \equiv m^{k\phi(n)+1} \equiv m^{k\phi(n)} \cdot m \pmod{n}\]</span></p>
<p>Si pgcd<span class="math inline">\((m,n) = 1\)</span>, on a par le <strong>théorème d’Euler</strong> : <span class="math display">\[m^{\phi(n)} \equiv 1 \pmod{n}\]</span></p>
<p>donc : <span class="math display">\[c^d \equiv (m^{\phi(n)})^k \cdot m \equiv m \pmod{n}\]</span> c.q.f.d. !</p>
<p>Si pgcd<span class="math inline">\((m,n) \neq 1\)</span>, <span class="math inline">\(m\)</span> est nécessairement multiple de <span class="math inline">\(p\)</span> ou de <span class="math inline">\(q\)</span> (cas très peu probable…), on peut montrer en faisant les calculs mod <span class="math inline">\(p\)</span> et mod <span class="math inline">\(q\)</span> que la congruence reste vraie.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Clé publique</strong> : <span class="math inline">\((n, e)\)</span> avec <span class="math inline">\(n = pq\)</span></li>
<li><strong>Clé privée</strong> : <span class="math inline">\(d\)</span> tel que <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span></li>
<li><strong>Chiffrement</strong> : <span class="math inline">\(c = m^e \bmod n\)</span></li>
<li><strong>Déchiffrement</strong> : <span class="math inline">\(m = c^d \bmod n\)</span></li>
<li><strong>Sécurité</strong> : basée sur difficulté de factoriser <span class="math inline">\(n\)</span></li>
</ul>
</div>
</div>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Plaintext m] --&gt;|Encryption: m^e mod n| B[Ciphertext c]
    B --&gt;|Decryption: c^d mod n| C[Plaintext m]
    D[Clé publique: n, e] -.-&gt;|utilisée pour| A
    E[Clé privée: d] -.-&gt;|utilisée pour| B
    F[p, q premiers secrets] --&gt;|n = pq| D
    F --&gt;|φn = p-1q-1| E
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
<section id="sécurité-de-rsa" class="level3">
<h3 class="anchored" data-anchor-id="sécurité-de-rsa">Sécurité de RSA</h3>
<p><strong>Équivalence problème RSA ⟺ Factorisation</strong> :</p>
<ul>
<li>Trouver <span class="math inline">\(d\)</span> ⟺ factoriser <span class="math inline">\(n\)</span> (prouvé équivalent)</li>
<li>Décrypter sans <span class="math inline">\(d\)</span> n’est <strong>pas prouvé</strong> aussi difficile que factoriser, mais…</li>
<li>Aucune méthode plus rapide que factorisation n’est connue</li>
</ul>
<p><strong>Complexité de la factorisation</strong> :</p>
<ul>
<li>Méthodes les plus rapides : <span class="math inline">\(O(\exp(c \cdot (\ln(n))^{1/3}))\)</span> (sous-exponentiel)</li>
<li>Calculatoirement impossible pour <span class="math inline">\(n \geq 1024\)</span> bits</li>
<li><strong>Recommandation actuelle</strong> : 2048 bits minimum (3072-4096 pour sécurité durable)</li>
</ul>
<p><strong>Choix des exposants</strong> :</p>
<ul>
<li><p><strong>Exposant d’encryption <span class="math inline">\(e\)</span></strong> :</p>
<ul>
<li>Souvent <strong>petit</strong> pour accélérer : <span class="math inline">\(e = 3, 17, 65537\)</span> (commun)</li>
<li>Attention : si <span class="math inline">\(e\)</span> trop petit ET <span class="math inline">\(m &lt; n^{1/e}\)</span>, attaque possible (racine <span class="math inline">\(e\)</span>-ième dans <span class="math inline">\(\mathbb{Z}\)</span>)</li>
<li>Solution : <strong>randomization</strong> (padding) du message</li>
</ul></li>
<li><p><strong>Exposant de décryption <span class="math inline">\(d\)</span></strong> :</p>
<ul>
<li>Doit être <strong>grand</strong> : au moins la moitié de la taille de <span class="math inline">\(n\)</span></li>
<li>Si <span class="math inline">\(d\)</span> petit : vulnérable à l’attaque de Wiener</li>
</ul></li>
</ul>
<p><strong>Conséquence performance</strong> :</p>
<ul>
<li><strong>Encryption rapide</strong> (<span class="math inline">\(e\)</span> petit)</li>
<li><strong>Decryption lente</strong> (<span class="math inline">\(d\)</span> grand)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<section id="rsa-sécurité" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="rsa-sécurité">RSA: Sécurité</h3>
<p>Le problème <strong>RSAP</strong> consistant à trouver <span class="math inline">\(m\)</span> à partir de <span class="math inline">\(c\)</span> n’est pas prouvé comme étant aussi difficile que la factorisation mais… :</p>
<ul>
<li><p>On peut prouver que si on trouve <span class="math inline">\(d\)</span> on peut facilement calculer <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span>. Ceci équivaut à dire que <strong>factoriser <span class="math inline">\(n\)</span> et trouver <span class="math inline">\(d\)</span> nécessitent un effort de calcul équivalent</strong>.</p></li>
<li><p>On sait que les méthodes les plus rapides pour factoriser ont une <strong>complexité sub-exponentielle</strong> <span class="math inline">\(O(\exp(c \cdot (\ln(n))^{1/3}))\)</span>. Le problème reste donc <strong>calculatoirement impossible</strong> pour des modulus <span class="math inline">\(\geq 1048\)</span> bits (2048 bits est un choix fréquent pour une sécurité durable…).</p></li>
<li><p>Afin d’améliorer la vitesse d’encryption, on a tendance à choisir des <strong>exposants <span class="math inline">\(e\)</span> assez petits</strong> (typiquement : <span class="math inline">\(e := 3\)</span>, <span class="math inline">\(e := 17\)</span> et <span class="math inline">\(e := 19\)</span>). On a cependant prouvé que le calcul d’une <span class="math inline">\(i\)</span>-ème racine (avec <span class="math inline">\(i\)</span> petit) modulo un composite <span class="math inline">\(n\)</span> peut être nettement plus facile que la factorisation de <span class="math inline">\(n\)</span>. Par contre, en 2008 on a prouvé que la résolution générique du problème RSA est équivalent à la factorisation.</p></li>
<li><p>L’<strong>exposant de decryption <span class="math inline">\(d\)</span> doit impérativement être de grande taille</strong> (au moins la moitié de la taille de <span class="math inline">\(n\)</span>) pour garantir la sécurité du système.</p></li>
<li><p>Par conséquent, l’<strong>encryption est normalement nettement plus rapide que la decryption</strong> puisque les exposants utilisés sont beaucoup plus petits !</p></li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Sécurité</strong> : basée sur difficulté de FACTP (factorisation)</li>
<li><strong>Taille recommandée</strong> : <span class="math inline">\(n \geq 2048\)</span> bits</li>
<li><strong><span class="math inline">\(e\)</span> petit</strong> : encryption rapide (3, 17, 65537)</li>
<li><strong><span class="math inline">\(d\)</span> grand</strong> : au moins <span class="math inline">\(\text{taille}(n)/2\)</span></li>
<li><strong>Clés séparées</strong> : encryption ≠ signature</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="attaques-sur-rsa" class="level3">
<h3 class="anchored" data-anchor-id="attaques-sur-rsa">Attaques sur RSA</h3>
<section id="attaque-sur-exposant-petit-avec-même-message" class="level4">
<h4 class="anchored" data-anchor-id="attaque-sur-exposant-petit-avec-même-message">Attaque sur exposant petit avec même message</h4>
<p>Si on envoie le même message <span class="math inline">\(m\)</span> à 3 destinataires avec <span class="math inline">\(e = 3\)</span> :</p>
<ul>
<li><span class="math inline">\(c_1 \equiv m^3 \pmod{n_1}\)</span></li>
<li><span class="math inline">\(c_2 \equiv m^3 \pmod{n_2}\)</span></li>
<li><span class="math inline">\(c_3 \equiv m^3 \pmod{n_3}\)</span></li>
</ul>
<p>Le <strong>Théorème des Restes Chinois</strong> donne une solution unique <span class="math inline">\(x \bmod n_1n_2n_3\)</span> telle que : <span class="math display">\[x \equiv c_1 \pmod{n_1}, \quad x \equiv c_2 \pmod{n_2}, \quad x \equiv c_3 \pmod{n_3}\]</span></p>
<p>Si <span class="math inline">\(m^3 &lt; n_1n_2n_3\)</span> (souvent vrai), alors <span class="math inline">\(x = m^3\)</span> dans <span class="math inline">\(\mathbb{Z}\)</span> et on peut calculer <span class="math inline">\(m\)</span> en prenant simplement la racine cubique entière !</p>
<p><strong>Protection</strong> : toujours randomizer le message avant encryption (padding OAEP)</p>
</section>
<section id="attaque-si-message-petit" class="level4">
<h4 class="anchored" data-anchor-id="attaque-si-message-petit">Attaque si message petit</h4>
<p>Si <span class="math inline">\(m &lt; n^{1/e}\)</span>, alors <span class="math inline">\(m^e &lt; n\)</span>, donc <span class="math inline">\(c = m^e\)</span> (dans <span class="math inline">\(\mathbb{Z}\)</span>, pas modulo). On peut calculer directement la racine <span class="math inline">\(e\)</span>-ième !</p>
<p><strong>Protection</strong> : padding obligatoire</p>
</section>
<section id="propriété-multiplicative" class="level4">
<h4 class="anchored" data-anchor-id="propriété-multiplicative">Propriété multiplicative</h4>
<p><span class="math display">\[E(m_1) \cdot E(m_2) \equiv (m_1 \cdot m_2)^e \equiv E(m_1 \cdot m_2) \pmod{n}\]</span></p>
<p>Permet des attaques de type chosen-ciphertext et blind signatures.</p>
</section>
<section id="attaque-générale" class="level4">
<h4 class="anchored">Attaque générale</h4>
<p>La méthode la plus efficace reste la <strong>factorisation de <span class="math inline">\(n\)</span></strong> (si paramètres bien choisis et implémentation correcte).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Texte Original">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte Original
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<section id="rsa-attaques" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="rsa-attaques">RSA: Attaques</h3>
<p>Lors qu’on souhaite encrypter le <strong>même message pour un groupe de correspondants</strong>, il convient d’introduire des variations (<strong>randomization</strong>) avant l’encryption pour éviter l’attaque suivante :</p>
<p>Admettons qu’on calcule des ciphertexts <span class="math inline">\(c_1, c_2, c_3\)</span> à partir du même plaintext <span class="math inline">\(m\)</span> et du même exposant <span class="math inline">\(e := 3\)</span> adressés à trois entités avec des modulus : <span class="math inline">\(n_1, n_2, n_3\)</span>.</p>
<p>Le <strong>Théorème des Restes Chinois</strong> nous dit qu’il existe une solution <span class="math inline">\(x \bmod n_1n_2n_3\)</span>, t.q. : <span class="math display">\[x \equiv c_1 \pmod{n_1}, \quad x \equiv c_2 \pmod{n_2}, \quad x \equiv c_3 \pmod{n_3}\]</span></p>
<p>Mais si <span class="math inline">\(m\)</span> ne change pas pour les trois encryptions, on a que <span class="math inline">\(x = m^3 \bmod n_1n_2n_3\)</span> et, de plus : <span class="math inline">\(m^3 &lt; n_1n_2n_3\)</span>. On peut, donc, trouver <span class="math inline">\(m\)</span> en calculant la <strong>racine cubique entière</strong> de <span class="math inline">\(m^3\)</span>, en sachant que pour ce calcul il existe des algorithmes efficaces !</p>
<p>Plus généralement, si <span class="math inline">\(m &lt; n^{1/e}\)</span>, on peut appliquer des algorithmes rapides (dans <span class="math inline">\(\mathbb{Z}\)</span>) pour calculer les racines <span class="math inline">\(e\)</span>-ièmes de <span class="math inline">\(m^e\)</span>. Il convient donc d’effectuer des opérations de <strong>“randomization” de <span class="math inline">\(m\)</span> avant d’encrypter</strong> !</p>
<p><strong>La propriété multiplicative de RSA</strong> : <span class="math inline">\((m_1 m_2)^e \equiv m_1^e \cdot m_2^e \equiv c_1 \cdot c_2 \pmod{n}\)</span></p>
<p>donne lieu à des <strong>failles dangereuses</strong> (voir signatures aveugles).</p>
<p>En admettant que les paramètres sont correctement choisis et que l’implantation n’a pas de failles, <strong>la méthode la plus efficace pour “casser” l’algorithme générique RSA reste la factorisation de <span class="math inline">\(n\)</span></strong>.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Révision Rapide">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision Rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Même message, petit <span class="math inline">\(e\)</span></strong> : CRT permet d’extraire <span class="math inline">\(m\)</span> !</li>
<li><strong>Message trop petit</strong> : <span class="math inline">\(m &lt; n^{1/e}\)</span> → racine directe</li>
<li><strong>Propriété multiplicative</strong> : <span class="math inline">\(E(m_1) \cdot E(m_2) = E(m_1 m_2)\)</span></li>
<li><strong>Protection</strong> : toujours padding/randomization (OAEP)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="lalgorithme-elgamal" class="level2">
<h2 class="anchored" data-anchor-id="lalgorithme-elgamal">L’Algorithme ElGamal</h2>
<p>Système asymétrique (1985) basé sur le <strong>problème du logarithme discret (DLP)</strong>.</p>
<p><strong>Clés :</strong></p>
<ul>
<li>Choisir premier <span class="math inline">\(p\)</span>, générateur <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span>, secret <span class="math inline">\(a\)</span></li>
<li>Calculer <span class="math inline">\(y = \alpha^a \bmod p\)</span></li>
<li><strong>Publique</strong> : <span class="math inline">\((p, \alpha, y)\)</span> | <strong>Privée</strong> : <span class="math inline">\(a\)</span></li>
</ul>
<p><strong>Chiffrement :</strong> Pour message <span class="math inline">\(m\)</span>, choisir aléatoire <span class="math inline">\(k\)</span> unique</p>
<ul>
<li><span class="math inline">\(\gamma = \alpha^k \bmod p\)</span></li>
<li><span class="math inline">\(\delta = m \cdot y^k \bmod p\)</span></li>
<li>Envoyer <span class="math inline">\((\gamma, \delta)\)</span></li>
</ul>
<p><strong>Déchiffrement :</strong> <span class="math inline">\(m = \delta \cdot \gamma^{-a} \bmod p\)</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Texte original du cours">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original du cours
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<section id="procédé-dencryptiondecryption-delgamal" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="procédé-dencryptiondecryption-delgamal">Procédé d’Encryption/Decryption d’ElGamal</h2>
<p><strong>Génération des clés</strong></p>
<p>Chaque entité (A) crée une paire de clés (publique et privée) comme suit:</p>
<ul>
<li>A génère un nombre premier <span class="math inline">\(p\)</span> (len(<span class="math inline">\(p\)</span>) ≥ 1024 bits) et un <strong>générateur <span class="math inline">\(\alpha\)</span></strong> du groupe multiplicatif <span class="math inline">\(\mathbb{Z}_p^*\)</span></li>
<li>A génère un nombre aléatoire <span class="math inline">\(a\)</span>, t.q. <span class="math inline">\(1 \leq a \leq p-2\)</span> et calcule <span class="math inline">\(y := \alpha^a \bmod p\)</span></li>
<li>La <strong>clé publique</strong> de A est <span class="math inline">\((p, \alpha, y)\)</span>, la <strong>clé privée</strong> de A est <span class="math inline">\(a\)</span></li>
</ul>
<p><strong>Encryption</strong></p>
<ul>
<li>L’entité B obtient <span class="math inline">\((p, \alpha, \alpha^a \bmod p)\)</span>, la clé publique authentique de A</li>
<li>B transforme son plaintext en une série d’entiers <span class="math inline">\(m_i\)</span>, t.q. <span class="math inline">\(m_i \in [0, p-1]\)</span> <span class="math inline">\(\forall i\)</span></li>
<li>Pour chaque message <span class="math inline">\(m_i\)</span> :
<ul>
<li>B génère un nombre aléatoire <strong>unique</strong> <span class="math inline">\(k\)</span>, t.q. <span class="math inline">\(1 \leq k \leq p-2\)</span></li>
<li>B calcule <span class="math inline">\(\gamma := \alpha^k \bmod p\)</span> et <span class="math inline">\(\delta := m_i \cdot (\alpha^a)^k \bmod p\)</span> et envoie le ciphertext <span class="math inline">\(c := (\gamma, \delta)\)</span></li>
</ul></li>
</ul>
<p><strong>Decryption</strong></p>
<ul>
<li>A utilise sa clé privée <span class="math inline">\(a\)</span> pour calculer <span class="math inline">\(\gamma^{p-1-a} \bmod p\)</span> (à noter que: <span class="math inline">\(\gamma^{p-1-a} \equiv \gamma^{-a} \equiv \alpha^{-ak} \bmod p\)</span>)</li>
<li>A retrouve le plaintext en calculant: <span class="math inline">\(\delta \cdot \gamma^{-ak} \bmod p\)</span></li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Base</strong> : DLP dans <span class="math inline">\(\mathbb{Z}_p^*\)</span></p>
<p><strong>Chiffré</strong> : <span class="math inline">\((\alpha^k, m \cdot y^k)\)</span></p>
<p><strong>Sécurité</strong> : <span class="math inline">\(k\)</span> doit être unique et grand</p>
<p><strong>Inconvénient</strong> : double la taille du message</p>
</div>
</div>
</div>
<section id="remarques-essentielles" class="level3">
<h3 class="anchored" data-anchor-id="remarques-essentielles">Remarques essentielles</h3>
<ul>
<li><strong>Preuve</strong> : <span class="math inline">\(\delta \cdot \gamma^{-a} = m \cdot (\alpha^a)^k \cdot (\alpha^k)^{-a} = m \bmod p\)</span></li>
<li><strong>Sécurité</strong> : basée sur DLP (complexité sub-exponentielle proche de la factorisation)</li>
<li><strong>Exposants</strong> : <span class="math inline">\(k\)</span> et <span class="math inline">\(a\)</span> doivent être grands (sinon vulnérable à baby-step giant-step)</li>
<li><strong>Réutilisation interdite</strong> : si <span class="math inline">\(k\)</span> répété, <span class="math inline">\(\delta_1/\delta_2 = m_1/m_2\)</span> révèle les messages</li>
<li><strong>Inconvénient majeur</strong> : expansion ×2 de la taille du chiffré</li>
<li><strong>Généralisation</strong> : fonctionne sur <span class="math inline">\(GF(2^n)\)</span> ou courbes elliptiques</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original - Remarques
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Preuve</strong> que le schéma fonctionne : Si <span class="math inline">\(s \equiv k^{-1}(m_h - ar) \bmod (p-1)\)</span>, on a que: <span class="math inline">\(m_h \equiv (ar + ks) \bmod (p-1)\)</span> et <span class="math inline">\(v_2 = \alpha^{H(m)} \bmod p\)</span>. Si, comme on souhaite montrer <span class="math inline">\(m_h = H(m)\)</span>, en réduisant les exposants mod <span class="math inline">\((p-1)\)</span>, on peut réécrire <span class="math inline">\(v_2\)</span>: <span class="math inline">\(v_2 \equiv \alpha^{ar+ks} \bmod p\)</span>. D’autre part: <span class="math inline">\(v_1 = y^r\alpha^{rs} \equiv \alpha^{ar}\alpha^{ks} \equiv \alpha^{ar+ks} \bmod p\)</span>.</p>
<p>Le procédé d’ElGamal se base sur la difficulté de calculer des <strong>logarithmes discrets modulo un nombre premier</strong> (problème DLP) même s’il n’a pas été prouvé qu’il soit strictement équivalent à ce problème.</p>
<p>Les <strong>algorithmes les plus efficaces</strong> connus ont une complexité sub-exponentielle très proche de celle de la factorisation (on utilise souvent les mêmes algorithmes).</p>
<p>Les <strong>exposants choisis</strong> (<span class="math inline">\(k\)</span>, <span class="math inline">\(a\)</span>) doivent être de grande taille car il existe des algorithmes efficaces pour calculer des logarithmes discrets modulo un nombre premier lorsque l’exposant est petit (baby-step giant-step algorithm).</p>
<p>Un <strong>inconvénient d’ElGamal</strong> est qu’il multiplie par 2 la longueur du ciphertext.</p>
<p>Il est <strong>essentiel</strong> pour la sécurité du procédé que le nombre aléatoire <span class="math inline">\(k\)</span> ne soit pas répété, autrement: soient <span class="math inline">\((\gamma_1, \delta_1)\)</span> et <span class="math inline">\((\gamma_2, \delta_2)\)</span> les deux ciphertexts générés, on a que <span class="math inline">\(\delta_1/\delta_2 = m_1/m_2\)</span> et par conséquent, il est trivial de retrouver un plaintext à partir de l’autre.</p>
<p>Le procédé d’ElGamal peut se <strong>généraliser</strong> à d’autres groupes comme <span class="math inline">\(GF(2^n)\)</span> ou les courbes elliptiques.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision rapide - Remarques
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Équivalence</strong> : basé sur DLP (non prouvé équivalent)</p>
<p><strong><span class="math inline">\(k\)</span> unique</strong> : CRITIQUE - sinon <span class="math inline">\(m_1/m_2\)</span> révélé</p>
<p><strong>Taille clés</strong> : exposants grands nécessaires</p>
<p><strong>Extensions</strong> : <span class="math inline">\(GF(2^n)\)</span>, courbes elliptiques</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="algorithme-de-rabin" class="level2">
<h2 class="anchored" data-anchor-id="algorithme-de-rabin">Algorithme de Rabin</h2>
<p>Système asymétrique <strong>équivalent à la factorisation</strong> (provably secure).</p>
<p><strong>Clés :</strong></p>
<ul>
<li>Générer deux premiers <span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span> (≥1024 bits total), calculer <span class="math inline">\(n = pq\)</span>
<ul>
<li><strong>Publique</strong> : <span class="math inline">\(n\)</span></li>
<li><strong>Privée</strong> : <span class="math inline">\((p, q)\)</span></li>
</ul></li>
</ul>
<p><strong>Chiffrement :</strong> <span class="math inline">\(c = m^2 \bmod n\)</span></p>
<p><strong>Déchiffrement :</strong></p>
<ul>
<li>Calculer les 4 racines carrées de <span class="math inline">\(c \bmod n\)</span> (via racines mod <span class="math inline">\(p\)</span> et mod <span class="math inline">\(q\)</span>)</li>
<li>Identifier le bon message par redondance</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Texte original du cours">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original du cours
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<section id="procédé-dencryptiondecryption-de-rabin" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="procédé-dencryptiondecryption-de-rabin">Procédé d’Encryption/Decryption de Rabin</h2>
<p><strong>Génération des clés</strong></p>
<p>Chaque entité (A) crée une paire de clés (publique et privée) comme suit:</p>
<ul>
<li>A génère deux nombres premiers aléatoires <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> de grande taille (len(<span class="math inline">\(pq\)</span>) ≥ 1024)</li>
<li>A calcule <span class="math inline">\(n := pq\)</span></li>
<li>La <strong>clé publique</strong> de A est <span class="math inline">\(n\)</span>, la <strong>clé privée</strong> de A est <span class="math inline">\((p, q)\)</span></li>
</ul>
<p><strong>Encryption</strong></p>
<ul>
<li>L’entité B obtient <span class="math inline">\(n\)</span>, la clé publique authentique de A</li>
<li>B transforme son plaintext en une série d’entiers <span class="math inline">\(m_i\)</span>, t.q. <span class="math inline">\(m_i \in [0, n-1]\)</span> <span class="math inline">\(\forall i\)</span></li>
<li>B calcule <span class="math inline">\(c_i = m_i^2 \bmod n\)</span> pour chaque message <span class="math inline">\(m_i\)</span></li>
<li>B envoie tous les ciphertext <span class="math inline">\(c_i\)</span> à A</li>
</ul>
<p><strong>Decryption</strong></p>
<ul>
<li>A utilise sa clé privée <span class="math inline">\((p, q)\)</span> pour retrouver les <strong>4 solutions</strong> de l’équation: <span class="math inline">\(c_i = x^2 \bmod n\)</span> en utilisant des <strong>algorithmes efficaces</strong> pour calculer des racines carrées <span class="math inline">\(\bmod p\)</span> et <span class="math inline">\(\bmod q\)</span></li>
<li>A détermine soit par une <strong>indication supplémentaire</strong> de B, soit par une <strong>analyse de redondance</strong> lequel des 4 messages <span class="math inline">\(m_1, m_2, m_3, m_4\)</span> est le plaintext original</li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision rapide
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Base</strong> : SQROOTP (racine carrée mod composite)</p>
<p><strong>Avantage</strong> : équivalent prouvé à factorisation</p>
<p><strong>Problème</strong> : 4 solutions possibles, nécessite redondance</p>
<p><strong>Vulnérabilité</strong> : attaque chosen-ciphertext révèle facteurs</p>
</div>
</div>
</div>
<section id="remarques-essentielles-1" class="level3">
<h3 class="anchored" data-anchor-id="remarques-essentielles-1">Remarques essentielles</h3>
<ul>
<li><strong>Sécurité prouvée</strong> : SQROOTP ⟺ FACTP (seul algorithme avec équivalence prouvée)</li>
<li><strong>Attaque chosen-ciphertext</strong> : si A décrypte <span class="math inline">\(c = m^2 \bmod n\)</span> choisi par adversaire M
<ul>
<li>M reçoit une racine <span class="math inline">\(m_x\)</span> parmi 4 possibles</li>
<li>Si <span class="math inline">\(m \neq m_x \bmod n\)</span> (prob. 0.5), alors <span class="math inline">\(\gcd(m - m_x, n)\)</span> donne un facteur de <span class="math inline">\(n\)</span></li>
</ul></li>
<li><strong>Solution</strong> : exiger redondance suffisante pour identifier solution unique sans ambiguïté</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original - Remarques
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Le procédé de Rabin est basé sur l’<strong>impossibilité de trouver des racines carrées modulo un composite de factorisation inconnue</strong> (problème SQROOTP).</p>
<p>L’<strong>intérêt principal</strong> de cet algorithme réside dans le fait qu’il a été <strong>prouvé comme étant équivalent à la factorisation</strong> (SQROOTP ⟺ FACTP). Cet algorithme appartient donc à la catégorie <strong>provably secure</strong> pour toute attaque passive.</p>
<p>Les <strong>attaques actives</strong> peuvent, dans certains cas, compromettre la sécurité de l’algorithme. Plus précisément, si on monte l’attaque <strong>chosen ciphertext</strong> suivant:</p>
<ul>
<li>L’attaquant M génère un <span class="math inline">\(m\)</span> et envoie à A le ciphertext <span class="math inline">\(c = m^2 \bmod n\)</span>.</li>
<li>A répond avec une racine <span class="math inline">\(m_x\)</span> parmi les 4 possibles <span class="math inline">\(m_1, m_2, m_3, m_4\)</span>.</li>
<li>Si <span class="math inline">\(m \neq m_x \bmod n\)</span> (probabilité 0.5), M recommence avec un nouveau <span class="math inline">\(m\)</span>.</li>
<li>Sinon, A calcule <span class="math inline">\(\gcd(m - m_x, n)\)</span> et obtient ainsi un des deux facteurs de <span class="math inline">\(n\)</span>.</li>
</ul>
<p>Cette attaque pourrait être <strong>évitée</strong> si le procédé exigeait une <strong>redondance suffisante</strong> dans les plaintexts permettant à A d’identifier sans ambiguïté laquelle des solutions possibles est le plaintext original. Dans ce cas, A répondrait toujours <span class="math inline">\(m\)</span> et jetterait les autres solutions n’ayant pas le niveau de redondance préétabli.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision rapide - Remarques
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Unique</strong> : seul algorithme prouvé équivalent à FACTP</p>
<p><strong>Attaque</strong> : chosen-ciphertext donne facteurs (prob. 0.5)</p>
<p><strong>Parade</strong> : redondance obligatoire dans messages</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="comparaison-rsa---elgamal---rabin" class="level2">
<h2 class="anchored" data-anchor-id="comparaison-rsa---elgamal---rabin">Comparaison RSA - ElGamal - Rabin</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Critère</th>
<th>RSA</th>
<th>ElGamal</th>
<th>Rabin</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Problème</strong></td>
<td>RSAP</td>
<td>DLP</td>
<td>SQROOTP</td>
</tr>
<tr class="even">
<td><strong>Sécurité</strong></td>
<td>Équiv. factorisation (cas générique)</td>
<td>Basée sur DLP</td>
<td><strong>Prouvée</strong> ⟺ factorisation</td>
</tr>
<tr class="odd">
<td><strong>Expansion</strong></td>
<td>1:1</td>
<td><strong>1:2</strong></td>
<td>1:1</td>
</tr>
<tr class="even">
<td><strong>Déchiffrement</strong></td>
<td>Déterministe</td>
<td>Déterministe</td>
<td><strong>4 solutions</strong></td>
</tr>
<tr class="odd">
<td><strong>Signature</strong></td>
<td>Oui</td>
<td>Oui</td>
<td>Oui (avec précautions)</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="courbes-elliptiques-idée-de-base" class="level2">
<h2 class="anchored" data-anchor-id="courbes-elliptiques-idée-de-base">Courbes Elliptiques (Idée de base)</h2>
<section id="concept-fondamental" class="level3">
<h3 class="anchored" data-anchor-id="concept-fondamental">Concept fondamental</h3>
<p>Une <strong>courbe elliptique</strong> <span class="math inline">\(E\)</span> est définie par : <span class="math inline">\(y^2 = x^3 + ax + b\)</span> (avec discriminant <span class="math inline">\(4a^3 + 27b^2 \neq 0\)</span>).</p>
<p><strong>Opération clé : Addition de points</strong></p>
<ul>
<li>Géométriquement : tracer une droite entre deux points <span class="math inline">\(P\)</span> et <span class="math inline">\(Q\)</span>, trouver le 3ᵉ point d’intersection, puis prendre son symétrique</li>
<li>Forme un <strong>groupe commutatif</strong> avec point à l’infini <span class="math inline">\(\mathcal{O}\)</span> comme identité</li>
<li><strong>Multiplication scalaire</strong> : <span class="math inline">\(kP = P + P + ... + P\)</span> (<span class="math inline">\(k\)</span> fois)</li>
</ul>
<p><strong>Avantage cryptographique :</strong></p>
<ul>
<li>Le <strong>problème ECDLP</strong> : trouver <span class="math inline">\(k\)</span> tel que <span class="math inline">\(Q = kP\)</span> est très difficile (effort exponentiel)</li>
<li><strong>Clés plus courtes</strong> pour même sécurité qu’en <span class="math inline">\(\mathbb{Z}_p^*\)</span></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original - Définition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Une <strong>courbe elliptique</strong> est un ensemble de points <span class="math inline">\(E\)</span> défini par l’équation: <span class="math inline">\(y^2 = x^3 + ax + b\)</span>, avec <span class="math inline">\(x, y, a\)</span> et <span class="math inline">\(b\)</span> des nombres rationnels, entiers ou entiers modulo <span class="math inline">\(m\)</span> (<span class="math inline">\(m &gt; 1\)</span>). L’ensemble <span class="math inline">\(E\)</span> contient également un “point à l’infini” noté <span class="math inline">\(\mathcal{O}\)</span>. Le point <span class="math inline">\(\mathcal{O}\)</span> n’est pas dans la courbe mais il est l’élément identité de <span class="math inline">\(E\)</span>.</p>
<p>On choisira pour nos calculs les courbes elliptiques n’ayant pas de racines multiples ou, en d’autres termes, des courbes où le <strong>discriminant</strong> <span class="math inline">\(4a^3 + 27b^2 \neq 0\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision rapide - Concept
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Équation</strong> : <span class="math inline">\(y^2 = x^3 + ax + b\)</span></p>
<p><strong>Structure</strong> : groupe avec <span class="math inline">\(\mathcal{O}\)</span></p>
<p><strong>Opération</strong> : addition géométrique</p>
<p><strong>Problème dur</strong> : ECDLP</p>
</div>
</div>
</div>
</section>
<section id="addition-sur-courbes-elliptiques" class="level3">
<h3 class="anchored" data-anchor-id="addition-sur-courbes-elliptiques">Addition sur courbes elliptiques</h3>
<p>Soit <span class="math inline">\(P := (x, y) \in E\)</span>, on définit <span class="math inline">\(-P := (x, -y)\)</span> (symétrique par rapport à l’axe des <span class="math inline">\(x\)</span>). On a <span class="math inline">\(P + (-P) = \mathcal{O}\)</span>.</p>
<p>Pour deux points <span class="math inline">\(P, Q \in E\)</span> avec <span class="math inline">\(Q \neq -P\)</span>, on définit <span class="math inline">\(P + Q := R\)</span> où <span class="math inline">\(-R\)</span> est le 3ᵉ point d’intersection entre la courbe et la droite passant par <span class="math inline">\(P\)</span> et <span class="math inline">\(Q\)</span>.</p>
<p>Pour le <strong>doublement</strong> : <span class="math inline">\(2P = R\)</span> où <span class="math inline">\(-R\)</span> est le point d’intersection de la courbe avec la tangente à la courbe au point <span class="math inline">\(P\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original - Addition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Soit <span class="math inline">\(P := (x, y) \in E\)</span>, on définit <span class="math inline">\(-P\)</span> comme <span class="math inline">\(-P := (x, -y)\)</span>. Graphiquement, <span class="math inline">\(-P\)</span> est le point symétrique de <span class="math inline">\(P\)</span> par rapport à l’axe des <span class="math inline">\(x\)</span>. À noter que <span class="math inline">\(P + (-P) = \mathcal{O}\)</span>.</p>
<p>Soient deux points <span class="math inline">\(P, Q \in E\)</span>, tels que <span class="math inline">\(Q \neq -P\)</span>, on définit l’addition <span class="math inline">\(P + Q := R\)</span> où <span class="math inline">\(R \in E\)</span> tel que <span class="math inline">\(-R\)</span> est le 3ᵉ point d’intersection entre la courbe et la droite qui passe par <span class="math inline">\(P\)</span> et <span class="math inline">\(Q\)</span>.</p>
<p>L’ensemble <span class="math inline">\(E\)</span> avec <span class="math inline">\(\oplus\)</span> définit un <strong>groupe commutatif</strong> pour l’addition.</p>
<p>Soit <span class="math inline">\(P \in E\)</span>, le point <span class="math inline">\(2P = R\)</span>, tel que <span class="math inline">\(-R\)</span> est le point d’intersection de la courbe avec la droite tangente à la courbe au point <span class="math inline">\(P\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision rapide - Addition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Inverse</strong> : <span class="math inline">\(-P = (x, -y)\)</span></p>
<p><strong>Addition</strong> : 3ᵉ point d’intersection + symétrie</p>
<p><strong>Doublement</strong> : tangente + symétrie</p>
<p><strong>Propriété</strong> : groupe commutatif</p>
</div>
</div>
</div>
</section>
<section id="ecdlp-et-avantages-cryptographiques" class="level3">
<h3 class="anchored" data-anchor-id="ecdlp-et-avantages-cryptographiques">ECDLP et avantages cryptographiques</h3>
<p>Lorsque la courbe elliptique est définie sur le corps <span class="math inline">\(\mathbb{Z}_p\)</span> avec <span class="math inline">\(p\)</span> premier de grande taille (<span class="math inline">\(y^2 \equiv x^3 + ax + b \bmod p\)</span>), le calcul de <span class="math inline">\(k \in \mathbb{Z}_p\)</span> tel que <span class="math inline">\(Q = kP\)</span> avec <span class="math inline">\((P, Q)\)</span> connus est <strong>très difficile</strong> (effort exponentiel). Ce problème est le <strong>Elliptic Curve Discrete Logarithm Problem (ECDLP)</strong>.</p>
<p><strong>Avantage principal</strong> : taille des clés beaucoup plus petite pour une sécurité équivalente.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original - ECDLP et avantages
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Lorsque la courbe elliptique est définie sur le corps <span class="math inline">\(\mathbb{Z}_p\)</span> avec <span class="math inline">\(p\)</span> un nombre premier de grande taille (<span class="math inline">\(y^2 \equiv x^3 + ax + b \bmod p\)</span>), le calcul de <span class="math inline">\(k \in \mathbb{Z}_p\)</span> tel que <span class="math inline">\(Q = kP\)</span> avec <span class="math inline">\((P, Q)\)</span> connus, est très difficile (nécessite un effort exponentiel). Ce problème est connu comme: <strong>Elliptic Curve Discrete Logarithm Problem (ECDLP)</strong>.</p>
<p>L’<strong>avantage principal</strong> de la cryptographie publique basée sur des courbes elliptiques est que la taille des nombres utilisés (et donc, des clés) est plus petite.</p>
<p>Ceci est dû à la <strong>complexité accrue</strong> des calculs sur <span class="math inline">\(E_p\)</span> (courbe elliptique définie sur le corps <span class="math inline">\(\mathbb{Z}_p\)</span>) par rapport aux corps habituels tels que <span class="math inline">\(\mathbb{Z}_p\)</span> ou <span class="math inline">\(GF(2^m)\)</span>.</p>
<p>La <strong>représentation d’un plaintext en points</strong> de la courbe reste une opération complexe.</p>
<p>En Octobre 2003, la <strong>US National Security Agency (NSA)</strong> a acheté un brevet de Certicom pour l’utilisation de la cryptographie à courbes elliptiques.</p>
<p>En Septembre 2013 Claus Diem montré que sous certaines conditions le problème ECDLP pouvait être résolu en temps <strong>sub-exponentiel</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision rapide - ECDLP
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Problème</strong> : trouver <span class="math inline">\(k\)</span> dans <span class="math inline">\(Q = kP\)</span> (exponentiel)</p>
<p><strong>Gain</strong> : clés ~6-10× plus courtes</p>
<p><strong>Limite</strong> : représenter messages en points difficile</p>
<p><strong>NSA</strong> : adopté en 2003</p>
</div>
</div>
</div>
</section>
<section id="tableau-de-comparaison-des-tailles-de-clés" class="level3">
<h3 class="anchored" data-anchor-id="tableau-de-comparaison-des-tailles-de-clés">Tableau de comparaison des tailles de clés</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>AES (symétrique)</th>
<th>RSA/DH</th>
<th>Courbes Elliptiques</th>
<th>Rapport</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>56 bits</td>
<td>512 bits</td>
<td>112 bits</td>
<td>1:4.6</td>
</tr>
<tr class="even">
<td>80 bits</td>
<td>1024 bits</td>
<td>160 bits</td>
<td>1:6.4</td>
</tr>
<tr class="odd">
<td>112 bits</td>
<td>2048 bits</td>
<td>224 bits</td>
<td>1:9.1</td>
</tr>
<tr class="even">
<td>128 bits</td>
<td>3072 bits</td>
<td>256 bits</td>
<td>1:12</td>
</tr>
<tr class="odd">
<td>256 bits</td>
<td>15360 bits</td>
<td>512 bits</td>
<td>1:30</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original - Tableau
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Ce tableau montre les rapports des tailles des clés par rapport à celles de RSA pour une sécurité équivalente.</p>
<p><em>(Tableau extrait du document original)</em></p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="elgamal-sur-courbes-elliptiques" class="level2">
<h2 class="anchored" data-anchor-id="elgamal-sur-courbes-elliptiques">ElGamal sur Courbes Elliptiques</h2>
<section id="adaptation-directe" class="level3">
<h3 class="anchored" data-anchor-id="adaptation-directe">Adaptation directe</h3>
<p>Remplacer opérations dans <span class="math inline">\(\mathbb{Z}_p^*\)</span> par opérations sur <span class="math inline">\(E_p\)</span></p>
<p><strong>Clés :</strong></p>
<ul>
<li>Choisir courbe <span class="math inline">\(E_p\)</span> et point <span class="math inline">\(P_0 \in E_p\)</span> de grand ordre</li>
<li>Secret <span class="math inline">\(x\)</span>, calculer <span class="math inline">\(P_a = xP_0\)</span></li>
<li><strong>Publique</strong> : <span class="math inline">\((E_p, P_0, P_a)\)</span> | <strong>Privée</strong> : <span class="math inline">\(x\)</span></li>
</ul>
<p><strong>Chiffrement :</strong> Pour message <span class="math inline">\(m_i \in E_p\)</span></p>
<ul>
<li>Choisir <span class="math inline">\(k\)</span> aléatoire</li>
<li><span class="math inline">\(\gamma = kP_0\)</span>, <span class="math inline">\(\delta = kP_a + m_i\)</span></li>
<li>Envoyer <span class="math inline">\((\gamma, \delta)\)</span></li>
</ul>
<p><strong>Déchiffrement :</strong> <span class="math inline">\(m_i = \delta - x\gamma\)</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Texte original - ElGamal EC
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Génération des clés</strong></p>
<p>Chaque entité (A) crée une paire de clés (publique et privée) comme suit:</p>
<ul>
<li>A choisit une courbe elliptique <span class="math inline">\(E_p\)</span> avec <span class="math inline">\(p\)</span>, un nombre premier de grande taille (len(<span class="math inline">\(p\)</span>) bits) et un point <span class="math inline">\(P_0 \in E_p\)</span>.</li>
<li>A génère un nombre aléatoire <span class="math inline">\(x\)</span>, tel que <span class="math inline">\(1 \leq x \leq p\)</span> et calcule <span class="math inline">\(P_a = xP_0\)</span> (multiplication par un scalaire sur <span class="math inline">\(E_p\)</span>, pour laquelle, il existe des algorithmes efficaces).</li>
<li>La clé publique de A est <span class="math inline">\((E_p, P_0, P_a)\)</span>, la clé privée de A est <span class="math inline">\(x\)</span>.</li>
</ul>
<p><strong>Encryption</strong></p>
<p>L’entité B obtient <span class="math inline">\((E_p, P_0, P_a)\)</span>, la clé publique authentique de A.</p>
<ul>
<li>B transforme son plaintext en une série d’entiers <span class="math inline">\(m_i\)</span>, tel que <span class="math inline">\(m_i \in E_p\)</span> pour tout <span class="math inline">\(i\)</span>.</li>
<li>Pour chaque message <span class="math inline">\(m_i\)</span> :
<ul>
<li>B génère un nombre aléatoire unique <span class="math inline">\(k\)</span>, tel que <span class="math inline">\(1 \leq k \leq p\)</span>.</li>
<li>B calcule <span class="math inline">\(\gamma := kP_0\)</span> et <span class="math inline">\(\delta := kP_a + m_i\)</span> et envoie le ciphertext <span class="math inline">\(c := (\gamma, \delta)\)</span>.</li>
</ul></li>
</ul>
<p><strong>Decryption</strong></p>
<ul>
<li>A utilise sa clé privée <span class="math inline">\(x\)</span> pour calculer: <span class="math inline">\(x\gamma = xkP_0 = kP_a\)</span>.</li>
<li>A retrouve le plaintext en calculant: <span class="math inline">\(\delta - kP_a = kP_a + m_i - kP_a = m_i\)</span>.</li>
</ul>
<p>La sécurité du schéma s’appuie sur <strong>ECDLP</strong> !</p>
<p>Il est également nécessaire d’<strong>authentifier</strong> les parties publiques échangées afin d’éviter les attaques man-in-the middle précédemment décrites.</p>
<p>Les propriétés du protocole sont identiques au cas <span class="math inline">\(\mathbb{Z}_p^*\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Révision rapide - ElGamal EC
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Principe</strong> : même qu’ElGamal sur <span class="math inline">\(E_p\)</span></p>
<p><strong>Opérations</strong> : + et × scalaire sur points</p>
<p><strong>Sécurité</strong> : ECDLP</p>
<p><strong>Authentification</strong> : nécessaire contre MitM</p>
<p><strong>Avantage</strong> : clés courtes</p>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>