---
title: "Backdoor"
author: Michel Jean Joseph Donnet
date: today
date-format: DD-MM-YYYY
toc: true
toc-depth: 2
toc-title: Table of content
format:
  revealjs:
    theme: dracula
    navigation-mode: vertical
    smaller: true
    scrollable: true
    include-in-header:
      - text: |
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
filters:
  - diagram
---

# Theory

## What is a backdoor

Backdoor is a mecanism that facilite access to

- service
- application
- $\cdots$

It can be created and used to maintain a software (with correct security measures !), but also for criminal purposes.
However it's essentialy an entry point and not a kind of attack.

<span class="fa fa-exclamation-triangle" style="color:orange;"></span>
**All backdoors are entry points for hackers !!!**

Sources [nexa.fr](https://www.nexa.fr/post/backdoor-attack-definition)

## Attack type 

| Attack                    | Target            |
|:-------------------------:|:-----------------:|
| Spoofing                  | Confidentiality   |
| Tampering / Falsification | Integrity         |
| Repudiation               | Non repudiation   |
| Information disclosure    | Confidentiality   |
| Denial of service         | Disponibility     |
| Exclanation of privileges | Authentification  |

<span class="fa fa-exclamation-triangle" style="color:orange;"></span> **Note**
Backdoor cover all this attacks !

## Attack class

| Attack class      | Example         |
|:-----------------:|:---------------:|
| Hardware          | Chips with exfiltration, reprogrammed FPGA chips      |
| Firmware          | Modification of firmware (disk, network device, ...)  |
| Software          | Trojans, ...     |
| Supply-chain      | Third party dependencies, software update, ...        |
| Network / Command & Control | Tunneling to another server, shell reverse, data extraction, ...   |
| Cryptographic / weak keys algorithm     | Algorithm/key/RNG with vulnerabilities known by creator | 
| Accounts          | Hardcoded key in code, maintenance account not docummented, ... |

## Protection mecanism

- Check code and dependencies
- Log centralization and analysis
- Network trafic analysis
- Communication filtering
- Backup points
- ...

# Example 1

## Flatmap-stream

"On the morning of November 26th, npm‚Äôs security team was notified of a malicious package that had made its way into event-stream, a popular npm package.
After triaging the malware, npm Security responded by removing flatmap-stream and event-stream@3.3.6 from the Registry and taking ownership of the event-stream package to prevent further abuse."
[from npm blog](https://blog.npmjs.org/post/180565383195/details-about-the-event-stream-incident)

## Attack and target

Attacker earned confidence and take maintenance of `flatmap-stream`.

```{.plantuml}
@startuml

scale 1.5

' Dracula palette
skinparam backgroundColor #282a36
skinparam defaultTextAlignment center
skinparam shadowing false

' Node styling
skinparam Activity {
  BackgroundColor #44475a
  BorderColor #6272a4
  FontColor #f8f8f2
  FontName "DejaVu Sans"
}
skinparam Decision {
  BackgroundColor #6272a4
  BorderColor #bd93f9
  FontColor #282a36
  FontName "DejaVu Sans"
}
skinparam ArrowColor #ff79c6
skinparam ArrowThickness 3
skinparam ArrowFontColor #f8f8f2
skinparam Note {
  BackgroundColor #3b3f58
  BorderColor #6272a4
  FontColor #f8f8f2
}

' Start
' Fake "start" and "end" with styled ellipses
start
:<b>üîé Check environment</b>;
:<b>üí≥ Check account balance (Bitcoin Cash on Copay)</b>;
if ("Balance sufficient?") then (yes)
  :<b>üîí Collect account data / private keys</b>;
  :<b>üåê Send to server</b>;
  stop
else (no)
  :<b>No action needed</b>;
  stop
endif
@enduml
```

## Note

It's a **social engineering attack** $\Longrightarrow$ Check the code delivered by others !!

# Example 2

## SolarWind attack (2020)

- Hackers infiltrated SolarWinds (Sep 2019)
- Spent month to test code injections in Orion, that manage metric performance (admin privileges !!)
- Backdoor "Sunburst" created in Orion
- SolarWind began to distribute update Orion with the backdoor (Mars 2020)
- Hackers wan access to network of victims
- criminal actions...

Sources: [fortinet](https://www.fortinet.com/fr/resources/cyberglossary/solarwinds-cyber-attack)

## Balance sheet

More than 18¬¥000 clients are impacted

Pros:

- Companies share experience and good practices

Cons:

- Cost companies 11% of their annual revenue

# Example 3

## MIFARE backdoor

- Hardware backdoor on MIFARE contactless cards (cards from 2020)
- Enable to compromise all user-defined keys with knowledge of the backdoor by accessing the card in a few minutes
- Another hardware backdoor exist on older cards and is common to several manufacturers

Sources: [Cryptology ePrint Archive](https://eprint.iacr.org/2024/1275), [next](https://next.ink/brief_article/un-chercheur-francais-identifie-une-porte-derobee-dans-les-cartes-sans-contact-mifare/), [datasecuritybreach](https://www.datasecuritybreach.fr/backdoor-mifare/)

## Complementary informations

- Produced by **Shanghai Fudan Microelectronics Group**, one of China's leading chip manufacturers
- Over than 750 towns of more than 50 land use this system (contactless payment/access control, transport titles, ...)
- Discovered by **Philippe Teuwen** from **Quarkslab** french compagny

# Example 4

## XZ Utils Backdoor ?

# Questions

##

### What is a backdoor ?

### What are the kinds of backdoors ?

### Give an example of backdoor
