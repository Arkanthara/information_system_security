<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ISS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-960d9d362f81d399278ec3e29b622b37.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-e7f4145358ce1d0cd37d8d374dbb44f9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-960d9d362f81d399278ec3e29b622b37.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ISS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./exam_notes.qmd"> 
<span class="menu-text">Course</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./exercices.html"> 
<span class="menu-text">Exercises</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-language" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text">Language</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-language">    
        <li>
    <a class="dropdown-item" href="./index.html">
 <span class="dropdown-text">English</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./fr/index.html">
 <span class="dropdown-text">French</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#fundamental-security-services" id="toc-fundamental-security-services" class="nav-link active" data-scroll-target="#fundamental-security-services">Fundamental Security Services</a></li>
  <li><a href="#summary-services-threats-and-protection-mechanisms" id="toc-summary-services-threats-and-protection-mechanisms" class="nav-link" data-scroll-target="#summary-services-threats-and-protection-mechanisms">Summary: Services, Threats, and Protection Mechanisms</a></li>
  <li><a href="#internet-related-risks" id="toc-internet-related-risks" class="nav-link" data-scroll-target="#internet-related-risks">Internet-Related Risks</a>
  <ul class="collapse">
  <li><a href="#malware-delivered-via-e-mail" id="toc-malware-delivered-via-e-mail" class="nav-link" data-scroll-target="#malware-delivered-via-e-mail">Malware Delivered via E-Mail</a></li>
  <li><a href="#malware-delivered-via-web" id="toc-malware-delivered-via-web" class="nav-link" data-scroll-target="#malware-delivered-via-web">Malware Delivered via Web</a></li>
  <li><a href="#phishing" id="toc-phishing" class="nav-link" data-scroll-target="#phishing">Phishing</a></li>
  <li><a href="#spam" id="toc-spam" class="nav-link" data-scroll-target="#spam">Spam</a></li>
  <li><a href="#ransomware" id="toc-ransomware" class="nav-link" data-scroll-target="#ransomware">Ransomware</a></li>
  <li><a href="#attacks-on-internet-of-things-iot-devices" id="toc-attacks-on-internet-of-things-iot-devices" class="nav-link" data-scroll-target="#attacks-on-internet-of-things-iot-devices">Attacks on <strong><em>Internet of Things (IoT)</em></strong> Devices</a></li>
  <li><a href="#information-spoofing-and-website-defacement" id="toc-information-spoofing-and-website-defacement" class="nav-link" data-scroll-target="#information-spoofing-and-website-defacement">Information Spoofing and Website Defacement</a></li>
  <li><a href="#denial-of-service-dos-ddos-attacks" id="toc-denial-of-service-dos-ddos-attacks" class="nav-link" data-scroll-target="#denial-of-service-dos-ddos-attacks">Denial of Service (DoS / DDoS) Attacks</a></li>
  </ul></li>
  <li><a href="#digital-security-methods" id="toc-digital-security-methods" class="nav-link" data-scroll-target="#digital-security-methods">Digital Security Methods</a>
  <ul class="collapse">
  <li><a href="#cryptographic-hash-functions" id="toc-cryptographic-hash-functions" class="nav-link" data-scroll-target="#cryptographic-hash-functions">Cryptographic Hash Functions</a></li>
  <li><a href="#pseudo-random-generators" id="toc-pseudo-random-generators" class="nav-link" data-scroll-target="#pseudo-random-generators">(Pseudo) Random Generators</a></li>
  <li><a href="#symmetric-cryptography" id="toc-symmetric-cryptography" class="nav-link" data-scroll-target="#symmetric-cryptography">Symmetric Cryptography</a></li>
  <li><a href="#asymmetric-cryptography" id="toc-asymmetric-cryptography" class="nav-link" data-scroll-target="#asymmetric-cryptography">Asymmetric Cryptography</a></li>
  <li><a href="#asymmetric-symmetric-cryptography-hybrid" id="toc-asymmetric-symmetric-cryptography-hybrid" class="nav-link" data-scroll-target="#asymmetric-symmetric-cryptography-hybrid">Asymmetric + Symmetric Cryptography (Hybrid)</a></li>
  <li><a href="#asymmetric-cryptography-operation-rsa" id="toc-asymmetric-cryptography-operation-rsa" class="nav-link" data-scroll-target="#asymmetric-cryptography-operation-rsa">Asymmetric Cryptography: Operation (RSA)</a>
  <ul class="collapse">
  <li><a href="#key-construction" id="toc-key-construction" class="nav-link" data-scroll-target="#key-construction">Key Construction</a></li>
  <li><a href="#encryptiondecryption-process" id="toc-encryptiondecryption-process" class="nav-link" data-scroll-target="#encryptiondecryption-process">Encryption/decryption process</a></li>
  <li><a href="#mathematical-proof" id="toc-mathematical-proof" class="nav-link" data-scroll-target="#mathematical-proof">Mathematical proof</a></li>
  <li><a href="#system-security" id="toc-system-security" class="nav-link" data-scroll-target="#system-security">System security</a></li>
  </ul></li>
  <li><a href="#asymmetric-cryptography-conclusions" id="toc-asymmetric-cryptography-conclusions" class="nav-link" data-scroll-target="#asymmetric-cryptography-conclusions">Asymmetric Cryptography: Conclusions</a></li>
  <li><a href="#symmetric-vs-asymmetric-comparison" id="toc-symmetric-vs-asymmetric-comparison" class="nav-link" data-scroll-target="#symmetric-vs-asymmetric-comparison">Symmetric vs Asymmetric Comparison</a>
  <ul class="collapse">
  <li><a href="#comparative-advantages" id="toc-comparative-advantages" class="nav-link" data-scroll-target="#comparative-advantages">Comparative advantages</a></li>
  <li><a href="#common-issues" id="toc-common-issues" class="nav-link" data-scroll-target="#common-issues">Common issues</a></li>
  <li><a href="#usage-recommendations" id="toc-usage-recommendations" class="nav-link" data-scroll-target="#usage-recommendations">Usage recommendations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#dissection-of-an-attack-ransomware" id="toc-dissection-of-an-attack-ransomware" class="nav-link" data-scroll-target="#dissection-of-an-attack-ransomware">Dissection of an Attack: Ransomware</a>
  <ul class="collapse">
  <li><a href="#definition-and-impact" id="toc-definition-and-impact" class="nav-link" data-scroll-target="#definition-and-impact">Definition and Impact</a></li>
  <li><a href="#ransomware-attack-lifecycle" id="toc-ransomware-attack-lifecycle" class="nav-link" data-scroll-target="#ransomware-attack-lifecycle">Ransomware Attack Lifecycle</a>
  <ul class="collapse">
  <li><a href="#prevention-and-response" id="toc-prevention-and-response" class="nav-link" data-scroll-target="#prevention-and-response">Prevention and Response</a></li>
  <li><a href="#technical-dissection" id="toc-technical-dissection" class="nav-link" data-scroll-target="#technical-dissection">Technical Dissection</a></li>
  </ul></li>
  <li><a href="#cryptolocker-technical-analysis" id="toc-cryptolocker-technical-analysis" class="nav-link" data-scroll-target="#cryptolocker-technical-analysis">Cryptolocker: Technical Analysis</a>
  <ul class="collapse">
  <li><a href="#attack-scheme" id="toc-attack-scheme" class="nav-link" data-scroll-target="#attack-scheme">Attack Scheme</a></li>
  <li><a href="#preferred-targets" id="toc-preferred-targets" class="nav-link" data-scroll-target="#preferred-targets">Preferred Targets</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#basic-cryptography-concepts" id="toc-basic-cryptography-concepts" class="nav-link" data-scroll-target="#basic-cryptography-concepts">Basic Cryptography Concepts</a>
  <ul class="collapse">
  <li><a href="#kerckhoffs-principle" id="toc-kerckhoffs-principle" class="nav-link" data-scroll-target="#kerckhoffs-principle">Kerckhoffs’ Principle</a></li>
  <li><a href="#classification-of-encryption-systems" id="toc-classification-of-encryption-systems" class="nav-link" data-scroll-target="#classification-of-encryption-systems">Classification of Encryption Systems</a>
  <ul class="collapse">
  <li><a href="#unconditional-security" id="toc-unconditional-security" class="nav-link" data-scroll-target="#unconditional-security">Unconditional Security</a></li>
  <li><a href="#as-hard-as-equivalent-provable-security" id="toc-as-hard-as-equivalent-provable-security" class="nav-link" data-scroll-target="#as-hard-as-equivalent-provable-security">As hard as / equivalent / provable security</a></li>
  <li><a href="#computational-security" id="toc-computational-security" class="nav-link" data-scroll-target="#computational-security">Computational Security</a></li>
  </ul></li>
  <li><a href="#entropy" id="toc-entropy" class="nav-link" data-scroll-target="#entropy">Entropy</a>
  <ul class="collapse">
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#conditional-entropy" id="toc-conditional-entropy" class="nav-link" data-scroll-target="#conditional-entropy">Conditional Entropy</a></li>
  </ul></li>
  <li><a href="#attacks-on-encryption-systems" id="toc-attacks-on-encryption-systems" class="nav-link" data-scroll-target="#attacks-on-encryption-systems">Attacks on Encryption Systems</a></li>
  <li><a href="#oracles-and-security-models" id="toc-oracles-and-security-models" class="nav-link" data-scroll-target="#oracles-and-security-models">Oracles and Security Models</a>
  <ul class="collapse">
  <li><a href="#random-oracles-and-security-models" id="toc-random-oracles-and-security-models" class="nav-link" data-scroll-target="#random-oracles-and-security-models">Random Oracles and Security Models</a></li>
  <li><a href="#encryption-decryption-and-signature-oracles" id="toc-encryption-decryption-and-signature-oracles" class="nav-link" data-scroll-target="#encryption-decryption-and-signature-oracles">Encryption, Decryption and Signature Oracles</a></li>
  <li><a href="#indistinguishability-and-semantic-security-ind-cpa" id="toc-indistinguishability-and-semantic-security-ind-cpa" class="nav-link" data-scroll-target="#indistinguishability-and-semantic-security-ind-cpa">Indistinguishability and Semantic Security (IND-CPA)</a></li>
  <li><a href="#probabilistic-encryption-and-oaep" id="toc-probabilistic-encryption-and-oaep" class="nav-link" data-scroll-target="#probabilistic-encryption-and-oaep">Probabilistic Encryption and OAEP</a></li>
  </ul></li>
  <li><a href="#history-of-cryptography-and-unconditional-security" id="toc-history-of-cryptography-and-unconditional-security" class="nav-link" data-scroll-target="#history-of-cryptography-and-unconditional-security">History of Cryptography and Unconditional Security</a>
  <ul class="collapse">
  <li><a href="#historical-encryption-systems" id="toc-historical-encryption-systems" class="nav-link" data-scroll-target="#historical-encryption-systems">Historical Encryption Systems</a></li>
  <li><a href="#the-one-time-pad-otp" id="toc-the-one-time-pad-otp" class="nav-link" data-scroll-target="#the-one-time-pad-otp">The One-Time Pad (OTP)</a></li>
  <li><a href="#steganography" id="toc-steganography" class="nav-link" data-scroll-target="#steganography">Steganography</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#symmetric-cryptography-1" id="toc-symmetric-cryptography-1" class="nav-link" data-scroll-target="#symmetric-cryptography-1">Symmetric Cryptography</a>
  <ul class="collapse">
  <li><a href="#stream-ciphers-stream-encryption" id="toc-stream-ciphers-stream-encryption" class="nav-link" data-scroll-target="#stream-ciphers-stream-encryption">Stream Ciphers (Stream Encryption)</a>
  <ul class="collapse">
  <li><a href="#introduction-to-stream-ciphers" id="toc-introduction-to-stream-ciphers" class="nav-link" data-scroll-target="#introduction-to-stream-ciphers">Introduction to Stream Ciphers</a></li>
  <li><a href="#synchronous-stream-ciphers" id="toc-synchronous-stream-ciphers" class="nav-link" data-scroll-target="#synchronous-stream-ciphers">Synchronous Stream Ciphers</a></li>
  <li><a href="#asynchronous-stream-ciphers" id="toc-asynchronous-stream-ciphers" class="nav-link" data-scroll-target="#asynchronous-stream-ciphers">Asynchronous Stream Ciphers</a></li>
  <li><a href="#keystream-generators-lsfr" id="toc-keystream-generators-lsfr" class="nav-link" data-scroll-target="#keystream-generators-lsfr">Keystream Generators: LSFR</a></li>
  <li><a href="#rc4-software-stream-cipher" id="toc-rc4-software-stream-cipher" class="nav-link" data-scroll-target="#rc4-software-stream-cipher">RC4: Software Stream Cipher</a></li>
  </ul></li>
  <li><a href="#block-ciphers-block-encryption" id="toc-block-ciphers-block-encryption" class="nav-link" data-scroll-target="#block-ciphers-block-encryption">Block Ciphers (Block Encryption)</a>
  <ul class="collapse">
  <li><a href="#introduction-to-block-ciphers" id="toc-introduction-to-block-ciphers" class="nav-link" data-scroll-target="#introduction-to-block-ciphers">1. Introduction to Block Ciphers</a></li>
  <li><a href="#block-cipher-modes-of-operation" id="toc-block-cipher-modes-of-operation" class="nav-link" data-scroll-target="#block-cipher-modes-of-operation">2. Block Cipher Modes of Operation</a></li>
  <li><a href="#product-ciphers-and-feistel-ciphers" id="toc-product-ciphers-and-feistel-ciphers" class="nav-link" data-scroll-target="#product-ciphers-and-feistel-ciphers">3. Product Ciphers and Feistel Ciphers</a></li>
  <li><a href="#data-encryption-standard-des" id="toc-data-encryption-standard-des" class="nav-link" data-scroll-target="#data-encryption-standard-des">4. Data Encryption Standard (DES)</a></li>
  <li><a href="#triple-des-and-des-security" id="toc-triple-des-and-des-security" class="nav-link" data-scroll-target="#triple-des-and-des-security">5. Triple-DES and DES Security</a></li>
  <li><a href="#advanced-encryption-standard-aes" id="toc-advanced-encryption-standard-aes" class="nav-link" data-scroll-target="#advanced-encryption-standard-aes">6. Advanced Encryption Standard (AES)</a></li>
  <li><a href="#attacks-and-aes-security" id="toc-attacks-and-aes-security" class="nav-link" data-scroll-target="#attacks-and-aes-security">7. Attacks and AES Security</a></li>
  <li><a href="#block-cipher-cryptanalysis-techniques" id="toc-block-cipher-cryptanalysis-techniques" class="nav-link" data-scroll-target="#block-cipher-cryptanalysis-techniques">8. Block Cipher Cryptanalysis Techniques</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#asymmetric-cryptography-public-key-cryptography" id="toc-asymmetric-cryptography-public-key-cryptography" class="nav-link" data-scroll-target="#asymmetric-cryptography-public-key-cryptography">Asymmetric Cryptography (Public Key Cryptography)</a>
  <ul class="collapse">
  <li><a href="#mathematical-foundations" id="toc-mathematical-foundations" class="nav-link" data-scroll-target="#mathematical-foundations">Mathematical Foundations</a>
  <ul class="collapse">
  <li><a href="#fundamental-theorem-of-arithmetic-and-eulers-totient-function" id="toc-fundamental-theorem-of-arithmetic-and-eulers-totient-function" class="nav-link" data-scroll-target="#fundamental-theorem-of-arithmetic-and-eulers-totient-function">Fundamental Theorem of Arithmetic and Euler’s Totient Function</a></li>
  <li><a href="#eulers-theorem-and-fermats-little-theorem" id="toc-eulers-theorem-and-fermats-little-theorem" class="nav-link" data-scroll-target="#eulers-theorem-and-fermats-little-theorem">Euler’s Theorem and Fermat’s Little Theorem</a></li>
  <li><a href="#multiplicative-groups-and-generators" id="toc-multiplicative-groups-and-generators" class="nav-link" data-scroll-target="#multiplicative-groups-and-generators">Multiplicative Groups and Generators</a></li>
  <li><a href="#fast-exponentiation" id="toc-fast-exponentiation" class="nav-link" data-scroll-target="#fast-exponentiation">Fast Exponentiation</a></li>
  <li><a href="#chinese-remainder-theorem-crt" id="toc-chinese-remainder-theorem-crt" class="nav-link" data-scroll-target="#chinese-remainder-theorem-crt">Chinese Remainder Theorem (CRT)</a></li>
  </ul></li>
  <li><a href="#basic-problems-and-complexity" id="toc-basic-problems-and-complexity" class="nav-link" data-scroll-target="#basic-problems-and-complexity">Basic Problems and Complexity</a>
  <ul class="collapse">
  <li><a href="#classification-of-hard-problems" id="toc-classification-of-hard-problems" class="nav-link" data-scroll-target="#classification-of-hard-problems">Classification of Hard Problems</a></li>
  <li><a href="#factorization-techniques" id="toc-factorization-techniques" class="nav-link" data-scroll-target="#factorization-techniques">Factorization Techniques</a></li>
  </ul></li>
  <li><a href="#the-rsa-algorithm" id="toc-the-rsa-algorithm" class="nav-link" data-scroll-target="#the-rsa-algorithm">The RSA Algorithm</a>
  <ul class="collapse">
  <li><a href="#rsa-operation-encryptiondecryption" id="toc-rsa-operation-encryptiondecryption" class="nav-link" data-scroll-target="#rsa-operation-encryptiondecryption">RSA Operation (Encryption/Decryption)</a></li>
  <li><a href="#rsa-security" id="toc-rsa-security" class="nav-link" data-scroll-target="#rsa-security">RSA Security</a></li>
  <li><a href="#attacks-on-rsa" id="toc-attacks-on-rsa" class="nav-link" data-scroll-target="#attacks-on-rsa">Attacks on RSA</a></li>
  </ul></li>
  <li><a href="#the-elgamal-algorithm" id="toc-the-elgamal-algorithm" class="nav-link" data-scroll-target="#the-elgamal-algorithm">The ElGamal Algorithm</a>
  <ul class="collapse">
  <li><a href="#essential-remarks" id="toc-essential-remarks" class="nav-link" data-scroll-target="#essential-remarks">Essential Remarks</a></li>
  </ul></li>
  <li><a href="#rabin-algorithm" id="toc-rabin-algorithm" class="nav-link" data-scroll-target="#rabin-algorithm">Rabin Algorithm</a>
  <ul class="collapse">
  <li><a href="#essential-remarks-1" id="toc-essential-remarks-1" class="nav-link" data-scroll-target="#essential-remarks-1">Essential Remarks</a></li>
  </ul></li>
  <li><a href="#comparison-rsa---elgamal---rabin" id="toc-comparison-rsa---elgamal---rabin" class="nav-link" data-scroll-target="#comparison-rsa---elgamal---rabin">Comparison RSA - ElGamal - Rabin</a></li>
  <li><a href="#elliptic-curves-basic-idea" id="toc-elliptic-curves-basic-idea" class="nav-link" data-scroll-target="#elliptic-curves-basic-idea">Elliptic Curves (Basic Idea)</a>
  <ul class="collapse">
  <li><a href="#fundamental-concept" id="toc-fundamental-concept" class="nav-link" data-scroll-target="#fundamental-concept">Fundamental Concept</a></li>
  <li><a href="#addition-on-elliptic-curves" id="toc-addition-on-elliptic-curves" class="nav-link" data-scroll-target="#addition-on-elliptic-curves">Addition on Elliptic Curves</a></li>
  <li><a href="#ecdlp-and-cryptographic-advantages" id="toc-ecdlp-and-cryptographic-advantages" class="nav-link" data-scroll-target="#ecdlp-and-cryptographic-advantages">ECDLP and Cryptographic Advantages</a></li>
  <li><a href="#key-size-comparison-table" id="toc-key-size-comparison-table" class="nav-link" data-scroll-target="#key-size-comparison-table">Key Size Comparison Table</a></li>
  </ul></li>
  <li><a href="#elgamal-on-elliptic-curves" id="toc-elgamal-on-elliptic-curves" class="nav-link" data-scroll-target="#elgamal-on-elliptic-curves">ElGamal on Elliptic Curves</a>
  <ul class="collapse">
  <li><a href="#direct-adaptation" id="toc-direct-adaptation" class="nav-link" data-scroll-target="#direct-adaptation">Direct Adaptation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cryptographic-hash-functions-and-macs" id="toc-cryptographic-hash-functions-and-macs" class="nav-link" data-scroll-target="#cryptographic-hash-functions-and-macs">Cryptographic Hash Functions and MACs</a>
  <ul class="collapse">
  <li><a href="#one-way-functions-owf" id="toc-one-way-functions-owf" class="nav-link" data-scroll-target="#one-way-functions-owf">One-Way Functions (OWF)</a></li>
  <li><a href="#hash-functions-definitions" id="toc-hash-functions-definitions" class="nav-link" data-scroll-target="#hash-functions-definitions">Hash Functions: Definitions</a></li>
  <li><a href="#message-authentication-codes-macs" id="toc-message-authentication-codes-macs" class="nav-link" data-scroll-target="#message-authentication-codes-macs">Message Authentication Codes (MACs)</a></li>
  <li><a href="#attacks-on-mdcs" id="toc-attacks-on-mdcs" class="nav-link" data-scroll-target="#attacks-on-mdcs">Attacks on MDCs</a>
  <ul class="collapse">
  <li><a href="#nd-preimage-resistance-attack" id="toc-nd-preimage-resistance-attack" class="nav-link" data-scroll-target="#nd-preimage-resistance-attack">2nd-Preimage Resistance Attack</a></li>
  <li><a href="#collision-resistance-attack-birthday-paradox" id="toc-collision-resistance-attack-birthday-paradox" class="nav-link" data-scroll-target="#collision-resistance-attack-birthday-paradox">Collision Resistance Attack: Birthday Paradox</a></li>
  </ul></li>
  <li><a href="#computational-resistance-recap" id="toc-computational-resistance-recap" class="nav-link" data-scroll-target="#computational-resistance-recap">Computational Resistance: Recap</a></li>
  <li><a href="#mdcs-based-on-encryption-systems" id="toc-mdcs-based-on-encryption-systems" class="nav-link" data-scroll-target="#mdcs-based-on-encryption-systems">MDCs Based on Encryption Systems</a></li>
  <li><a href="#customized-mdcs" id="toc-customized-mdcs" class="nav-link" data-scroll-target="#customized-mdcs">Customized MDCs</a></li>
  <li><a href="#macs-based-on-encryption-systems" id="toc-macs-based-on-encryption-systems" class="nav-link" data-scroll-target="#macs-based-on-encryption-systems">MACs Based on Encryption Systems</a></li>
  <li><a href="#nested-macs-and-hmacs" id="toc-nested-macs-and-hmacs" class="nav-link" data-scroll-target="#nested-macs-and-hmacs">Nested MACs and HMACs</a></li>
  <li><a href="#hash-functions-applications" id="toc-hash-functions-applications" class="nav-link" data-scroll-target="#hash-functions-applications">Hash Functions Applications</a>
  <ul class="collapse">
  <li><a href="#data-integrity" id="toc-data-integrity" class="nav-link" data-scroll-target="#data-integrity">Data Integrity</a></li>
  <li><a href="#blockchains-and-proof-of-work" id="toc-blockchains-and-proof-of-work" class="nav-link" data-scroll-target="#blockchains-and-proof-of-work">Blockchains and Proof of Work</a></li>
  <li><a href="#other-applications" id="toc-other-applications" class="nav-link" data-scroll-target="#other-applications">Other Applications</a></li>
  </ul></li>
  <li><a href="#randomized-hash-functions-unix-example" id="toc-randomized-hash-functions-unix-example" class="nav-link" data-scroll-target="#randomized-hash-functions-unix-example">Randomized Hash Functions: UNIX Example</a></li>
  </ul></li>
  <li><a href="#digital-signatures" id="toc-digital-signatures" class="nav-link" data-scroll-target="#digital-signatures">Digital Signatures</a>
  <ul class="collapse">
  <li><a href="#introduction-and-definitions" id="toc-introduction-and-definitions" class="nav-link" data-scroll-target="#introduction-and-definitions">Introduction and Definitions</a></li>
  <li><a href="#formal-framework-signatures-with-appendix" id="toc-formal-framework-signatures-with-appendix" class="nav-link" data-scroll-target="#formal-framework-signatures-with-appendix">Formal Framework: Signatures with Appendix</a></li>
  <li><a href="#formal-framework-signatures-with-recovery" id="toc-formal-framework-signatures-with-recovery" class="nav-link" data-scroll-target="#formal-framework-signatures-with-recovery">Formal Framework: Signatures with Recovery</a></li>
  <li><a href="#rsa-signature" id="toc-rsa-signature" class="nav-link" data-scroll-target="#rsa-signature">RSA Signature</a></li>
  <li><a href="#blind-signatures" id="toc-blind-signatures" class="nav-link" data-scroll-target="#blind-signatures">Blind Signatures</a></li>
  <li><a href="#rabin-signature" id="toc-rabin-signature" class="nav-link" data-scroll-target="#rabin-signature">Rabin Signature</a></li>
  <li><a href="#elgamal-signature" id="toc-elgamal-signature" class="nav-link" data-scroll-target="#elgamal-signature">ElGamal Signature</a></li>
  <li><a href="#signatures-and-cryptocurrencies" id="toc-signatures-and-cryptocurrencies" class="nav-link" data-scroll-target="#signatures-and-cryptocurrencies">Signatures and Cryptocurrencies</a></li>
  <li><a href="#summary-table-of-schemes" id="toc-summary-table-of-schemes" class="nav-link" data-scroll-target="#summary-table-of-schemes">Summary Table of Schemes</a></li>
  <li><a href="#types-of-attacks" id="toc-types-of-attacks" class="nav-link" data-scroll-target="#types-of-attacks">Types of Attacks</a></li>
  </ul></li>
  <li><a href="#authentication" id="toc-authentication" class="nav-link" data-scroll-target="#authentication">Authentication</a>
  <ul class="collapse">
  <li><a href="#authentication-of-data-origin-and-entities" id="toc-authentication-of-data-origin-and-entities" class="nav-link" data-scroll-target="#authentication-of-data-origin-and-entities">Authentication of Data Origin and Entities</a>
  <ul class="collapse">
  <li><a href="#authentication-methods" id="toc-authentication-methods" class="nav-link" data-scroll-target="#authentication-methods">Authentication Methods</a></li>
  <li><a href="#entity-authentication-introduction" id="toc-entity-authentication-introduction" class="nav-link" data-scroll-target="#entity-authentication-introduction">Entity Authentication – Introduction</a></li>
  </ul></li>
  <li><a href="#attacks-and-countermeasures" id="toc-attacks-and-countermeasures" class="nav-link" data-scroll-target="#attacks-and-countermeasures">Attacks and Countermeasures</a>
  <ul class="collapse">
  <li><a href="#dictionary-attacks" id="toc-dictionary-attacks" class="nav-link" data-scroll-target="#dictionary-attacks">Dictionary Attacks</a></li>
  <li><a href="#plaintext-equivalence" id="toc-plaintext-equivalence" class="nav-link" data-scroll-target="#plaintext-equivalence">Plaintext Equivalence</a></li>
  </ul></li>
  <li><a href="#weak-authentication" id="toc-weak-authentication" class="nav-link" data-scroll-target="#weak-authentication">Weak Authentication</a>
  <ul class="collapse">
  <li><a href="#fixed-passwords" id="toc-fixed-passwords" class="nav-link" data-scroll-target="#fixed-passwords">Fixed Passwords</a></li>
  <li><a href="#variable-passwords" id="toc-variable-passwords" class="nav-link" data-scroll-target="#variable-passwords">Variable Passwords</a></li>
  </ul></li>
  <li><a href="#strong-authentication" id="toc-strong-authentication" class="nav-link" data-scroll-target="#strong-authentication">Strong Authentication</a>
  <ul class="collapse">
  <li><a href="#symmetric" id="toc-symmetric" class="nav-link" data-scroll-target="#symmetric">Symmetric</a></li>
  <li><a href="#asymmetric" id="toc-asymmetric" class="nav-link" data-scroll-target="#asymmetric">Asymmetric</a></li>
  </ul></li>
  <li><a href="#zero-knowledge-proofs" id="toc-zero-knowledge-proofs" class="nav-link" data-scroll-target="#zero-knowledge-proofs">Zero-Knowledge Proofs</a>
  <ul class="collapse">
  <li><a href="#concepts" id="toc-concepts" class="nav-link" data-scroll-target="#concepts">Concepts</a></li>
  <li><a href="#zkip-intuitive-example-ali-babas-cave" id="toc-zkip-intuitive-example-ali-babas-cave" class="nav-link" data-scroll-target="#zkip-intuitive-example-ali-babas-cave">ZKIP – Intuitive Example (Ali Baba’s Cave)</a></li>
  <li><a href="#zkip-graph-isomorphism" id="toc-zkip-graph-isomorphism" class="nav-link" data-scroll-target="#zkip-graph-isomorphism">ZKIP – Graph Isomorphism</a></li>
  <li><a href="#zkip-fiat-shamir-algorithm" id="toc-zkip-fiat-shamir-algorithm" class="nav-link" data-scroll-target="#zkip-fiat-shamir-algorithm">ZKIP – Fiat-Shamir Algorithm</a></li>
  <li><a href="#zkip-practical-implementations" id="toc-zkip-practical-implementations" class="nav-link" data-scroll-target="#zkip-practical-implementations">ZKIP – Practical Implementations</a></li>
  <li><a href="#zkip-mafia-attack-and-final-remarks" id="toc-zkip-mafia-attack-and-final-remarks" class="nav-link" data-scroll-target="#zkip-mafia-attack-and-final-remarks">ZKIP – Mafia Attack and Final Remarks</a></li>
  </ul></li>
  <li><a href="#summary-attacks-and-protections" id="toc-summary-attacks-and-protections" class="nav-link" data-scroll-target="#summary-attacks-and-protections">Summary – Attacks and Protections</a></li>
  </ul></li>
  <li><a href="#key-establishment-protocols-kep" id="toc-key-establishment-protocols-kep" class="nav-link" data-scroll-target="#key-establishment-protocols-kep">Key Establishment Protocols (KEP)</a>
  <ul class="collapse">
  <li><a href="#kep-definition-and-properties" id="toc-kep-definition-and-properties" class="nav-link" data-scroll-target="#kep-definition-and-properties">KEP Definition and Properties</a>
  <ul class="collapse">
  <li><a href="#definitions-and-classification" id="toc-definitions-and-classification" class="nav-link" data-scroll-target="#definitions-and-classification">Definitions and Classification</a></li>
  <li><a href="#kep-properties" id="toc-kep-properties" class="nav-link" data-scroll-target="#kep-properties">KEP Properties</a></li>
  </ul></li>
  <li><a href="#kap" id="toc-kap" class="nav-link" data-scroll-target="#kap">KAP</a>
  <ul class="collapse">
  <li><a href="#symmetric-1" id="toc-symmetric-1" class="nav-link" data-scroll-target="#symmetric-1">Symmetric</a></li>
  <li><a href="#asymmetric-with-pre-distribution" id="toc-asymmetric-with-pre-distribution" class="nav-link" data-scroll-target="#asymmetric-with-pre-distribution">Asymmetric with Pre-distribution</a></li>
  <li><a href="#asymmetric-with-dke" id="toc-asymmetric-with-dke" class="nav-link" data-scroll-target="#asymmetric-with-dke">Asymmetric with DKE</a></li>
  <li><a href="#attacks-on-dh-and-pfs" id="toc-attacks-on-dh-and-pfs" class="nav-link" data-scroll-target="#attacks-on-dh-and-pfs">Attacks on DH and PFS</a></li>
  </ul></li>
  <li><a href="#ktp" id="toc-ktp" class="nav-link" data-scroll-target="#ktp">KTP</a>
  <ul class="collapse">
  <li><a href="#symmetric-2" id="toc-symmetric-2" class="nav-link" data-scroll-target="#symmetric-2">Symmetric</a></li>
  <li><a href="#asymmetric-1" id="toc-asymmetric-1" class="nav-link" data-scroll-target="#asymmetric-1">Asymmetric</a></li>
  <li><a href="#hybrid" id="toc-hybrid" class="nav-link" data-scroll-target="#hybrid">Hybrid</a></li>
  <li><a href="#symmetric-with-key-distribution-center-kdc" id="toc-symmetric-with-key-distribution-center-kdc" class="nav-link" data-scroll-target="#symmetric-with-key-distribution-center-kdc">Symmetric with Key Distribution Center (KDC)</a></li>
  </ul></li>
  <li><a href="#ssltls" id="toc-ssltls" class="nav-link" data-scroll-target="#ssltls">SSL/TLS</a>
  <ul class="collapse">
  <li><a href="#ssltls-architecture" id="toc-ssltls-architecture" class="nav-link" data-scroll-target="#ssltls-architecture">SSL/TLS Architecture</a></li>
  <li><a href="#ssl-handshake-protocol" id="toc-ssl-handshake-protocol" class="nav-link" data-scroll-target="#ssl-handshake-protocol">SSL Handshake Protocol</a></li>
  <li><a href="#ssltls-key-generation" id="toc-ssltls-key-generation" class="nav-link" data-scroll-target="#ssltls-key-generation">SSL/TLS Key Generation</a></li>
  </ul></li>
  <li><a href="#final-remarks-on-keps" id="toc-final-remarks-on-keps" class="nav-link" data-scroll-target="#final-remarks-on-keps">Final Remarks on KEPs</a></li>
  </ul></li>
  <li><a href="#trusted-third-parties-ttp-and-certification" id="toc-trusted-third-parties-ttp-and-certification" class="nav-link" data-scroll-target="#trusted-third-parties-ttp-and-certification">Trusted Third Parties (TTP) and Certification</a>
  <ul class="collapse">
  <li><a href="#ttp" id="toc-ttp" class="nav-link" data-scroll-target="#ttp">TTP</a>
  <ul class="collapse">
  <li><a href="#ttp-operating-modes" id="toc-ttp-operating-modes" class="nav-link" data-scroll-target="#ttp-operating-modes">TTP Operating Modes</a></li>
  <li><a href="#key-distribution-centers-kdcs" id="toc-key-distribution-centers-kdcs" class="nav-link" data-scroll-target="#key-distribution-centers-kdcs">Key Distribution Centers (KDCs)</a></li>
  <li><a href="#certification-authorities-cas" id="toc-certification-authorities-cas" class="nav-link" data-scroll-target="#certification-authorities-cas">Certification Authorities (CAs)</a></li>
  <li><a href="#functional-entities-related-to-certification" id="toc-functional-entities-related-to-certification" class="nav-link" data-scroll-target="#functional-entities-related-to-certification">Functional Entities Related to Certification</a></li>
  <li><a href="#other-ttps" id="toc-other-ttps" class="nav-link" data-scroll-target="#other-ttps">Other TTPs</a></li>
  </ul></li>
  <li><a href="#public-key-authentication" id="toc-public-key-authentication" class="nav-link" data-scroll-target="#public-key-authentication">Public Key Authentication</a>
  <ul class="collapse">
  <li><a href="#certificates" id="toc-certificates" class="nav-link" data-scroll-target="#certificates">Certificates</a></li>
  <li><a href="#certificate-revocation-lists-crls" id="toc-certificate-revocation-lists-crls" class="nav-link" data-scroll-target="#certificate-revocation-lists-crls">Certificate Revocation Lists (CRLs)</a></li>
  <li><a href="#authentication-trees" id="toc-authentication-trees" class="nav-link" data-scroll-target="#authentication-trees">Authentication Trees</a></li>
  <li><a href="#certification-topologies" id="toc-certification-topologies" class="nav-link" data-scroll-target="#certification-topologies">Certification Topologies</a></li>
  </ul></li>
  <li><a href="#public-key-infrastructure-pki" id="toc-public-key-infrastructure-pki" class="nav-link" data-scroll-target="#public-key-infrastructure-pki">Public Key Infrastructure (PKI)</a>
  <ul class="collapse">
  <li><a href="#main-functional-entities" id="toc-main-functional-entities" class="nav-link" data-scroll-target="#main-functional-entities">Main Functional Entities</a></li>
  <li><a href="#advantages-and-disadvantages" id="toc-advantages-and-disadvantages" class="nav-link" data-scroll-target="#advantages-and-disadvantages">Advantages and Disadvantages</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>





<section id="fundamental-security-services" class="level1">
<h1>Fundamental Security Services</h1>
<p>Security services are the objectives aimed at protecting a system.</p>
<ul>
<li><p><strong>Confidentiality</strong>: Protection against unauthorized disclosure.</p></li>
<li><p><strong>Integrity</strong>: Protection against unauthorized modification.</p></li>
<li><p><strong>Availability</strong>: Guarantee of access for legitimate users.</p></li>
<li><p><strong>Authentication</strong>:</p>
<ul>
<li><em>Entity authentication</em>: Certifying the identity of an actor.</li>
<li><em>Data origin authentication</em>: Certifying the source of data.</li>
</ul></li>
<li><p><strong>Non-repudiation</strong>: Inability to deny a transaction.</p></li>
<li><p><strong>Non-duplication</strong>: Protection against illicit copying.</p></li>
<li><p><strong>Anonymity</strong>: Preservation of identity or source.</p></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Confidentiality</strong>: Protection of information from unauthorized disclosure.</p></li>
<li><p><strong>Integrity</strong>: Protection against unauthorized modification of information.</p></li>
<li><p><strong>Availability</strong>: Ensuring that resources are accessible to legitimate users.</p></li>
<li><p><strong>Authentication</strong>:</p>
<ul>
<li><strong>Entity authentication</strong> <em>(entity authentication)</em>: Process allowing one entity to be certain of the identity of a second entity, supported by corroborating evidence (e.g., physical presence, cryptographic, biometric, etc.). The term identification is sometimes also used for this service.</li>
<li><strong>Data origin authentication</strong> <em>(data origin authentication)</em>: Process allowing one entity to be certain that a second entity is the original source of a set of data. By definition, this service also ensures the integrity of the data.</li>
</ul></li>
<li><p><strong>Non-repudiation</strong>: Guarantees that an entity cannot deny being involved in a transaction.</p></li>
<li><p><strong>Non-duplication</strong>: Protection against illicit copying.</p></li>
<li><p><strong>Anonymity (entity or data origin)</strong>: Preserves the identity of an entity, the source of information, or a transaction.</p></li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="summary-services-threats-and-protection-mechanisms" class="level1">
<h1>Summary: Services, Threats, and Protection Mechanisms</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 31%">
<col style="width: 22%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Security Services</th>
<th style="text-align: left;">Threats and Attacks (<em>Italic</em>)</th>
<th style="text-align: left;">Classic Mechanisms</th>
<th style="text-align: left;">Digital Mechanisms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Confidentiality</strong></td>
<td style="text-align: left;">Information leakage, <em>eavesdropping</em>, traffic analysis</td>
<td style="text-align: left;">Seals, safes, padlocks</td>
<td style="text-align: left;">Encryption, logical authorization</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Integrity</strong></td>
<td style="text-align: left;">Modification, <em>tampering</em>, illicit creation or destruction</td>
<td style="text-align: left;">Special ink, holograms</td>
<td style="text-align: left;">One-way functions + encryption</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Availability</strong></td>
<td style="text-align: left;"><em>Denial of Service (DoS)</em>, viruses, illicit use</td>
<td style="text-align: left;">Physical access control, video surveillance</td>
<td style="text-align: left;">Logical access control, audit, antivirus</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Entity Authentication</strong></td>
<td style="text-align: left;">Unauthorized access, password theft, protocol flaw</td>
<td style="text-align: left;">Presence, voice, ID card, biometrics</td>
<td style="text-align: left;">Secret + protocol, network address + userid, smart card + PIN</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Data Authentication</strong></td>
<td style="text-align: left;">Falsification of information or signature</td>
<td style="text-align: left;">Seals, signature, fingerprint</td>
<td style="text-align: left;">One-way functions + encryption</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Non-repudiation</strong></td>
<td style="text-align: left;">Denying a transaction (<em>repudiation</em>), claiming key theft</td>
<td style="text-align: left;">Seals, notary signature, registered mail</td>
<td style="text-align: left;">One-way functions + encryption + digital signature</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Non-duplication</strong></td>
<td style="text-align: left;">Duplication, falsification, imitation</td>
<td style="text-align: left;">Special ink, holograms, tagging</td>
<td style="text-align: left;">Digital watermarking, cryptographic locking</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Anonymity</strong></td>
<td style="text-align: left;">Identification, transaction analysis, tracing</td>
<td style="text-align: left;">Voice scramblers, disguise, cash</td>
<td style="text-align: left;"><em>Mixers</em>, <em>remailers</em>, e-money, <em>deep web</em></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="threats-and-attacks-summary" class="level2">
<h2 class="anchored" data-anchor-id="threats-and-attacks-summary">Threats and Attacks: Summary</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 28%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Services</th>
<th style="text-align: left;">Threats</th>
<th style="text-align: left;">Attacks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Confidentiality</strong></td>
<td style="text-align: left;">Information leakage</td>
<td style="text-align: left;">Unauthorized eavesdropping, traffic analysis</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Integrity</strong></td>
<td style="text-align: left;">Information modification</td>
<td style="text-align: left;">Illicit creation, alteration, or destruction</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Availability</strong></td>
<td style="text-align: left;">Denial of service, illicit use</td>
<td style="text-align: left;">Viruses, repeated access attempts to disable a system</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Entity Authentication</strong></td>
<td style="text-align: left;">Unauthorized access</td>
<td style="text-align: left;">Password theft, authentication protocol flaw</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Data Authentication</strong></td>
<td style="text-align: left;">Information falsification</td>
<td style="text-align: left;">Signature forgery, protocol flaw</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Non-repudiation</strong></td>
<td style="text-align: left;">Denying involvement in a transaction</td>
<td style="text-align: left;">Claiming key theft or signature protocol flaw</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Non-duplication</strong></td>
<td style="text-align: left;">Duplication</td>
<td style="text-align: left;">Falsification, imitation</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Anonymity</strong></td>
<td style="text-align: left;">Identification</td>
<td style="text-align: left;">Transaction analysis, unauthorized access enabling identification</td>
</tr>
</tbody>
</table>
</section>
<section id="protection-mechanisms" class="level2">
<h2 class="anchored" data-anchor-id="protection-mechanisms">Protection Mechanisms</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 33%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Services</th>
<th style="text-align: left;">Classic Mechanisms</th>
<th style="text-align: left;">Digital Mechanisms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Confidentiality</strong></td>
<td style="text-align: left;">Seals, safes, padlocks</td>
<td style="text-align: left;">Encryption, logical authorization</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Integrity</strong></td>
<td style="text-align: left;">Special ink, holograms</td>
<td style="text-align: left;">One-way functions + encryption</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Availability</strong></td>
<td style="text-align: left;">Physical access control, video surveillance</td>
<td style="text-align: left;">Logical access control, audit, antivirus</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Entity Authentication</strong></td>
<td style="text-align: left;">Presence, voice, ID card, biometric recognition</td>
<td style="text-align: left;">Secret + authentication protocol, network address + userid, smart card + PIN</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Data Authentication</strong></td>
<td style="text-align: left;">Seals, signature, fingerprint</td>
<td style="text-align: left;">One-way functions + encryption</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Non-repudiation</strong></td>
<td style="text-align: left;">Seals, signature, notary signature, registered mail</td>
<td style="text-align: left;">One-way functions + encryption + digital signature</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Non-duplication</strong></td>
<td style="text-align: left;">Special ink, holograms, tagging</td>
<td style="text-align: left;">Digital watermarking, cryptographic locking</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Anonymity</strong></td>
<td style="text-align: left;">Voice scrambler, disguise, cash</td>
<td style="text-align: left;">Mixers, remailers, e-money, deep web</td>
</tr>
</tbody>
</table>
</section>
</div>
</div>
</div>
<hr>
</section>
<section id="internet-related-risks" class="level1">
<h1>Internet-Related Risks</h1>
<section id="malware-delivered-via-e-mail" class="level2">
<h2 class="anchored" data-anchor-id="malware-delivered-via-e-mail">Malware Delivered via E-Mail</h2>
<ul>
<li><p>Also called <strong>malware</strong>.</p></li>
<li><p>Emails designed to <strong>trigger an action</strong> (open attachment or click a link).</p></li>
<li><p>Often <strong>personalized</strong> using <strong>social engineering</strong>.</p></li>
<li><p><strong>Main consequences:</strong></p>
<ul>
<li>Malware installation (<em>ransomware</em>, <em>keyloggers</em>, etc.).</li>
<li><strong>Loss or theft of personal data</strong>.</li>
<li><strong>System hijacking</strong> and <strong>malware propagation</strong>.</li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Malware spread by email</li>
<li>Prompting clicks or opens</li>
<li>Social engineering</li>
<li>Data theft, loss, hijacking</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<section id="malware-delivered-via-e-mail-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="malware-delivered-via-e-mail-1">Malware Delivered via E-Mail</h2>
<ul>
<li><p>Also called <strong>malware</strong>.</p></li>
<li><p>Emails designed to <strong>incite the recipient</strong> to <strong>open an attachment</strong> or <strong>follow a link</strong> containing ads, offensive info, risky programs, etc.</p></li>
<li><p>Often targeted based on victim interests (preliminary social engineering).</p></li>
<li><p><strong>Consequences:</strong></p>
<ul>
<li>Malware installation (<em>ransomware</em>, <em>keyloggers</em>, etc.) on victim systems (<em>computer</em>, <em>tablet</em>, <em>smartphone</em>, <em>smartwatch</em>, etc.).</li>
<li>Data destruction.</li>
<li>Theft of personal information or data.</li>
<li>System hijacking for malicious purposes (e.g., illegal bitcoin mining).</li>
<li>Malware propagation (potentially to other users).</li>
</ul></li>
</ul>
</section>
</div>
</div>
</section>
<section id="malware-delivered-via-web" class="level2">
<h2 class="anchored" data-anchor-id="malware-delivered-via-web">Malware Delivered via Web</h2>
<ul>
<li><p>Method called <strong><em>drive-by download</em></strong>: <strong>automatic infection when visiting a website</strong>.</p></li>
<li><p>Sources can be:</p>
<ul>
<li>A <strong>malicious website</strong></li>
<li>A <strong>compromised legitimate site</strong> (e.g., <em>cross-site scripting</em>).</li>
</ul></li>
<li><p><strong>User caution</strong> greatly reduces this propagation method.</p></li>
<li><p><strong>Impacts are similar</strong> to email-borne infections.</p></li>
<li><p><strong>Script restriction</strong> (<em>Java/JavaScript</em>) reduces risk but can <strong>affect browsing</strong>.</p></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><em>Drive-by download</em> = infection without user action</li>
<li>Malicious or compromised sites</li>
<li>Awareness + restricted scripts = protection</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<section id="malware-delivered-via-web-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="malware-delivered-via-web-1">Malware Delivered via Web</h2>
<ul>
<li><p>Often called <strong><em>drive-by download</em></strong>, allows <strong>infecting the system</strong> (<em>computer</em>, <em>tablet</em>, <em>smartphone</em>, <em>smartwatch</em>, etc.) <strong>simply by visiting a website</strong>.</p></li>
<li><p>Sources may be:</p>
<ul>
<li>Malicious site containing malware</li>
<li>Legitimate website previously infected (e.g., <em>cross-site scripting</em>). Infection may only affect certain pages.</li>
</ul></li>
<li><p>User awareness (avoiding suspicious sites) reduces the effectiveness.</p></li>
<li><p>Consequences are similar to email infections.</p></li>
<li><p>Restricted script execution (<em>Java/JavaScript</em>) in browsers can limit infection but may constrain navigation.</p></li>
</ul>
</section>
</div>
</div>
</section>
<section id="phishing" class="level2">
<h2 class="anchored" data-anchor-id="phishing">Phishing</h2>
<ul>
<li><p>Technique to <strong>collect private information</strong> through <strong>indiscriminate fishing</strong>.</p></li>
<li><p><strong><em>Phishing</em></strong> can be:</p>
<ul>
<li><strong>General</strong> (broad targeting)</li>
<li><strong>Targeted</strong> (<em>spear phishing</em>) for a specific person or organization.</li>
</ul></li>
<li><p>Main vector: <strong>forged email address</strong>, hard to detect.</p></li>
<li><p>Goal: obtain <strong>sensitive data</strong> (credentials, passwords, personal or banking info).</p></li>
<li><p>Attacks use <strong>credible or threatening pretexts</strong> to prompt victim cooperation.</p></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Information theft by deception</li>
<li>Forged emails</li>
<li><em>Spear phishing</em> = targeted attack</li>
<li>Urgent or threatening pretexts</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<section id="phishing-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="phishing-1">Phishing</h2>
<ul>
<li>The word <strong><em>phishing</em></strong> comes from English <strong><em>“password”</em></strong>, <strong><em>“harvesting”</em></strong>, and <strong><em>“fishing”</em></strong>.</li>
<li>Shows the technique’s main goal: <strong>collect as much private info</strong> via indiscriminate fishing.</li>
<li>Targeted attacks are called <strong><em>spear phishing</em></strong> (from <em>spear fishing</em>).</li>
<li>Transmission vector: email with <strong>forged sender address</strong> requesting private info: emails, social media credentials, passwords, ID numbers, bank accounts, etc.</li>
<li>Pretexts vary (system update, service stoppage, delivery withdrawal) and may threaten the user if ignored.</li>
</ul>
</section>
</div>
</div>
</section>
<section id="spam" class="level2">
<h2 class="anchored" data-anchor-id="spam">Spam</h2>
<ul>
<li><p><strong>Unwanted emails</strong>, often ads, or <strong>unsolicited pop-ups</strong> during web browsing.</p></li>
<li><p>Represent about <strong>60% of global emails</strong>.</p></li>
<li><p>Main consequences:</p>
<ul>
<li><strong>Resource consumption</strong> and time loss.</li>
<li>Some can <strong>transmit malware</strong>.</li>
</ul></li>
<li><p>Often target short addresses or come from <strong>sold/exchanged address lists</strong>.</p></li>
<li><p><strong>Anti-spam filters</strong> incur <strong>significant costs</strong> for organizations.</p></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Unwanted emails/ads</li>
<li>Risks: time/resource loss, malware</li>
<li>Targeting: short addresses or lists</li>
<li>Filtering costly for organizations</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<section id="spam-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="spam-1">Spam</h2>
<ul>
<li>Includes all <strong>unwanted emails</strong> (often ads) received by people and organizations.</li>
<li>Also applies to <strong>pages/pop-up windows</strong> <strong>shown without user consent</strong> during web browsing.</li>
<li>Around <strong>60%</strong> of global emails belong to this category.</li>
<li>Consequences: resource consumption and wasted time, but some spam can also <strong>transmit malware</strong>.</li>
<li>Often target short email addresses or list-based addresses (sold/exchanged).</li>
<li><strong>Anti-spam filtering</strong> incurs high organizational costs.</li>
</ul>
</section>
</div>
</div>
</section>
<section id="ransomware" class="level2">
<h2 class="anchored" data-anchor-id="ransomware">Ransomware</h2>
<ul>
<li>Trojan-type malware that <strong>encrypts data</strong> to make it inaccessible.</li>
<li>Demands a <strong>ransom</strong> (often in bitcoins) to recover files.</li>
<li>Can remain <strong>dormant</strong>, triggered by an event or date.</li>
<li>Main vector: <strong>malicious emails</strong>.</li>
<li>Other effects: <strong>DoS attacks, extortion</strong>.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Data encrypted by Trojan</li>
<li>Ransom to restore access</li>
<li>Possible programmed dormancy</li>
<li>Infection via malicious emails</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<section id="ransomware-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="ransomware-1">Ransomware</h2>
<ul>
<li>Trojan malware family.</li>
<li>Typically <strong>encrypts victim’s data</strong> to make it completely inaccessible.</li>
<li>Then displays a message requesting <strong>ransom payment</strong> (often in <strong>bitcoins</strong>).</li>
<li>May stay in <strong>dormant state</strong> triggered by event or date.</li>
<li>Infection vectors vary, but <strong>malicious email attachments</strong> often responsible.</li>
<li>Variants exist and continue to evolve.</li>
<li>Other behaviors: <strong>DoS, targeted extortion, threats</strong>, etc.</li>
</ul>
</section>
</div>
</div>
</section>
<section id="attacks-on-internet-of-things-iot-devices" class="level2">
<h2 class="anchored" data-anchor-id="attacks-on-internet-of-things-iot-devices">Attacks on <strong><em>Internet of Things (IoT)</em></strong> Devices</h2>
<ul>
<li><p>Target <strong>connected objects</strong> (cameras, TVs, sensors, alarms, etc.).</p></li>
<li><p>Devices are <strong>easy to compromise</strong> due to:</p>
<ul>
<li><strong>Known vulnerabilities</strong></li>
<li><strong>Default passwords</strong></li>
<li><strong>User unawareness</strong></li>
</ul></li>
<li><p><strong>Remote control</strong> enables:</p>
<ul>
<li><strong>Entry point</strong> to the network</li>
<li><strong>Device abuse</strong> for illicit activities (DDoS, hacking, mining)</li>
</ul></li>
<li><p>A <strong>precise inventory</strong> of connected devices is essential.</p></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Targets connected objects</li>
<li>Weak security (vulnerabilities, default passwords)</li>
<li>Risk of network access and abuse</li>
<li>IoT inventory needed</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<section id="attacks-on-iot-devices" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="attacks-on-iot-devices">Attacks on IoT Devices</h2>
<ul>
<li><p>Target connected objects (cameras, TVs, fridges, sensors, alarm systems, etc.).</p></li>
<li><p>Often <strong>easier to hack</strong> than traditional systems due to:</p>
<ul>
<li>Many vulnerabilities known to attackers</li>
<li>Default passwords</li>
<li>User negligence</li>
</ul></li>
<li><p>Remote takeover allows:</p>
<ul>
<li>Entry point to home/corporate network</li>
<li>Device use for illicit activities (hacking, DDoS, bitcoin mining)</li>
</ul></li>
<li><p>Maintaining a detailed directory of all connected devices is necessary.</p></li>
</ul>
</section>
</div>
</div>
</section>
<section id="information-spoofing-and-website-defacement" class="level2">
<h2 class="anchored" data-anchor-id="information-spoofing-and-website-defacement">Information Spoofing and Website Defacement</h2>
<ul>
<li>Attacks aiming to <strong>alter information</strong> on websites and social media.</li>
<li>Impact: <strong>compromised reputation</strong> and <strong>economic damage</strong>.</li>
<li>Websites: secure host system, restrictive configuration, <strong>regular audits</strong>.</li>
<li>Social media: strong passwords, <strong>multi-factor authentication</strong>, session closure, cookie deletion.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Altered info on websites and social media</li>
<li>Risks: reputation, economic losses</li>
<li>Websites: security + audits</li>
<li>Social media: strong passwords, MFA, closed sessions, cookies cleared</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<section id="information-spoofing-and-website-defacement-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="information-spoofing-and-website-defacement-1">Information Spoofing and Website Defacement</h2>
<ul>
<li><p>Target <strong>integrity</strong> of published info on websites and social media.</p></li>
<li><p>Affects <strong>reputation</strong> and can cause <strong>economic damage</strong>.</p></li>
<li><p><strong>Websites</strong>: secure host system, as restrictive configuration as possible, recurring security audits recommended.</p></li>
<li><p><strong>Social media</strong>: depends on authentication process:</p>
<ul>
<li>Avoid simple passwords</li>
<li>Prefer strong, possibly multi-factor authentication</li>
<li>Close sessions properly</li>
<li>Clear cookies</li>
</ul></li>
</ul>
</section>
</div>
</div>
</section>
<section id="denial-of-service-dos-ddos-attacks" class="level2">
<h2 class="anchored" data-anchor-id="denial-of-service-dos-ddos-attacks">Denial of Service (DoS / DDoS) Attacks</h2>
<ul>
<li><p>Aim to <strong>make IT systems inaccessible</strong>, especially for organizations.</p></li>
<li><p><strong>DDoS</strong>: distributed attack using thousands of devices, generating massive traffic.</p></li>
<li><p>Classic protections (<em>firewalls</em>, IDS/IPS sensors) often <strong>insufficient</strong>.</p></li>
<li><p>Consequences:</p>
<ul>
<li><strong>Affected reputation</strong></li>
<li><strong>Financial losses</strong> (sometimes ransom)</li>
<li><strong>High risk for critical infrastructure</strong> (hospitals, power plants, Internet backbone)</li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>DDoS = inaccessible systems via massive attacks</li>
<li>Limited protections</li>
<li>Risks: reputation, finances, critical infrastructures</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<section id="denial-of-service-dos-ddos-attacks-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="denial-of-service-dos-ddos-attacks-1">Denial of Service (DoS / DDoS) Attacks</h2>
<ul>
<li><p>Aim to <strong>render IT systems inaccessible</strong>, mainly targeting private or governmental organizations.</p></li>
<li><p><strong>DDoS</strong> (<em>Distributed Denial of Service</em>): multiple devices (<strong>often tens of thousands</strong>) simultaneously target victim system(s).</p></li>
<li><p>Traffic can reach several hundred Gbps.</p></li>
<li><p>Traditional protection (<em>firewalls</em>, <em>intrusion detection/prevention sensors</em>) has limited effectiveness.</p></li>
<li><p>Service unavailability can cause:</p>
<ul>
<li><strong>Reputational issues</strong></li>
<li>Significant <strong>financial losses</strong> (ransom demands)</li>
<li><strong>High security risks (even physical)</strong> for <strong>critical infrastructures</strong> (hospitals, power plants, Internet backbone).</li>
</ul></li>
</ul>
</section>
</div>
</div>
</section>
</section>
<section id="digital-security-methods" class="level1">
<h1>Digital Security Methods</h1>
<p><strong>Problem:</strong> Protecting digital information</p>
<ul>
<li>in a distributed environment</li>
<li>globally accessible</li>
<li>without physical boundaries</li>
</ul>
<p><strong>Solution:</strong></p>
<ul>
<li>Cryptography
<ul>
<li>Symmetric</li>
<li>Asymmetric</li>
<li><span class="math inline">\(+\)</span> One-way functions</li>
<li><span class="math inline">\(+\)</span> (Pseudo) random generators</li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Problem:</strong> Security in a distributed/global environment.</li>
<li><strong>Solutions:</strong>
<ul>
<li>Crypto (symmetric/asymmetric).</li>
<li>One-way functions (hashing).</li>
<li>Random generators (physical/pseudo).</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Problem:</strong> Protecting digital information</p>
<ul>
<li>in a distributed environment</li>
<li>globally accessible</li>
<li>without physical boundaries</li>
</ul>
<p><strong>Solution:</strong></p>
<ul>
<li>Cryptography
<ul>
<li>Symmetric</li>
<li>Asymmetric</li>
<li><span class="math inline">\(+\)</span> One-way functions</li>
<li><span class="math inline">\(+\)</span> (Pseudo) random generators</li>
</ul></li>
</ul>
</div>
</div>
</div>
<hr>
<section id="cryptographic-hash-functions" class="level2">
<h2 class="anchored" data-anchor-id="cryptographic-hash-functions">Cryptographic Hash Functions</h2>
<ul>
<li><strong>Functions easy to compute in one direction but virtually impossible to reverse</strong>.</li>
<li>Any modification of the source document radically changes the <strong>digest</strong> (avalanche effect).</li>
<li><strong>Key properties</strong>:
<ul>
<li><strong>One-way</strong>: impossible to retrieve the input from the hash.</li>
<li><strong>Collision-free</strong>: impossible to find two inputs with the same hash.</li>
</ul></li>
<li>Digest size: 160 to 512 bits.</li>
<li>Algorithms (very <strong>performant</strong>): SHA-1, SHA-256, SHA-3.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>One-way + collision-free</strong>.</li>
<li>Size: 160-512 bits.</li>
<li>Algos: SHA-1/256/3.</li>
<li>Usage: integrity, signatures.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Functions easy to compute in one direction but virtually impossible to compute in the reverse direction</strong>.</li>
<li>Any modification (even insignificant) of the source document results in a fundamentally different <strong>digest</strong>.</li>
<li>It is virtually impossible to retrieve the source document using only the digest (<strong>one-way</strong>).</li>
<li>It is virtually impossible to find a second source document producing the same digest (<strong>collision-free</strong>).</li>
<li>Usual digest length: 160 to 512 bits.</li>
<li>One-way algorithms are very performant.</li>
<li>Examples: SHA-1, SHA-256, SHA-3, etc.</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="pseudo-random-generators" class="level2">
<h2 class="anchored" data-anchor-id="pseudo-random-generators">(Pseudo) Random Generators</h2>
<ul>
<li><strong>Characteristics</strong>
<ul>
<li><strong>random</strong></li>
<li><strong>unpredictable</strong></li>
<li><strong>non-reproducible</strong></li>
</ul></li>
<li><strong>Critical</strong> for security (keys, IV, secrets).</li>
<li><strong>Types</strong>:
<ul>
<li><strong>True random</strong>: based on physical phenomena (radioactivity, quantum).</li>
<li><strong>Pseudo-random</strong>: deterministic (based on a <em>seed</em>: initial random sequence).</li>
</ul></li>
<li><strong>Risk</strong>: “Pseudo-security” if the <em>seed</em> is predictable (Pitkin quote).</li>
<li>Applications: session keys, IV (DES-CBC), signatures (ElGamal).</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>True random</strong>: physical (quantum).</li>
<li><strong>Pseudo-random</strong>: deterministic (<em>seed</em>).</li>
<li><strong>Risk</strong>: predictable <em>seed</em> = vulnerability.</li>
<li>Uses: keys, IV, signatures.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Random number generation is a very important process that can compromise the security of many encryption systems.</li>
<li>Applications: session key generation, initialization vectors (DES - CBC mode), secrets for signatures (ElGamal), etc.</li>
<li>A <strong>random generator</strong> is a device capable of generating numbers in a <strong>random</strong>, <strong>unpredictable</strong> and <strong>non-reproducible</strong> way. (e.g.&nbsp;based on physical phenomena: radioactive or quantum source).</li>
<li><strong>Pseudo-random generators</strong> are deterministic processes developed from an initial random sequence (<strong>seed</strong>) (e.g.&nbsp;user keystrokes, disk access).</li>
<li><em>Quote:</em> R. Pitkin in [Kau95]: “The use of pseudo-random processes to generate secret quantities can result in pseudo-security”</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="symmetric-cryptography" class="level2">
<h2 class="anchored" data-anchor-id="symmetric-cryptography">Symmetric Cryptography</h2>
<ul>
<li><strong>History</strong>: Used since Julius Caesar (1st century BC).</li>
<li><strong>Principle</strong>: A single key for encryption/decryption.</li>
<li><strong>Scheme</strong>: Plaintext → Encryption (Key) → Ciphertext → Decryption (Key) → Plaintext.</li>
<li><strong>Characteristics</strong>:
<ul>
<li>Algorithms: AES, DES, IDEA, RC4.</li>
<li>Services: Confidentiality, Authentication, Integrity.</li>
<li><strong>Limit</strong>: No signatures (shared key).</li>
<li><strong>Problem</strong>: Secure key exchange required.</li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>1 key</strong> to encrypt/decrypt.</li>
<li><strong>Fast</strong> (AES, DES).</li>
<li><strong>Problem</strong>: key exchange.</li>
<li>Uses: personal documents, closed groups.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Also called conventional cryptography or secret key cryptography (1st century BC, Julius Caesar).</li>
<li><strong>Idea:</strong> Based on a single secret key, perform a transformation capable of respectively making information unreadable and restoring it.</li>
<li><strong>Scheme:</strong> Plaintext <span class="math inline">\(\to\)</span> Encryption (Key) <span class="math inline">\(\to\)</span> Ciphertext <span class="math inline">\(\to\)</span> Decryption (Key) <span class="math inline">\(\to\)</span> Plaintext.</li>
<li><strong>Characteristics:</strong>
<ul>
<li>Algorithms: AES, DES, IDEA, RC4, RC5, etc. (some are free and openly available)</li>
<li>Services: Confidentiality, Authentication, Integrity.</li>
<li>No direct support for digital signatures (because key known by both).</li>
<li>Requires a confidential channel to exchange the key.</li>
<li>Ideal for protection of personal documents or closed groups.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="asymmetric-cryptography" class="level2">
<h2 class="anchored" data-anchor-id="asymmetric-cryptography">Asymmetric Cryptography</h2>
<ul>
<li>Also called <strong>public cryptography</strong> (1976, Diffie &amp; Hellman).</li>
<li><strong>Principle</strong>
<ul>
<li>Key pair (public/private) for encryption and signatures.</li>
</ul></li>
<li><strong>Two main uses</strong>:
<ol type="1">
<li><strong>Confidentiality</strong>:
<ul>
<li>Encryption: recipient’s public key</li>
<li>Decryption: recipient’s private key</li>
</ul></li>
<li><strong>Digital signature</strong>:
<ul>
<li>Signature: sender’s private key</li>
<li>Verification: sender’s public key</li>
<li><em>Optimization</em>: Generally sign the <strong>hash</strong> of the document</li>
<li><strong>Fundamental properties</strong>:
<ul>
<li><strong>Integrity</strong>: Any modification invalidates the signature</li>
<li><strong>Non-collision</strong>: Impossible to have 2 documents with the same signature</li>
<li><strong>Non-repudiation</strong>: Only the holder of the private key can sign</li>
</ul></li>
</ul></li>
</ol></li>
<li><strong>Technical aspects</strong>:
<ul>
<li><strong>Algorithms</strong>: RSA, ElGamal</li>
<li><strong>Services</strong>: Integrity, Authentication, Non-Repudiation</li>
<li><strong>Performance</strong>: much slower than symmetric (100x slower)</li>
<li><strong>Advantage</strong>: No need for a confidential channel for key exchange</li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>2 keys</strong>: public (encrypt/verify) + private (decrypt/sign)</li>
<li><strong>2 uses</strong>:
<ul>
<li>Confidentiality: encrypt for a recipient</li>
<li>Signature: prove authenticity</li>
</ul></li>
<li><strong>Signatures</strong>:
<ul>
<li>Integrity + non-repudiation</li>
</ul></li>
<li><strong>Algorithms</strong>: RSA/ElGamal</li>
<li><strong>Advantage</strong>: No need for secure channel to exchange keys</li>
<li><strong>Disadvantage</strong>: Slow</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<section id="asymmetric-cryptography-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="asymmetric-cryptography-1">Asymmetric Cryptography</h2>
<ul>
<li>Also called public cryptography or public key cryptography (1976, W. Diffie &amp; M. Hellman).</li>
<li><strong>Idea:</strong> Use two different keys - one <strong>secret</strong> and one <strong>public</strong> - respectively for encryption and decryption operations.</li>
<li>Each user has a <strong>keyring</strong>.</li>
</ul>
<p><strong>Confidentiality:</strong> * Sender encrypts with the <strong>recipient’s public key</strong>. * Recipient decrypts with their <strong>private key</strong>. * Only the recipient’s key is used!</p>
<p><strong>Digital Signature:</strong> * Sender signs with their <strong>private key</strong>. * Recipient verifies with the <strong>sender’s public key</strong>. * Only the sender’s key is used! * <em>Note:</em> Generally sign the <strong>digest</strong> of the document (hash) for performance reasons.</p>
<p><strong>Signature characteristics:</strong> * The signature changes if the document changes, while the private key remains the same. * If the document or signature is modified, verification fails (<strong>integrity guaranteed</strong>). * It is virtually impossible, even for the holder of the private key, to generate a second document producing the same signature (one-way function <strong>without collisions</strong>). * Only the holder of the private key can generate a signature verifiable using the corresponding public key (<strong>non-repudiation</strong>). * <strong>Algorithms</strong>: RSA, ElGamal. * <strong>Services</strong>: Integrity, Authentication, Non-Repudiation. * <strong>Slowness</strong>: Up to 50 times slower than symmetric cryptography. * <strong>Advantage</strong>: No need for a confidential channel to exchange keys (unlike symmetric).</p>
</section>
</div>
</div>
<hr>
</section>
<section id="asymmetric-symmetric-cryptography-hybrid" class="level2">
<h2 class="anchored" data-anchor-id="asymmetric-symmetric-cryptography-hybrid">Asymmetric + Symmetric Cryptography (Hybrid)</h2>
<ul>
<li><strong>Principle</strong>: Use asymmetric to exchange a symmetric key (session key).</li>
<li><strong>Steps</strong>:
<ol type="1">
<li>A generates a random symmetric key <span class="math inline">\(K_s\)</span>.</li>
<li>A encrypts <span class="math inline">\(K_s\)</span> with B’s public key.</li>
<li>A and B then communicate using <span class="math inline">\(K_s\)</span> (symmetric).</li>
</ol></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Asymmetric</strong>: exchange of symmetric key.</li>
<li><strong>Symmetric</strong>: data encryption.</li>
<li><strong>Advantage</strong>: combines security + performance.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Idea:</strong> Use public cryptography only to exchange symmetric keys (Session keys).</li>
<li>A generates a random key <span class="math inline">\(K_s\)</span> and transmits it to B by encrypting it with B’s public key.</li>
<li>A &amp; B then communicate using <span class="math inline">\(K_s\)</span> (symmetric).</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="asymmetric-cryptography-operation-rsa" class="level2">
<h2 class="anchored" data-anchor-id="asymmetric-cryptography-operation-rsa">Asymmetric Cryptography: Operation (RSA)</h2>
<section id="key-construction" class="level3">
<h3 class="anchored" data-anchor-id="key-construction">Key Construction</h3>
<ol type="1">
<li><strong>Choice of prime numbers</strong>:
<ul>
<li><span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>: two large prime numbers (&gt; 1024 bits)</li>
<li><span class="math inline">\(n = pq\)</span>: RSA modulus (size = 2048+ bits)</li>
</ul></li>
<li><strong>Calculation of Euler’s totient function</strong>:
<ul>
<li><span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span></li>
<li><em>Property</em>: For any <span class="math inline">\(a\)</span> coprime with <span class="math inline">\(n\)</span>, <span class="math inline">\(a^{\phi(n)} \equiv 1 \pmod{n}\)</span></li>
</ul></li>
<li><strong>Selection of exponents</strong>:
<ul>
<li><span class="math inline">\(e\)</span>: integer coprime with <span class="math inline">\(\phi(n)\)</span> (public exponent)</li>
<li><span class="math inline">\(d\)</span>: modular inverse of <span class="math inline">\(e\)</span> (private exponent), such that <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span></li>
</ul></li>
</ol>
</section>
<section id="encryptiondecryption-process" class="level3">
<h3 class="anchored" data-anchor-id="encryptiondecryption-process">Encryption/decryption process</h3>
<ul>
<li><strong>Public key</strong>: <span class="math inline">\((n,e)\)</span></li>
<li><strong>Private key</strong>: <span class="math inline">\((d)\)</span></li>
<li><strong>Encryption</strong>: <span class="math inline">\(C = P^e \pmod{n}\)</span></li>
<li><strong>Decryption</strong>: <span class="math inline">\(P = C^d \pmod{n}\)</span></li>
</ul>
</section>
<section id="mathematical-proof" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-proof">Mathematical proof</h3>
<ol type="1">
<li><p><strong>Fundamental congruence</strong>:</p>
<ul>
<li><span class="math inline">\(ed = 1 + k\phi(n)\)</span> (by definition of <span class="math inline">\(d\)</span>)</li>
</ul></li>
<li><p><strong>Application of Euler’s theorem</strong>:</p>
<ul>
<li><span class="math inline">\(P^{\phi(n)} \equiv 1 \pmod{n}\)</span> (if <span class="math inline">\(P\)</span> coprime with <span class="math inline">\(n\)</span>)</li>
</ul></li>
<li><p><strong>Demonstration</strong>:</p>
<p><span class="math display">\[\begin{align*}
(P^e)^d &amp;\equiv P^{ed} \pmod{n} \\
&amp;\equiv P^{1 + k\phi(n)} \pmod{n} \\
&amp;\equiv P \cdot (P^{\phi(n)})^k \pmod{n} \\
&amp;\equiv P \cdot 1^k \pmod{n} \\
&amp;\equiv P \pmod{n}
\end{align*}\]</span></p></li>
</ol>
</section>
<section id="system-security" class="level3">
<h3 class="anchored">System security</h3>
<ul>
<li><strong>Hard problem</strong>: Factorization of <span class="math inline">\(n\)</span> into <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span></li>
<li><strong>Recommended size</strong>:
<ul>
<li><span class="math inline">\(n\)</span>: 2048 bits (minimum for current security)</li>
<li><span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>: 1024+ bits each</li>
</ul></li>
<li><strong>Known vulnerabilities</strong>:
<ul>
<li>Side-channel attacks (timing, power analysis)</li>
<li>Inappropriate parameter choices (<span class="math inline">\(e\)</span> too small, <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> too close)</li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Keys</strong>:
<ul>
<li>Public: <span class="math inline">\((n,e)\)</span> where <span class="math inline">\(n = pq\)</span></li>
<li>Private: <span class="math inline">\((d)\)</span> with <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span></li>
</ul></li>
<li><strong>Operations</strong>:
<ul>
<li>Encryption: <span class="math inline">\(P^e \mod n\)</span></li>
<li>Decryption: <span class="math inline">\(C^d \mod n\)</span></li>
</ul></li>
<li><strong>Security</strong>: Factorization of <span class="math inline">\(n\)</span> difficult</li>
<li><strong>Size</strong>: 2048+ bits for <span class="math inline">\(n\)</span></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<section id="asymmetric-cryptography-operation-rsa-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="asymmetric-cryptography-operation-rsa-1">Asymmetric Cryptography: Operation (RSA)</h2>
<ul>
<li>Let <span class="math inline">\(n := pq\)</span> with <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> two large prime numbers (&gt; 1024 bits).</li>
<li>Let <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span>.</li>
<li>Let <span class="math inline">\(e\)</span> and <span class="math inline">\(d\)</span> such that <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span>.</li>
<li>By definition of congruences: <span class="math inline">\(ed = 1 + k\phi(n)\)</span></li>
<li>Euler’s theorem: <span class="math inline">\(a^{\phi(n)} \equiv 1 \pmod n\)</span>.</li>
<li><strong>Encryption:</strong> <span class="math inline">\(C = P^e \pmod n\)</span>. <strong>Public key:</strong> <span class="math inline">\((n,e)\)</span>.</li>
<li><strong>Decryption:</strong> <span class="math inline">\(P = C^d \pmod n\)</span>. <strong>Private key:</strong> <span class="math inline">\((d)\)</span>.</li>
<li><em>Proof:</em> <span class="math inline">\((P^e)^d \equiv P^{ed} \equiv P^{1 + k\phi(n)} \equiv (P \pmod n) (P^{\phi(n)} \pmod n)^k \equiv P \pmod n\)</span>.</li>
</ul>
</section>
</div>
</div>
<hr>
</section>
</section>
<section id="asymmetric-cryptography-conclusions" class="level2">
<h2 class="anchored" data-anchor-id="asymmetric-cryptography-conclusions">Asymmetric Cryptography: Conclusions</h2>
<ul>
<li><strong>Dominant algorithms</strong>: RSA (most used), Rabin, ElGamal</li>
<li><strong>Complete services</strong>:
<ul>
<li>Confidentiality</li>
<li>Authentication</li>
<li>Integrity</li>
<li>Digital signature &amp; Non-repudiation</li>
<li>Non-duplication</li>
</ul></li>
<li><strong>Performance</strong>:
<ul>
<li>50x slower than symmetric</li>
<li><strong>Optimal solution</strong>: Combination of asymmetric (key exchange) + symmetric (encryption)</li>
</ul></li>
<li><strong>Key management</strong>:
<ul>
<li><strong>Advantage</strong>: Public key exchange without confidential channel</li>
<li><strong>Risk</strong>: Need to verify authenticity of public keys
<ul>
<li>Authenticated acquisition channel <strong>or</strong></li>
<li>Certification by trusted third party</li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Algos</strong>: RSA (dominant), Rabin, ElGamal</li>
<li><strong>Services</strong>: Confidentiality + Authentication + Integrity + Signatures</li>
<li><strong>Slowness</strong>: 50x vs symmetric → <strong>hybrid recommended</strong></li>
<li><strong>Keys</strong>: Simple public exchange but <strong>authentication crucial</strong></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<section id="asymmetric-cryptography-conclusions-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="asymmetric-cryptography-conclusions-1">Asymmetric Cryptography: Conclusions</h2>
<ul>
<li><p>There are a few asymmetric encryption systems (<strong>Rabin</strong>, <strong>ElGamal</strong>, etc.) but the most used is <strong>RSA</strong>.</p></li>
<li><p><strong>Supported services</strong>: <strong>Confidentiality</strong>, <strong>Authentication</strong>, <strong>Integrity</strong>, <strong>Digital Signature &amp; Non-Repudiation</strong>, (<strong>Non-Duplication</strong>).</p></li>
<li><p>Operations related to <strong>asymmetric cryptography</strong> are up to <strong>50 times (!) slower</strong> than those of <strong>symmetric cryptography</strong>. A <strong>combination of the two methods</strong> is often desirable.</p></li>
<li><p><strong>Key distribution</strong> is simplified by the fact that only <strong>public keys</strong> need to be exchanged between participants (no need for an alternative confidential channel) but…</p></li>
<li><p>… it is necessary to <strong>verify that the public key actually belongs to the recipient</strong>:</p>
<ul>
<li>Either the <strong>acquisition channel</strong> of the public key is protected against any modification (<strong>authenticated</strong>)</li>
<li>Or the key is <strong>certified accurate by a third party</strong></li>
</ul></li>
</ul>
</section>
</div>
</div>
<hr>
</section>
<section id="symmetric-vs-asymmetric-comparison" class="level2">
<h2 class="anchored" data-anchor-id="symmetric-vs-asymmetric-comparison">Symmetric vs Asymmetric Comparison</h2>
<section id="comparative-advantages" class="level3">
<h3 class="anchored" data-anchor-id="comparative-advantages">Comparative advantages</h3>
<ul>
<li><strong>Symmetric</strong>:
<ul>
<li><strong>Performance</strong>: 100x faster</li>
<li><strong>Implementation</strong>: Easy in hardware</li>
<li><strong>Keys</strong>: Short (128 bits = 16 memorable characters)</li>
</ul></li>
<li><strong>Asymmetric</strong>:
<ul>
<li><strong>Key exchange</strong>: Authenticated channel sufficient (no need for confidentiality)</li>
<li><strong>Management</strong>: 1 key pair for n correspondents (vs n keys in symmetric)</li>
</ul></li>
</ul>
</section>
<section id="common-issues" class="level3">
<h3 class="anchored" data-anchor-id="common-issues">Common issues</h3>
<ul>
<li><strong>Weak link</strong>: Key management by users</li>
<li><strong>Security basis</strong>: Empirical rather than theoretical</li>
<li><strong>Legal constraints</strong>: Usage and export restrictions</li>
</ul>
</section>
<section id="usage-recommendations" class="level3">
<h3 class="anchored">Usage recommendations</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 29%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Use case</strong></th>
<th><strong>Recommended solution</strong></th>
<th><strong>Justification</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Personal documents</td>
<td>Symmetric</td>
<td>Speed + memorable keys</td>
</tr>
<tr class="even">
<td>Groups of close users</td>
<td>Symmetric</td>
<td>Speed + easy confidential exchange</td>
</tr>
<tr class="odd">
<td>Distant/unknown users</td>
<td>Asymmetric</td>
<td>No need for confidential channel</td>
</tr>
<tr class="even">
<td>Remote transactions</td>
<td>Hybrid (Asymmetric + Symmetric)</td>
<td>Asymmetric for key exchange, symmetric for data</td>
</tr>
<tr class="odd">
<td>Software protection (distribution)</td>
<td>Hybrid</td>
<td>Unique symmetric key per version, encrypted with asymmetric</td>
</tr>
<tr class="even">
<td>Network segments</td>
<td>Symmetric</td>
<td>Speed + controlled environment (easy key exchange between administrators)</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric</strong>:</p>
<pre><code>✅ Fast (100x)
✅ Short keys (128 bits)
❌ Confidential key exchange required</code></pre>
<p><strong>Asymmetric</strong>:</p>
<pre><code>✅ Simplified key exchange
✅ 1 key pair for n correspondents
❌ Slow (50x)
❌ Long keys (1024+ bits)</code></pre>
<p><strong>Hybrid</strong>: Best of both worlds <strong>Common problems</strong>: Key management, empirical basis, legal restrictions</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="symmetric-vs.-asymmetric-cryptography" class="level2">
<h2 class="anchored" data-anchor-id="symmetric-vs.-asymmetric-cryptography">Symmetric vs.&nbsp;Asymmetric Cryptography</h2>
<ul>
<li><p>There are <strong>hundreds of symmetric and asymmetric algorithms</strong> capable of providing a sufficient level of <strong>confidentiality</strong>.</p></li>
<li><p><strong>Symmetric solutions</strong> offer the following advantages:</p>
<ul>
<li><strong>Speed</strong> (up to <strong>100 times faster</strong> than asymmetric solutions)</li>
<li><strong>Ease of hardware implementation</strong></li>
<li><strong>Reduced key length</strong>: <strong>128 bits</strong> (= 16 characters ⇒ memorable!) instead of <strong>1024 bits</strong> for asymmetric equivalents.</li>
</ul></li>
<li><p><strong>Asymmetric solutions</strong> have as main arguments:</p>
<ul>
<li><strong>Simplified key exchange</strong>: keys must be exchanged through an <strong>authenticated but non-confidential channel</strong></li>
<li><strong>Simplified key management</strong>: a single <strong>public/private key pair</strong> is sufficient for a user to receive confidential messages from <strong>n users</strong> (instead of <strong>n different keys</strong> in the symmetric case).</li>
</ul></li>
<li><p><strong>Problems common to both techniques</strong>:</p>
<ul>
<li><strong>Key management by the user</strong> remains the <strong>weakest link</strong></li>
<li>Security (normally) based on <strong>empirical arguments</strong> rather than <strong>theoretical</strong> ones</li>
<li><strong>Legal restrictions</strong> on usage and export</li>
</ul></li>
</ul>
</section>
<section id="symmetric-vs.-asymmetric-cryptography-ii" class="level2">
<h2 class="anchored" data-anchor-id="symmetric-vs.-asymmetric-cryptography-ii">Symmetric vs.&nbsp;Asymmetric Cryptography (II)</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 31%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Activity</strong></th>
<th><strong>Recommendation</strong></th>
<th><strong>Remarks</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Protection of personal documents</td>
<td><strong>Symmetric crypto</strong></td>
<td><strong>Speed</strong>, easily memorable keys</td>
</tr>
<tr class="even">
<td>Protection of documents in a group of close users</td>
<td><strong>Symmetric crypto</strong></td>
<td><strong>Speed</strong>, ease of exchanging confidential keys</td>
</tr>
<tr class="odd">
<td>Establishment of confidential channels between distant users (unknown)</td>
<td><strong>Asymmetric crypto</strong></td>
<td>No need to have a confidential channel: <strong>authenticity suffices</strong></td>
</tr>
<tr class="even">
<td>Transactions between two distant users, Software protection (multicast distribution)</td>
<td><strong>Asymmetric crypto for symmetric key protection</strong> + <strong>Symmetric crypto for data protection</strong></td>
<td><strong>Speed</strong>, Only the symmetric key needs to be re-encrypted for each correspondent, Encrypted copy of software can be made public</td>
</tr>
<tr class="odd">
<td>Protection of network segments</td>
<td><strong>Symmetric crypto</strong></td>
<td><strong>Speed</strong>, Stable environment → easy confidential key exchange between sysadmins</td>
</tr>
</tbody>
</table>
</section>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="dissection-of-an-attack-ransomware" class="level1">
<h1>Dissection of an Attack: Ransomware</h1>
<section id="definition-and-impact" class="level3">
<h3 class="anchored" data-anchor-id="definition-and-impact">Definition and Impact</h3>
<ul>
<li><strong>Definition</strong>: Malicious software that encrypts data and demands a ransom for its restoration.</li>
<li><strong>Limitations of the classic definition</strong>:
<ul>
<li>Does not cover the impact on <strong>critical infrastructure</strong> (e.g., Colonial Pipeline, May 2021)</li>
<li>Underestimates the <strong>systemic scope</strong> of attacks</li>
</ul></li>
<li><strong>Alarming statistics</strong>:
<ul>
<li>Billions of annual attacks</li>
<li>Considered the <strong>most dangerous cyber threat</strong> in 2021 (“Ransomware Everywhere”)</li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Malware</strong>: Encrypts data → demands ransom</li>
<li><strong>Impact</strong>: Critical infrastructure (e.g., Colonial Pipeline)</li>
<li><strong>Threat #1</strong> in cybersecurity (2021)</li>
<li><strong>Targets</strong>: Individuals + businesses + states</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>“Ransomware (from English <strong>ransomware</strong>), ransom software, extortion software, is malicious software that holds personal data hostage. To do this, ransomware <strong>encrypts personal data</strong> then asks their owner to send money in exchange for the <strong>decryption key</strong>” (Wikipedia September 21, 2021).</p>
<ul>
<li><p><strong>Incomplete definition</strong> because <strong>ransomware</strong> affects a <strong>vast spectrum of IT infrastructure</strong></p></li>
<li><p>For example, in May 2021, a <strong>ransomware attack</strong> against the <strong>Colonial Pipeline</strong> company caused a <strong>fuel supply disruption</strong> for a large part of the US coast</p></li>
<li><p>With a <strong>total number of attacks</strong> counted in <strong>billions per year</strong>, “<strong>Ransomware Everywhere</strong>” is globally considered the <strong>most direct, visible and dangerous threat</strong> for users and companies in 2021!</p></li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="ransomware-attack-lifecycle" class="level2">
<h2 class="anchored" data-anchor-id="ransomware-attack-lifecycle">Ransomware Attack Lifecycle</h2>
<section id="prevention-and-response" class="level3">
<h3 class="anchored" data-anchor-id="prevention-and-response">Prevention and Response</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Phase</th>
<th>Measures</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Prevention</strong></td>
<td>- Regular patching<br>- Detection solutions (Firewalls, WAFs, IDS/IPS)<br>- Anti-malware scans (emails, files)</td>
</tr>
<tr class="even">
<td><strong>Protection</strong></td>
<td>- <strong>Offline backups</strong> (essential!)<br>- Strict security policies<br>- User training</td>
</tr>
<tr class="odd">
<td><strong>Response</strong></td>
<td>- <strong>Do not pay</strong> (official recommendation)<br>- Forensic analysis<br>- Restoration from backups</td>
</tr>
</tbody>
</table>
</section>
<section id="technical-dissection" class="level3">
<h3 class="anchored" data-anchor-id="technical-dissection">Technical Dissection</h3>
<ol type="1">
<li><strong>Infection</strong>:
<ul>
<li>Vectors: Phishing, exploits, vulnerable RDP</li>
<li>Propagation: Lateral (network) or vertical (system)</li>
</ul></li>
<li><strong>Execution</strong>:
<ul>
<li>Encryption of targeted files</li>
<li>Deletion of shadow copies</li>
<li>Persistence (registry, scheduled tasks)</li>
</ul></li>
<li><strong>Extortion</strong>:
<ul>
<li>Display of ransom demand</li>
<li>Payment in cryptocurrencies (Bitcoin, Monero)</li>
<li>Payment deadlines with penalties</li>
</ul></li>
<li><strong>Obfuscation</strong>:
<ul>
<li>Code obfuscation</li>
<li>Communication via TOR/Deep Web</li>
<li>Log erasure</li>
</ul></li>
</ol>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Attack cycle</strong>:</p>
<ol type="1">
<li>Infection (phishing/exploits)</li>
<li>Execution (encryption + persistence)</li>
<li>Extortion (ransom in crypto)</li>
<li>Obfuscation (TOR + trace erasure)</li>
</ol>
<p><strong>Countermeasures</strong>:</p>
<pre><code>✅ Offline backups
✅ Patching + detection
✅ Training
❌ Do not pay</code></pre>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="cryptolocker-technical-analysis" class="level2">
<h2 class="anchored" data-anchor-id="cryptolocker-technical-analysis">Cryptolocker: Technical Analysis</h2>
<section id="attack-scheme" class="level3">
<h3 class="anchored" data-anchor-id="attack-scheme">Attack Scheme</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    A[Initial infection] --&gt; B[File encryption]
    B --&gt; C[Private key storage on C2 servers]
    C --&gt; D[Ransom demand]
    D --&gt; E{Payment ?}
    E --&gt;|Yes| F[Decryption key sent via TOR]
    E --&gt;|No| G[Permanent data loss]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="preferred-targets" class="level3">
<h3 class="anchored">Preferred Targets</h3>
<ul>
<li><strong>Critical extensions</strong> (extract):
<ul>
<li>Documents: <code>.docx</code>, <code>.xlsx</code>, <code>.pdf</code>, <code>.pptx</code></li>
<li>Databases: <code>.mdb</code>, <code>.sql</code>, <code>.sqlite</code></li>
<li>Media: <code>.jpg</code>, <code>.png</code>, <code>.mp4</code>, <code>.avi</code></li>
<li>Development: <code>.java</code>, <code>.cpp</code>, <code>.py</code>, <code>.php</code></li>
<li>Financial: <code>.qbw</code>, <code>.qbb</code>, <code>.wallet</code></li>
</ul></li>
<li><strong>Behavior</strong>:
<ul>
<li><strong>Selective</strong> encryption (recent/modified files)</li>
<li><strong>Double extortion</strong>: Encryption + threat of leakage</li>
<li><strong>RaaS</strong> (Ransomware-as-a-Service): Economic model</li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Mechanism</strong>: - Private key stored on C2 servers - Payment → key via TOR - Targets: 100+ extensions (docs, DB, media)</p>
<p><strong>Recent evolutions</strong>: - Double extortion (encryption + leakage) - RaaS (ransomware rental)</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="ransomware-complete-view" class="level2">
<h2 class="anchored" data-anchor-id="ransomware-complete-view">Ransomware: Complete View</h2>
<p><em>(Source: 2017 State of Cybersecurity, F-Secure Inc.)</em></p>
</section>
<section id="ransomware-complete-view-1" class="level2">
<h2 class="anchored" data-anchor-id="ransomware-complete-view-1">Ransomware: Complete View</h2>
<section id="prevention-remediation-and-response" class="level4">
<h4 class="anchored" data-anchor-id="prevention-remediation-and-response">Prevention, Remediation and Response</h4>
<ul>
<li><strong>Patching</strong></li>
<li><strong>Active and passive detection</strong> (Firewalls, WAFs, IDS, IPS, email malware scan, etc.)</li>
<li><strong>Offline backups</strong> !</li>
<li><strong>Security Policy</strong> - Rules for proper email usage</li>
<li><strong>Training</strong> !</li>
<li><strong>To pay or not to pay</strong>…</li>
</ul>
</section>
<section id="technical-dissection-of-the-attack" class="level4">
<h4 class="anchored" data-anchor-id="technical-dissection-of-the-attack">Technical Dissection of the Attack</h4>
<ul>
<li><strong>Infection and propagation</strong></li>
<li><strong>Execution</strong></li>
<li><strong>Payment</strong> (Crypto-currencies / Bitcoin)</li>
<li><strong>Obfuscation</strong> (Obfuscation, TOR Networks/Deep Web)</li>
</ul>
</section>
<section id="generic-scheme-of-a-cryptolocker-ransomware" class="level3">
<h3 class="anchored" data-anchor-id="generic-scheme-of-a-cryptolocker-ransomware">Generic Scheme of a Cryptolocker Ransomware</h3>
<ul>
<li><strong>Decryption private keys</strong> are stored on the <strong>attacker’s</strong> servers</li>
<li>They are sent to the <strong>victim</strong> after <strong>bitcoin payment</strong></li>
<li>The <strong>trace</strong> is shredded using <strong>TOR networks</strong></li>
</ul>
</section>
</section>
<section id="ransomware-cryptolocker-targets" class="level2">
<h2 class="anchored" data-anchor-id="ransomware-cryptolocker-targets">Ransomware Cryptolocker: Targets</h2>
<p><strong>Targeted file extensions</strong>: .jin, .xls, .xlsx, .pdf, .doc, .docx, .ppt, .pptx, .txt, .dwg, .bak, .bkf, .pst, .dbx, .zip, .rar, .mdb, .asp, .aspx, .html, .htm, .dbf, .3dm, .3ds, .3fr, .jar, .3g2, .xml, .png, .tif, .3gp, .java, .jpe, .jpeg, .jpg, .jsp, .php, .3pr, .7z, .ab4, .accdb, .accde, .accdr, .accdt, .ach, .kbx, .acr, .act, .adb, .ads, .agdl, .ai, .ait, .al, .apj, .arw, .asf, .asm, .asx, .avi, .awg, .back, .backup, .backupdb, .pbl, .bank, .bay, .bdb, .bgt, .bik, .bkp, .blend, .bpw, .c, .cdf, .cdr, .cdr3, .cdr4, .cdr5, .cdr6, .cdrw, .cdx, .ce1, .ce2, .cer, .cfp, .cgm, .cib, .class, .cls, .cmt, .cpi, .cpp, .cr2, .craw, .crt, .crw, .phtml, .php5, .cs, .csh, .csl, .tib, .csv, .dac, .db, .db3, .dbjournal, .dc2, .dcr, .dcs, .ddd, .ddoc, .ddrw, .dds, .der, .des, .design, .dgc, .djvu, .dng, .dot, .docm, .dotm, .dotx, .drf, .drw, .dtd, .dxb, .dxf, .dxg, .eml, .eps, .erbsql, .erf, .exf, .fdb, .ffd, .fff, .fh, .fmb, .fhd, .fla, .flac, .flv, .fpx, .fxg, .gray, .grey, .gry, .h, .hbk, .hpp, .ibank, .ibd, .ibz, .idx, .iif, .iiq, .incpas, .indd, .kc2, .kdbx, .kdc, .key, .kpdx, .lua, .m, .m4v, .max, .mdc, .mdf, .mef, .mfw, .mmw, .moneywell, .mos, .mov, .mp3, .mp4, .mpg, .mrw, .msg, .myd, .nd, .ndd, .nef, .nk2, .nop, .nrw, .ns2, .ns3, .ns4, .nsd, .nsf, .nsg, .nsh, .nwb, .nx2, .nxl, .nyf, .oab, .obj, .odb, .odc, .odf, .odg, .odm, .odp, .ods, .odt, .oil, .orf, .ost, .otg, .oth, .otp, .ots, .ott, .p12, .p7b, .p7c, .pab, .pages, .pas, .pat, .pcd, .pct, .pdb, .pdd, .pef, .pem, .pfx, .pl, .plc, .pot, .potm, .potx, .ppam, .pps, .ppsm, .ppsx, .pptm, .prf, .ps, .psafe3, .psd, .pspimage, .ptx, .py, .qba, .qbb, .qbm, .qbr, .qbw, .qbx, .qby, .r3d, .raf, .rat, .raw, .rdb, .rm, .rtf, .rw2, .rwl, .rwz, .s3db, .sas7bdat, .say, .sd0, .sda, .sdf, .sldm, .sldx, .sql, .sqlite, .sqlite3, .sqlitedb, .sr2, .srf, .srt, .srw, .st4, .st5, .st6, .st7, .st8, .std, .sti, .stw, .stx, .svg, .swf, .sxc, .sxd, .sxg, .sxi, .sxi, .sxm, .sxw, .tex, .tga, .thm, .tlg, .vob, .war, .wallet, .wav, .wb2, .wmv, .wpd, .wps, .x11, .x3f, .xis, .xla, .xlam, .xlk, .xlm, .xlr, .xlsb, .xlsm, .xlt, .xltm, .xltx, .xlw, .ycbcra, .yuv</p>
<p><em>Source: Intel Security Advanced Threat Research - http://www.intelsecurity.com</em></p>
</section>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="basic-cryptography-concepts" class="level1">
<h1>Basic Cryptography Concepts</h1>
<ul>
<li>Introduction to the <strong>fundamental concepts</strong> of cryptography.</li>
<li>Presents <strong>security principles</strong>, <strong>system types</strong>, and <strong>attack models</strong>.</li>
<li>Includes <strong>historical systems</strong> and complementary techniques.</li>
</ul>
<section id="kerckhoffs-principle" class="level2">
<h2 class="anchored" data-anchor-id="kerckhoffs-principle">Kerckhoffs’ Principle</h2>
<ul>
<li>Fundamental principle: <strong>security relies solely on the key</strong>, not on the secrecy of the algorithm.</li>
<li>The system must remain <strong>secure even if the algorithm is public</strong>.</li>
<li>The key must be <strong>easily modifiable</strong> and the system <strong>simple to use</strong>.</li>
<li>Explicit rejection of <strong>security through obscurity</strong>.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Security based on the key</li>
<li>Public algorithm</li>
<li>No security through obscurity</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse">
<section id="kerckhoffs-principle-1" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="kerckhoffs-principle-1">Kerckhoffs’ Principle</h2>
<p><strong>Auguste Kerckhoffs</strong> published in <strong>1883</strong> two articles defining <strong>six principles</strong> for military ciphers:</p>
<ol type="1">
<li>The system must be <strong>practically, if not mathematically, undecipherable</strong>.</li>
<li>It must <strong>not require confidentiality</strong> and remain secure even if it falls into enemy hands.</li>
<li>The <strong>key</strong> must be able to be <strong>memorized, transmitted and modified easily</strong>, without written notes.</li>
<li>The system must be <strong>compatible with telegraphic communications</strong>.</li>
<li>It must be <strong>portable</strong> and usable by <strong>a single person</strong>.</li>
<li>It must be <strong>simple to use</strong>, without complex procedures or excessive constraints.</li>
</ol>
<p>Kerckhoffs stated as early as the <strong>19th century</strong> that security must be <strong>mathematically demonstrable</strong> and that <strong>there is no security through obscurity</strong>.</p>
</section>
</div>
</div>
</section>
<section id="classification-of-encryption-systems" class="level2">
<h2 class="anchored" data-anchor-id="classification-of-encryption-systems">Classification of Encryption Systems</h2>
<section id="unconditional-security" class="level3">
<h3 class="anchored" data-anchor-id="unconditional-security">Unconditional Security</h3>
<p>(<em>unconditional security</em> / <em>perfect secrecy</em>)</p>
<ul>
<li>Security <strong>independent of computing power</strong>.</li>
<li><strong>Ciphertext</strong> provides no information about the <strong>plaintext</strong>.</li>
<li>Conditions: <strong>key ≥ message</strong>, <strong>never reused</strong>.</li>
<li>Mostly <strong>theoretical</strong> use.</li>
<li><strong>Example</strong>: <em>one-time pad</em>.</li>
</ul>
</section>
<section id="as-hard-as-equivalent-provable-security" class="level3">
<h3 class="anchored" data-anchor-id="as-hard-as-equivalent-provable-security">As hard as / equivalent / provable security</h3>
<ul>
<li>Cryptanalysis <strong>as difficult</strong> as a <strong>hard mathematical problem</strong>.</li>
<li><strong>RSA</strong> and <strong>Rabin</strong> proven equivalent to factorization.
<ul>
<li>Demonstrated by <strong>reduction</strong> (<em>reduction proof</em>).</li>
</ul></li>
<li>Central but <strong>controversial</strong> concept.</li>
</ul>
</section>
<section id="computational-security" class="level3">
<h3 class="anchored" data-anchor-id="computational-security">Computational Security</h3>
<p>(<em>computational security</em> / <em>practical security</em>)</p>
<ul>
<li>Security based on <strong>unrealistic cost of attacks</strong>.</li>
<li>Most used category in practice.</li>
<li><strong>Examples</strong>: <strong>AES</strong>, <strong>DES</strong>, <strong>IDEA</strong>, <strong>RC4</strong>.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Unconditional</strong>: perfect, theoretical (<em>one-time pad</em>).</li>
<li><strong>Provable security</strong>: equivalence to hard mathematical problem.</li>
<li><strong>Computational</strong>: secure in practice.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Unconditional security</strong> (<em>unconditional security also called <strong>perfect secrecy</strong></em>):</p>
<ul>
<li>The security of the encryption system <strong>is not compromised by the computing power</strong> intended for cryptanalysis.</li>
<li>This category relies on <strong>information theory</strong> published by <strong>Shannon in 1949</strong>.</li>
<li>More precisely, an encryption system is <strong>unconditionally secure</strong> if the probability of encountering a <strong>plaintext x</strong> after observing the <strong>corresponding ciphertext y</strong> is identical to the a priori probability of encountering plaintext x.</li>
<li>In other words, having <strong>plaintext/ciphertext pairs (x,y)</strong> provides <strong>no help for cryptanalysis</strong>.</li>
<li>A necessary condition for a system to be unconditionally secure is that the <strong>key be at least the same size as the message</strong> and, above all, that it <strong>not be reused</strong> to encrypt different messages.</li>
<li>This condition makes these systems <strong>poorly suited to usual cryptographic needs</strong> and reduces their domain of interest to a <strong>theoretical framework</strong>.</li>
<li>The classic example is the <strong>one-time pad</strong> invented in <strong>1917</strong> by <strong>J. Mauborgne</strong> and <strong>G. Vernam</strong>.</li>
<li>Theoretical foundations of unconditionally secure systems + other examples in <strong>[Sti06]</strong>.</li>
</ul></li>
<li><p><strong>As hard as / equivalent / provable security</strong></p>
<ul>
<li>When it can be proven that cryptanalyzing the algorithm is <strong>as difficult as solving a reputedly hard mathematical problem</strong>.</li>
<li>For example <strong>factorization of large numbers</strong>, calculation of <strong>square roots modulo a composite</strong>, calculation of <strong>discrete logarithms in a finite group</strong>, etc.</li>
<li>The <strong>Rabin</strong> and <strong>RSA</strong> algorithms (generic case^1) are “proven” <strong>equivalent to factorization</strong>.</li>
<li>Such a proof is called a “reduction” (<strong>reduction proof</strong>).</li>
<li>The notion of <strong>provable security</strong> is at the origin of an <strong>important controversy</strong> in the cryptographic world.</li>
</ul></li>
<li><p><strong>Computational security</strong> (<em>computational security also called <strong>practical security</strong></em>)</p>
<ul>
<li>An encryption system is in this category if the <strong>computational effort needed to “break” it</strong> using the best possible techniques is <strong>beyond</strong> (with a reasonable margin) the computing resources of a hypothetical adversary.</li>
<li>The vast majority of symmetric encryption systems (<strong>AES, DES, IDEA, RC4</strong>, etc.) are in this category.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="entropy" class="level2">
<h2 class="anchored" data-anchor-id="entropy">Entropy</h2>
<ul>
<li><strong>Entropy</strong> (Shannon, 1948) measures the <strong>effective amount of information</strong> contained in a message.</li>
<li><strong>Conditional entropy</strong> measures the uncertainty that remains about the <strong>plaintext</strong> after observing the <strong>ciphertext</strong>.</li>
</ul>
<section id="properties" class="level3">
<h3 class="anchored" data-anchor-id="properties">Properties</h3>
<ul>
<li><span class="math inline">\(0 \le H(X) \le \log n\)</span></li>
<li><span class="math inline">\(H(X) = 0\)</span> → no uncertainty</li>
<li><span class="math inline">\(H(X) = \log n\)</span> → all outcomes equally probable</li>
</ul>
</section>
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation">Interpretation</h3>
<ul>
<li>Approximates the <strong>number of bits needed</strong> to encode <span class="math inline">\(X\)</span>.</li>
<li><strong>Redundancy</strong> = difference between effective encoding and entropy.</li>
</ul>
</section>
<section id="conditional-entropy" class="level3">
<h3 class="anchored" data-anchor-id="conditional-entropy">Conditional Entropy</h3>
<ul>
<li><span class="math inline">\(H(X \mid Y = y) = - \sum_{x} P(X=x \mid Y=y) \log P(X=x \mid Y=y)\)</span></li>
<li><span class="math inline">\(H(X \mid Y) = \sum_y P(Y=y) H(X \mid Y=y)\)</span></li>
<li>Measures the remaining uncertainty about the <strong>plaintext</strong> after observing the <strong>ciphertext</strong>.</li>
</ul>
<hr>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Entropy</strong>: amount of information in a message.</li>
<li><strong>Conditional entropy</strong>: uncertainty about plaintext after ciphertext.</li>
<li><strong>Redundancy</strong>: difference between effective encoding and entropy.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-47-contents" aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-47" class="callout-47-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>An essential definition in cryptography is the <strong>effective</strong> amount of information contained in a message.</li>
<li>For example, days of the week (<em>Monday</em>, …, <em>Sunday</em>) can intuitively be encoded as character strings of length (<span class="math inline">\(\le \text{len}(\text{``Wednesday''})\)</span>), i.e., <span class="math inline">\((8 \times 8 = 64)\)</span> bits. However, the effective amount of information of the variable <em>day of the week</em> can be optimally encoded on <strong>3 bits</strong> (since <span class="math inline">\((2^3 = 8)\)</span> is sufficient to represent the 7 possible variations).</li>
<li><strong>Entropy</strong> (Shannon, 1948) is the mathematical formalization of this definition.</li>
</ul>
<section id="formal-definition" class="level3">
<h3 class="anchored" data-anchor-id="formal-definition">Formal Definition</h3>
<p>Let <span class="math inline">\(X\)</span> be a random variable with a finite set of possible values <span class="math inline">\({x_1, x_2, \dots, x_n}\)</span>, such that <span class="math inline">\(P(X=x_i) = p_i\)</span>, with <span class="math inline">\(0 \le p_i \le 1\)</span> and <span class="math inline">\(\sum p_i = 1\)</span>. The entropy of <span class="math inline">\(X\)</span>, denoted <span class="math inline">\(H(X)\)</span>, is defined by</p>
<p><span class="math inline">\(H(X) = - \sum_{i=1}^{n} p_i \log p_i = \sum_{i=1}^{n} p_i \log \left(\frac{1}{p_i}\right)\)</span></p>
<p>By convention: <span class="math inline">\(p_i \log p_i = 0\)</span> if <span class="math inline">\(p_i = 0\)</span>. All logarithms are in <strong>base 2</strong>.</p>
</section>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<ul>
<li>Approximation of the number of bits needed to encode the elements of <span class="math inline">\(X\)</span>.</li>
<li><strong>Redundancy</strong> is the difference between the effective encoding and entropy.</li>
</ul>
</section>
<section id="properties-1" class="level3">
<h3 class="anchored" data-anchor-id="properties-1">Properties</h3>
<ol type="1">
<li><span class="math inline">\(0 \le H(X) \le \log n\)</span></li>
<li><span class="math inline">\(H(X) = 0 \iff \exists i : p_i = 1, p_j = 0 \ \forall j \ne i\)</span></li>
<li><span class="math inline">\(H(X) = \log n \iff p_i = 1/n \ \forall i\)</span></li>
</ol>
</section>
<section id="conditional-entropy-1" class="level3">
<h3 class="anchored" data-anchor-id="conditional-entropy-1">Conditional Entropy</h3>
<ul>
<li><span class="math inline">\(H(X \mid Y = y) = - \sum_{x} P(X=x \mid Y=y) \log P(X=x \mid Y=y)\)</span>,</li>
<li><span class="math inline">\(H(X \mid Y) = \sum_y P(Y=y) H(X \mid Y=y)\)</span></li>
</ul>
<p><em>Measures the uncertainty about <span class="math inline">\(X\)</span> (plaintext) after having observed <span class="math inline">\(Y\)</span> (ciphertext).</em></p>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="attacks-on-encryption-systems" class="level2">
<h2 class="anchored" data-anchor-id="attacks-on-encryption-systems">Attacks on Encryption Systems</h2>
<ul>
<li><strong>Ciphertext-only</strong>: Adversary has only the <strong>ciphertext</strong>.</li>
<li><strong>Known-plaintext</strong>: Adversary has <strong>plaintext/ciphertext pairs</strong>.</li>
<li><strong>Chosen-plaintext</strong>: Adversary <strong>chooses</strong> the <strong>plaintext</strong> and see the ciphertext (and tries to find the plaintext for other messages).</li>
<li><strong>Adaptive chosen-plaintext</strong>: <strong>depends on</strong> the <strong>received</strong> ciphertexts.</li>
<li><strong>Chosen-ciphertext</strong>: Adversary <strong>chooses</strong> the <strong>ciphertext</strong> and obtains the plaintext (aims to find the key).</li>
<li><strong>Adaptive Chosen-ciphertext</strong>: <strong>Chosen-ciphertext</strong> depends on the received plaintexts.</li>
</ul>
</section>
<section id="oracles-and-security-models" class="level2">
<h2 class="anchored" data-anchor-id="oracles-and-security-models">Oracles and Security Models</h2>
<section id="random-oracles-and-security-models" class="level3">
<h3 class="anchored" data-anchor-id="random-oracles-and-security-models">Random Oracles and Security Models</h3>
<ul>
<li><strong>Random Oracle</strong>: A theoretical “perfect” function that returns a uniform and random value for each new input, but remains deterministic for an input already seen.</li>
<li><strong>ROM (Random Oracle Model)</strong>: Mathematical proof framework using this ideal oracle as a substitute for hash functions.</li>
<li><strong>Standard Model</strong>: Framework where security relies solely on the adversary’s computing power against real algorithms.</li>
<li><strong>Limit</strong>: A security proof in ROM does not guarantee absolute security in the real world (with SHA-256, etc.).</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A <strong>random oracle</strong> is an abstract entity accessible to legitimate parties and adversaries.</p>
<ul>
<li><strong>Behavior</strong>: It responds to input queries <span class="math inline">\(x\)</span> with perfectly random responses <span class="math inline">\(Orc(x)\)</span>.</li>
<li><strong>Determinism</strong>: The only exception lies in previously processed inputs (<span class="math inline">\(x_1, x_2, \dots, x_n\)</span>). If <span class="math inline">\(x_1' = x_1\)</span>, then <span class="math inline">\(Orc(x_1') = Orc(x_1)\)</span>.</li>
<li><strong>Modeling</strong>: It is modeled by a function <span class="math inline">\(Orc : X \to Y\)</span> where <span class="math inline">\(\forall x \in X, \Pr(Orc(x) = y) = \frac{1}{|Y|}\)</span>.</li>
<li><strong>Utility</strong>: It behaves like an <strong>“ideal” cryptographic hash function</strong>, a valuable tool for proving security in the <strong>Random Oracle Model</strong>.</li>
<li><strong>Comparison</strong>: The <strong>standard model</strong> limits adversaries by computational factors. A protocol secure in the random oracle model can become vulnerable if used with a “real” hash function (SHA-1, SHA-256).</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="encryption-decryption-and-signature-oracles" class="level3">
<h3 class="anchored" data-anchor-id="encryption-decryption-and-signature-oracles">Encryption, Decryption and Signature Oracles</h3>
<ul>
<li><strong>Function</strong>: Entities that perform operations (encrypt/sign) for the adversary using secret keys without ever revealing them.</li>
<li><strong>Symmetric cryptography</strong>: The oracle provides <span class="math inline">\(E_k(x)\)</span> or <span class="math inline">\(D_k(y)\)</span>.</li>
<li><strong>Asymmetric cryptography</strong>: The oracle is crucial for private operations (decryption/signature), as public operations are already freely accessible.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-49-contents" aria-controls="callout-49" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version: Operational Oracles
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-49" class="callout-49-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>An <strong>encryption/decryption/signature oracle</strong> is an abstract entity offering an “on-demand” service.</p>
<ul>
<li><strong>Key access</strong>: It uses the <strong>same keys as the legitimate owners</strong> (symmetric and asymmetric systems) without disclosing them.</li>
<li><strong>Symmetric primitives</strong>: For a primitive <span class="math inline">\(E\)</span> and a key <span class="math inline">\(k\)</span>, it returns <span class="math inline">\(y = E_k(x)\)</span> or the corresponding plaintext <span class="math inline">\(x\)</span>.</li>
<li><strong>Public key systems</strong>: The oracle is only needed for operations with the <strong>private key</strong> (<span class="math inline">\(priv_k\)</span>).
<ul>
<li><strong>Decryption</strong>: returns <span class="math inline">\(x\)</span> such that <span class="math inline">\(E'_{pubk}(x) = y\)</span>.</li>
<li><strong>Signature</strong>: For a system <span class="math inline">\(S\)</span>, it returns <span class="math inline">\(y = S_{privk}(x)\)</span>.</li>
</ul></li>
<li><strong>Attacks</strong>: The attack models using <strong>chosen plaintext</strong> (CPA) and <strong>chosen ciphertext</strong> (CCA) rely on making these oracles available to the adversary.</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="indistinguishability-and-semantic-security-ind-cpa" class="level3">
<h3 class="anchored" data-anchor-id="indistinguishability-and-semantic-security-ind-cpa">Indistinguishability and Semantic Security (IND-CPA)</h3>
<ul>
<li><strong>Property</strong>: An adversary must not be able to distinguish the ciphertexts of two different plaintext messages.</li>
<li><strong>IND-CPA (Indistinguishability under Chosen Plaintext Attack)</strong>: If the adversary guesses the correct message only with a probability of <span class="math inline">\(1/2 + \epsilon\)</span>, the system is considered secure.</li>
<li><strong>Semantic Security</strong>: Equivalent to IND-CPA, it ensures that no useful information leaks from the ciphertext.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-50-contents" aria-controls="callout-50" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version: Semantic Security
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-50" class="callout-50-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Ciphertext indistinguishability</strong> guarantees the inability to distinguish the ciphertexts of given plaintexts.</p>
<ul>
<li><strong>Experiment (IND-CPA Security Game)</strong>:
<ol type="1">
<li>The adversary chooses two messages <span class="math inline">\(M_0\)</span> and <span class="math inline">\(M_1\)</span>.</li>
<li>The oracle chooses a random index <span class="math inline">\(i \in \{0,1\}\)</span> and returns <span class="math inline">\(c_i = E_k(M_i)\)</span>.</li>
<li>The adversary can perform other calculations or oracle calls.</li>
</ol></li>
<li><strong>IND-CPA Definition</strong>: The system is secure if the adversary’s advantage is <strong>negligible</strong> (<span class="math inline">\(Prob = 1/2 + \epsilon\)</span> with <span class="math inline">\(\epsilon\)</span> small).</li>
<li><strong>Note</strong>: In public key, the encryption oracle is useless because the adversary already possesses the public key. IND-CPA provides <strong>semantic security</strong>.</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="probabilistic-encryption-and-oaep" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic-encryption-and-oaep">Probabilistic Encryption and OAEP</h3>
<ul>
<li><strong>Problem</strong>: Deterministic encryption allows <strong>dictionary attacks</strong> (comparison of known ciphertexts).</li>
<li><strong>Solution</strong>: Add randomness to the message before encryption so that <span class="math inline">\(E(M)\)</span> is different each time.</li>
<li><strong>OAEP (Optimal Asymmetric Encryption Padding)</strong>: Standard used with RSA. It combines the message <span class="math inline">\(P\)</span> with a random number <span class="math inline">\(R\)</span> via hash functions <span class="math inline">\(h\)</span> and XOR operations (<span class="math inline">\(\oplus\)</span>).</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-51-contents" aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version: Determinism vs.&nbsp;Probabilism
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-51" class="callout-51-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Deterministic</strong> behavior (same inputs = same outputs) creates vulnerabilities.</p>
<ul>
<li><strong>Example</strong>: If Alice sends “Yes” or “No”, the adversary can compute <span class="math inline">\(C_{yes} = E_{pub}(``Yes")\)</span> and compare. They can create a <strong>codebook</strong> (dictionary) to identify messages without breaking the key.</li>
<li><strong>Probabilistic encryption</strong>: Adds randomness. The goal is semantic security for the public key.</li>
<li><strong>OAEP</strong>: Used in <strong>RSA-PKCS1</strong>. The text <span class="math inline">\(P\)</span> is combined with randomness <span class="math inline">\(R\)</span>:
<ul>
<li><span class="math inline">\(M_1 := P \oplus h(R)\)</span></li>
<li><span class="math inline">\(M_2 := R \oplus h(M_1)\)</span></li>
<li>Encryption applies to <span class="math inline">\(M_1\)</span> and <span class="math inline">\(M_2\)</span>. During decryption, we recover <span class="math inline">\(R = M_2 \oplus h(M_1)\)</span>, then <span class="math inline">\(P = h(R) \oplus M_1\)</span>.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-52-contents" aria-controls="callout-52" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-52" class="callout-52-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Random Oracle</strong>: “Ideal” hash function (theoretical model).</li>
<li><strong>CPA/CCA Oracles</strong>: Simulate access to the secret key to test resistance.</li>
<li><strong>IND-CPA</strong>: Inability to distinguish two ciphertexts (Semantic Security).</li>
<li><strong>Probabilistic Encryption</strong>: Essential to counter codebooks (dictionary attacks).</li>
<li><strong>OAEP</strong>: Padding method adding the necessary randomness to RSA.</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="history-of-cryptography-and-unconditional-security" class="level2">
<h2 class="anchored" data-anchor-id="history-of-cryptography-and-unconditional-security">History of Cryptography and Unconditional Security</h2>
<section id="historical-encryption-systems" class="level3">
<h3 class="anchored" data-anchor-id="historical-encryption-systems">Historical Encryption Systems</h3>
<p>Cryptography was for a long time limited to the sole pursuit of <strong>confidentiality</strong>. Historical systems are based on two fundamental principles: <strong>substitution</strong> and <strong>transposition</strong>.</p>
<ul>
<li><strong>Caesar Cipher</strong> (mono-alphabetic substitution): Fixed letter shift. Very vulnerable to <strong>frequency analysis</strong>.</li>
<li><strong>Vigenère Cipher</strong> (polyalphabetic substitution): Uses a key to vary the shift. More complex, but breakable by identifying the key length.</li>
<li><strong>Transposition Cipher</strong>: Reorganization of the original text characters according to a permutation defined by a key.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-53-contents" aria-controls="callout-53" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version: Historical Cryptography
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-53" class="callout-53-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For centuries <strong>confidentiality</strong> was the only application of cryptography…</p>
<ul>
<li><strong>1st century BC, Caesar Cipher</strong>: <strong>Mono-alphabetic substitution encryption</strong> <span class="math inline">\(e_k(x) = (x + k) \pmod{26}\)</span>, <span class="math inline">\(d_k(y) = (y - k) \pmod{26}\)</span> where <span class="math inline">\(x, y, k \in \mathbb{Z}_{26}\)</span>.
<ul>
<li>Example: <span class="math inline">\(E_1(\text{'hello'}) = \text{'ifmmp'}\)</span>.</li>
<li><strong>Cryptanalysis</strong>: easy, based on <strong>character frequency</strong>.</li>
</ul></li>
<li><strong>16th century, Vigenère</strong>: <strong>Polyalphabetic substitution encryption</strong> <span class="math inline">\(e_k(x_1, \dots, x_n) = (x_1 + k_1, \dots, x_m + k_m, x_{m+1} + k_1, \dots) \pmod{26}\)</span>.
<ul>
<li><strong>Cryptanalysis</strong>: find the <strong>key length <span class="math inline">\(m\)</span></strong> by identifying repeated ciphertext portions and analyzing separate blocks as in the Caesar Cipher.</li>
</ul></li>
<li><strong>Transposition Ciphers</strong> (Porta, 1563): The key defines a <strong>permutation</strong> on the plaintext.</li>
<li>These techniques are still the basis of modern encryption systems (ex: <strong>Enigma</strong>, qualified by W. Churchill as the secret weapon that won the war).</li>
</ul>
</div>
</div>
</div>
</section>
<section id="the-one-time-pad-otp" class="level3">
<h3 class="anchored" data-anchor-id="the-one-time-pad-otp">The One-Time Pad (OTP)</h3>
<p>The <strong>One-Time Pad</strong> (OTP), or <strong>Vernam cipher</strong>, is the only system proven to be <strong>unconditionally secure</strong> (perfect secrecy).</p>
<ul>
<li><strong>Principle</strong>: The message is combined with a key of the same length via the XOR operation (<span class="math inline">\(\oplus\)</span>).</li>
<li><strong>Unconditional Security</strong>: Observation of the encrypted message provides no information about the plaintext message. Even an adversary with infinite computing power cannot break it.</li>
<li><strong>Shannon’s Constraints</strong>: The key must be <strong>as long as the message</strong>, purely <strong>random</strong>, and <strong>used only once</strong>.</li>
<li><strong>Key Reuse</strong>: If a key is reused for two messages, an attacker can eliminate the key by XOR (<span class="math inline">\(y_a \oplus y_b = x_a \oplus x_b\)</span>) and recover the plaintext messages.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-54-contents" aria-controls="callout-54" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version: The One-Time Pad
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-54" class="callout-54-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(n \ge 1\)</span> and the spaces <span class="math inline">\(P, C, K\)</span> such that <span class="math inline">\(P, C, K = (\mathbb{Z}_2)^n\)</span>. The encryption and decryption operations of a <strong>one-time pad</strong> (Vernam Cipher) are: <span class="math inline">\(E_k(x_i) = x_i \oplus k_i\)</span> and <span class="math inline">\(D_k(y_i) = y_i \oplus k_i\)</span> for <span class="math inline">\(1 \le i \le n\)</span>.</p>
<ul>
<li><strong>Unconditional security</strong>: If <span class="math inline">\(k_i\)</span> are random and independent, observation of ciphertexts does not help cryptanalysis. The <strong>entropy</strong> of <span class="math inline">\(X\)</span> does not decrease: <span class="math inline">\(H(X|C) = H(X)\)</span>.</li>
<li><strong>Shannon’s Theorem</strong>: Necessary condition: <span class="math inline">\(H(K) \ge H(X)\)</span>. The length of the <strong>random key</strong> must be at least as large as that of the plaintext.</li>
<li><strong>Key reuse</strong>: <span class="math inline">\(y_a \oplus y_b = x_a \oplus x_b\)</span>. With low-entropy messages, the plaintexts and the key (<span class="math inline">\(k = y_a \oplus x_a\)</span>) can be recovered.</li>
<li>Vulnerable to the <strong>Known Plaintext</strong> attack (if the key is reused).</li>
<li>Major problem: The <strong>distribution and management</strong> of large keys. Revived by <strong>quantum cryptography</strong> proposing confidential channels for unlimited-length key distribution.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="steganography" class="level3">
<h3 class="anchored" data-anchor-id="steganography">Steganography</h3>
<p>In contrast to cryptography, which makes the message unreadable, <strong>steganography</strong> conceals the very existence of the message.</p>
<ul>
<li><strong>Method</strong>: Use a “subliminal channel” (an innocent medium like an image or a banal text).</li>
<li><strong>Modern technique</strong>: Insertion of data into the <strong>least significant bits</strong> (LSB) of multimedia files, allowing the hiding of large volumes of data without visible alteration.</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-55-contents" aria-controls="callout-55" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original version: Steganography
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-55" class="callout-55-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Steganography</strong> hides a message inside another. Constituent elements:</p>
<ol type="1">
<li>A different <strong>physical or logical channel</strong> (subliminal channel).</li>
<li>A <strong>secret mechanism</strong> to identify this channel.</li>
</ol>
<ul>
<li><strong>Classic examples</strong>: First letters of words in a text, invisible ink.</li>
<li><strong>Modern example</strong>: Use the <strong>least significant bits</strong> of the frames of a Photo CD.</li>
<li>For a 2048x3072 image (RGB 24 bits), hiding a message using 1 bit allows storing <strong>2.3 Mb</strong> without deteriorating quality.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-56-contents" aria-controls="callout-56" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Ultra-summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-56" class="callout-56-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>History</strong>: Substitution (Caesar/Vigenère) and Transposition (permutation).</li>
<li><strong>One-Time Pad</strong>: Absolute security if the key is random, unique, and as long as the message (<span class="math inline">\(H(K) \ge H(X)\)</span>).</li>
<li><strong>Steganography</strong>: Hiding the existence of the message (ex: LSB technique in images).</li>
</ul>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="symmetric-cryptography-1" class="level1">
<h1>Symmetric Cryptography</h1>
<section id="stream-ciphers-stream-encryption" class="level2">
<h2 class="anchored" data-anchor-id="stream-ciphers-stream-encryption">Stream Ciphers (Stream Encryption)</h2>
<section id="introduction-to-stream-ciphers" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-stream-ciphers">Introduction to Stream Ciphers</h3>
<section id="definition-and-principle" class="level4">
<h4 class="anchored" data-anchor-id="definition-and-principle">Definition and Principle</h4>
<p><strong>Stream ciphers</strong> are a family of encryption systems characterized by:</p>
<ul>
<li><strong>Unit block size</strong>: each encrypted block = 1 bit</li>
<li><strong>Two-phase architecture</strong>:
<ol type="1">
<li><strong>Keystream generation</strong>: production of the key sequence</li>
<li><strong>Substitution</strong>: operation on plaintext bits based on the keystream</li>
</ol></li>
</ul>
<p><strong>Classic example</strong>: the <em>one-time pad</em></p>
<ul>
<li>Generation: (pseudo-)random generator</li>
<li>Substitution: XOR operation (<span class="math inline">\(\oplus\)</span>) with the keystream</li>
</ul>
</section>
<section id="general-characteristics" class="level4">
<h4 class="anchored">General Characteristics</h4>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>Speed</strong>: encryption at register level, ideal for real-time <em>streaming</em> (video)</li>
<li><strong>Lightweight</strong>: work on systems with limited CPU resources</li>
<li><strong>Low memory</strong>: little or no buffering needed</li>
<li><strong>Non-propagated errors</strong>: retransmission of defective packets is sufficient (suitable for wireless transmissions - WiFi)</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><strong>Dependency on keystream quality</strong>: randomness determines robustness</li>
<li><strong>Dangerous reuse</strong>: keystream reuse allows easy cryptanalysis</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-57-contents" aria-controls="callout-57" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-57" class="callout-57-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="stream-ciphers" class="level3">
<h3 class="anchored" data-anchor-id="stream-ciphers">Stream Ciphers</h3>
<ul>
<li><strong>Stream ciphers</strong> constitute a <strong>family of encryption systems</strong> where the <strong>size of the encrypted block is equal to 1 bit</strong>.</li>
<li>Stream ciphers are generally composed of <strong>two phases</strong>:
<ul>
<li>A <strong>generation phase</strong> of the sequence of elements forming the key (the <strong>keystream</strong>).</li>
<li>A <strong>substitution phase</strong> where the <em>plaintext</em> bits undergo a specific operation dependent on the keystream.</li>
</ul></li>
<li>An obvious example of a stream cipher is the <strong>one-time pad</strong> with:
<ul>
<li>A keystream generation phase performed by a <strong>(pseudo-)random generator</strong>.</li>
<li>A substitution phase consisting of performing a <strong>xor</strong> (<span class="math inline">\(\oplus\)</span>) with the keystream.</li>
</ul></li>
</ul>
</section>
<section id="stream-ciphers-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="stream-ciphers-characteristics">Stream Ciphers: Characteristics</h3>
<ul>
<li><strong>Speed</strong>: Encryption is done directly at the register level. Ideal for applications requiring <em>“on the fly”</em> encryption like <strong>video streaming</strong>.</li>
<li><strong>Ease</strong>: Operations can be performed by systems with <strong>limited CPU resources</strong>.</li>
<li><strong>No (or little…) need for memory/buffering</strong>.</li>
<li><strong>Limited or absent error propagation</strong>: retransmission of faulty packets is normally sufficient (suitable for applications where packet loss is frequent like <strong>wireless transmissions (WiFi)</strong>).</li>
<li><strong>Disadvantages</strong>:
<ul>
<li>The <strong>quality in terms of randomness</strong> of the generated keystream determines the <strong>system’s robustness</strong>.</li>
<li><strong>Keystream reuse</strong> allows <strong>easy cryptanalysis</strong> (cf.&nbsp;the one-time pad).</li>
</ul></li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-58-contents" aria-controls="callout-58" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-58" class="callout-58-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Stream Ciphers</strong> = encryption bit by bit in 2 phases (keystream generation + substitution).</p>
<p><strong>Advantages</strong>: fast, lightweight, no error propagation.</p>
<p><strong>Disadvantages</strong>: keystream quality critical, reuse = vulnerability.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="synchronous-stream-ciphers" class="level3">
<h3 class="anchored" data-anchor-id="synchronous-stream-ciphers">Synchronous Stream Ciphers</h3>
<section id="operating-principle" class="level4">
<h4 class="anchored" data-anchor-id="operating-principle">Operating Principle</h4>
<p>In a <strong>synchronous stream cipher</strong>, the keystream depends <strong>only on the key</strong>, independent of the plaintext and ciphertext.</p>
<p><strong>Process equations:</strong></p>
<p><span class="math display">\[\sigma_{i+1} = f(\sigma_i, k)\]</span> <span class="math display">\[z_i = g(\sigma_i, k)\]</span> <span class="math display">\[c_i = h(z_i, m_i)\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\sigma_i\)</span>: state at time <span class="math inline">\(i\)</span> (initial state <span class="math inline">\(\sigma_0\)</span> may depend on <span class="math inline">\(k\)</span>)</li>
<li><span class="math inline">\(k\)</span>: secret key</li>
<li><span class="math inline">\(f\)</span>: state transition function</li>
<li><span class="math inline">\(g\)</span>: keystream production function producing <span class="math inline">\(z_i\)</span></li>
<li><span class="math inline">\(h\)</span>: output function producing ciphertext <span class="math inline">\(c_i\)</span> from plaintext <span class="math inline">\(m_i\)</span></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Key k] --&gt; B[State σi]
    B --&gt; C[Function f]
    C --&gt; D[State σi+1]
    B --&gt; E[Function g]
    E --&gt; F[Keystream zi]
    F --&gt; G[Function h]
    H[Plaintext mi] --&gt; G
    G --&gt; I[Ciphertext ci]
    D -.-&gt;|loop| B
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="characteristics" class="level4">
<h4 class="anchored" data-anchor-id="characteristics">Characteristics</h4>
<p><strong>Synchronization requirement:</strong></p>
<ul>
<li>Transmitter and receiver must share the same key <span class="math inline">\(k\)</span> <strong>AND</strong> the same state <span class="math inline">\(\sigma_i\)</span></li>
<li>Loss of synchronization = need for external mechanisms (markers, redundancy analysis)</li>
</ul>
<p><strong>Properties:</strong></p>
<ul>
<li><strong>No error propagation</strong>: modification of ciphertext does not affect subsequent sequences</li>
<li><strong>Attention</strong>: deletion of a ciphertext = receiver desynchronization</li>
</ul>
<p><strong>Vulnerabilities to active attacks:</strong></p>
<ul>
<li>✓ Detection: insertion, elimination, replay of fragments</li>
<li>✗ Bit modification: adversary can modify bits and analyze impact on plaintext</li>
<li><strong>Solution</strong>: additional authentication mechanisms necessary</li>
</ul>
</section>
<section id="special-case-additive-stream-cipher" class="level4">
<h4 class="anchored">Special case: Additive Stream Cipher</h4>
<p>The most frequent case where:</p>
<ul>
<li>Functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> replaced by a random generator</li>
<li>Function <span class="math inline">\(h\)</span> = modulo 2 addition (XOR: <span class="math inline">\(\oplus\)</span>)</li>
</ul>
<p><strong>Formula</strong>: <span class="math inline">\(c_i = z_i \oplus m_i\)</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-59-contents" aria-controls="callout-59" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-59" class="callout-59-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="synchronous-stream-ciphers-1" class="level3">
<h3 class="anchored" data-anchor-id="synchronous-stream-ciphers-1">Synchronous Stream Ciphers</h3>
<ul>
<li>The <strong>generated keystream depends only on the key</strong> and not on the plaintext nor the ciphertext.</li>
<li>The encryption process of a <strong>synchronous stream cipher</strong> is described by the following equations: <span class="math display">\[\sigma_{i+1} = f(\sigma_i, k)\]</span> <span class="math display">\[z_i = g(\sigma_i, k)\]</span> <span class="math display">\[c_i = h(z_i, m_i)\]</span> with <span class="math inline">\(\sigma_i\)</span> the <strong>initial state</strong> which may depend on the key <span class="math inline">\(k\)</span>, <span class="math inline">\(f\)</span> the <strong>function determining the next state</strong>, <span class="math inline">\(g\)</span> the <strong>function producing the keystream</strong> <span class="math inline">\(z_i\)</span> and <span class="math inline">\(h\)</span> the <strong>output function</strong> producing the ciphertext <span class="math inline">\(c_i\)</span> from the plaintext <span class="math inline">\(m_i\)</span>.</li>
</ul>
</section>
<section id="synchronous-stream-ciphers-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="synchronous-stream-ciphers-characteristics">Synchronous Stream Ciphers: Characteristics</h3>
<ul>
<li><strong>Require synchronization</strong> of the transmitter and receiver: In addition to using the same key <span class="math inline">\(k\)</span>, both must be in the <strong>same state</strong> for the process to work. If synchronization is lost, <strong>external mechanisms</strong> are needed to recover it (special markers, plaintext redundancy analysis, etc.)</li>
<li><strong>No error propagation</strong>. Modification of the ciphertext during transmission does not cause disturbances in subsequent ciphertext sequences (however, the <strong>deletion</strong> of a ciphertext would cause <strong>desynchronization</strong> of the receiver).</li>
<li><strong>Active attacks</strong>: Insertion, elimination or replay of parts of ciphertext are <strong>detected</strong> by the receiver. However, an adversary could <strong>modify certain bits</strong> of the ciphertext and analyze the impact on the corresponding plaintext. Additional <strong>origin authentication mechanisms</strong> are necessary to detect these attacks.</li>
<li><strong>Most frequent case</strong> of Synchronous Stream Ciphers: the <strong>additive stream cipher</strong> (cf.&nbsp;the one-time pad) where the functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> generating the keystream are replaced by a <strong>random generator</strong> and the function <span class="math inline">\(h\)</span> is a <strong>modulo 2 addition (xor)</strong>.</li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-60-contents" aria-controls="callout-60" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-60" class="callout-60-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Synchronous</strong>: keystream = <span class="math inline">\(f\)</span>(key only). Equations: <span class="math inline">\(\sigma_{i+1} = f(\sigma_i, k)\)</span>, <span class="math inline">\(z_i = g(\sigma_i, k)\)</span>, <span class="math inline">\(c_i = h(z_i, m_i)\)</span>.</p>
<p><strong>Requires synchronization</strong> transmitter/receiver. No error propagation but vulnerable to bit modifications.</p>
<p><strong>Frequent case</strong>: additive cipher with XOR.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="asynchronous-stream-ciphers" class="level3">
<h3 class="anchored" data-anchor-id="asynchronous-stream-ciphers">Asynchronous Stream Ciphers</h3>
<section id="operating-principle-1" class="level4">
<h4 class="anchored" data-anchor-id="operating-principle-1">Operating Principle</h4>
<p>Also called <strong>self-synchronizing ciphers</strong>.</p>
<p>The keystream depends on the key <strong>AND</strong> a fixed number of previous ciphertexts.</p>
<p><strong>Process equations:</strong></p>
<p><span class="math display">\[\sigma_i = (c_{i-t}, c_{i-t+1}, \ldots, c_{i-1})\]</span> <span class="math display">\[z_i = g(\sigma_i, k)\]</span> <span class="math display">\[c_i = h(z_i, m_i)\]</span></p>
<p>Where <span class="math inline">\(\sigma_i\)</span> represents a buffer of the last <span class="math inline">\(t\)</span> ciphertexts.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Key k] --&gt; B[Function g]
    C[Buffer: ci-t...ci-1] --&gt; B
    B --&gt; D[Keystream zi]
    D --&gt; E[Function h]
    F[Plaintext mi] --&gt; E
    E --&gt; G[Ciphertext ci]
    G -.-&gt;|feedback| C
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="characteristics-1" class="level4">
<h4 class="anchored">Characteristics</h4>
<p><strong>Self-synchronization:</strong></p>
<ul>
<li>In case of insertion/elimination of ciphertexts, the receiver <strong>automatically re-synchronizes</strong></li>
<li>Mechanism: memorization (buffer) of the last ciphertexts</li>
</ul>
<p><strong>Limited error propagation:</strong></p>
<ul>
<li>Error propagates only over the <strong>buffer size</strong> (<span class="math inline">\(t\)</span> bits)</li>
<li>After buffer exhaustion, correct decryption resumes</li>
</ul>
<p><strong>Security against active attacks:</strong></p>
<ul>
<li><strong>Better detection</strong>: modifications detected thanks to error propagation</li>
<li><strong>Attention</strong>: self-synchronization allows receiver to continue even after insertions/deletions</li>
<li><strong>Solution</strong>: verification of integrity and authenticity of entire stream necessary</li>
</ul>
<p><strong>Diffusion of plaintext statistics:</strong></p>
<ul>
<li>Each plaintext bit influences <strong>all subsequent ciphertexts</strong></li>
<li><strong>Result</strong>: better dispersion of statistics vs.&nbsp;synchronous case</li>
<li><strong>Application</strong>: use for low entropy or highly redundant plaintexts</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-61-contents" aria-controls="callout-61" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-61" class="callout-61-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="asynchronous-stream-ciphers-1" class="level3">
<h3 class="anchored" data-anchor-id="asynchronous-stream-ciphers-1">Asynchronous Stream Ciphers</h3>
<ul>
<li>Also called <strong>self-synchronizing ciphers</strong>.</li>
<li>The <strong>generated keystream depends on the key as well as a fixed number of previous ciphertexts</strong>.</li>
<li>The encryption process of an <strong>asynchronous stream cipher</strong> is described by the following equations: <span class="math display">\[\sigma_i = (c_{i-t}, c_{i-t+1}, \ldots, c_{i-1})\]</span> <span class="math display">\[z_i = g(\sigma_i, k)\]</span> <span class="math display">\[c_i = h(z_i, m_i)\]</span> with <span class="math inline">\(\sigma_i\)</span>, <span class="math inline">\(g\)</span> and <span class="math inline">\(h\)</span> as for the synchronous case.</li>
</ul>
</section>
<section id="asynchronous-stream-ciphers-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="asynchronous-stream-ciphers-characteristics">Asynchronous Stream Ciphers: Characteristics</h3>
<ul>
<li><strong>Self-synchronization</strong>: In case of elimination or insertion of ciphertexts along the way, the receiver is capable of <strong>re-synchronizing with the transmitter</strong> thanks to the <strong>memorization (buffer)</strong> of a number of previous ciphertexts.</li>
<li><strong>Limited error propagation</strong>: Error propagation extends only to the <strong>number of ciphertext bits memorized</strong> (buffer size). Afterwards, decryption proceeds correctly again.</li>
<li><strong>Active attacks</strong>: Modification of ciphertext fragments will be <strong>more easily detected</strong> than in the synchronous case because of error propagation. However, since the receiver is capable of self-synchronizing with the transmitter, even if ciphertexts are eliminated or inserted along the way, it is necessary to <strong>verify the integrity and authenticity of the entire stream</strong>.</li>
<li><strong>Diffusion of plaintext statistics</strong>: The fact that <strong>each plaintext bit will influence all subsequent ciphertexts</strong> results in a <strong>greater dispersion of statistics</strong> compared to the synchronous case…</li>
<li>… It is therefore advisable to use <strong>asynchronous stream ciphers when the entropy of plaintexts is limited</strong> and could allow targeted attacks on highly redundant plaintexts.</li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-62-contents" aria-controls="callout-62" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-62" class="callout-62-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Asynchronous</strong> (self-synchronizing): keystream = <span class="math inline">\(f\)</span>(key + last ciphertexts). State <span class="math inline">\(\sigma_i\)</span> = buffer of <span class="math inline">\(t\)</span> previous ciphertexts.</p>
<p><strong>Automatic self-synchronization</strong>. Limited error propagation to buffer.</p>
<p><strong>Better diffusion</strong> of statistics → ideal for redundant/low entropy plaintexts.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="keystream-generators-lsfr" class="level3">
<h3 class="anchored" data-anchor-id="keystream-generators-lsfr">Keystream Generators: LSFR</h3>
<section id="context-and-necessity" class="level4">
<h4 class="anchored" data-anchor-id="context-and-necessity">Context and Necessity</h4>
<p><strong>Problem</strong>: generate a keystream of length <span class="math inline">\(m\)</span> from a secret key of length <span class="math inline">\(l\)</span> with <span class="math inline">\(l \ll m\)</span>.</p>
<p><strong>Solution</strong>: Linear Feedback Shift Register (<strong>LSFR</strong> or <strong>LFSR</strong>)</p>
</section>
<section id="lsfr-characteristics" class="level4">
<h4 class="anchored" data-anchor-id="lsfr-characteristics">LSFR Characteristics</h4>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>Optimal hardware implementation</strong>: very efficient circuits</li>
<li><strong>Long periods</strong>: sequences of great length</li>
<li><strong>Good random quality</strong>: notable randomness</li>
<li><strong>Mathematical basis</strong>: algebraic properties of linear combinations</li>
</ul>
<p><strong>Generic structure</strong>: LSFR of length <span class="math inline">\(L\)</span></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[bit L-1] --&gt; B[bit L-2]
    B --&gt; C[...]
    C --&gt; D[bit 1]
    D --&gt; E[bit 0]
    E --&gt; F[Output]
    A -.-&gt;|feedback| G[⊕]
    D -.-&gt;|coeff| G
    C -.-&gt;|coeff| G
    G --&gt; A
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="important-remarks-on-lsfr" class="level4">
<h4 class="anchored">Important Remarks on LSFR</h4>
<p><strong>History and Usage:</strong></p>
<ul>
<li>Very widespread construction in cryptography and coding theory</li>
<li>Many military stream ciphers based on LSFR</li>
</ul>
<p><strong>Security Limits:</strong></p>
<ul>
<li><strong>Insufficient security level</strong> compared to modern block ciphers</li>
<li><strong>Vulnerability</strong>: the Berlekamp-Massey algorithm allows to:
<ul>
<li>Determine the <strong>linear complexity</strong> of an LSFR</li>
<li>Calculate an arbitrary number of generated sequences</li>
</ul></li>
</ul>
<p><strong>Metric</strong>: Linear complexity (<em>linear complexity</em>)</p>
<p><strong>Improvement Solution:</strong></p>
<p>Replace the linear combination with a <strong>non-linear function</strong> <span class="math inline">\(f\)</span></p>
<p>→ <strong>Non Linear Feedback Shift Registers</strong> (NLFSR)</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-63-contents" aria-controls="callout-63" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-63" class="callout-63-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="stream-ciphers-keystream-generators" class="level3">
<h3 class="anchored" data-anchor-id="stream-ciphers-keystream-generators">Stream Ciphers: Keystream Generators</h3>
<ul>
<li>When it is necessary to <strong>generate a keystream of length <span class="math inline">\(m\)</span></strong> from a <strong>secret key of length <span class="math inline">\(l\)</span></strong> with <span class="math inline">\(l \ll m\)</span>, we call upon <strong>keystream generators</strong>.</li>
<li>The most common of these generators is the <strong>Linear Feedback Shift Register (LSFR)</strong>.</li>
<li>An LSFR has the following characteristics:
<ul>
<li><strong>Adapts very well to hardware implementations</strong>.</li>
<li>Produces sequences of <strong>long periods</strong> and with <strong>notable random quality</strong> (quite strong randomness)</li>
<li>Based on the <strong>algebraic properties of linear combinations</strong>.</li>
</ul></li>
</ul>
</section>
<section id="lsfrs-some-remarks" class="level3">
<h3 class="anchored" data-anchor-id="lsfrs-some-remarks">LSFRs: Some Remarks</h3>
<ul>
<li>LSFRs are <strong>very widespread constructions</strong> in cryptography and coding theory.</li>
<li>A <strong>large number of stream ciphers</strong> based on LSFRs (especially in the <strong>military sphere</strong>) were developed in the past.</li>
<li>Unfortunately, the <strong>security level offered by these systems is deemed insufficient</strong> nowadays (compared to that of block ciphers…)</li>
<li>The <strong>metric</strong> allowing analysis of an LFSR is its <strong>linear complexity</strong>. The <strong>Berlekamp-Massey algorithm</strong> allows determining the linear complexity of an LSFR and thus calculating an arbitrarily large number of sequences generated by an LSFR.</li>
<li>A solution to <strong>increase complexity</strong> is to substitute the linear combination of ciphertext bits with a <strong>non-linear function</strong> <span class="math inline">\(f\)</span>. These are the <strong>Non Linear Feedback Shift Registers</strong>.</li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-64-contents" aria-controls="callout-64" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-64" class="callout-64-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>LSFR</strong>: long keystream generator (<span class="math inline">\(m\)</span>) from short key (<span class="math inline">\(l\)</span>). Base = linear combinations.</p>
<p><strong>Advantages</strong>: efficient hardware, long periods.</p>
<p><strong>Problem</strong>: insufficient security, vulnerable to Berlekamp-Massey (linear complexity calculation).</p>
<p><strong>Solution</strong>: NLFSR (non-linear function).</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="rc4-software-stream-cipher" class="level3">
<h3 class="anchored" data-anchor-id="rc4-software-stream-cipher">RC4: Software Stream Cipher</h3>
<section id="general-presentation" class="level4">
<h4 class="anchored" data-anchor-id="general-presentation">General Presentation</h4>
<p><strong>RC4™</strong> (<em>Rivest Cipher 4</em>) developed in 1987 by Ron Rivest for RSA Security.</p>
<p><strong>Main characteristics:</strong></p>
<ul>
<li><strong>Variable key</strong>: flexible length</li>
<li><strong>Extremely fast</strong>: 10× faster than DES</li>
<li><strong>Synchronous mode</strong>: keystream independent of plaintext/ciphertext</li>
</ul>
<p><strong>History:</strong></p>
<ul>
<li>1987-1994: patented, details confidential (NDA contract required)</li>
<li>1994: unofficial publication in a newsgroup</li>
<li>Since then: intensive analysis by cryptographic community</li>
</ul>
</section>
<section id="architecture" class="level4">
<h4 class="anchored" data-anchor-id="architecture">Architecture</h4>
<p><strong>Key components:</strong></p>
<ul>
<li><strong>S-box</strong>: 8×8 substitution box (256 entries)
<ul>
<li>Content: permutation of numbers 0 to 255</li>
<li>Depends on the main key of variable length: <span class="math inline">\(0 &lt; len(k) \leq 255\)</span></li>
</ul></li>
<li><strong>Combinations</strong>: linear and non-linear</li>
<li><strong>Final encryption</strong>: XOR between keystream and plaintext</li>
</ul>
</section>
<section id="applications-and-security" class="level4">
<h4 class="anchored" data-anchor-id="applications-and-security">Applications and Security</h4>
<p><strong>Commercial uses (numerous):</strong></p>
<ul>
<li>Lotus Notes</li>
<li>Oracle SQL</li>
<li>Microsoft Windows</li>
<li>SSL/TLS</li>
<li>And many more…</li>
</ul>
<p><strong>Analyses and Vulnerabilities:</strong></p>
<ul>
<li>Exhaustive work on key scheduling and PRGA</li>
<li><strong>Major flaw</strong>: implementation in WEP (WiFi Wired Equivalent Privacy)
<ul>
<li>WEP protocol completely compromised</li>
<li>Problem: faulty usage mode, not the RC4 algorithm itself</li>
</ul></li>
</ul>
</section>
<section id="operation" class="level4">
<h4 class="anchored">Operation</h4>
<p>RC4 decomposes into <strong>two steps</strong>:</p>
<ol type="1">
<li><strong>Key Scheduling Algorithm (KSA)</strong>
<ul>
<li>Responsible for initial permutation of the S-box</li>
<li>Function of the variable length key <span class="math inline">\(len(k) = l\)</span></li>
</ul></li>
<li><strong>Pseudo Random Generator Algorithm (PRGA)</strong>
<ul>
<li>Generates keystream of arbitrary size</li>
<li>Relies on S-box permuted by KSA</li>
</ul></li>
</ol>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    A[Variable length key k] --&gt; B[KSA: Key Scheduling]
    B --&gt; C[Permuted S-box]
    C --&gt; D[PRGA: Generation]
    D --&gt; E[Keystream zi]
    E --&gt; F[XOR]
    G[Plaintext mi] --&gt; F
    F --&gt; H[Ciphertext ci]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-65-contents" aria-controls="callout-65" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-65" class="callout-65-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="software-cipher-streams-rc4" class="level3">
<h3 class="anchored" data-anchor-id="software-cipher-streams-rc4">Software Cipher Streams: RC4</h3>
<ul>
<li>The major <strong>disadvantage of stream ciphers based on registers</strong> is that they are <strong>very slow in programmed version</strong> on a generic machine. <strong>RC4™</strong> is a <strong>variable key stream cipher</strong> developed in <strong>1987 by Ron Rivest</strong> for RSA security. It is <strong>very fast</strong> (<strong>10 times faster than DES</strong> !)</li>
<li>For 7 years, this algorithm was <strong>patented</strong> and its internal operational details were disclosed only after <strong>signing a confidentiality contract</strong>. Since its <strong>(unofficial) publication in a newsgroup in 1994</strong>, it has been widely discussed and analyzed by the entire cryptographic community.</li>
<li>The algorithm works in <strong>synchronous mode</strong> (the keystream is independent of the ciphertext and plaintext).</li>
<li>It is composed of <strong>linear and non-linear combinations</strong>. The key element is an <strong>8×8 substitution box (S-box)</strong> whose entries are a <strong>permutation of the numbers 0 to 255</strong>. The permutation is a <strong>function of the main key</strong> of variable size with <span class="math inline">\(0 &lt; len(k) \leq 255\)</span>. The <strong>final encryption is obtained by a xor</strong> between the keystream and the plaintext.</li>
<li>RC4 is used in a <strong>large number of commercial applications</strong>: Lotus Notes, Oracle SQL, MS Windows, SSL, etc. It is the subject of a <strong>large number of analytical and exhaustive works</strong> that have managed to <strong>compromise the security</strong> of the key scheduling and the PRGA.</li>
<li>In particular the application of RC4 to the <strong>Wired Equivalent Privacy (WiFi WEP) protocol has been “broken”</strong> due to a <strong>flaw in the protocol’s usage mode</strong>.</li>
</ul>
</section>
<section id="rc4-operation" class="level3">
<h3 class="anchored" data-anchor-id="rc4-operation">RC4: Operation</h3>
<ul>
<li>The algorithm consists of <strong>two steps</strong>:
<ul>
<li>The <strong>Key Scheduling Algorithm (KSA)</strong>: Responsible for the <strong>initial permutation</strong> that will fill the S-box depending on the variable length key <span class="math inline">\(len(k) = l\)</span>.</li>
<li>The <strong>Pseudo Random Generator Algorithm (PRGA)</strong>: Generates the <strong>keystream of arbitrary size</strong> relying on the S-box.</li>
</ul></li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-66-contents" aria-controls="callout-66" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-66" class="callout-66-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>RC4</strong>: software stream cipher, variable key, 10× faster than DES.</p>
<p><strong>Architecture</strong>: 8×8 S-box (permutation 0-255) + XOR.</p>
<p><strong>2 steps</strong>: KSA (S-box permutation) + PRGA (keystream generation). Synchronous mode.</p>
<p><strong>Vulnerability</strong>: WEP broken (usage flaw). Used in SSL, Windows, Oracle…</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="block-ciphers-block-encryption" class="level2">
<h2 class="anchored" data-anchor-id="block-ciphers-block-encryption">Block Ciphers (Block Encryption)</h2>
<section id="introduction-to-block-ciphers" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-block-ciphers">1. Introduction to Block Ciphers</h3>
<section id="definition-and-principle-1" class="level4">
<h4 class="anchored" data-anchor-id="definition-and-principle-1">Definition and Principle</h4>
<p>A <strong>block cipher</strong> is a cryptographic function that:</p>
<ul>
<li><strong>Transforms fixed-size blocks</strong>: maps a block of <span class="math inline">\(n\)</span> bits to another block of the same size</li>
<li><strong>Is parameterized by a key</strong>: the key <span class="math inline">\(K\)</span> of <span class="math inline">\(k\)</span> bits defines the transformation</li>
<li><strong>Must be bijective</strong>: to allow unique decryption</li>
<li><strong>Each key = different bijection</strong>: guarantees variability</li>
</ul>
<p><strong>Nominal size</strong>: input block size on which encryption is applied</p>
</section>
<section id="quality-criteria" class="level4">
<h4 class="anchored" data-anchor-id="quality-criteria">Quality Criteria</h4>
<p><strong>1. Key size/Entropy</strong></p>
<ul>
<li>Keys ideally <strong>equiprobable</strong> with entropy = <span class="math inline">\(k\)</span> bits</li>
<li>Strong entropy protects against <strong>brute-force attacks</strong></li>
<li><strong>Minimum required</strong>: 128 bits for modern block ciphers</li>
</ul>
<p><strong>2. Performance</strong></p>
<ul>
<li>Execution speed</li>
<li>Software/hardware efficiency</li>
</ul>
<p><strong>3. Block size</strong></p>
<ul>
<li>Too small block = vulnerability to <strong>plaintext/ciphertext dictionaries</strong></li>
<li><strong>Modern standard</strong>: blocks ≥ 128 bits</li>
</ul>
<p><strong>4. Cryptographic resistance</strong></p>
<ul>
<li>Resistance to known techniques:
<ul>
<li>Linear cryptanalysis</li>
<li>Differential cryptanalysis</li>
<li>Meet in the middle</li>
</ul></li>
<li><strong>Cryptanalysis effort</strong> equivalent to brute force</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Plaintext n bits] --&gt; B[Block Cipher]
    C[Key K k bits] --&gt; B
    B --&gt; D[Ciphertext n bits]
    
    style B fill:#e1f5ff
    style C fill:#fff4e1
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-67-contents" aria-controls="callout-67" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-67" class="callout-67-contents callout-collapse collapse">
<section id="block-ciphers" class="level4 callout-body-container callout-body">
<h4 class="anchored" data-anchor-id="block-ciphers">Block Ciphers</h4>
<ul>
<li><p><strong>Symmetric block ciphers</strong> constitute the <strong>cornerstone of cryptography</strong>. Their main functionality is <strong>confidentiality</strong> but they are also the basis for <strong>authentication</strong>, <strong>hashing functions</strong>, <strong>random generation</strong>, etc.</p></li>
<li><p><strong>Definition</strong>: A block cipher is a <strong>function</strong> that maps a <strong>block of <span class="math inline">\(n\)</span> bits</strong> to another block of <strong>the same size</strong>. The function is <strong>parameterized by a key <span class="math inline">\(K\)</span> of <span class="math inline">\(k\)</span> bits</strong>. To allow <strong>unique decryption</strong>, the function must be <strong>bijective</strong>. <strong>Each key defines a different bijection</strong>. The <strong>input block size</strong> on which encryption is applied is also called <strong>nominal algorithm size</strong>.</p></li>
<li><p><strong>Criteria to evaluate the quality</strong> of a block cipher:</p>
<ul>
<li><strong>Key size/Entropy</strong>: Ideally, keys are <strong>equiprobable</strong> and the key space has an <strong>entropy equal to <span class="math inline">\(k\)</span></strong>. A <strong>strong key entropy</strong> protects against <strong>brute-force attacks</strong> from chosen/known plaintexts. Modern block ciphers must have <strong>keys of at least 128 bits</strong>.</li>
<li><strong>Performance</strong></li>
<li><strong>Block size</strong>: A <strong>too small block</strong> would allow attacks where <strong>plaintext/ciphertext “dictionaries”</strong> could be built. Nowadays, <strong>blocks of size ≥ 128 bits</strong> are becoming common.</li>
<li><strong>Cryptographic resistance</strong>: The block cipher must show <strong>resistance</strong> to known cryptanalysis techniques: <strong>linear or differential cryptanalysis</strong>, <strong>meet in the middle</strong>, etc. The <strong>inherent effort</strong> of these attacks (complexity, storage, parallelization, etc.) must be <strong>equivalent to that of a brute force attack</strong>.</li>
</ul></li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-68-contents" aria-controls="callout-68" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-68" class="callout-68-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Block cipher</strong>: bijective function transforming blocks of <span class="math inline">\(n\)</span> bits with key <span class="math inline">\(K\)</span> of <span class="math inline">\(k\)</span> bits. <strong>Criteria</strong>: key entropy ≥ 128 bits, block size ≥ 128 bits, cryptanalysis resistance = brute force effort. <strong>Usage</strong>: confidentiality, authentication, hashing, random generation.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="block-cipher-modes-of-operation" class="level3">
<h3 class="anchored" data-anchor-id="block-cipher-modes-of-operation">2. Block Cipher Modes of Operation</h3>
<section id="electronic-codebook-ecb" class="level4">
<h4 class="anchored" data-anchor-id="electronic-codebook-ecb">2.1 Electronic Codebook (ECB)</h4>
<p><strong>Principle</strong>: each plaintext block is encrypted <strong>independently</strong> with the same key.</p>
<p><span class="math display">\[c_i = E_K(m_i)\]</span> <span class="math display">\[m_i = D_K(c_i)\]</span></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph Encryption
        P1[Plaintext Block 1] --&gt; E1[Block Cipher E]
        K1[Key K] --&gt; E1
        E1 --&gt; C1[Ciphertext Block 1]
        
        P2[Plaintext Block 2] --&gt; E2[Block Cipher E]
        K2[Key K] --&gt; E2
        E2 --&gt; C2[Ciphertext Block 2]
    end
    
    style E1 fill:#ffcccc
    style E2 fill:#ffcccc
    style K1 fill:#fff4e1
    style K2 fill:#fff4e1
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Characteristics:</strong></p>
<ul>
<li>✗ <strong>Identical plaintexts</strong> → identical ciphertexts (predictable)</li>
<li>✓ <strong>No error propagation</strong>: error on <span class="math inline">\(c_j\)</span> affects only <span class="math inline">\(m_j\)</span></li>
<li>✗ <strong>Visible patterns</strong>: plaintext structure transparent in ciphertext</li>
<li>✓ <strong>Parallelizable</strong>: each block processed independently</li>
</ul>
<p><strong>⚠️ Major vulnerability</strong>: Should NOT be used for redundant data</p>
<hr>
</section>
<section id="cipher-block-chaining-cbc" class="level4">
<h4 class="anchored" data-anchor-id="cipher-block-chaining-cbc">2.2 Cipher Block Chaining (CBC)</h4>
<p><strong>Principle</strong>: each plaintext block is <strong>XORed with the previous ciphertext</strong> before encryption.</p>
<p><span class="math display">\[c_i = E_K(m_i \oplus c_{i-1})\]</span> <span class="math display">\[m_i = D_K(c_i) \oplus c_{i-1}\]</span></p>
<p>With <span class="math inline">\(c_0 = IV\)</span> (Initialization Vector)</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph Encryption
        IV[IV] --&gt; X1[⊕]
        P1[Plaintext m1] --&gt; X1
        X1 --&gt; E1[Block Cipher E]
        K1[Key K] --&gt; E1
        E1 --&gt; C1[Ciphertext c1]
        
        C1 --&gt; X2[⊕]
        P2[Plaintext m2] --&gt; X2
        X2 --&gt; E2[Block Cipher E]
        K2[Key K] --&gt; E2
        E2 --&gt; C2[Ciphertext c2]
    end
    
    style E1 fill:#ccffcc
    style E2 fill:#ccffcc
    style X1 fill:#ffffcc
    style X2 fill:#ffffcc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Characteristics:</strong></p>
<ul>
<li>✓ <strong>Identical plaintexts</strong> → different ciphertexts (if IV changes)</li>
<li>✓ <strong>Patterns erased</strong>: chaining masks the structure</li>
<li>✓ <strong>Limited error propagation</strong>: error on <span class="math inline">\(c_j\)</span> affects <span class="math inline">\(m_j\)</span> and <span class="math inline">\(m_{j+1}\)</span> only</li>
<li>✗ <strong>Not parallelizable</strong> in encryption (sequential)</li>
<li>✓ <strong>Parallelizable</strong> in decryption</li>
</ul>
<p><strong>IV (Initialization Vector):</strong></p>
<ul>
<li>Must be <strong>random</strong> or <strong>pseudo-random</strong></li>
<li>Can be transmitted <strong>in clear</strong></li>
<li>Must be <strong>different</strong> for each message with the same key</li>
</ul>
<hr>
</section>
<section id="cipher-feedback-mode-cfb" class="level4">
<h4 class="anchored" data-anchor-id="cipher-feedback-mode-cfb">2.3 Cipher Feedback Mode (CFB)</h4>
<p><strong>Principle</strong>: works like a <strong>stream cipher</strong> where the keystream is generated by the block cipher. The keystream depends on <strong>previous ciphertexts</strong> (<strong>asynchronous</strong> mode).</p>
<p><span class="math display">\[c_i = m_i \oplus E_K(c_{i-1})\]</span> <span class="math display">\[m_i = c_i \oplus E_K(c_{i-1})\]</span></p>
<p>With <span class="math inline">\(c_0 = IV\)</span></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph CFB_Encryption
        IV[IV / ci-1] --&gt; E1[Block Cipher E]
        K1[Key K] --&gt; E1
        E1 --&gt; X1[⊕]
        P1[Plaintext mi] --&gt; X1
        X1 --&gt; C1[Ciphertext ci]
        C1 -.feedback.-&gt; IV
    end
    
    style E1 fill:#ffccff
    style X1 fill:#ffffcc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Characteristics:</strong></p>
<ul>
<li>✓ <strong>Identical plaintexts</strong> → different ciphertexts (if IV changes)</li>
<li>✓ <strong>Chaining</strong>: dependencies between ciphertexts</li>
<li>⚠️ <strong>Error propagation</strong>: error on <span class="math inline">\(c_j\)</span> affects <span class="math inline">\(\frac{n}{r}\)</span> following blocks
<ul>
<li><span class="math inline">\(n\)</span> = nominal size of block cipher</li>
<li><span class="math inline">\(r\)</span> = size of plaintexts</li>
</ul></li>
<li>✗ <strong>Not parallelizable</strong></li>
<li>⚠️ <strong>IV non-confidential</strong> but must be transmitted</li>
</ul>
<p><strong>Usage</strong>: suitable for transmissions with frequent packet loss</p>
<hr>
</section>
<section id="output-feedback-mode-ofb" class="level4">
<h4 class="anchored" data-anchor-id="output-feedback-mode-ofb">2.4 Output Feedback Mode (OFB)</h4>
<p><strong>Principle</strong>: works like a <strong>synchronous stream cipher</strong>. The keystream is <strong>entirely determined</strong> by the key and IV, <strong>independent</strong> of plaintext and ciphertext.</p>
<p><span class="math display">\[z_i = E_K(z_{i-1})\]</span> <span class="math display">\[c_i = m_i \oplus z_i\]</span> <span class="math display">\[m_i = c_i \oplus z_i\]</span></p>
<p>With <span class="math inline">\(z_0 = IV\)</span></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph OFB_Mode
        IV[IV / zi-1] --&gt; E1[Block Cipher E]
        K1[Key K] --&gt; E1
        E1 --&gt; Z[zi keystream]
        Z --&gt; X1[⊕]
        P1[Plaintext mi] --&gt; X1
        X1 --&gt; C1[Ciphertext ci]
        Z -.feedback.-&gt; IV
    end
    
    style E1 fill:#cce5ff
    style X1 fill:#ffffcc
    style Z fill:#e1ffe1
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Characteristics:</strong></p>
<ul>
<li>✓ <strong>Identical plaintexts</strong> → different ciphertexts (if IV changes)</li>
<li>✓ <strong>No error propagation</strong>: error on <span class="math inline">\(c_j\)</span> affects only <span class="math inline">\(m_j\)</span></li>
<li>✓ <strong>Pre-computable keystream</strong>: efficient</li>
<li>⚠️ <strong>CRITICAL</strong>: NEVER reuse the same IV with the same key (otherwise identical keystream)</li>
<li>✓ <strong>Parallelizable</strong> if keystream pre-computed</li>
</ul>
<p><strong>⚠️ Reuse warning</strong>: Change IV for each new message!</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-69-contents" aria-controls="callout-69" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text (CFB and OFB Modes)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-69" class="callout-69-contents callout-collapse collapse">
<section id="cfb-and-ofb-modes-characteristics" class="level4 callout-body-container callout-body">
<h4 class="anchored" data-anchor-id="cfb-and-ofb-modes-characteristics">CFB and OFB Modes: Characteristics</h4>
<p>The <strong>CFB and OFB modes</strong> work as a <strong>stream cipher</strong> with a <strong>keystream generated by the encryption block</strong>. In <strong>CFB</strong>, the keystream depends on <strong>previous ciphertexts</strong> (<strong>asynchronous</strong>) whereas in <strong>OFB</strong>, the keystream is <strong>entirely determined by the key and the IV</strong> (<strong>synchronous</strong>).</p>
<p><strong>Particularities of CFB:</strong></p>
<ul>
<li>As in CBC mode, <strong>identical plaintexts</strong> are translated into <strong>different ciphertexts</strong> if the <strong>IV changes</strong>. The <strong>IV is not necessarily confidential</strong> and can be exchanged in clear between parties.</li>
<li><strong>Chaining</strong> also introduces <strong>dependencies</strong> between current ciphertexts and previous ciphertexts. In particular, if <span class="math inline">\(n\)</span> is the <strong>nominal algorithm size</strong> and <span class="math inline">\(r\)</span> is the <strong>plaintext size</strong>, the current ciphertext will depend on the <span class="math inline">\(\frac{n}{r}\)</span> <strong>previous ciphertexts</strong> (each iteration will shift the faulty input by <span class="math inline">\(r\)</span> positions, after <span class="math inline">\(\frac{n}{r}\)</span> iterations the faulty ciphertext will be completely “expelled”).</li>
<li><strong>Error propagation</strong> follows the same principle: an error in a ciphertext will result in incorrect decryption of the <span class="math inline">\(\frac{n}{r}\)</span> following ciphertexts.</li>
</ul>
<p><strong>Particularities of OFB:</strong></p>
<ul>
<li>OFB has <strong>identical behavior</strong> to CBC and CFB modes for <strong>encryption of identical plaintexts</strong>.</li>
<li><strong>No error propagation</strong> on adjacent ciphertexts.</li>
<li><strong>Modify the IV</strong> if the key does not change to <strong>avoid keystream reuse</strong> !!!</li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-70-contents" aria-controls="callout-70" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision (CFB/OFB)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-70" class="callout-70-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CFB</strong> (asynchronous): keystream = <span class="math inline">\(f\)</span>(previous ciphertexts). Limited error propagation (<span class="math inline">\(\frac{n}{r}\)</span> blocks).</p>
<p><strong>OFB</strong> (synchronous): keystream = <span class="math inline">\(f\)</span>(key + IV only). No error propagation.</p>
<p><strong>CRITICAL</strong>: NEVER reuse same IV with same key. IV transmissible in clear.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="counter-mode-ctr" class="level4">
<h4 class="anchored" data-anchor-id="counter-mode-ctr">2.5 Counter Mode (CTR)</h4>
<p><strong>Principle</strong>: the keystream is generated by <strong>encryption of a counter</strong> incremented at each block.</p>
<p><span class="math display">\[c_i = m_i \oplus E_K(counter + i)\]</span> <span class="math display">\[m_i = c_i \oplus E_K(counter + i)\]</span></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph CTR_Mode
        CTR1[Counter + 0] --&gt; E1[Block Cipher E]
        K1[Key K] --&gt; E1
        E1 --&gt; X1[⊕]
        P1[Plaintext m1] --&gt; X1
        X1 --&gt; C1[Ciphertext c1]
        
        CTR2[Counter + 1] --&gt; E2[Block Cipher E]
        K2[Key K] --&gt; E2
        E2 --&gt; X2[⊕]
        P2[Plaintext m2] --&gt; X2
        X2 --&gt; C2[Ciphertext c2]
    end
    
    style E1 fill:#ffe6cc
    style E2 fill:#ffe6cc
    style X1 fill:#ffffcc
    style X2 fill:#ffffcc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Characteristics:</strong></p>
<ul>
<li>✓ <strong>Synchronous mode</strong>: keystream = <span class="math inline">\(f\)</span>(counter)</li>
<li>✓ <strong>Parallelizable</strong>: keystream pre-computable for encryption AND decryption</li>
<li>✓ <strong>Random access</strong>: each block decryptable independently</li>
<li>✓ <strong>No error propagation</strong></li>
<li>✓ <strong>Benefits from SIMD architectures</strong>: no dependencies between blocks</li>
<li>⚠️ <strong>Counter</strong>: must be of size <span class="math inline">\(2^b\)</span> (<span class="math inline">\(b\)</span> = block size)</li>
<li>⚠️ <strong>CRITICAL</strong>: NEVER reuse the same counter with the same key</li>
</ul>
<p><strong>Counter management:</strong></p>
<ul>
<li><strong>Increment modulo</strong> <span class="math inline">\(2^b\)</span> after each iteration</li>
<li><strong>Solution</strong>: always increment for each encrypted stream</li>
<li>First block of stream <span class="math inline">\(i+1\)</span> &gt; last block of stream <span class="math inline">\(i\)</span></li>
</ul>
<p><strong>Applications:</strong></p>
<ul>
<li><strong>ATM</strong> (Asynchronous Transfer Mode)</li>
<li><strong>IPsec</strong> (IP security)</li>
<li><strong>High-speed lines</strong>: selective transmission of blocks</li>
<li><strong>Large volume transfers</strong>: video</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-71-contents" aria-controls="callout-71" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text (Counter Mode)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-71" class="callout-71-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="counter-mode-ctr-mode" class="level4">
<h4 class="anchored" data-anchor-id="counter-mode-ctr-mode">Counter Mode (CTR Mode)</h4>
<p>Frequently used as encryption support in data transfer protocols like <strong>ATM</strong> (Asynchronous Transfer Mode) and <strong>IPsec</strong> (IP security).</p>
</section>
<section id="counter-mode-ii" class="level4">
<h4 class="anchored" data-anchor-id="counter-mode-ii">Counter Mode (II)</h4>
<ul>
<li>The <strong>keystream</strong> is generated by the <strong>encryption of a random counter</strong> of size <span class="math inline">\(2^b\)</span> (with <span class="math inline">\(b\)</span> the block size) and necessary for decryption. This counter is <strong>incremented modulo</strong> <span class="math inline">\(2^b\)</span> after each iteration.</li>
<li>Works in <strong>synchronous mode</strong>. <strong>Reuse of the same counter</strong> results in an <strong>identical keystream</strong> !</li>
<li><strong>Solution</strong>: Always <strong>increment the counter</strong> for each encrypted stream such that the counter of the first block of a stream is <strong>larger than the last block</strong> of the previous stream.</li>
<li><strong>Easily parallelizable</strong>: The keystream can be <strong>pre-calculated</strong> both for encryption and decryption. Fully benefits from <strong>SIMD architectures</strong> because unlike other chaining modes there are no <strong>dependencies between operations</strong> of different blocks.</li>
<li><strong>Random access</strong> to encryption/decryption of each block: Unlike other chaining modes where the <span class="math inline">\(i\)</span>-th operation depends on the <span class="math inline">\((i-1)\)</span>-th operation.</li>
<li>If we add <strong>absence of error propagation</strong>, the counter mode facilitates <strong>selective (re)transmission</strong> of ciphertext blocks, making it very attractive for <strong>securing high-speed lines</strong> as well as for <strong>encrypted transfers of large volumes</strong> of information (e.g.&nbsp;video).</li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-72-contents" aria-controls="callout-72" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision (Counter Mode)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-72" class="callout-72-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CTR</strong>: keystream = <span class="math inline">\(E_K\)</span>(counter + <span class="math inline">\(i\)</span>).</p>
<p><strong>Advantages</strong>: parallelizable (encryption + decryption), random access, no error propagation, SIMD-friendly.</p>
<p><strong>CRITICAL</strong>: never reuse counter.</p>
<p><strong>Usage</strong>: ATM, IPsec, high speed, video.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="product-ciphers-and-feistel-ciphers" class="level3">
<h3 class="anchored" data-anchor-id="product-ciphers-and-feistel-ciphers">3. Product Ciphers and Feistel Ciphers</h3>
<section id="product-ciphers" class="level4">
<h4 class="anchored" data-anchor-id="product-ciphers">Product Ciphers</h4>
<p><strong>Definition</strong>: encryption scheme combining a <strong>series of successive transformations</strong> to strengthen resistance to cryptanalysis.</p>
<p><strong>Common transformations:</strong></p>
<ul>
<li>Transpositions (permutations)</li>
<li>Substitutions (S-boxes)</li>
<li>XORs</li>
<li>Linear combinations</li>
<li>Modular multiplications</li>
</ul>
</section>
<section id="feistel-ciphers" class="level4">
<h4 class="anchored" data-anchor-id="feistel-ciphers">Feistel Ciphers</h4>
<p><strong>Definition</strong>: iterative product cipher with specific structure.</p>
<p><strong>Operating principle:</strong></p>
<ul>
<li><strong>Input</strong>: plaintext of <span class="math inline">\(2t\)</span> bits = <span class="math inline">\((L_0, R_0)\)</span> (two sub-blocks of <span class="math inline">\(t\)</span> bits)</li>
<li><strong>Output</strong>: ciphertext of <span class="math inline">\(2t\)</span> bits = <span class="math inline">\((R_r, L_r)\)</span> after <span class="math inline">\(r\)</span> steps (rounds)</li>
<li><strong>Each step</strong>: invertible bijection (for unique decryption)</li>
</ul>
<p><strong>Equations of step</strong> <span class="math inline">\(i\)</span> (<span class="math inline">\(1 \leq i \leq r\)</span>):</p>
<p><span class="math display">\[(L_{i-1}, R_{i-1}) \xrightarrow{K_i} (L_i, R_i)\]</span></p>
<p>With:</p>
<ul>
<li><span class="math inline">\(L_i = R_{i-1}\)</span></li>
<li><span class="math inline">\(R_i = L_{i-1} \oplus f(R_{i-1}, K_i)\)</span></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph Feistel_Round
        L0[Li-1] --&gt; R1[Ri = Li-1 ⊕ f]
        R0[Ri-1] --&gt; L1[Li = Ri-1]
        R0 --&gt; F[Function f]
        K[Key Ki] --&gt; F
        F --&gt; XOR[⊕]
        L0 --&gt; XOR
        XOR --&gt; R1
    end
    
    style F fill:#ffcccc
    style XOR fill:#ffffcc
    style K fill:#fff4e1
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Characteristics:</strong></p>
<ul>
<li><span class="math inline">\(K_i\)</span>: subkeys generated from the main key <span class="math inline">\(K\)</span></li>
<li>Number of steps <span class="math inline">\(r\)</span>: generally <strong>even</strong> and <span class="math inline">\(\geq 3\)</span>
<ul>
<li>Example: DES has 16 steps</li>
</ul></li>
<li><strong>Final permutation</strong>: <span class="math inline">\((L_r, R_r) \rightarrow (R_r, L_r)\)</span></li>
<li><strong>Decryption</strong>: identical to encryption but subkeys applied in <strong>reverse order</strong> (from <span class="math inline">\(K_r\)</span> to <span class="math inline">\(K_1\)</span>)</li>
</ul>
<p><strong>Frequent operations:</strong></p>
<ul>
<li>Permutations</li>
<li>Substitutions (S-boxes)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-73-contents" aria-controls="callout-73" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-73" class="callout-73-contents callout-collapse collapse">
<section id="product-ciphers-and-feistel-ciphers-1" class="level4 callout-body-container callout-body">
<h4 class="anchored" data-anchor-id="product-ciphers-and-feistel-ciphers-1">Product Ciphers and Feistel Ciphers</h4>
<ul>
<li><p>A <strong>product cipher</strong> is an <strong>encryption scheme</strong> combining a <strong>series of successive transformations</strong> to <strong>strengthen resistance to cryptanalysis</strong>. Common transformations for a product cipher are: <strong>transpositions</strong>, <strong>substitutions</strong>, <strong>XORs</strong>, <strong>linear combinations</strong>, <strong>modular multiplications</strong>, etc.</p></li>
<li><p>A <strong>Feistel cipher</strong> is an <strong>iterative product cipher</strong> capable of transforming a <strong>plaintext of <span class="math inline">\(2t\)</span> bits</strong> of the form <span class="math inline">\((L_0, R_0)\)</span> composed of two <strong>sub-blocks</strong> <span class="math inline">\(L_0\)</span> and <span class="math inline">\(R_0\)</span> of <span class="math inline">\(t\)</span> bits into a <strong>ciphertext of size <span class="math inline">\(2t\)</span></strong> of the form <span class="math inline">\((R_r, L_r)\)</span> after <span class="math inline">\(r\)</span> <strong>successive steps (rounds)</strong> with <span class="math inline">\(r \geq 1\)</span>. <strong>Each step</strong> defines a <strong>bijection (inversible !)</strong> to allow unique decryption.</p></li>
<li><p><strong>Permutations</strong> and <strong>substitutions</strong> are the most frequent operations.</p></li>
<li><p>The steps <span class="math inline">\(1 \leq i \leq r\)</span> are written: <span class="math inline">\((L_{i-1}, R_{i-1}) \xrightarrow{K_i} (L_i, R_i)\)</span> with <span class="math inline">\(L_i = R_{i-1}\)</span> and <span class="math inline">\(R_i = L_{i-1} \oplus f(R_{i-1}, K_i)\)</span>. The <span class="math inline">\(K_i\)</span> are <strong>sub-keys</strong>, <strong>different for each step</strong>, generated from the <strong>main key <span class="math inline">\(K\)</span></strong> of the encryption scheme.</p></li>
<li><p>The <strong>number of steps</strong> proper to a Feistel cipher is normally <strong>even</strong> and <span class="math inline">\(\geq 3\)</span> (e.g.&nbsp;<strong>DES has 16 steps</strong>)</p></li>
<li><p>After execution of all steps, a Feistel cipher performs a <strong>permutation</strong> of the two parts <span class="math inline">\((L_r, R_r)\)</span> into <span class="math inline">\((R_r, L_r)\)</span>.</p></li>
<li><p>The <strong>decryption</strong> of a Feistel Cipher is <strong>identical to encryption</strong> except that the sub-keys <span class="math inline">\(K_i\)</span> are applied in <strong>reverse order</strong> (From <span class="math inline">\(K_r\)</span> to <span class="math inline">\(K_1\)</span>).</p></li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-74-contents" aria-controls="callout-74" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-74" class="callout-74-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Product cipher</strong>: combination of successive transformations (transpositions, substitutions, XOR).</p>
<p><strong>Feistel cipher</strong>:</p>
<ul>
<li>iterative product cipher</li>
<li>plaintext <span class="math inline">\(2t\)</span> bits = <span class="math inline">\((L_0, R_0)\)</span></li>
<li><span class="math inline">\(r\)</span> rounds with <span class="math inline">\(L_i = R_{i-1}\)</span> and <span class="math inline">\(R_i = L_{i-1} \oplus f(R_{i-1}, K_i)\)</span>.</li>
<li>Decryption = encryption with reversed sub-keys.</li>
<li>Example: DES (16 rounds).</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="data-encryption-standard-des" class="level3">
<h3 class="anchored" data-anchor-id="data-encryption-standard-des">4. Data Encryption Standard (DES)</h3>
<section id="general-presentation-1" class="level4">
<h4 class="anchored" data-anchor-id="general-presentation-1">General Presentation</h4>
<p><strong>DES</strong> (Data Encryption Standard): most important cryptographic algorithm until the advent of AES in 2001.</p>
<p><strong>Main characteristics:</strong></p>
<ul>
<li><strong>Type</strong>: Feistel Cipher</li>
<li><strong>Block size</strong>: 64 bits (nominal size)</li>
<li><strong>Key size</strong>: 56 effective bits (64 total bits with 8 parity bits)</li>
<li><strong>Number of steps</strong>: 16 rounds</li>
<li><strong>Subkeys</strong>: 16 subkeys of 48 bits (one per step)</li>
<li><strong>Usage modes</strong>: ECB, CBC, CFB, OFB</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph DES_Overview
        P[Plaintext 64 bits] --&gt; DES[DES Encryption]
        K[Key 56 bits] --&gt; DES
        DES --&gt; C[Ciphertext 64 bits]
        
        C --&gt; DES_INV[DES Decryption]
        K2[Key 56 bits] --&gt; DES_INV
        DES_INV --&gt; P2[Plaintext 64 bits]
    end
    
    style DES fill:#ffcccc
    style DES_INV fill:#ccffcc
    style K fill:#fff4e1
    style K2 fill:#fff4e1
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="des-structure" class="level4">
<h4 class="anchored" data-anchor-id="des-structure">DES Structure</h4>
<p><strong>Main components:</strong></p>
<ol type="1">
<li><strong>Initial permutation (IP)</strong>: permutation of the 64 input bits</li>
<li><strong>16 Feistel rounds</strong>: iterative transformation</li>
<li><strong>Final permutation (IP⁻¹)</strong>: inverse of IP</li>
</ol>
<p><strong>Each round applies:</strong></p>
<ul>
<li>Division into two halves: <span class="math inline">\(L_{i-1}\)</span> and <span class="math inline">\(R_{i-1}\)</span> (32 bits each)</li>
<li>Function <span class="math inline">\(f\)</span> on <span class="math inline">\(R_{i-1}\)</span> with subkey <span class="math inline">\(K_i\)</span></li>
<li>XOR with <span class="math inline">\(L_{i-1}\)</span></li>
<li>Exchange of halves</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    Plain[Plaintext 64 bits] --&gt; IP[Initial Permutation IP]
    IP --&gt; Split[Split L0, R0]
    
    Split --&gt; Round1[Round 1]
    K1[K1] --&gt; Round1
    Round1 --&gt; Round2[Round 2]
    K2[K2] --&gt; Round2
    Round2 --&gt; Dots[...]
    Dots --&gt; Round16[Round 16]
    K16[K16] --&gt; Round16
    
    Round16 --&gt; Swap[Swap R16, L16]
    Swap --&gt; IP_inv[Final Permutation IP⁻¹]
    IP_inv --&gt; Cipher[Ciphertext 64 bits]
    
    style IP fill:#e1f5ff
    style IP_inv fill:#e1f5ff
    style Round1 fill:#ffcccc
    style Round2 fill:#ffcccc
    style Round16 fill:#ffcccc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="des-cipher-function" class="level4">
<h4 class="anchored" data-anchor-id="des-cipher-function">DES Cipher Function</h4>
<p>The <strong>function <span class="math inline">\(f\)</span></strong> for each round:</p>
<ol type="1">
<li><strong>Expansion E</strong>: 32 bits → 48 bits (table E)</li>
<li><strong>Key Addition</strong>: XOR with subkey <span class="math inline">\(K_i\)</span> (48 bits)</li>
<li><strong>S-boxes</strong>: 8 S-boxes transform 48 bits → 32 bits
<ul>
<li>Each S-box: 6 bits input → 4 bits output</li>
</ul></li>
<li><strong>Permutation P</strong>: permutation of the resulting 32 bits</li>
</ol>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    R[Ri-1 32 bits] --&gt; E[Expansion E]
    E --&gt; E_out[48 bits]
    E_out --&gt; XOR1[⊕]
    K[Ki 48 bits] --&gt; XOR1
    XOR1 --&gt; S[8 S-boxes]
    S --&gt; S_out[32 bits]
    S_out --&gt; P[Permutation P]
    P --&gt; F_out[f output 32 bits]
    
    style E fill:#cce5ff
    style S fill:#ffcccc
    style P fill:#e1ffe1
    style XOR1 fill:#ffffcc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>S-box operation:</strong></p>
<p>Input: <span class="math inline">\(a_1a_2a_3a_4a_5a_6\)</span> (6 bits)</p>
<ul>
<li><strong>Row</strong>: <span class="math inline">\(a_1 + 2a_6\)</span> (external bits)</li>
<li><strong>Column</strong>: <span class="math inline">\(a_2 + 2a_3 + 4a_4 + 8a_5\)</span> (internal bits)</li>
<li><strong>Output</strong>: value of the corresponding cell (4 bits)</li>
</ul>
</section>
<section id="subkey-generation" class="level4">
<h4 class="anchored" data-anchor-id="subkey-generation">Subkey Generation</h4>
<p><strong>Process:</strong></p>
<ol type="1">
<li>Main key: 64 bits (56 effective + 8 parity)</li>
<li><strong>Permuted Choice 1 (PC-1)</strong>: selection of 56 bits</li>
<li>Division into two halves: <span class="math inline">\(C_0\)</span> and <span class="math inline">\(D_0\)</span> (28 bits each)</li>
<li>For each round <span class="math inline">\(i\)</span>:
<ul>
<li>Left circular rotation of <span class="math inline">\(C_{i-1}\)</span> and <span class="math inline">\(D_{i-1}\)</span></li>
<li><strong>Permuted Choice 2 (PC-2)</strong>: selection of 48 bits for <span class="math inline">\(K_i\)</span></li>
</ul></li>
</ol>
<p><strong>Rotations:</strong></p>
<ul>
<li>Rounds 1, 2, 9, 16: 1 position</li>
<li>Other rounds: 2 positions</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-75-contents" aria-controls="callout-75" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text (DES Operation)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-75" class="callout-75-contents callout-collapse collapse">
<section id="des-operation" class="level4 callout-body-container callout-body">
<h4 class="anchored" data-anchor-id="des-operation">DES: Operation</h4>
<p><strong>Cipher Function</strong></p>
<ul>
<li><p><strong>Expansion E</strong>: The <strong>32 bits of the input</strong> are transformed into a vector of <strong>48 bits</strong> using the <strong>table E</strong>. The first line of this table indicates how the first sub-block of 6 bits will be generated: first take the 32nd bit then bits 1,2,3,4,5. The second sub-block starts with the 4th bit then bits 5,6,7,8,9 and so on…</p></li>
<li><p><strong>Key addition</strong>: <strong>XOR of the 48-bit vector</strong> with the key.</p></li>
<li><p><strong>S-boxes</strong>: Apply <strong>8 S-boxes</strong> on the resulting 48-bit vector. Each of these S-boxes takes a <strong>6-bit sub-block</strong> and transforms it into a <strong>4-bit sub-block</strong>. The operation is performed as follows: If we denote the 6 input bits of the S-box as: <span class="math inline">\(a_1a_2a_3a_4a_5a_6\)</span>. The output is given by the content of the cell located in the <strong>row</strong> <span class="math inline">\(a_1 + 2a_6\)</span> and the <strong>column</strong> <span class="math inline">\(a_2 + 2a_3 + 4a_4 + 8a_5\)</span>.</p></li>
<li><p><strong>Permutation P</strong>: Permutation P works as follows: The first bit is sent to the 16th position, the second to the 7th position and so on.</p></li>
</ul>
<p><strong>Permutations IP and IP⁻¹</strong></p>
<ul>
<li>Act respectively at the <strong>beginning</strong> and at the <strong>end</strong> of the block processing and on the <strong>entirety of the 64 bits</strong>.</li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-76-contents" aria-controls="callout-76" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision (DES)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-76" class="callout-76-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>DES</strong>: Feistel cipher, 64-bit blocks, 56-bit effective key, 16 rounds.</p>
<p><strong>Function <span class="math inline">\(f\)</span></strong>: Expansion E (32→48 bits) → XOR <span class="math inline">\(K_i\)</span> → 8 S-boxes (48→32 bits) → Permutation P.</p>
<p><strong>S-box</strong>: 6 bits input → 4 bits output via table (row = external bits, column = internal bits).</p>
<p><strong>Permutations</strong>: IP (initial) and IP⁻¹ (final) on 64 bits.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="triple-des-and-des-security" class="level3">
<h3 class="anchored" data-anchor-id="triple-des-and-des-security">5. Triple-DES and DES Security</h3>
<section id="des-vulnerabilities" class="level4">
<h4 class="anchored" data-anchor-id="des-vulnerabilities">DES Vulnerabilities</h4>
<p><strong>Main problem</strong>: key space size <span class="math inline">\(\{0,1\}^{56}\)</span> insufficient.</p>
<p><strong>Brute force attack:</strong></p>
<ul>
<li><strong>1999</strong>: key found in <strong>24 hours</strong></li>
<li>Technique: massively parallel brute force (100,000 PCs on Internet)</li>
<li>Known plaintext attack</li>
</ul>
</section>
<section id="triple-des-3des" class="level4">
<h4 class="anchored" data-anchor-id="triple-des-3des">Triple-DES (3DES)</h4>
<p><strong>Solution</strong>: increase key space to <span class="math inline">\(\{0,1\}^{112}\)</span>.</p>
<p><strong>Scheme:</strong></p>
<p><span class="math display">\[C = E_{K_1}(D_{K_2}(E_{K_1}(P)))\]</span></p>
<p>With:</p>
<ul>
<li><span class="math inline">\(E\)</span>: DES encryption</li>
<li><span class="math inline">\(D\)</span>: DES decryption</li>
<li><span class="math inline">\(K_1, K_2\)</span>: two 56-bit keys</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    P[Plaintext 64 bits] --&gt; E1[DES Encrypt K1]
    E1 --&gt; D[DES Decrypt K2]
    D --&gt; E2[DES Encrypt K1]
    E2 --&gt; C[Ciphertext 64 bits]
    
    K1a[Key K1 56 bits] --&gt; E1
    K2[Key K2 56 bits] --&gt; D
    K1b[Key K1 56 bits] --&gt; E2
    
    style E1 fill:#ffcccc
    style D fill:#ccffcc
    style E2 fill:#ffcccc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Advantages:</strong></p>
<ul>
<li>✓ <strong>Satisfactory security</strong>: key space <span class="math inline">\(2^{112}\)</span></li>
<li>✓ <strong>Compatibility</strong>: reuse of existing DES hardware/software</li>
<li>✓ <strong>Gradual migration</strong>: while waiting for AES</li>
</ul>
<p><strong>Disadvantage:</strong></p>
<ul>
<li>✗ <strong>Performance</strong>: 3× slower (3 successive DES executions)</li>
</ul>
</section>
<section id="des-properties" class="level4">
<h4 class="anchored" data-anchor-id="des-properties">DES Properties</h4>
<p><strong>1. DES is not a group</strong></p>
<p>DES is NOT a group under composition:</p>
<p><span class="math display">\[\nexists K_3 \text{ such that } E_{K_3}(E_{K_2}(E_{K_1}(x))) = E_{K_3}(x)\]</span></p>
<p><strong>Consequence</strong>: composite encryption (Triple-DES) considerably increases security.</p>
<p><strong>If DES were a group</strong>: exhaustive search on <span class="math inline">\(\{0,1\}^{56}\)</span> would break the algorithm regardless of the number of consecutive executions.</p>
<p><strong>2. Weak and semi-weak keys</strong></p>
<ul>
<li><p><strong>Weak key</strong>: <span class="math inline">\(E_K(E_K(x)) = x\)</span></p></li>
<li><p><strong>Pair of semi-weak keys</strong>: <span class="math inline">\(E_{K_1}(E_{K_2}(x)) = x\)</span></p></li>
</ul>
<p><strong>Characteristic</strong>: weak keys generate identical subkeys in pairs:</p>
<ul>
<li><span class="math inline">\(k_1 = k_{16}\)</span>, <span class="math inline">\(k_2 = k_{15}\)</span>, …, <span class="math inline">\(k_8 = k_9\)</span></li>
<li>Facilitates cryptanalysis</li>
</ul>
<p><strong>DES has 4 weak keys:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Weak key (hexadecimal)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0101 0101 0101 0101</td>
</tr>
<tr class="even">
<td>0101 0101 FEFE FEFE</td>
</tr>
<tr class="odd">
<td>FEFE FEFE FEFE FEFE</td>
</tr>
<tr class="even">
<td>FEFE FEFE 0101 0101</td>
</tr>
</tbody>
</table>
<p><strong>And 6 pairs of semi-weak keys</strong></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-77-contents" aria-controls="callout-77" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text (DES and 3DES)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-77" class="callout-77-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="des-and-triple-des" class="level4">
<h4 class="anchored" data-anchor-id="des-and-triple-des">DES and Triple-DES</h4>
<ul>
<li><p>The <strong>size of the key set</strong> (<span class="math inline">\(\{0,1\}^{56}\)</span>) constitutes the <strong>greatest threat</strong> weighing on DES with current computing resources. In <strong>1999</strong> it took only <strong>24 hours</strong> to find the key from a <strong>known plaintext</strong> using a <strong>massively parallel brute force technique</strong> (100,000 PCs connected to the Internet).</p></li>
<li><p><strong>Triple DES</strong> protects us from these <strong>brute force attacks</strong> by increasing the <strong>possible key space</strong> to <span class="math inline">\(\{0,1\}^{112}\)</span>.</p></li>
<li><p>This alternative allows continuing to use <strong>DES “boxes”</strong> (hardware and software) while waiting for migration to AES.</p></li>
<li><p>The <strong>security level</strong> obtained by this solution is <strong>very satisfactory</strong>.</p></li>
<li><p>The <strong>performance impact</strong> of three successive DES executions remains a <strong>disadvantage</strong> for some applications.</p></li>
</ul>
</section>
<section id="des-properties-1" class="level4">
<h4 class="anchored" data-anchor-id="des-properties-1">DES: properties</h4>
<ul>
<li><p><strong>DES is not a group</strong> (in the algebraic sense) under composition: In other words, DES being a permutation: <span class="math inline">\(\{0,1\}^{64} \rightarrow \{0,1\}^{64}\)</span>, if DES were a group under composition, this would mean that: <span class="math inline">\(\exists K_3\)</span> such that <span class="math inline">\(E_{K_3}(E_{K_2}(x)) = E_{K_3}(x)\)</span></p>
<p>This property ensures that <strong>composite encryption</strong> (like Triple-DES) <strong>considerably increases the security</strong> of DES. If DES were a group, exhaustive search on the possible key set (<span class="math inline">\(\{0,1\}^{56}\)</span>) would allow “breaking” the algorithm <strong>regardless of the number of consecutive executions</strong> of DES.</p></li>
<li><p><strong>Weak and semi-weak keys</strong> (weak and semi-weak keys):</p>
<ul>
<li>A key <span class="math inline">\(K\)</span> is said to be <strong>weak</strong> if <span class="math inline">\(E_K(E_K(x)) = x\)</span>.</li>
<li>A pair of keys <span class="math inline">\((K_1, K_2)\)</span> is said to be <strong>semi-weak</strong> if <span class="math inline">\(E_{K_1}(E_{K_2}(x)) = x\)</span>.</li>
</ul></li>
<li><p>Weak keys have the particularity of generating <strong>identical subkeys in pairs</strong> (<span class="math inline">\(k_1 = k_{16}\)</span>, <span class="math inline">\(k_2 = k_{15}\)</span>, …, <span class="math inline">\(k_8 = k_9\)</span>), which <strong>facilitates cryptanalysis</strong>.</p></li>
<li><p><strong>DES has 4 weak keys</strong> (and 6 pairs of semi-weak keys).</p></li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-78-contents" aria-controls="callout-78" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision (3DES and security)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-78" class="callout-78-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>DES vulnerability</strong>: key space <span class="math inline">\(2^{56}\)</span> breakable in 24h (1999). <strong>Triple-DES</strong>: <span class="math inline">\(E_{K_1}(D_{K_2}(E_{K_1}(P)))\)</span>, space <span class="math inline">\(2^{112}\)</span>, reuses DES hardware, 3× slower. <strong>DES ≠ group</strong> → composite encryption strengthens security. <strong>4 weak keys</strong> generating identical subkeys in pairs → facilitates cryptanalysis.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="advanced-encryption-standard-aes" class="level3">
<h3 class="anchored" data-anchor-id="advanced-encryption-standard-aes">6. Advanced Encryption Standard (AES)</h3>
<section id="general-presentation-2" class="level4">
<h4 class="anchored" data-anchor-id="general-presentation-2">General Presentation</h4>
<p><strong>AES</strong> (Advanced Encryption Standard): standard adopted in November 2001.</p>
<p><strong>Design</strong>: Johan Daemen and Vincent Rijmen (original name: <strong>Rijndael</strong>)</p>
<p><strong>Main characteristics:</strong></p>
<ul>
<li><strong>Type</strong>: iterative block cipher (but <strong>NOT a Feistel Cipher</strong>)</li>
<li><strong>Block size</strong>: 128 bits</li>
<li><strong>Variable key size</strong>: 128, 192 or 256 bits</li>
<li><strong>Number of rounds</strong>: depends on key size
<ul>
<li>10 rounds for 128-bit key</li>
<li>12 rounds for 192-bit key</li>
<li>14 rounds for 256-bit key</li>
</ul></li>
<li><strong>Usage modes</strong>: ECB, CBC, CFB, OFB, CTR</li>
</ul>
<p><strong>Advantages over DES:</strong></p>
<ul>
<li>✓ <strong>Open process</strong>: consultation and analysis by worldwide experts</li>
<li>✓ <strong>~2× more performant</strong> in software</li>
<li>✓ <strong>~10²² times more secure</strong> (theoretically)</li>
<li>✓ <strong>Scalable</strong>: key size can be increased if necessary</li>
</ul>
</section>
<section id="aes-structure" class="level4">
<h4 class="anchored" data-anchor-id="aes-structure">AES Structure</h4>
<p><strong>Basic unit</strong>: <strong>State</strong> matrix of 4 rows × 4 columns (for 128-bit key)</p>
<ul>
<li>Each element = 1 byte</li>
<li><strong>Total</strong>: 16 bytes = 128 bits</li>
</ul>
<p><strong>Operations on field</strong> <span class="math inline">\(GF(2^8)\)</span>:</p>
<ul>
<li>Byte = element of <span class="math inline">\(GF(2^8)\)</span></li>
<li>Finite field of polynomials of degree ≤ 7 with coefficients in <span class="math inline">\(GF(2)\)</span></li>
<li>Additions, multiplications defined in <span class="math inline">\(GF(2^8)\)</span></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph State_Matrix
        S00[s0,0] --- S01[s0,1]
        S01 --- S02[s0,2]
        S02 --- S03[s0,3]
        
        S10[s1,0] --- S11[s1,1]
        S11 --- S12[s1,2]
        S12 --- S13[s1,3]
        
        S20[s2,0] --- S21[s2,1]
        S21 --- S22[s2,2]
        S22 --- S23[s2,3]
        
        S30[s3,0] --- S31[s3,1]
        S31 --- S32[s3,2]
        S32 --- S33[s3,3]
    end
    
    style S00 fill:#ffe6cc
    style S11 fill:#ffe6cc
    style S22 fill:#ffe6cc
    style S33 fill:#ffe6cc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="aes-round-detail" class="level4">
<h4 class="anchored" data-anchor-id="aes-round-detail">AES Round Detail</h4>
<p><strong>Four operations per round:</strong></p>
<p><strong>1. SubBytes (ByteSub)</strong></p>
<ul>
<li>Non-linear substitution via <strong>S-box</strong></li>
<li>Each byte transformed independently</li>
<li>Resistance to linear and differential cryptanalysis</li>
</ul>
<p><strong>2. ShiftRows</strong></p>
<ul>
<li><strong>Permutation of bytes</strong> with variable shifts per row</li>
<li>Row 0: no shift</li>
<li>Row 1: left shift 1 position</li>
<li>Row 2: left shift 2 positions</li>
<li>Row 3: left shift 3 positions</li>
</ul>
<p><strong>3. MixColumns</strong></p>
<ul>
<li>Each column = linear combination of other columns</li>
<li><strong>Matrix multiplication</strong> in <span class="math inline">\(GF(2^8)\)</span></li>
<li>Maximum diffusion</li>
</ul>
<p><strong>4. AddRoundKey</strong></p>
<ul>
<li><strong>XOR</strong> of the State matrix with the round subkey</li>
<li>Subkey = result of Key Schedule</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    Input[State Input] --&gt; SB[SubBytes]
    SB --&gt; SR[ShiftRows]
    SR --&gt; MC[MixColumns]
    MC --&gt; ARK[AddRoundKey]
    K[Round Key] --&gt; ARK
    ARK --&gt; Output[State Output]
    
    style SB fill:#ffcccc
    style SR fill:#ccffcc
    style MC fill:#cce5ff
    style ARK fill:#ffffcc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Final round</strong>: identical EXCEPT <strong>no MixColumns</strong></p>
</section>
<section id="key-schedule-subkey-generation" class="level4">
<h4 class="anchored" data-anchor-id="key-schedule-subkey-generation">Key Schedule (Subkey Generation)</h4>
<p><strong>Process:</strong></p>
<ol type="1">
<li><strong>Key Expansion</strong>: generation of an extended matrix
<ul>
<li>Key 128 bits → matrix 4 × 4 × (<span class="math inline">\(N_e\)</span> + 1) bytes</li>
<li><span class="math inline">\(N_e\)</span> = number of rounds</li>
</ul></li>
<li><strong>Key Selection</strong>: extraction of subkeys
<ul>
<li>First subkey: first 4 columns</li>
<li>Second subkey: next 4 columns</li>
<li>Etc.</li>
</ul></li>
</ol>
<p><strong>Operations:</strong></p>
<ul>
<li>Byte rotations</li>
<li>Substitutions via S-box</li>
<li>XOR with constants (Rcon)</li>
</ul>
</section>
<section id="aes-pseudo-code" class="level4">
<h4 class="anchored" data-anchor-id="aes-pseudo-code">AES Pseudo-code</h4>
<pre><code>Rijndael(State, CipherKey) {
    KeyExpansion(CipherKey, ExpandedKey);  // Key Schedule
    
    AddRoundKey(State, ExpandedKey[0..3]); // Initial XOR
    
    for(i = 1; i &lt; Ne; i++) {
        Round(State, ExpandedKey[4*i...(4*i)+3]);
    }
    
    FinalRound(State, ExpandedKey[4*Ne...4*Ne+3]);  // Without MixColumns
}</code></pre>
</section>
<section id="aes-decryption" class="level4">
<h4 class="anchored" data-anchor-id="aes-decryption">AES Decryption</h4>
<p><strong>Principle</strong>: apply the <strong>inverse operations</strong> in each round.</p>
<p><strong>Inverse operations:</strong></p>
<ul>
<li><strong>InvSubBytes</strong>: inverse substitution via S-box⁻¹</li>
<li><strong>InvShiftRows</strong>: right shifts (instead of left)</li>
<li><strong>InvMixColumns</strong>: inverse matrix multiplication</li>
<li><strong>AddRoundKey</strong>: self-inverse (XOR)</li>
</ul>
<p><strong>Order</strong>: inverse of encryption with subkeys in reverse order</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-79-contents" aria-controls="callout-79" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text (AES)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-79" class="callout-79-contents callout-collapse collapse">
<section id="advanced-encryption-standard-aes-1" class="level4 callout-body-container callout-body">
<h4 class="anchored" data-anchor-id="advanced-encryption-standard-aes-1">Advanced Encryption Standard (AES)</h4>
<ul>
<li><p>Adopted as <strong>standard in November 2001</strong>, designed by <strong>Johan Daemen and Vincent Rijmen</strong> (hence its original name <strong>Rijndael</strong>).</p></li>
<li><p>It is also an <strong>iterative block cipher</strong> (like DES) but <strong>not a Feistel Cipher</strong>.</p></li>
<li><p><strong>Plaintext/Ciphertext Blocks</strong>: <strong>128 bits</strong>.</p></li>
<li><p><strong>Variable key length</strong>: <strong>128, 192, or 256 bits</strong>.</p></li>
<li><p>Unlike DES, AES comes from an <strong>open consultation and analysis process</strong> involving worldwide experts.</p></li>
<li><p>Techniques similar to DES (substitutions, permutations, XOR…) complemented by <strong>simple and very performant algebraic operations</strong>.</p></li>
<li><p>All operations are performed in the <strong>field</strong> <span class="math inline">\(GF(2^8)\)</span>: the finite field of <strong>polynomials of degree ≤ 7</strong> with <strong>coefficients in</strong> <span class="math inline">\(GF(2)\)</span>.</p></li>
<li><p>In particular, a <strong>byte for AES is an element in</strong> <span class="math inline">\(GF(2^8)\)</span> and the <strong>operations on bytes</strong> (additions, multiplications,…) are <strong>defined as in</strong> <span class="math inline">\(GF(2^8)\)</span>.</p></li>
<li><p><strong>~2 times more performant</strong> (in software) and <strong>~10²² times (in theory…) more secure</strong> than DES…</p></li>
<li><p><strong>Scalable</strong>: The key size can be increased if necessary.</p></li>
</ul>
<section id="detail-of-an-aes-step-round" class="level5">
<h5 class="anchored" data-anchor-id="detail-of-an-aes-step-round">Detail of an AES Step (round)</h5>
<p>The <strong>basic unit</strong> on which calculations are applied is a <strong>matrix of 4 rows and 4 columns</strong> (in the case of a 128-bit key) whose elements are <strong>bytes</strong>:</p>
<ul>
<li><p><strong>ByteSub</strong>: <strong>Non-linear operation (S-box)</strong> designed to <strong>resist linear and differential cryptanalysis</strong>.</p></li>
<li><p><strong>ShiftRow</strong>: <strong>Permutation of bytes</strong> introducing <strong>variable shifts</strong> on the rows.</p></li>
<li><p><strong>MixColumn</strong>: Each column is replaced by <strong>linear combinations</strong> of the other columns (<strong>matrix multiplication</strong> !)</p></li>
<li><p><strong>AddRoundKey</strong>: <strong>XOR</strong> of the current matrix with the <strong>subkey</strong> corresponding to the current step.</p></li>
</ul>
</section>
<section id="aes-global-operation" class="level5">
<h5 class="anchored" data-anchor-id="aes-global-operation">AES: Global Operation</h5>
<ul>
<li><p>The <strong>number of steps</strong> of AES varies depending on the <strong>key size</strong>. For a <strong>128-bit key</strong>, <strong>10 steps</strong> must be performed. Each increase of 32 bits in the key size entails an <strong>additional step</strong> (14 steps for 256-bit keys).</p></li>
<li><p><strong>Decryption</strong> consists of applying the <strong>inverse operations</strong> in each of the steps (<strong>InvSubBytes</strong>, <strong>InvShiftRows</strong>, <strong>InvMixColumns</strong>). <strong>AddRoundKey</strong> (because of XOR) is <strong>its own inverse</strong>.</p></li>
<li><p>The <strong>Key Schedule</strong> consists of:</p>
<ul>
<li>An operation of <strong>key expansion</strong> of the main key. If <span class="math inline">\(N_e\)</span> is the number of steps (depending on the key), a <strong>matrix of 4 rows and 4 × (<span class="math inline">\(N_e\)</span> + 1) columns</strong> is generated.</li>
<li>An operation of <strong>step key selection</strong>: The <strong>first subkey</strong> will be constituted by the <strong>first 4 columns</strong> of the matrix generated during expansion and so on.</li>
</ul></li>
</ul>
</section>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-80-contents" aria-controls="callout-80" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision (AES)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-80" class="callout-80-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>AES</strong> (Rijndael 2001): iterative block cipher (NOT Feistel), 128-bit blocks, keys 128/192/256 bits → 10/12/14 rounds.</p>
<p><strong>State</strong>: 4×4 byte matrix in <span class="math inline">\(GF(2^8)\)</span>.</p>
<p><strong>4 operations/round</strong>:</p>
<ul>
<li>SubBytes (non-linear S-box)</li>
<li>ShiftRows (row shifts)</li>
<li>MixColumns (linear combinations)</li>
<li>AddRoundKey (XOR subkey).</li>
</ul>
<p>2× faster than DES, 10²² times more secure.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="attacks-and-aes-security" class="level3">
<h3 class="anchored" data-anchor-id="attacks-and-aes-security">7. Attacks and AES Security</h3>
<section id="aes-strengths" class="level4">
<h4 class="anchored" data-anchor-id="aes-strengths">AES Strengths</h4>
<p><strong>Simplicity and performance:</strong></p>
<ul>
<li>✓ Simple and efficient algorithm</li>
<li>✓ Works on limited platforms (8-bit smart cards)</li>
<li>✓ Hardware and software optimizations</li>
</ul>
</section>
<section id="published-attacks" class="level4">
<h4 class="anchored" data-anchor-id="published-attacks">Published Attacks</h4>
<p><strong>1. Algebraic attacks (2002)</strong></p>
<p><strong>XSL technique</strong> (N. Courtois and P. Pieprzyk):</p>
<ul>
<li>Represents AES as <strong>system of 8000 quadratic equations</strong> with 1600 binary unknowns</li>
<li><strong>Estimated effort</strong>: <span class="math inline">\(2^{100}\)</span> operations (still a conjecture)</li>
<li><strong>Characteristic</strong>: requires few known plaintexts</li>
<li><strong>Distinction</strong>: different from linear/differential attacks</li>
</ul>
<p><strong>Critique</strong>: based on the “highly algebraic” character of AES (largely contested)</p>
<p><strong>2. Related Key Attacks (2009-2011)</strong></p>
<p><strong>Principle</strong>: attacks based on <strong>similar keys</strong></p>
<ul>
<li>Interesting results on <strong>reduced versions</strong> of AES</li>
<li>Do not compromise full AES</li>
</ul>
<p><strong>3. Side Channel Attacks</strong></p>
<p><strong>Principle</strong>: attacks on <strong>implementation</strong> (not the algorithm)</p>
<p><strong>Techniques:</strong></p>
<ul>
<li><strong>Cache timing attacks</strong>: cache access analysis</li>
<li><strong>Power analysis</strong>: power consumption</li>
<li><strong>Electromagnetic analysis</strong>: electromagnetic emissions</li>
</ul>
<p><strong>Example</strong> (2005): Osvik, Shamir, Tromer</p>
<ul>
<li>Extraction of 128-bit key with <strong>6-7 plaintext/ciphertext pairs</strong></li>
<li>Based on <strong>cache access</strong> analysis</li>
</ul>
<p><strong>4. Meet in the Middle on biclique structures (2011-2015)</strong></p>
<p><strong>Result:</strong></p>
<ul>
<li>Reduces effort for AES-128 to <strong><span class="math inline">\(2^{126}\)</span></strong> (factor 4 vs brute force)</li>
<li><strong>Remains well above</strong> current capabilities</li>
</ul>
</section>
<section id="practical-security" class="level4">
<h4 class="anchored" data-anchor-id="practical-security">Practical Security</h4>
<p><strong>Fundamental assumption</strong>: key of <strong>maximum entropy</strong></p>
<p><strong>Recent attacks</strong> (WPA2, etc.):</p>
<ul>
<li>Exploit <strong>weakness of passwords/passphrases</strong></li>
<li>No flaw in AES itself</li>
<li>Problem: key generation from weak passwords</li>
</ul>
<p><strong>⚠️ Critical reminder</strong>: key quality = system security</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-81-contents" aria-controls="callout-81" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text (AES Attacks)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-81" class="callout-81-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="aes-final-remarks-and-attacks-i" class="level4">
<h4 class="anchored" data-anchor-id="aes-final-remarks-and-attacks-i">AES: Final Remarks and Attacks (I)</h4>
<ul>
<li><p>The greatest <strong>strength of AES</strong> lies in its <strong>simplicity</strong> and its <strong>performance</strong>, including on <strong>reduced computing capacity platforms</strong> (e.g.&nbsp;<strong>smart cards</strong> with 8-bit processors).</p></li>
<li><p>Since its official publication, <strong>many cryptanalysis works</strong> have been published with very interesting results. In particular, <strong>N. Courtois and P.Pieprzyk</strong> presented a technique called <strong>XSL</strong> allowing to represent AES as a <strong>system of 8000 quadratic equations</strong> with <strong>1600 binary unknowns</strong>. The <strong>effort needed</strong> to break this system is estimated (it is still a <strong>conjecture</strong>…) to be <strong><span class="math inline">\(2^{100}\)</span></strong>.</p></li>
<li><p>These attacks are based on the <strong>highly algebraic character</strong> (and largely contested…) of AES. Moreover, only <strong>a few known plaintexts</strong> are needed to set them up, which distinguishes them from linear and differential attacks.</p></li>
<li><p>In recent years (2009-2011) <strong>attacks based on similar keys</strong> (related key attacks) have obtained interesting results on <strong>reduced versions</strong> of AES.</p></li>
<li><p>Another family of attacks called <strong>side channel attacks</strong> acting directly on the <strong>algorithm implementation</strong> allows extracting cryptographically relevant information during encryption execution.</p></li>
</ul>
</section>
<section id="aes-final-remarks-and-attacks-ii" class="level4">
<h4 class="anchored" data-anchor-id="aes-final-remarks-and-attacks-ii">AES: Final remarks and Attacks (II)</h4>
<ul>
<li><p>In <strong>2015</strong> a <strong>Meet in the Middle</strong> type attack based on <strong>biclique structures</strong> showed that it was possible to reduce the <strong>effort needed</strong> to find an AES-128 key to <strong><span class="math inline">\(2^{126}\)</span></strong>, i.e., a <strong>factor of 4</strong> compared to brute force. This nevertheless remains <strong>well above</strong> current computing capabilities.</p></li>
<li><p>Another family of attacks called <strong>side channel attacks</strong> acting directly on the <strong>algorithm implementation</strong> allows extracting cryptographically relevant information during encryption execution. In particular, the authors manage to <strong>extract the 128-bit key</strong> with only <strong>6-7 plaintext/ciphertext pairs</strong> based on <strong>cache accesses</strong>.</p></li>
<li><p>The <strong>security of AES</strong> (as for any other encryption algorithm) is always based on the assumption of a <strong>key of maximum entropy</strong>. The <strong>attacks published recently</strong> on protocols based on AES (like WPA2) exploit the <strong>weakness of passwords/passphrases</strong> that are the origin of the keys used.</p></li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-82-contents" aria-controls="callout-82" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision (AES Security)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-82" class="callout-82-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Strengths</strong>: simplicity, performance (even 8-bit cards). <strong>Attacks</strong>: XSL (<span class="math inline">\(2^{100}\)</span>, algebraic), related keys (reduced versions), side channel (implementation, cache), Meet-in-Middle biclique (<span class="math inline">\(2^{126}\)</span>). <strong>Security</strong>: assumption of max entropy key. Practical attacks = weak passwords, not AES flaw.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="block-cipher-cryptanalysis-techniques" class="level3">
<h3 class="anchored" data-anchor-id="block-cipher-cryptanalysis-techniques">8. Block Cipher Cryptanalysis Techniques</h3>
<section id="differential-cryptanalysis" class="level4">
<h4 class="anchored" data-anchor-id="differential-cryptanalysis">8.1 Differential Cryptanalysis</h4>
<p><strong>Principle</strong>: <strong>chosen plaintext</strong> attack analyzing the <strong>propagation of differences</strong> between two plaintexts through the rounds.</p>
<p><strong>Method:</strong></p>
<ol type="1">
<li>Choose two plaintexts with known difference: <span class="math inline">\(x_a\)</span> and <span class="math inline">\(x_b\)</span></li>
<li>Observe propagation: <span class="math inline">\(\Delta x = x_a \oplus x_b\)</span></li>
<li>Analyze ciphertexts: <span class="math inline">\(\Delta y = y_a \oplus y_b\)</span></li>
<li><strong>Assign probabilities to keys</strong> according to observed changes</li>
<li><strong>Most probable key</strong> = correct key (after many trials)</li>
</ol>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Requires <strong><span class="math inline">\(2^{47}\)</span> chosen plaintext pairs</strong> for DES</li>
<li><strong>Probabilities</strong>: depend on S-boxes and structure</li>
<li>The more pairs increase, the more success probability increases</li>
</ul>
<p><strong>Sensitivity</strong>: very sensitive to <strong>number of rounds</strong></p>
<ul>
<li>Chances of success increase <strong>exponentially</strong> when rounds decrease</li>
</ul>
</section>
<section id="linear-cryptanalysis" class="level4">
<h4 class="anchored" data-anchor-id="linear-cryptanalysis">8.2 Linear Cryptanalysis</h4>
<p><strong>Principle</strong>: <strong>known plaintext</strong> attack creating a <strong>linear simulator</strong> of the block cipher.</p>
<p><strong>Method:</strong></p>
<ol type="1">
<li>Create <strong>linear approximations</strong> of the algorithm</li>
<li>Analyze a large number of plaintext/ciphertext pairs</li>
<li>The bits of the simulator key <strong>tend to coincide</strong> with those of the real key (probabilistic calculation)</li>
</ol>
<p><strong>Complexity for DES:</strong></p>
<ul>
<li><strong><span class="math inline">\(2^{38}\)</span> known plaintexts</strong> → 10% probability of guessing correctly</li>
<li><strong><span class="math inline">\(2^{43}\)</span> known plaintexts</strong> → 85% success probability</li>
</ul>
<p><strong>Characteristics:</strong></p>
<ul>
<li><strong>Most powerful analytical attack</strong> to date on block ciphers</li>
<li>Also <strong>sensitive to number of rounds</strong></li>
</ul>
</section>
<section id="differential-vs-linear-comparison" class="level4">
<h4 class="anchored" data-anchor-id="differential-vs-linear-comparison">8.3 Differential vs Linear Comparison</h4>
<p><strong>Common difficulties:</strong></p>
<ul>
<li>✗ <strong>Parallelization</strong>: less efficient than parallel brute force</li>
<li>⚠️ <strong>Sensitivity to rounds</strong>: efficiency decreases exponentially with number of rounds</li>
</ul>
<p><strong>DES and these attacks:</strong></p>
<ul>
<li>Widespread conjecture: DES designers <strong>knew these attacks</strong> (1970s, unpublished at the time)</li>
<li><strong>S-box design</strong>: very high resistance to both techniques</li>
</ul>
</section>
<section id="meet-in-the-middle-attack" class="level4">
<h4 class="anchored" data-anchor-id="meet-in-the-middle-attack">8.4 Meet-in-the-Middle Attack</h4>
<p><strong>Principle</strong>: exploits <strong>composite constructions</strong> of type <span class="math inline">\(y = E_{K_2}(E_{K_1}(x))\)</span>.</p>
<p><strong>Method:</strong></p>
<ol type="1">
<li>Build list <span class="math inline">\(L_1\)</span>: <span class="math inline">\(L_1 = \{E_{K_1}(x) \mid K_1 \in \text{KeySpace}\}\)</span></li>
<li>Build list <span class="math inline">\(L_2\)</span>: <span class="math inline">\(L_2 = \{D_{K_2}(y) \mid K_2 \in \text{KeySpace}\}\)</span></li>
<li>Identify <strong>repeated elements</strong> in <span class="math inline">\(L_1\)</span> and <span class="math inline">\(L_2\)</span></li>
<li>Verify hypothesis with <strong>second known plaintext</strong></li>
<li>The associated keys <span class="math inline">\(K_1\)</span> and <span class="math inline">\(K_2\)</span> are probably the sought keys</li>
</ol>
<p><strong>Example for DES:</strong></p>
<p>Intuitive key space for <span class="math inline">\(E_{K_2}(E_{K_1}(x))\)</span>: <span class="math inline">\(\{0,1\}^{112}\)</span></p>
<p><strong>Actual effort:</strong></p>
<ul>
<li><strong><span class="math inline">\(2^{57}\)</span> operations</strong> to establish the two lists</li>
<li><strong><span class="math inline">\(2^{56}\)</span> blocks</strong> of 64 bits storage</li>
<li><strong>Significantly lower</strong> than the intuitive <span class="math inline">\(2^{112}\)</span></li>
</ul>
<p><strong>Applications:</strong></p>
<ul>
<li>Attacks on <strong>composite constructions</strong></li>
<li><strong>Internal</strong> cryptanalysis of block ciphers</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TB
    subgraph Meet_in_Middle
        X[Known Plaintext x] --&gt; E1[Encrypt K1]
        E1 --&gt; M[Middle Value m]
        M --&gt; E2[Encrypt K2]
        E2 --&gt; Y[Known Ciphertext y]
        
        X2[x] --&gt; L1[List L1: EK1 for all K1]
        Y2[y] --&gt; L2[List L2: DK2 for all K2]
        
        L1 -.match.-&gt; Match[Find common m]
        L2 -.match.-&gt; Match
    end
    
    style M fill:#ffffcc
    style Match fill:#ccffcc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-83-contents" aria-controls="callout-83" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📄 Original text (Cryptanalysis)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-83" class="callout-83-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="block-cipher-cryptanalysis-techniques-1" class="level4">
<h4 class="anchored" data-anchor-id="block-cipher-cryptanalysis-techniques-1">Block Cipher Cryptanalysis Techniques</h4>
<p><strong>Differential Cryptanalysis</strong></p>
<ul>
<li><p>This is a <strong>chosen plaintext attack</strong> that focuses on the <strong>propagation of differences</strong> in two plaintexts as they evolve through the different steps of the algorithm.</p></li>
<li><p>It <strong>assigns probabilities to keys</strong> it “guesses” based on the <strong>changes</strong> they induce on the ciphertexts. The <strong>most probable key</strong> has a good chance of being the correct key after a <strong>large number</strong> of plaintext/ciphertext pairs.</p></li>
<li><p>Requires <strong><span class="math inline">\(2^{47}\)</span> chosen plaintext pairs</strong> (for DES) to obtain correct results.</p></li>
</ul>
<p><strong>Linear Cryptanalysis</strong></p>
<ul>
<li><p>This is a <strong>known plaintext attack</strong> that creates a <strong>block simulator</strong> from <strong>linear approximations</strong>. By analyzing a <strong>large number</strong> of plaintext/ciphertext pairs, the <strong>bits of the simulator key</strong> tend to <strong>coincide</strong> with those of the analyzed block cipher (<strong>probabilistic calculation</strong>)</p></li>
<li><p>For DES an attack based on this technique requires <strong><span class="math inline">\(2^{38}\)</span> known plaintexts</strong> to obtain a probability of <strong>10%</strong> of guessing correctly and <strong><span class="math inline">\(2^{43}\)</span> for 85%</strong> !</p></li>
<li><p>It is the <strong>most powerful analytical attack</strong> to date on block ciphers.</p></li>
</ul>
</section>
<section id="block-cipher-cryptanalysis-techniques-ii" class="level4">
<h4 class="anchored" data-anchor-id="block-cipher-cryptanalysis-techniques-ii">Block Cipher Cryptanalysis Techniques (II)</h4>
<ul>
<li><p>The practical implementation of <strong>differential and linear attacks</strong> presents <strong>difficulties in parallelizing</strong> calculations compared to an exhaustive key search.</p></li>
<li><p>These two attacks are <strong>very sensitive to the number of steps</strong> of the block cipher: chances of success increase <strong>exponentially</strong> as the number of algorithm steps decreases.</p></li>
<li><p>A widespread conjecture among cryptographers is that these attacks, at the time <strong>unpublished</strong>, were <strong>known to the designers of DES</strong>. In particular, the <strong>design of the S-boxes</strong> offers a <strong>very high resistance</strong> to both techniques.</p></li>
</ul>
<p><strong>Meet-in-the-Middle Attack</strong></p>
<ul>
<li><p>Applies to constructions of the type <span class="math inline">\(y := E_{K_2}(E_{K_1}(x))\)</span>. For DES, the key space for this solution would be <span class="math inline">\(\{0,1\}^{112}\)</span>. First build <strong>two lists</strong> <span class="math inline">\(L_1\)</span> and <span class="math inline">\(L_2\)</span> of <span class="math inline">\(2^{56}\)</span> messages of the form: <span class="math inline">\(L_1 = E_{K_1}(x)\)</span> and <span class="math inline">\(L_2 = D_{K_2}(y)\)</span> with <span class="math inline">\(E\)</span> and <span class="math inline">\(D\)</span> the encryption and decryption operations respectively. Then <strong>identify elements that repeat</strong> in both lists and <strong>verify our hypothesis</strong> with a second known plaintext. The <span class="math inline">\(K_1\)</span> and <span class="math inline">\(K_2\)</span> associated with this pair of known plaintexts will (in all likelihood) be <strong>the sought keys</strong> !</p></li>
<li><p><strong>Effort required</strong> to carry out the attacks (for DES): <strong><span class="math inline">\(2^{57}\)</span> operations</strong> to establish the two lists + <strong><span class="math inline">\(2^{56}\)</span> blocks</strong> of 64 bits of storage to memorize intermediate results… <strong>significantly lower</strong> than the intuitive <span class="math inline">\(2^{112}\)</span>…</p></li>
<li><p>These meet-in-the-middle techniques are also applied to the <strong>internal cryptanalysis</strong> of block ciphers.</p></li>
</ul>
</section>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-84-contents" aria-controls="callout-84" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>📌 Quick revision (Cryptanalysis)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-84" class="callout-84-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Differential</strong>: chosen plaintext, difference propagation, probabilities on keys, <span class="math inline">\(2^{47}\)</span> pairs (DES).</p>
<p><strong>Linear</strong>: known plaintext, linear approximations, <span class="math inline">\(2^{38}\)</span>-<span class="math inline">\(2^{43}\)</span> plaintexts (DES), most powerful attack.</p>
<p><strong>Meet-in-Middle</strong>: composite constructions, 2 lists <span class="math inline">\(2^{56}\)</span>, effort <span class="math inline">\(2^{57}\)</span> &lt;&lt; <span class="math inline">\(2^{112}\)</span>.</p>
<p><strong>Sensitivity</strong>: very dependent on number of rounds.</p>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="asymmetric-cryptography-public-key-cryptography" class="level1">
<h1>Asymmetric Cryptography (Public Key Cryptography)</h1>
<section id="mathematical-foundations" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-foundations">Mathematical Foundations</h2>
<section id="fundamental-theorem-of-arithmetic-and-eulers-totient-function" class="level3">
<h3 class="anchored" data-anchor-id="fundamental-theorem-of-arithmetic-and-eulers-totient-function">Fundamental Theorem of Arithmetic and Euler’s Totient Function</h3>
<p>Asymmetric cryptography relies on solid mathematical foundations from number theory. Two concepts are essential:</p>
<p><strong>Fundamental Theorem of Arithmetic</strong>: Every positive integer greater than 1 can be written uniquely (up to order) as a product of prime powers:</p>
<p><span class="math display">\[n = p_1^{e_1} \cdot p_2^{e_2} \cdot p_3^{e_3} \cdots p_m^{e_m}\]</span></p>
<p><strong>Euler’s Totient Function <span class="math inline">\(\phi(n)\)</span></strong>: Number of positive integers smaller than <span class="math inline">\(n\)</span> that are coprime with <span class="math inline">\(n\)</span>.</p>
<p>To compute <span class="math inline">\(\phi(n)\)</span>:</p>
<p><span class="math display">\[\phi(n) = \prod_{i=1}^{m} p_i^{e_i} \cdot \left(1 - \frac{1}{p_i}\right)\]</span></p>
<p><strong>Important special case</strong>: If <span class="math inline">\(n = p \cdot q\)</span> with <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> prime, then:</p>
<p><span class="math display">\[\phi(n) = (p-1)(q-1)\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-85-contents" aria-controls="callout-85" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-85" class="callout-85-contents callout-collapse collapse">
<section id="mathematical-foundations-1" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="mathematical-foundations-1">Mathematical Foundations</h3>
<p><strong>Fundamental Theorem of Arithmetic</strong>: Every positive integer <span class="math inline">\(n\)</span> can be written uniquely (up to order) as a product of powers of distinct prime numbers <span class="math inline">\(p_i\)</span>:</p>
<p><span class="math display">\[n = p_1^{e_1} \cdot p_2^{e_2} \cdot p_3^{e_3} \cdots p_m^{e_m}\]</span></p>
<p><strong>Euler’s Totient Function</strong>: Let <span class="math inline">\(n \in \mathbb{Z}^+\)</span>, the <strong>Euler’s totient function</strong> <span class="math inline">\(\phi(n)\)</span> is equal to the number of positive integers smaller than <span class="math inline">\(n\)</span> that are <strong>relatively prime</strong> to <span class="math inline">\(n\)</span>.</p>
<p><strong>Calculation of Euler’s totient function</strong>: According to the fundamental theorem of arithmetic, every integer <span class="math inline">\(n &gt; 1\)</span> can be written as:</p>
<p><span class="math display">\[n = \prod_{i=1}^{m} p_i^{e_i}\]</span></p>
<p>then <span class="math inline">\(\phi(n)\)</span> is calculated as:</p>
<p><span class="math display">\[\phi(n) = \prod_{i=1}^{m} \left(p_i^{e_i} - p_i^{e_i-1}\right)\]</span></p>
<p>In particular, if <span class="math inline">\(n = p \cdot q\)</span> with <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> prime, then:</p>
<p><span class="math display">\[\phi(n) = (p-1)(q-1)\]</span></p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-86-contents" aria-controls="callout-86" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-86" class="callout-86-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Unique decomposition</strong>: every integer = product of prime numbers</li>
<li><strong><span class="math inline">\(\phi(n)\)</span></strong>: counts integers <span class="math inline">\(&lt; n\)</span> coprime with <span class="math inline">\(n\)</span></li>
<li><strong>Key for RSA</strong>: if <span class="math inline">\(n = pq\)</span> (primes) then <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span></li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="eulers-theorem-and-fermats-little-theorem" class="level3">
<h3 class="anchored" data-anchor-id="eulers-theorem-and-fermats-little-theorem">Euler’s Theorem and Fermat’s Little Theorem</h3>
<p>These theorems are at the heart of RSA and other asymmetric algorithms.</p>
<p><strong>Euler’s Theorem</strong>: If <span class="math inline">\(n \in \mathbb{Z}^+\)</span> and <span class="math inline">\(a \in \mathbb{Z}\)</span> with <span class="math inline">\(\text{gcd}(a,n) = 1\)</span>, then:</p>
<p><span class="math display">\[a^{\phi(n)} \equiv 1 \pmod{n}\]</span></p>
<p><strong>Fermat’s Little Theorem</strong> (special case if <span class="math inline">\(n = p\)</span> prime): If <span class="math inline">\(a \in \mathbb{Z}\)</span> and <span class="math inline">\(p\)</span> prime does not divide <span class="math inline">\(a\)</span>:</p>
<p><span class="math display">\[a^{p-1} \equiv 1 \pmod{p}\]</span></p>
<p><strong>Important applications</strong>:</p>
<ol type="1">
<li><p><strong>Exponent reduction</strong>: If <span class="math inline">\(n\)</span> is a product of distinct primes and <span class="math inline">\(r \equiv s \pmod{\phi(n)}\)</span>, then: <span class="math display">\[a^r \equiv a^s \pmod{n}\]</span></p></li>
<li><p><strong>Calculation of inverses</strong>: <span class="math inline">\(a^{\phi(n)-1}\)</span> is the inverse of <span class="math inline">\(a\)</span> modulo <span class="math inline">\(n\)</span>. In particular, if <span class="math inline">\(p\)</span> is prime, <span class="math inline">\(a^{p-2}\)</span> is the inverse of <span class="math inline">\(a\)</span> modulo <span class="math inline">\(p\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-87-contents" aria-controls="callout-87" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-87" class="callout-87-contents callout-collapse collapse">
<section id="mathematical-foundations-ii" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="mathematical-foundations-ii">Mathematical Foundations (II)</h3>
<p><strong>Euler’s Theorem</strong>: Let <span class="math inline">\(n \in \mathbb{Z}^+\)</span> and <span class="math inline">\(a \in \mathbb{Z}\)</span> with <span class="math inline">\(\text{gcd}(a,n) = 1\)</span>, then we have:</p>
<p><span class="math display">\[a^{\phi(n)} \equiv 1 \pmod{n}\]</span></p>
<p><strong>Fermat’s Little Theorem</strong> (special case of Euler’s theorem if <span class="math inline">\(n\)</span> is prime): Let <span class="math inline">\(a \in \mathbb{Z}\)</span> and <span class="math inline">\(p\)</span> a prime number such that <span class="math inline">\(p\)</span> does not divide <span class="math inline">\(a\)</span>, then we have:</p>
<p><span class="math display">\[a^{p-1} \equiv 1 \pmod{p}\]</span></p>
<p>Note that since <span class="math inline">\(p\)</span> is prime, we have <span class="math inline">\(\phi(p) = p-1\)</span>.</p>
<p><strong>Exponent reduction</strong> <span class="math inline">\(\bmod \phi(n)\)</span>: If <span class="math inline">\(n\)</span> is the product of distinct primes and <span class="math inline">\(r, s \in \mathbb{Z}\)</span> such that <span class="math inline">\(r \equiv s \pmod{\phi(n)}\)</span> then <span class="math inline">\(\forall a \in \mathbb{Z}\)</span>:</p>
<p><span class="math display">\[a^r \equiv a^s \pmod{n}\]</span></p>
<p><strong>Application of Euler’s Theorem to inverse calculation</strong>: From Euler’s theorem, we have that:</p>
<p><span class="math display">\[a \cdot a^{\phi(n)-1} \equiv 1 \pmod{n}\]</span></p>
<p>which means that <span class="math inline">\(a^{\phi(n)-1}\)</span> is the <strong>inverse of <span class="math inline">\(a\)</span> modulo <span class="math inline">\(n\)</span></strong>. In particular, <span class="math inline">\(a^{p-2}\)</span> is the inverse of <span class="math inline">\(a\)</span> modulo <span class="math inline">\(n\)</span> if <span class="math inline">\(p\)</span> is prime.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-88-contents" aria-controls="callout-88" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-88" class="callout-88-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Euler’s Theorem</strong>: <span class="math inline">\(a^{\phi(n)} \equiv 1 \pmod{n}\)</span></li>
<li><strong>Fermat</strong>: special case if <span class="math inline">\(p\)</span> prime: <span class="math inline">\(a^{p-1} \equiv 1 \pmod{p}\)</span></li>
<li><strong>Modular inverse</strong>: <span class="math inline">\(a^{-1} \equiv a^{\phi(n)-1} \pmod{n}\)</span></li>
<li><strong>Base of RSA</strong>: enables encryption/decryption with exponents</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="multiplicative-groups-and-generators" class="level3">
<h3 class="anchored" data-anchor-id="multiplicative-groups-and-generators">Multiplicative Groups and Generators</h3>
<p><strong>Multiplicative group <span class="math inline">\(\mathbb{Z}_n^*\)</span></strong>: Set of elements of <span class="math inline">\(\mathbb{Z}_n\)</span> coprime with <span class="math inline">\(n\)</span>:</p>
<p><span class="math display">\[\mathbb{Z}_n^* = \{a \in \mathbb{Z}_n \mid \text{gcd}(a,n) = 1\}\]</span></p>
<p>If <span class="math inline">\(n\)</span> is prime: <span class="math inline">\(\mathbb{Z}_n^* = \{1, 2, \ldots, n-1\}\)</span></p>
<p><strong>Order of an element</strong>: Smallest positive integer <span class="math inline">\(t\)</span> such that <span class="math inline">\(a^t \equiv 1 \pmod{n}\)</span></p>
<p><strong>Generator</strong>: An element <span class="math inline">\(\alpha\)</span> is a generator of <span class="math inline">\(\mathbb{Z}_n^*\)</span> if its order is <span class="math inline">\(\phi(n)\)</span>. Then <span class="math inline">\(\mathbb{Z}_n^*\)</span> is said to be <strong>cyclic</strong>.</p>
<p><strong>Properties of generators</strong>:</p>
<ol type="1">
<li><span class="math inline">\(\mathbb{Z}_n^*\)</span> has a generator iff <span class="math inline">\(n = 2, 4, p^k\)</span> or <span class="math inline">\(2p^k\)</span> (with <span class="math inline">\(p\)</span> prime, <span class="math inline">\(p \neq 2\)</span> and <span class="math inline">\(k \geq 1\)</span>)</li>
<li>If <span class="math inline">\(p\)</span> is prime, <span class="math inline">\(\mathbb{Z}_p^*\)</span> always has a generator</li>
<li>If <span class="math inline">\(\alpha\)</span> is a generator, all elements can be written as: <span class="math inline">\(\mathbb{Z}_n^* = \{\alpha^i \bmod n \mid 0 \leq i &lt; \phi(n)\}\)</span></li>
<li>The number of generators is <span class="math inline">\(\phi(\phi(n))\)</span></li>
</ol>
<p><strong>Generator test</strong></p>
<ul>
<li><span class="math inline">\(\alpha\)</span> is a generator of <span class="math inline">\(\mathbb{Z}_n^*\)</span> iff for every prime <span class="math inline">\(p\)</span> dividing <span class="math inline">\(\phi(n)\)</span>, <span class="math inline">\(\alpha^{\phi(n)/p} \not\equiv 1 \pmod{n}\)</span></li>
<li>if <span class="math inline">\(n = 2p+1\)</span> is a “safe prime” with <span class="math inline">\(p\)</span> prime: <span class="math inline">\(\alpha\)</span> is a generator iff <span class="math inline">\(\alpha^2 \not\equiv 1 \pmod{n}\)</span> and <span class="math inline">\(\alpha^p \not\equiv 1 \pmod{n}\)</span></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-89-contents" aria-controls="callout-89" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-89" class="callout-89-contents callout-collapse collapse">
<section id="mathematical-foundations-iii" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="mathematical-foundations-iii">Mathematical Foundations (III)</h3>
<p><strong>Definition</strong>: The <strong>multiplicative group of <span class="math inline">\(\mathbb{Z}_n\)</span></strong>, denoted <span class="math inline">\(\mathbb{Z}_n^*\)</span> is:</p>
<p><span class="math display">\[\mathbb{Z}_n^* = \{a \in \mathbb{Z}_n \mid \text{gcd}(a,n) = 1\}\]</span></p>
<p>In particular, if <span class="math inline">\(n\)</span> is prime: <span class="math inline">\(\mathbb{Z}_n^* = \{a \mid 1 \leq a \leq n-1\}\)</span></p>
<p>The <strong>number of elements or order</strong> of the multiplicative group <span class="math inline">\(\mathbb{Z}_n^*\)</span> is <span class="math inline">\(\phi(n)\)</span> (by definition of <span class="math inline">\(\phi\)</span>).</p>
<p><strong>Definition</strong>: Let <span class="math inline">\(a \in \mathbb{Z}_n\)</span>, the <strong>order of <span class="math inline">\(a\)</span></strong> is the smallest positive integer <span class="math inline">\(t\)</span> for which:</p>
<p><span class="math display">\[a^t \equiv 1 \pmod{n}\]</span></p>
<p><strong>Definition</strong>: Let <span class="math inline">\(\alpha \in \mathbb{Z}_n^*\)</span>, if the order of <span class="math inline">\(\alpha\)</span> is <span class="math inline">\(\phi(n)\)</span>, then <span class="math inline">\(\alpha\)</span> is a <strong>generator of <span class="math inline">\(\mathbb{Z}_n^*\)</span></strong>. When a group <span class="math inline">\(\mathbb{Z}_n^*\)</span> has a generator, it is said to be <strong>cyclic</strong>.</p>
<p><strong>Properties of generators</strong>:</p>
<ul>
<li><p><span class="math inline">\(\mathbb{Z}_n^*\)</span> has a generator iff <span class="math inline">\(n = 2, 4, p^k\)</span> or <span class="math inline">\(2p^k\)</span>, with <span class="math inline">\(p\)</span> prime, <span class="math inline">\(p \neq 2\)</span> and <span class="math inline">\(k \geq 1\)</span>. In particular, if <span class="math inline">\(p\)</span> is prime, <span class="math inline">\(\mathbb{Z}_p^*\)</span> has a generator.</p></li>
<li><p>If <span class="math inline">\(\alpha\)</span> is a generator of <span class="math inline">\(\mathbb{Z}_n^*\)</span>, then all elements of <span class="math inline">\(\mathbb{Z}_n^*\)</span> can be written as: <span class="math display">\[\mathbb{Z}_n^* = \{\alpha^i \bmod n \mid 0 \leq i \leq \phi(n)-1\}\]</span></p></li>
<li><p>The number of generators of <span class="math inline">\(\mathbb{Z}_n^*\)</span> is <span class="math inline">\(\phi(\phi(n))\)</span>.</p></li>
<li><p><span class="math inline">\(\alpha\)</span> is a generator of <span class="math inline">\(\mathbb{Z}_n^*\)</span> iff for every prime <span class="math inline">\(p\)</span> dividing <span class="math inline">\(\phi(n)\)</span>, we have: <span class="math display">\[\alpha^{\phi(n)/p} \not\equiv 1 \pmod{n}\]</span></p></li>
</ul>
<p>In particular if <span class="math inline">\(n\)</span> is a prime of the form <span class="math inline">\(n = 2p+1\)</span> with <span class="math inline">\(p\)</span> prime (such <span class="math inline">\(n\)</span> is called a <strong>safe prime</strong>), <span class="math inline">\(\alpha\)</span> is a generator of <span class="math inline">\(\mathbb{Z}_n^*\)</span> iff <span class="math inline">\(\alpha^2 \not\equiv 1 \pmod{n}\)</span> and <span class="math inline">\(\alpha^p \not\equiv 1 \pmod{n}\)</span>.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-90-contents" aria-controls="callout-90" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-90" class="callout-90-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong><span class="math inline">\(\mathbb{Z}_n^*\)</span></strong>: elements coprime with <span class="math inline">\(n\)</span>, cardinality = <span class="math inline">\(\phi(n)\)</span></li>
<li><strong>Generator</strong>: element of order <span class="math inline">\(\phi(n)\)</span> (generates the entire group)</li>
<li><strong>Crucial for DH and ElGamal</strong>: security based on discrete logarithm in cyclic group</li>
<li><strong>Safe prime</strong>: <span class="math inline">\(n = 2p+1\)</span> with <span class="math inline">\(p\)</span> and <span class="math inline">\(n\)</span> prime</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="fast-exponentiation" class="level3">
<h3 class="anchored" data-anchor-id="fast-exponentiation">Fast Exponentiation</h3>
<p>Efficient computation of <span class="math inline">\(a^k \bmod n\)</span> in polynomial time, essential for all asymmetric algorithms.</p>
<p><strong>Principle</strong>: Use the binary representation of the exponent <span class="math inline">\(k\)</span>.</p>
<p><strong>Example</strong>: Computation of <span class="math inline">\(2^{644} \bmod 645\)</span></p>
<ol type="1">
<li><p>Binary representation: <span class="math inline">\((644)_{10} = (1010000100)_2\)</span></p></li>
<li><p>Compute successive powers of 2 modulo 645:</p>
<ul>
<li><span class="math inline">\(2^1 \bmod 645\)</span></li>
<li><span class="math inline">\(2^2 \bmod 645\)</span></li>
<li><span class="math inline">\(2^4 \bmod 645\)</span></li>
<li><span class="math inline">\(2^8 \bmod 645\)</span></li>
<li>…</li>
<li><span class="math inline">\(2^{512} \bmod 645\)</span></li>
</ul></li>
<li><p>Combine according to bits set to 1: <span class="math inline">\(2^{644} = 2^{512} \cdot 2^{128} \cdot 2^4\)</span></p></li>
</ol>
<p><strong>Complexity</strong>: <span class="math inline">\(O(\log^3 n)\)</span> - very efficient!</p>
<p><strong>Application</strong>: Computation of the inverse using Euler’s theorem in polynomial time.</p>
<p>Alternative: <strong>Extended Euclidean algorithm</strong> to find <span class="math inline">\(x\)</span> such that <span class="math inline">\(ax \equiv 1 \pmod{n}\)</span> by solving <span class="math inline">\(ax - kn = 1 = \text{gcd}(a,n)\)</span>. Complexity also <span class="math inline">\(O(\log^3 n)\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-91-contents" aria-controls="callout-91" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-91" class="callout-91-contents callout-collapse collapse">
<section id="fast-exponentiation-1" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="fast-exponentiation-1">Fast Exponentiation</h3>
<p><strong>Fast exponentiation</strong>: Using the binary representation of a number, we can compute powers very efficiently.</p>
<p><strong>Example</strong>: computation of <span class="math inline">\(2^{644} \bmod 645\)</span></p>
<p><span class="math inline">\((644)_{10} = (1010000100)_2\)</span></p>
<p>Now, we compute the exponents corresponding to the powers of 2, namely:</p>
<p><span class="math display">\[2^1 \bmod 645, \quad 2^2 \bmod 645, \quad 2^4 \bmod 645, \quad \ldots, \quad 2^{512} \bmod 645\]</span></p>
<p>From the binary representation, we compute:</p>
<p><span class="math display">\[2^{644} = 2^{512+128+4} = 2^{512} \cdot 2^{128} \cdot 2^4 = 160 \cdot 153 \cdot 6 \bmod 645\]</span></p>
<p><strong>The complexity of this algorithm</strong> fast exponentiation is <span class="math inline">\(O(\log^3 n)\)</span>.</p>
<p>By relying on <strong>Euler’s theorem</strong>, the computation of the <strong>inverse of a number</strong> in such a group is therefore performed in polynomial time.</p>
<p><strong>The extended Euclidean algorithm</strong> can also be used to find an <span class="math inline">\(x\)</span> such that:</p>
<p><span class="math display">\[ax \equiv 1 \pmod{n}\]</span></p>
<p>since this congruence can be written as: <span class="math inline">\(ax - 1 = kn\)</span> and therefore:</p>
<p><span class="math display">\[ax - kn = 1 = \text{gcd}(a,n)\]</span></p>
<p>The complexity of this algorithm is also <span class="math inline">\(O(\log^3 n)\)</span>.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-92-contents" aria-controls="callout-92" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-92" class="callout-92-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Idea</strong>: binary representation of the exponent</li>
<li><strong>Complexity</strong>: <span class="math inline">\(O(\log^3 n)\)</span> - polynomial!</li>
<li><strong>Essential</strong>: makes RSA, ElGamal, DH practical</li>
<li><strong>Alternative</strong>: extended Euclidean algorithm for inverses</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="chinese-remainder-theorem-crt" class="level3">
<h3 class="anchored" data-anchor-id="chinese-remainder-theorem-crt">Chinese Remainder Theorem (CRT)</h3>
<p>The CRT allows solving systems of simultaneous congruences, with important applications in cryptography.</p>
<p><strong>Theorem</strong>: Let <span class="math inline">\(n_1, n_2, \ldots, n_t \in \mathbb{Z}^+\)</span> pairwise coprime (gcd<span class="math inline">\((n_i, n_j) = 1\)</span> if <span class="math inline">\(i \neq j\)</span>) and <span class="math inline">\(a_1, a_2, \ldots, a_t \in \mathbb{Z}\)</span>. Then the system:</p>
<p><span class="math display">\[\begin{cases}
x \equiv a_1 \pmod{n_1} \\
x \equiv a_2 \pmod{n_2} \\
\vdots \\
x \equiv a_t \pmod{n_t}
\end{cases}\]</span></p>
<p>has a unique solution <span class="math inline">\(x \bmod N\)</span> with <span class="math inline">\(N := n_1 \cdot n_2 \cdots n_t\)</span>.</p>
<p><strong>Gauss’s algorithm</strong> (1801) to compute <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[x = \sum_{i=1}^{t} a_i N_i M_i \bmod N\]</span></p>
<p>with:</p>
<ul>
<li><span class="math inline">\(N_i = N/n_i\)</span></li>
<li><span class="math inline">\(M_i = N_i^{-1} \bmod n_i\)</span> (modular inverse)</li>
</ul>
<p><strong>Complexity</strong>: <span class="math inline">\(O(\log^3 n)\)</span> - polynomial!</p>
<p><strong>Cryptographic applications</strong>:</p>
<ol type="1">
<li>Acceleration of RSA computations (use <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> separately)</li>
<li>Secret sharing (secret sharing schemes)</li>
<li>Certain attacks on RSA (if small exponent and multiple messages)</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-93-contents" aria-controls="callout-93" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-93" class="callout-93-contents callout-collapse collapse">
<section id="chinese-remainder-theorem" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="chinese-remainder-theorem">Chinese Remainder Theorem</h3>
<p>The <strong>Chinese Remainder Theorem</strong> (3rd century!) allows solving linear systems of simultaneous congruences. It solves problems raised in ancient Chinese puzzles. It was, for example, about finding a number that produces a remainder of 1 when divided by 3, of 2 when divided by 5 and of 3 when divided by 7… It was also used to calculate the exact moment of alignment of several celestial bodies having different orbits (and therefore periods).</p>
<p><strong>Chinese Remainder Theorem</strong>: Let <span class="math inline">\(n_1, n_2, \ldots, n_t \in \mathbb{Z}^+\)</span> be pairwise coprime (i.e., gcd<span class="math inline">\((n_i, n_j) = 1\)</span>, <span class="math inline">\(\forall i \neq j\)</span>) and <span class="math inline">\(a_1, a_2, \ldots, a_t \in \mathbb{Z}\)</span>. Then, the system of congruences:</p>
<p><span class="math display">\[\begin{cases}
x \equiv a_1 \pmod{n_1} \\
x \equiv a_2 \pmod{n_2} \\
\vdots \\
x \equiv a_t \pmod{n_t}
\end{cases}\]</span></p>
<p>has a unique solution <span class="math inline">\(x \bmod N := n_1 n_2 \cdots n_t\)</span></p>
<p><strong>Gauss’s algorithm</strong> (1801) for the computation of <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[x = \sum_{i=1}^{t} a_i N_i M_i \bmod N\]</span></p>
<p>with <span class="math inline">\(N_i = N/n_i\)</span> and <span class="math inline">\(M_i = N_i^{-1} \bmod n_i\)</span>.</p>
<p>The <strong>complexity</strong> of this algorithm is <span class="math inline">\(O(\log^3 n)\)</span>.</p>
<p>It is therefore possible in <strong>polynomial time</strong> to go from congruences mod <span class="math inline">\(n_i\)</span> to congruences mod <span class="math inline">\(N\)</span>!</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-94-contents" aria-controls="callout-94" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-94" class="callout-94-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Solves</strong>: systems of congruences with pairwise coprime moduli</li>
<li><strong>Unique solution</strong>: modulo product of moduli</li>
<li><strong>Complexity</strong>: <span class="math inline">\(O(\log^3 n)\)</span> (polynomial)</li>
<li><strong>Crypto usage</strong>: RSA optimization, attacks if small exponent</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="basic-problems-and-complexity" class="level2">
<h2 class="anchored" data-anchor-id="basic-problems-and-complexity">Basic Problems and Complexity</h2>
<section id="classification-of-hard-problems" class="level3">
<h3 class="anchored" data-anchor-id="classification-of-hard-problems">Classification of Hard Problems</h3>
<p>The security of asymmetric cryptography relies on mathematical problems reputed to be hard:</p>
<p><strong>Generic problems</strong>:</p>
<ol type="1">
<li><strong>Factorization (FACTP)</strong>: Given <span class="math inline">\(n\)</span>, find its factorization into prime numbers
<ul>
<li>Base of <strong>RSA</strong> and <strong>Rabin</strong></li>
</ul></li>
<li><strong>Discrete Logarithms (DLP)</strong>: Given prime <span class="math inline">\(p\)</span>, a generator <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span> and <span class="math inline">\(\beta \in \mathbb{Z}_p^*\)</span>, find <span class="math inline">\(x\)</span> such that: <span class="math display">\[\alpha^x \equiv \beta \pmod{p}\]</span>
<ul>
<li>Base of <strong>ElGamal</strong> and <strong>Diffie-Hellman</strong></li>
</ul></li>
<li><strong>Square Root modulo composite (SQROOTP)</strong>: Given composite <span class="math inline">\(n\)</span> and a quadratic residue <span class="math inline">\(a\)</span>, find <span class="math inline">\(\sqrt{a} \bmod n\)</span>
<ul>
<li>Base of <strong>Rabin</strong></li>
</ul></li>
</ol>
<p><strong>Specific problems</strong>:</p>
<ol type="1">
<li><p><strong>RSA Problem (RSAP)</strong>: Given <span class="math inline">\(n = pq\)</span>, <span class="math inline">\(e\)</span> with gcd<span class="math inline">\((e, \phi(n)) = 1\)</span> and <span class="math inline">\(c\)</span>, find <span class="math inline">\(m\)</span> such that <span class="math inline">\(m^e \equiv c \pmod{n}\)</span></p></li>
<li><p><strong>Diffie-Hellman Problem (DHP)</strong>: Given prime <span class="math inline">\(p\)</span>, generator <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\alpha^a \bmod p\)</span> and <span class="math inline">\(\alpha^b \bmod p\)</span>, find <span class="math inline">\(\alpha^{ab} \bmod p\)</span></p></li>
</ol>
<p><strong>Proven equivalences</strong>:</p>
<ul>
<li><strong>DHP ⟺ DLP</strong> (equivalent under certain conditions)</li>
<li><strong>RSAP ⟺ FACTP</strong> (proven equivalent for the generic case)</li>
<li><strong>SQROOTP ⟺ FACTP</strong></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-95-contents" aria-controls="callout-95" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-95" class="callout-95-contents callout-collapse collapse">
<section id="basic-problems" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="basic-problems">Basic Problems</h3>
<p><strong>Main generic problems</strong>:</p>
<ul>
<li><p><strong>Factorization (FACTP)</strong>: Given a positive integer <span class="math inline">\(n\)</span>, find its factorization into prime numbers.</p></li>
<li><p><strong>Discrete Logarithms (DLP)</strong>: Given a prime number <span class="math inline">\(p\)</span>, a generator <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span> and an element <span class="math inline">\(\beta \in \mathbb{Z}_p^*\)</span>, find the integer <span class="math inline">\(x\)</span>, <span class="math inline">\(0 \leq x \leq p-2\)</span>, such that: <span class="math inline">\(\alpha^x \equiv \beta \pmod{p}\)</span>.</p></li>
<li><p><strong>Square Root in <span class="math inline">\(\mathbb{Z}_n\)</span> if <span class="math inline">\(n\)</span> is composite (SQROOTP)</strong>: Given a composite integer <span class="math inline">\(n\)</span> and a quadratic residue <span class="math inline">\(a\)</span>, find the square root of <span class="math inline">\(a\)</span> mod <span class="math inline">\(n\)</span>.</p></li>
</ul>
<p><strong>Specific problems</strong> (proper to an encryption system):</p>
<ul>
<li><p><strong>RSA (RSAP)</strong>: Given a positive integer <span class="math inline">\(n = pq\)</span>, a positive integer <span class="math inline">\(e\)</span> with gcd<span class="math inline">\((e, (p-1)(q-1)) = 1\)</span> and an integer <span class="math inline">\(c\)</span>, find an integer <span class="math inline">\(m\)</span> with <span class="math inline">\(m^e \equiv c \pmod{n}\)</span>.</p></li>
<li><p><strong>Diffie-Hellman (DHP)</strong>: Given a prime number <span class="math inline">\(p\)</span>, a generator <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span> and the elements <span class="math inline">\(\alpha^a \bmod p\)</span> and <span class="math inline">\(\alpha^b \bmod p\)</span>, find <span class="math inline">\(\alpha^{ab} \bmod p\)</span>.</p></li>
</ul>
<p><strong>Proven results</strong>:</p>
<ul>
<li><strong>DHP ⟺ DLP</strong> (Equivalent under certain conditions)</li>
<li><strong>RSAP ⟺ FACTP</strong> (Proven equivalent for the generic problem)</li>
<li><strong>SQROOTP ⟺ FACTP</strong></li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-96-contents" aria-controls="callout-96" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-96" class="callout-96-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>FACTP</strong>: factor <span class="math inline">\(n\)</span> → base of RSA/Rabin</li>
<li><strong>DLP</strong>: find discrete logarithm → base ElGamal/DH</li>
<li><strong>SQROOTP</strong>: square root mod composite → Rabin</li>
<li><strong>Equivalences</strong>: breaking = solving the base problem</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="factorization-techniques" class="level3">
<h3 class="anchored" data-anchor-id="factorization-techniques">Factorization Techniques</h3>
<p>The security of RSA depends on the difficulty of factoring large numbers.</p>
<p><strong>Exponential time methods</strong>: <span class="math inline">\(O(\exp(c \cdot \ln(n)))\)</span></p>
<ul>
<li>Trial Division (successive division)</li>
<li>Sieve of Eratosthenes (2nd century BC)</li>
<li>Fermat’s Method (~1650)</li>
<li>Pollard’s <span class="math inline">\(\rho\)</span> Method (1975)</li>
<li>Pollard’s <span class="math inline">\(p-1\)</span> Method (1974)</li>
</ul>
<p><strong>Sub-exponential time methods</strong>: <span class="math inline">\(O(\exp(c \cdot (\ln(n))^{1/3}))\)</span></p>
<ul>
<li>Continued Fractions (1975)</li>
<li><strong>Quadratic Sieve (1981)</strong> - very effective in practice</li>
<li><strong>Number Field Sieve - NFS (1990)</strong> - currently the fastest</li>
<li>General Number Field Sieve - GNFS (2006)</li>
</ul>
<p><strong>Polynomial time methods</strong>:</p>
<ul>
<li><strong>Shor’s Algorithm</strong> (1994): <span class="math inline">\(O(\log^c n)\)</span> on <strong>quantum computer</strong></li>
</ul>
<p><strong>Current records (2020)</strong>:</p>
<ul>
<li>Largest number factored: <strong>RSA-829</strong> (250 digits, 829 bits)</li>
<li>Computation time: 2700 core-years (Intel Xeon Gold 6130 CPUs)</li>
<li>Method: General Number Field Sieve</li>
</ul>
<p><strong>Implications</strong>:</p>
<ul>
<li>RSA keys &lt; 1024 bits: <strong>vulnerable</strong></li>
<li>RSA keys 1024 bits: <strong>limits</strong> (states with significant resources)</li>
<li>Recommendation: <strong>2048 bits minimum</strong> (3072-4096 for long term)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-97-contents" aria-controls="callout-97" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-97" class="callout-97-contents callout-collapse collapse">
<section id="classical-factoring-techniques-and-new-developments" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="classical-factoring-techniques-and-new-developments">Classical Factoring Techniques and New Developments</h3>
<p><strong>Exponential time</strong>: <span class="math inline">\(O(\exp(c \cdot \ln(n)))\)</span></p>
<ul>
<li>Trial Division</li>
<li>Eratosthenes’ Sieve (II B.C.)</li>
<li>Fermat’s Difference of Squares Method (~1650)</li>
<li>Square Form Factorization (1971)</li>
<li>Pollard’s p-1 method (1974)</li>
<li>Pollard’s Rho Method (1975)</li>
</ul>
<p><strong>Sub-exponential time</strong>: <span class="math inline">\(O(\exp(c \cdot (\ln(n))^{1/3}))\)</span></p>
<ul>
<li>Continued Fractions (1975)</li>
<li><strong>Quadratic Sieve (1981)</strong></li>
<li><strong>Number Field Sieve - NFS (1990)</strong></li>
<li><strong>General Number Field Sieve - GNFS (2006)</strong></li>
</ul>
<p><strong>Polynomial time</strong>:</p>
<ul>
<li><strong>Shor’s Algorithm in a Quantum Computer (1994)</strong>: <span class="math inline">\(O(\log^c n)\)</span></li>
</ul>
<p><strong>Recent developments</strong>:</p>
<ul>
<li>Bernstein’s specific NFS computer to factor a 1536-bit number would take the same time as a 512-bit computation on a conventional machine</li>
<li><strong>Largest factorization to date (2020)</strong>: RSA-829 (250-digit number) using NFS</li>
<li>Total computation time: <strong>2700 core-years</strong> (Intel Xeon Gold 6130 CPUs at 2.1GHz)</li>
</ul>
<p><strong>Factorization on quantum computer</strong>:</p>
<ul>
<li>Significant problems (errors, dispersion, etc.)</li>
<li>2001: 7-qubit computer (IBM Almaden)</li>
<li>Feasibility of a computer with millions of qubits… ?</li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-98-contents" aria-controls="callout-98" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-98" class="callout-98-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Sub-exponential</strong>: NFS currently the fastest</li>
<li><strong>Record 2020</strong>: RSA-829 (829 bits) in 2700 core-years</li>
<li><strong>Recommendation</strong>: keys ≥ 2048 bits for RSA</li>
<li><strong>Future threat</strong>: quantum computers (Shor)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="the-rsa-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="the-rsa-algorithm">The RSA Algorithm</h2>
<section id="rsa-operation-encryptiondecryption" class="level3">
<h3 class="anchored" data-anchor-id="rsa-operation-encryptiondecryption">RSA Operation (Encryption/Decryption)</h3>
<p>RSA (Rivest-Shamir-Adleman, 1978) is the most used asymmetric algorithm.</p>
<p><strong>Key generation</strong>:</p>
<ol type="1">
<li>Choose two <strong>large</strong> prime numbers <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (≥ 1024 bits each)</li>
<li>Compute <span class="math inline">\(n := p \cdot q\)</span> and <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span></li>
<li>Choose encryption exponent <span class="math inline">\(e\)</span> with:
<ul>
<li><span class="math inline">\(1 &lt; e &lt; \phi(n)\)</span></li>
<li>gcd<span class="math inline">\((e, \phi(n)) = 1\)</span></li>
</ul></li>
<li>Compute decryption exponent <span class="math inline">\(d\)</span> such that: <span class="math display">\[e \cdot d \equiv 1 \pmod{\phi(n)}\]</span> (using extended Euclidean algorithm or fast exponentiation)</li>
</ol>
<p><strong>Resulting keys</strong>:</p>
<ul>
<li><strong>Public</strong> key: <span class="math inline">\((n, e)\)</span></li>
<li><strong>Private</strong> key: <span class="math inline">\(d\)</span> (keep <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> secret too!)</li>
</ul>
<p><strong>Encryption</strong> (by Bob, to Alice):</p>
<ol type="1">
<li>Obtain authentic public key <span class="math inline">\((n, e)\)</span> of Alice</li>
<li>Transform plaintext into integers <span class="math inline">\(m_i \in [0, n-1]\)</span></li>
<li>Compute ciphertexts: <span class="math inline">\(c_i := m_i^e \bmod n\)</span></li>
<li>Send the <span class="math inline">\(c_i\)</span> to Alice</li>
</ol>
<p><strong>Decryption</strong> (by Alice):</p>
<ul>
<li>Use private key <span class="math inline">\(d\)</span> to compute: <span class="math display">\[m_i = c_i^d \bmod n\]</span></li>
</ul>
<p><strong>Proof of operation</strong>:</p>
<p><span class="math display">\[c^d \equiv (m^e)^d \equiv m^{ed} \pmod{n}\]</span></p>
<p>Since <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span>, there exists <span class="math inline">\(k\)</span> such that <span class="math inline">\(ed = 1 + k\phi(n)\)</span>, therefore:</p>
<p><span class="math display">\[c^d \equiv m^{1+k\phi(n)} \equiv m \cdot (m^{\phi(n)})^k \equiv m \cdot 1^k \equiv m \pmod{n}\]</span></p>
<p>(by Euler’s theorem)</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-99-contents" aria-controls="callout-99" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-99" class="callout-99-contents callout-collapse collapse">
<section id="rsa-encryptiondecryption-procedure-and-proof" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="rsa-encryptiondecryption-procedure-and-proof">RSA Encryption/Decryption Procedure and Proof</h3>
<p><strong>Key generation</strong>:</p>
<ul>
<li>Each entity (A) creates a key pair (public and private) as follows:
<ul>
<li>A chooses the size of the modulus <span class="math inline">\(n\)</span> (e.g., size<span class="math inline">\((n) = 1024\)</span> or size<span class="math inline">\((n) = 2048\)</span>).</li>
<li>A generates two prime numbers <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> of large size <span class="math inline">\((n/2)\)</span>.</li>
<li>A computes <span class="math inline">\(n := pq\)</span> and <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span>.</li>
<li>A generates the encryption exponent <span class="math inline">\(e\)</span>, with <span class="math inline">\(1 &lt; e &lt; \phi(n)\)</span> such that gcd<span class="math inline">\((e, \phi(n)) = 1\)</span>.</li>
<li>A computes the decryption exponent <span class="math inline">\(d\)</span>, such that: <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span> using the extended Euclidean algorithm or fast exponentiation.</li>
</ul></li>
<li>The pair <span class="math inline">\((n,e)\)</span> is A’s <strong>public</strong> key; <span class="math inline">\(d\)</span> is A’s <strong>private</strong> key.</li>
</ul>
<p><strong>Encryption</strong>:</p>
<ul>
<li>Entity B obtains <span class="math inline">\((n,e)\)</span>, the <strong>authentic</strong> public key of A.</li>
<li>B transforms its plaintext into a series of integers <span class="math inline">\(m_i\)</span>, such that <span class="math inline">\(m_i \in [0, n-1]\)</span> <span class="math inline">\(\forall i\)</span>.</li>
<li>B computes the ciphertext <span class="math inline">\(c_i := m_i^e \bmod n\)</span>, <span class="math inline">\(\forall i\)</span> using fast exponentiation.</li>
<li>B sends to A all the ciphertexts <span class="math inline">\(c_i\)</span>.</li>
</ul>
<p><strong>Decryption</strong>:</p>
<ul>
<li>A uses its private key to compute the plaintexts <span class="math inline">\(m_i = c_i^d \bmod n\)</span>.</li>
</ul>
<p><strong>Proof</strong>: Let <span class="math inline">\(m\)</span> be the plaintext and <span class="math inline">\(c\)</span> the ciphertext with <span class="math inline">\(c := m^e \bmod n\)</span>, we need to prove: <span class="math inline">\(m \stackrel{!}{=} c^d \bmod n\)</span></p>
<p>Substituting <span class="math inline">\(c\)</span> by its value we obtain: <span class="math display">\[c^d \bmod n = m^{ed} \bmod n \quad (*)\]</span></p>
<p>but, we know that: <span class="math display">\[ed \equiv 1 \pmod{\phi(n)}\]</span></p>
<p>and therefore by definition of congruences, there exists an integer <span class="math inline">\(k\)</span> with: <span class="math display">\[ed - 1 = k\phi(n)\]</span></p>
<p>substituting in (*): <span class="math display">\[c^d \equiv m^{k\phi(n)+1} \equiv m^{k\phi(n)} \cdot m \pmod{n}\]</span></p>
<p>If gcd<span class="math inline">\((m,n) = 1\)</span>, we have by <strong>Euler’s theorem</strong>: <span class="math display">\[m^{\phi(n)} \equiv 1 \pmod{n}\]</span></p>
<p>therefore: <span class="math display">\[c^d \equiv (m^{\phi(n)})^k \cdot m \equiv m \pmod{n}\]</span> Q.E.D. !</p>
<p>If gcd<span class="math inline">\((m,n) \neq 1\)</span>, <span class="math inline">\(m\)</span> is necessarily a multiple of <span class="math inline">\(p\)</span> or <span class="math inline">\(q\)</span> (very unlikely case…), we can show by doing the calculations mod <span class="math inline">\(p\)</span> and mod <span class="math inline">\(q\)</span> that the congruence remains true.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-100-contents" aria-controls="callout-100" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-100" class="callout-100-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Public key</strong>: <span class="math inline">\((n, e)\)</span> with <span class="math inline">\(n = pq\)</span></li>
<li><strong>Private key</strong>: <span class="math inline">\(d\)</span> such that <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span></li>
<li><strong>Encryption</strong>: <span class="math inline">\(c = m^e \bmod n\)</span></li>
<li><strong>Decryption</strong>: <span class="math inline">\(m = c^d \bmod n\)</span></li>
<li><strong>Security</strong>: based on difficulty of factoring <span class="math inline">\(n\)</span></li>
</ul>
</div>
</div>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Plaintext m] --&gt;|Encryption: m^e mod n| B[Ciphertext c]
    B --&gt;|Decryption: c^d mod n| C[Plaintext m]
    D[Public key: n, e] -.-&gt;|used for| A
    E[Private key: d] -.-&gt;|used for| B
    F[p, q secret primes] --&gt;|n = pq| D
    F --&gt;|φn = p-1q-1| E
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
<section id="rsa-security" class="level3">
<h3 class="anchored" data-anchor-id="rsa-security">RSA Security</h3>
<p><strong>Equivalence RSA problem ⟺ Factorization</strong>:</p>
<ul>
<li>Finding <span class="math inline">\(d\)</span> ⟺ factoring <span class="math inline">\(n\)</span> (proven equivalent)</li>
<li>Decrypting without <span class="math inline">\(d\)</span> is <strong>not proven</strong> as hard as factoring, but…</li>
<li>No method faster than factoring is known</li>
</ul>
<p><strong>Factorization complexity</strong>:</p>
<ul>
<li>Fastest methods: <span class="math inline">\(O(\exp(c \cdot (\ln(n))^{1/3}))\)</span> (sub-exponential)</li>
<li>Computationally impossible for <span class="math inline">\(n \geq 1024\)</span> bits</li>
<li><strong>Current recommendation</strong>: 2048 bits minimum (3072-4096 for long-term security)</li>
</ul>
<p><strong>Choice of exponents</strong>:</p>
<ul>
<li><p><strong>Encryption exponent <span class="math inline">\(e\)</span></strong>:</p>
<ul>
<li>Often <strong>small</strong> for speed: <span class="math inline">\(e = 3, 17, 65537\)</span> (common)</li>
<li>Caution: if <span class="math inline">\(e\)</span> too small AND <span class="math inline">\(m &lt; n^{1/e}\)</span>, attack possible (<span class="math inline">\(e\)</span>-th root in <span class="math inline">\(\mathbb{Z}\)</span>)</li>
<li>Solution: <strong>randomization</strong> (padding) of the message</li>
</ul></li>
<li><p><strong>Decryption exponent <span class="math inline">\(d\)</span></strong>:</p>
<ul>
<li>Must be <strong>large</strong>: at least half the size of <span class="math inline">\(n\)</span></li>
<li>If <span class="math inline">\(d\)</span> small: vulnerable to Wiener’s attack</li>
</ul></li>
</ul>
<p><strong>Performance consequence</strong>:</p>
<ul>
<li><strong>Fast encryption</strong> (<span class="math inline">\(e\)</span> small)</li>
<li><strong>Slow decryption</strong> (<span class="math inline">\(d\)</span> large)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-101-contents" aria-controls="callout-101" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-101" class="callout-101-contents callout-collapse collapse">
<section id="rsa-security-1" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="rsa-security-1">RSA: Security</h3>
<p>The <strong>RSAP</strong> problem of finding <span class="math inline">\(m\)</span> from <span class="math inline">\(c\)</span> is not proven to be as hard as factorization but…:</p>
<ul>
<li><p>We can prove that if we find <span class="math inline">\(d\)</span> we can easily compute <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. This is equivalent to saying that <strong>factoring <span class="math inline">\(n\)</span> and finding <span class="math inline">\(d\)</span> require equivalent computational effort</strong>.</p></li>
<li><p>We know that the fastest methods for factoring have a <strong>sub-exponential complexity</strong> <span class="math inline">\(O(\exp(c \cdot (\ln(n))^{1/3}))\)</span>. The problem therefore remains <strong>computationally impossible</strong> for modulus <span class="math inline">\(\geq 1048\)</span> bits (2048 bits is a frequent choice for long-term security…).</p></li>
<li><p>To improve encryption speed, we tend to choose <strong>relatively small exponents <span class="math inline">\(e\)</span></strong> (typically: <span class="math inline">\(e := 3\)</span>, <span class="math inline">\(e := 17\)</span> and <span class="math inline">\(e := 19\)</span>). However, it has been proven that computing an <span class="math inline">\(i\)</span>-th root (with small <span class="math inline">\(i\)</span>) modulo a composite <span class="math inline">\(n\)</span> can be significantly easier than factoring <span class="math inline">\(n\)</span>. On the other hand, in 2008 it was proven that the generic RSA problem is equivalent to factorization.</p></li>
<li><p>The <strong>decryption exponent <span class="math inline">\(d\)</span> must imperatively be large</strong> (at least half the size of <span class="math inline">\(n\)</span>) to guarantee the system’s security.</p></li>
<li><p>Consequently, <strong>encryption is normally significantly faster than decryption</strong> since the exponents used are much smaller!</p></li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-102-contents" aria-controls="callout-102" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-102" class="callout-102-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Security</strong>: based on difficulty of FACTP (factorization)</li>
<li><strong>Recommended size</strong>: <span class="math inline">\(n \geq 2048\)</span> bits</li>
<li><strong>Small <span class="math inline">\(e\)</span></strong>: fast encryption (3, 17, 65537)</li>
<li><strong>Large <span class="math inline">\(d\)</span></strong>: at least <span class="math inline">\(\text{size}(n)/2\)</span></li>
<li><strong>Separate keys</strong>: encryption ≠ signature</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="attacks-on-rsa" class="level3">
<h3 class="anchored" data-anchor-id="attacks-on-rsa">Attacks on RSA</h3>
<section id="attack-on-small-exponent-with-same-message" class="level4">
<h4 class="anchored" data-anchor-id="attack-on-small-exponent-with-same-message">Attack on small exponent with same message</h4>
<p>If the same message <span class="math inline">\(m\)</span> is sent to 3 recipients with <span class="math inline">\(e = 3\)</span>:</p>
<ul>
<li><span class="math inline">\(c_1 \equiv m^3 \pmod{n_1}\)</span></li>
<li><span class="math inline">\(c_2 \equiv m^3 \pmod{n_2}\)</span></li>
<li><span class="math inline">\(c_3 \equiv m^3 \pmod{n_3}\)</span></li>
</ul>
<p>The <strong>Chinese Remainder Theorem</strong> gives a unique solution <span class="math inline">\(x \bmod n_1n_2n_3\)</span> such that: <span class="math display">\[x \equiv c_1 \pmod{n_1}, \quad x \equiv c_2 \pmod{n_2}, \quad x \equiv c_3 \pmod{n_3}\]</span></p>
<p>If <span class="math inline">\(m^3 &lt; n_1n_2n_3\)</span> (often true), then <span class="math inline">\(x = m^3\)</span> in <span class="math inline">\(\mathbb{Z}\)</span> and we can compute <span class="math inline">\(m\)</span> by simply taking the integer cube root!</p>
<p><strong>Protection</strong>: always randomize the message before encryption (OAEP padding)</p>
</section>
<section id="attack-if-message-small" class="level4">
<h4 class="anchored" data-anchor-id="attack-if-message-small">Attack if message small</h4>
<p>If <span class="math inline">\(m &lt; n^{1/e}\)</span>, then <span class="math inline">\(m^e &lt; n\)</span>, so <span class="math inline">\(c = m^e\)</span> (in <span class="math inline">\(\mathbb{Z}\)</span>, not modulo). We can directly compute the <span class="math inline">\(e\)</span>-th root!</p>
<p><strong>Protection</strong>: padding mandatory</p>
</section>
<section id="multiplicative-property" class="level4">
<h4 class="anchored" data-anchor-id="multiplicative-property">Multiplicative property</h4>
<p><span class="math display">\[E(m_1) \cdot E(m_2) \equiv (m_1 \cdot m_2)^e \equiv E(m_1 \cdot m_2) \pmod{n}\]</span></p>
<p>Allows chosen-ciphertext attacks and blind signatures.</p>
</section>
<section id="general-attack" class="level4">
<h4 class="anchored">General attack</h4>
<p>The most effective method remains <strong>factoring <span class="math inline">\(n\)</span></strong> (if parameters well chosen and implementation correct).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-103-contents" aria-controls="callout-103" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-103" class="callout-103-contents callout-collapse collapse">
<section id="rsa-attacks" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="rsa-attacks">RSA: Attacks</h3>
<p>When we want to encrypt the <strong>same message for a group of correspondents</strong>, it is advisable to introduce variations (<strong>randomization</strong>) before encryption to avoid the following attack:</p>
<p>Assume we compute ciphertexts <span class="math inline">\(c_1, c_2, c_3\)</span> from the same plaintext <span class="math inline">\(m\)</span> and the same exponent <span class="math inline">\(e := 3\)</span> addressed to three entities with modulus: <span class="math inline">\(n_1, n_2, n_3\)</span>.</p>
<p>The <strong>Chinese Remainder Theorem</strong> tells us that there exists a solution <span class="math inline">\(x \bmod n_1n_2n_3\)</span>, such that: <span class="math display">\[x \equiv c_1 \pmod{n_1}, \quad x \equiv c_2 \pmod{n_2}, \quad x \equiv c_3 \pmod{n_3}\]</span></p>
<p>But if <span class="math inline">\(m\)</span> does not change for the three encryptions, we have that <span class="math inline">\(x = m^3 \bmod n_1n_2n_3\)</span> and, moreover: <span class="math inline">\(m^3 &lt; n_1n_2n_3\)</span>. We can, therefore, find <span class="math inline">\(m\)</span> by computing the <strong>integer cube root</strong> of <span class="math inline">\(m^3\)</span>, knowing that for this calculation there exist efficient algorithms!</p>
<p>More generally, if <span class="math inline">\(m &lt; n^{1/e}\)</span>, we can apply fast algorithms (in <span class="math inline">\(\mathbb{Z}\)</span>) to compute the <span class="math inline">\(e\)</span>-th roots of <span class="math inline">\(m^e\)</span>. It is therefore advisable to perform <strong>“randomization” of <span class="math inline">\(m\)</span> before encrypting</strong>!</p>
<p><strong>The multiplicative property of RSA</strong>: <span class="math inline">\((m_1 m_2)^e \equiv m_1^e \cdot m_2^e \equiv c_1 \cdot c_2 \pmod{n}\)</span></p>
<p>gives rise to <strong>dangerous vulnerabilities</strong> (see blind signatures).</p>
<p>Assuming parameters are correctly chosen and the implementation has no flaws, <strong>the most effective method to “break” the generic RSA algorithm remains factoring <span class="math inline">\(n\)</span></strong>.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-104-contents" aria-controls="callout-104" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-104" class="callout-104-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Same message, small <span class="math inline">\(e\)</span></strong>: CRT allows extracting <span class="math inline">\(m\)</span>!</li>
<li><strong>Message too small</strong>: <span class="math inline">\(m &lt; n^{1/e}\)</span> → direct root</li>
<li><strong>Multiplicative property</strong>: <span class="math inline">\(E(m_1) \cdot E(m_2) = E(m_1 m_2)\)</span></li>
<li><strong>Protection</strong>: always padding/randomization (OAEP)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="the-elgamal-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="the-elgamal-algorithm">The ElGamal Algorithm</h2>
<p>Asymmetric system (1985) based on the <strong>discrete logarithm problem (DLP)</strong>.</p>
<p><strong>Keys:</strong></p>
<ul>
<li>Choose prime <span class="math inline">\(p\)</span>, generator <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span>, secret <span class="math inline">\(a\)</span></li>
<li>Compute <span class="math inline">\(y = \alpha^a \bmod p\)</span></li>
<li><strong>Public</strong>: <span class="math inline">\((p, \alpha, y)\)</span> | <strong>Private</strong>: <span class="math inline">\(a\)</span></li>
</ul>
<p><strong>Encryption:</strong> For message <span class="math inline">\(m\)</span>, choose unique random <span class="math inline">\(k\)</span></p>
<ul>
<li><span class="math inline">\(\gamma = \alpha^k \bmod p\)</span></li>
<li><span class="math inline">\(\delta = m \cdot y^k \bmod p\)</span></li>
<li>Send <span class="math inline">\((\gamma, \delta)\)</span></li>
</ul>
<p><strong>Decryption:</strong> <span class="math inline">\(m = \delta \cdot \gamma^{-a} \bmod p\)</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-105-contents" aria-controls="callout-105" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-105" class="callout-105-contents callout-collapse collapse">
<section id="elgamal-encryptiondecryption-procedure" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="elgamal-encryptiondecryption-procedure">ElGamal Encryption/Decryption Procedure</h2>
<p><strong>Key generation</strong></p>
<p>Each entity (A) creates a key pair (public and private) as follows:</p>
<ul>
<li>A generates a prime number <span class="math inline">\(p\)</span> (len(<span class="math inline">\(p\)</span>) ≥ 1024 bits) and a <strong>generator <span class="math inline">\(\alpha\)</span></strong> of the multiplicative group <span class="math inline">\(\mathbb{Z}_p^*\)</span></li>
<li>A generates a random number <span class="math inline">\(a\)</span>, such that <span class="math inline">\(1 \leq a \leq p-2\)</span> and computes <span class="math inline">\(y := \alpha^a \bmod p\)</span></li>
<li>The <strong>public key</strong> of A is <span class="math inline">\((p, \alpha, y)\)</span>, the <strong>private key</strong> of A is <span class="math inline">\(a\)</span></li>
</ul>
<p><strong>Encryption</strong></p>
<ul>
<li>Entity B obtains <span class="math inline">\((p, \alpha, \alpha^a \bmod p)\)</span>, the authentic public key of A</li>
<li>B transforms its plaintext into a series of integers <span class="math inline">\(m_i\)</span>, such that <span class="math inline">\(m_i \in [0, p-1]\)</span> <span class="math inline">\(\forall i\)</span></li>
<li>For each message <span class="math inline">\(m_i\)</span>:
<ul>
<li>B generates a <strong>unique</strong> random number <span class="math inline">\(k\)</span>, such that <span class="math inline">\(1 \leq k \leq p-2\)</span></li>
<li>B computes <span class="math inline">\(\gamma := \alpha^k \bmod p\)</span> and <span class="math inline">\(\delta := m_i \cdot (\alpha^a)^k \bmod p\)</span> and sends the ciphertext <span class="math inline">\(c := (\gamma, \delta)\)</span></li>
</ul></li>
</ul>
<p><strong>Decryption</strong></p>
<ul>
<li>A uses its private key <span class="math inline">\(a\)</span> to compute <span class="math inline">\(\gamma^{p-1-a} \bmod p\)</span> (note that: <span class="math inline">\(\gamma^{p-1-a} \equiv \gamma^{-a} \equiv \alpha^{-ak} \bmod p\)</span>)</li>
<li>A retrieves the plaintext by computing: <span class="math inline">\(\delta \cdot \gamma^{-ak} \bmod p\)</span></li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-106-contents" aria-controls="callout-106" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-106" class="callout-106-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Base</strong>: DLP in <span class="math inline">\(\mathbb{Z}_p^*\)</span></p>
<p><strong>Ciphertext</strong>: <span class="math inline">\((\alpha^k, m \cdot y^k)\)</span></p>
<p><strong>Security</strong>: <span class="math inline">\(k\)</span> must be unique and large</p>
<p><strong>Disadvantage</strong>: doubles message size</p>
</div>
</div>
</div>
<section id="essential-remarks" class="level3">
<h3 class="anchored" data-anchor-id="essential-remarks">Essential Remarks</h3>
<ul>
<li><strong>Proof</strong>: <span class="math inline">\(\delta \cdot \gamma^{-a} = m \cdot (\alpha^a)^k \cdot (\alpha^k)^{-a} = m \bmod p\)</span></li>
<li><strong>Security</strong>: based on DLP (complexity sub-exponential close to factorization)</li>
<li><strong>Exponents</strong>: <span class="math inline">\(k\)</span> and <span class="math inline">\(a\)</span> must be large (otherwise vulnerable to baby-step giant-step)</li>
<li><strong>Reuse prohibited</strong>: if <span class="math inline">\(k\)</span> repeated, <span class="math inline">\(\delta_1/\delta_2 = m_1/m_2\)</span> reveals the messages</li>
<li><strong>Major disadvantage</strong>: ×2 expansion of ciphertext size</li>
<li><strong>Generalization</strong>: works on <span class="math inline">\(GF(2^n)\)</span> or elliptic curves</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-107-contents" aria-controls="callout-107" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text - Remarks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-107" class="callout-107-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Proof</strong> that the scheme works: If <span class="math inline">\(s \equiv k^{-1}(m_h - ar) \bmod (p-1)\)</span>, we have that: <span class="math inline">\(m_h \equiv (ar + ks) \bmod (p-1)\)</span> and <span class="math inline">\(v_2 = \alpha^{H(m)} \bmod p\)</span>. If, as we wish to show <span class="math inline">\(m_h = H(m)\)</span>, by reducing exponents mod <span class="math inline">\((p-1)\)</span>, we can rewrite <span class="math inline">\(v_2\)</span>: <span class="math inline">\(v_2 \equiv \alpha^{ar+ks} \bmod p\)</span>. On the other hand: <span class="math inline">\(v_1 = y^r\alpha^{rs} \equiv \alpha^{ar}\alpha^{ks} \equiv \alpha^{ar+ks} \bmod p\)</span>.</p>
<p>The ElGamal procedure is based on the difficulty of computing <strong>discrete logarithms modulo a prime number</strong> (DLP problem) even though it has not been proven to be strictly equivalent to this problem.</p>
<p>The <strong>most efficient algorithms</strong> known have a sub-exponential complexity very close to that of factorization (we often use the same algorithms).</p>
<p>The <strong>chosen exponents</strong> (<span class="math inline">\(k\)</span>, <span class="math inline">\(a\)</span>) must be large because there exist efficient algorithms to compute discrete logarithms modulo a prime number when the exponent is small (baby-step giant-step algorithm).</p>
<p>A <strong>disadvantage of ElGamal</strong> is that it multiplies the ciphertext length by 2.</p>
<p>It is <strong>essential</strong> for the security of the procedure that the random number <span class="math inline">\(k\)</span> is not repeated, otherwise: let <span class="math inline">\((\gamma_1, \delta_1)\)</span> and <span class="math inline">\((\gamma_2, \delta_2)\)</span> be the two generated ciphertexts, we have that <span class="math inline">\(\delta_1/\delta_2 = m_1/m_2\)</span> and consequently, it is trivial to recover one plaintext from the other.</p>
<p>The ElGamal procedure can be <strong>generalized</strong> to other groups like <span class="math inline">\(GF(2^n)\)</span> or elliptic curves.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-108-contents" aria-controls="callout-108" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision - Remarks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-108" class="callout-108-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Equivalence</strong>: based on DLP (not proven equivalent)</p>
<p><strong><span class="math inline">\(k\)</span> unique</strong>: CRITICAL - otherwise <span class="math inline">\(m_1/m_2\)</span> revealed</p>
<p><strong>Key size</strong>: large exponents necessary</p>
<p><strong>Extensions</strong>: <span class="math inline">\(GF(2^n)\)</span>, elliptic curves</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="rabin-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="rabin-algorithm">Rabin Algorithm</h2>
<p>Asymmetric system <strong>equivalent to factorization</strong> (provably secure).</p>
<p><strong>Keys:</strong></p>
<ul>
<li>Generate two primes <span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span> (≥1024 bits total), compute <span class="math inline">\(n = pq\)</span>
<ul>
<li><strong>Public</strong>: <span class="math inline">\(n\)</span></li>
<li><strong>Private</strong>: <span class="math inline">\((p, q)\)</span></li>
</ul></li>
</ul>
<p><strong>Encryption:</strong> <span class="math inline">\(c = m^2 \bmod n\)</span></p>
<p><strong>Decryption:</strong></p>
<ul>
<li>Compute the 4 square roots of <span class="math inline">\(c \bmod n\)</span> (via roots mod <span class="math inline">\(p\)</span> and mod <span class="math inline">\(q\)</span>)</li>
<li>Identify the correct message by redundancy</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-109-contents" aria-controls="callout-109" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-109" class="callout-109-contents callout-collapse collapse">
<section id="rabin-encryptiondecryption-procedure" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="rabin-encryptiondecryption-procedure">Rabin Encryption/Decryption Procedure</h2>
<p><strong>Key generation</strong></p>
<p>Each entity (A) creates a key pair (public and private) as follows:</p>
<ul>
<li>A generates two random prime numbers <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> of large size (len(<span class="math inline">\(pq\)</span>) ≥ 1024)</li>
<li>A computes <span class="math inline">\(n := pq\)</span></li>
<li>The <strong>public key</strong> of A is <span class="math inline">\(n\)</span>, the <strong>private key</strong> of A is <span class="math inline">\((p, q)\)</span></li>
</ul>
<p><strong>Encryption</strong></p>
<ul>
<li>Entity B obtains <span class="math inline">\(n\)</span>, the authentic public key of A</li>
<li>B transforms its plaintext into a series of integers <span class="math inline">\(m_i\)</span>, such that <span class="math inline">\(m_i \in [0, n-1]\)</span> <span class="math inline">\(\forall i\)</span></li>
<li>B computes <span class="math inline">\(c_i = m_i^2 \bmod n\)</span> for each message <span class="math inline">\(m_i\)</span></li>
<li>B sends all the ciphertexts <span class="math inline">\(c_i\)</span> to A</li>
</ul>
<p><strong>Decryption</strong></p>
<ul>
<li>A uses its private key <span class="math inline">\((p, q)\)</span> to retrieve the <strong>4 solutions</strong> of the equation: <span class="math inline">\(c_i = x^2 \bmod n\)</span> using <strong>efficient algorithms</strong> to compute square roots <span class="math inline">\(\bmod p\)</span> and <span class="math inline">\(\bmod q\)</span></li>
<li>A determines either by an <strong>additional indication</strong> from B, or by <strong>redundancy analysis</strong> which of the 4 messages <span class="math inline">\(m_1, m_2, m_3, m_4\)</span> is the original plaintext</li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-110-contents" aria-controls="callout-110" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-110" class="callout-110-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Base</strong>: SQROOTP (square root mod composite)</p>
<p><strong>Advantage</strong>: proven equivalent to factorization</p>
<p><strong>Problem</strong>: 4 possible solutions, requires redundancy</p>
<p><strong>Vulnerability</strong>: chosen-ciphertext attack reveals factors</p>
</div>
</div>
</div>
<section id="essential-remarks-1" class="level3">
<h3 class="anchored" data-anchor-id="essential-remarks-1">Essential Remarks</h3>
<ul>
<li><strong>Proven security</strong>: SQROOTP ⟺ FACTP (only algorithm with proven equivalence)</li>
<li><strong>Chosen-ciphertext attack</strong>: if A decrypts <span class="math inline">\(c = m^2 \bmod n\)</span> chosen by adversary M
<ul>
<li>M receives a root <span class="math inline">\(m_x\)</span> among 4 possible</li>
<li>If <span class="math inline">\(m \neq m_x \bmod n\)</span> (prob. 0.5), then <span class="math inline">\(\gcd(m - m_x, n)\)</span> gives a factor of <span class="math inline">\(n\)</span></li>
</ul></li>
<li><strong>Solution</strong>: require sufficient redundancy to identify unique solution without ambiguity</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-111-contents" aria-controls="callout-111" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text - Remarks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-111" class="callout-111-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The Rabin procedure is based on the <strong>impossibility of finding square roots modulo a composite of unknown factorization</strong> (SQROOTP problem).</p>
<p>The <strong>main interest</strong> of this algorithm lies in the fact that it has been <strong>proven to be equivalent to factorization</strong> (SQROOTP ⟺ FACTP). This algorithm therefore belongs to the <strong>provably secure</strong> category for any passive attack.</p>
<p><strong>Active attacks</strong> can, in some cases, compromise the algorithm’s security. More precisely, if we mount the following <strong>chosen ciphertext</strong> attack:</p>
<ul>
<li>The attacker M generates an <span class="math inline">\(m\)</span> and sends to A the ciphertext <span class="math inline">\(c = m^2 \bmod n\)</span>.</li>
<li>A responds with a root <span class="math inline">\(m_x\)</span> among the 4 possible <span class="math inline">\(m_1, m_2, m_3, m_4\)</span>.</li>
<li>If <span class="math inline">\(m \neq m_x \bmod n\)</span> (probability 0.5), M repeats with a new <span class="math inline">\(m\)</span>.</li>
<li>Otherwise, A computes <span class="math inline">\(\gcd(m - m_x, n)\)</span> and thus obtains one of the two factors of <span class="math inline">\(n\)</span>.</li>
</ul>
<p>This attack could be <strong>avoided</strong> if the procedure required <strong>sufficient redundancy</strong> in the plaintexts allowing A to identify without ambiguity which of the possible solutions is the original plaintext. In this case, A would always respond with <span class="math inline">\(m\)</span> and discard the other solutions that do not have the predefined level of redundancy.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-112-contents" aria-controls="callout-112" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision - Remarks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-112" class="callout-112-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Unique</strong>: only algorithm proven equivalent to FACTP</p>
<p><strong>Attack</strong>: chosen-ciphertext gives factors (prob. 0.5)</p>
<p><strong>Countermeasure</strong>: mandatory redundancy in messages</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="comparison-rsa---elgamal---rabin" class="level2">
<h2 class="anchored" data-anchor-id="comparison-rsa---elgamal---rabin">Comparison RSA - ElGamal - Rabin</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Criterion</th>
<th>RSA</th>
<th>ElGamal</th>
<th>Rabin</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Problem</strong></td>
<td>RSAP</td>
<td>DLP</td>
<td>SQROOTP</td>
</tr>
<tr class="even">
<td><strong>Security</strong></td>
<td>Equiv. factorization (generic case)</td>
<td>Based on DLP</td>
<td><strong>Proven</strong> ⟺ factorization</td>
</tr>
<tr class="odd">
<td><strong>Expansion</strong></td>
<td>1:1</td>
<td><strong>1:2</strong></td>
<td>1:1</td>
</tr>
<tr class="even">
<td><strong>Decryption</strong></td>
<td>Deterministic</td>
<td>Deterministic</td>
<td><strong>4 solutions</strong></td>
</tr>
<tr class="odd">
<td><strong>Signature</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes (with precautions)</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="elliptic-curves-basic-idea" class="level2">
<h2 class="anchored" data-anchor-id="elliptic-curves-basic-idea">Elliptic Curves (Basic Idea)</h2>
<section id="fundamental-concept" class="level3">
<h3 class="anchored" data-anchor-id="fundamental-concept">Fundamental Concept</h3>
<p>An <strong>elliptic curve</strong> <span class="math inline">\(E\)</span> is defined by: <span class="math inline">\(y^2 = x^3 + ax + b\)</span> (with discriminant <span class="math inline">\(4a^3 + 27b^2 \neq 0\)</span>).</p>
<p><strong>Key operation: Point addition</strong></p>
<ul>
<li>Geometrically: draw a line between two points <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span>, find the 3rd intersection point, then take its symmetric</li>
<li>Forms a <strong>commutative group</strong> with point at infinity <span class="math inline">\(\mathcal{O}\)</span> as identity</li>
<li><strong>Scalar multiplication</strong>: <span class="math inline">\(kP = P + P + ... + P\)</span> (<span class="math inline">\(k\)</span> times)</li>
</ul>
<p><strong>Cryptographic advantage:</strong></p>
<ul>
<li>The <strong>ECDLP problem</strong>: finding <span class="math inline">\(k\)</span> such that <span class="math inline">\(Q = kP\)</span> is very difficult (exponential effort)</li>
<li><strong>Shorter keys</strong> for same security as in <span class="math inline">\(\mathbb{Z}_p^*\)</span></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-113-contents" aria-controls="callout-113" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text - Definition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-113" class="callout-113-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>An <strong>elliptic curve</strong> is a set of points <span class="math inline">\(E\)</span> defined by the equation: <span class="math inline">\(y^2 = x^3 + ax + b\)</span>, with <span class="math inline">\(x, y, a\)</span> and <span class="math inline">\(b\)</span> rational numbers, integers or integers modulo <span class="math inline">\(m\)</span> (<span class="math inline">\(m &gt; 1\)</span>). The set <span class="math inline">\(E\)</span> also contains a “point at infinity” denoted <span class="math inline">\(\mathcal{O}\)</span>. The point <span class="math inline">\(\mathcal{O}\)</span> is not on the curve but it is the identity element of <span class="math inline">\(E\)</span>.</p>
<p>We will choose for our calculations elliptic curves that do not have multiple roots or, in other words, curves where the <strong>discriminant</strong> <span class="math inline">\(4a^3 + 27b^2 \neq 0\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-114-contents" aria-controls="callout-114" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision - Concept
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-114" class="callout-114-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Equation</strong>: <span class="math inline">\(y^2 = x^3 + ax + b\)</span></p>
<p><strong>Structure</strong>: group with <span class="math inline">\(\mathcal{O}\)</span></p>
<p><strong>Operation</strong>: geometric addition</p>
<p><strong>Hard problem</strong>: ECDLP</p>
</div>
</div>
</div>
</section>
<section id="addition-on-elliptic-curves" class="level3">
<h3 class="anchored" data-anchor-id="addition-on-elliptic-curves">Addition on Elliptic Curves</h3>
<p>Let <span class="math inline">\(P := (x, y) \in E\)</span>, we define <span class="math inline">\(-P := (x, -y)\)</span> (symmetric with respect to the x-axis). We have <span class="math inline">\(P + (-P) = \mathcal{O}\)</span>.</p>
<p>For two points <span class="math inline">\(P, Q \in E\)</span> with <span class="math inline">\(Q \neq -P\)</span>, we define <span class="math inline">\(P + Q := R\)</span> where <span class="math inline">\(-R\)</span> is the 3rd intersection point between the curve and the line passing through <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span>.</p>
<p>For <strong>doubling</strong>: <span class="math inline">\(2P = R\)</span> where <span class="math inline">\(-R\)</span> is the intersection point of the curve with the tangent to the curve at point <span class="math inline">\(P\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-115-contents" aria-controls="callout-115" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text - Addition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-115" class="callout-115-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(P := (x, y) \in E\)</span>, we define <span class="math inline">\(-P\)</span> as <span class="math inline">\(-P := (x, -y)\)</span>. Graphically, <span class="math inline">\(-P\)</span> is the symmetric point of <span class="math inline">\(P\)</span> with respect to the x-axis. Note that <span class="math inline">\(P + (-P) = \mathcal{O}\)</span>.</p>
<p>Let two points <span class="math inline">\(P, Q \in E\)</span>, such that <span class="math inline">\(Q \neq -P\)</span>, we define the addition <span class="math inline">\(P + Q := R\)</span> where <span class="math inline">\(R \in E\)</span> such that <span class="math inline">\(-R\)</span> is the 3rd intersection point between the curve and the line passing through <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span>.</p>
<p>The set <span class="math inline">\(E\)</span> with <span class="math inline">\(\oplus\)</span> defines a <strong>commutative group</strong> for addition.</p>
<p>Let <span class="math inline">\(P \in E\)</span>, the point <span class="math inline">\(2P = R\)</span>, such that <span class="math inline">\(-R\)</span> is the intersection point of the curve with the line tangent to the curve at point <span class="math inline">\(P\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-116-contents" aria-controls="callout-116" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision - Addition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-116" class="callout-116-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Inverse</strong>: <span class="math inline">\(-P = (x, -y)\)</span></p>
<p><strong>Addition</strong>: 3rd intersection point + symmetry</p>
<p><strong>Doubling</strong>: tangent + symmetry</p>
<p><strong>Property</strong>: commutative group</p>
</div>
</div>
</div>
</section>
<section id="ecdlp-and-cryptographic-advantages" class="level3">
<h3 class="anchored" data-anchor-id="ecdlp-and-cryptographic-advantages">ECDLP and Cryptographic Advantages</h3>
<p>When the elliptic curve is defined over the field <span class="math inline">\(\mathbb{Z}_p\)</span> with <span class="math inline">\(p\)</span> a large prime (<span class="math inline">\(y^2 \equiv x^3 + ax + b \bmod p\)</span>), the computation of <span class="math inline">\(k \in \mathbb{Z}_p\)</span> such that <span class="math inline">\(Q = kP\)</span> with <span class="math inline">\((P, Q)\)</span> known is <strong>very difficult</strong> (exponential effort). This problem is the <strong>Elliptic Curve Discrete Logarithm Problem (ECDLP)</strong>.</p>
<p><strong>Main advantage</strong>: key sizes much smaller for equivalent security.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-117-contents" aria-controls="callout-117" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text - ECDLP and Advantages
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-117" class="callout-117-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When the elliptic curve is defined over the field <span class="math inline">\(\mathbb{Z}_p\)</span> with <span class="math inline">\(p\)</span> a large prime number (<span class="math inline">\(y^2 \equiv x^3 + ax + b \bmod p\)</span>), the computation of <span class="math inline">\(k \in \mathbb{Z}_p\)</span> such that <span class="math inline">\(Q = kP\)</span> with <span class="math inline">\((P, Q)\)</span> known, is very difficult (requires exponential effort). This problem is known as: <strong>Elliptic Curve Discrete Logarithm Problem (ECDLP)</strong>.</p>
<p>The <strong>main advantage</strong> of public cryptography based on elliptic curves is that the size of the numbers used (and therefore, keys) is smaller.</p>
<p>This is due to the <strong>increased complexity</strong> of computations on <span class="math inline">\(E_p\)</span> (elliptic curve defined over field <span class="math inline">\(\mathbb{Z}_p\)</span>) compared to usual fields such as <span class="math inline">\(\mathbb{Z}_p\)</span> or <span class="math inline">\(GF(2^m)\)</span>.</p>
<p>The <strong>representation of a plaintext as points</strong> of the curve remains a complex operation.</p>
<p>In October 2003, the <strong>US National Security Agency (NSA)</strong> purchased a patent from Certicom for the use of elliptic curve cryptography.</p>
<p>In September 2013 Claus Diem showed that under certain conditions the ECDLP problem could be solved in <strong>sub-exponential time</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-118-contents" aria-controls="callout-118" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision - ECDLP
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-118" class="callout-118-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Problem</strong>: finding <span class="math inline">\(k\)</span> in <span class="math inline">\(Q = kP\)</span> (exponential)</p>
<p><strong>Gain</strong>: keys ~6-10× shorter</p>
<p><strong>Limit</strong>: representing messages as points difficult</p>
<p><strong>NSA</strong>: adopted in 2003</p>
</div>
</div>
</div>
</section>
<section id="key-size-comparison-table" class="level3">
<h3 class="anchored" data-anchor-id="key-size-comparison-table">Key Size Comparison Table</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>AES (symmetric)</th>
<th>RSA/DH</th>
<th>Elliptic Curves</th>
<th>Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>56 bits</td>
<td>512 bits</td>
<td>112 bits</td>
<td>1:4.6</td>
</tr>
<tr class="even">
<td>80 bits</td>
<td>1024 bits</td>
<td>160 bits</td>
<td>1:6.4</td>
</tr>
<tr class="odd">
<td>112 bits</td>
<td>2048 bits</td>
<td>224 bits</td>
<td>1:9.1</td>
</tr>
<tr class="even">
<td>128 bits</td>
<td>3072 bits</td>
<td>256 bits</td>
<td>1:12</td>
</tr>
<tr class="odd">
<td>256 bits</td>
<td>15360 bits</td>
<td>512 bits</td>
<td>1:30</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-119-contents" aria-controls="callout-119" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text - Table
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-119" class="callout-119-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This table shows the key size ratios compared to RSA for equivalent security.</p>
<p><em>(Table extracted from original document)</em></p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="elgamal-on-elliptic-curves" class="level2">
<h2 class="anchored" data-anchor-id="elgamal-on-elliptic-curves">ElGamal on Elliptic Curves</h2>
<section id="direct-adaptation" class="level3">
<h3 class="anchored" data-anchor-id="direct-adaptation">Direct Adaptation</h3>
<p>Replace operations in <span class="math inline">\(\mathbb{Z}_p^*\)</span> with operations on <span class="math inline">\(E_p\)</span></p>
<p><strong>Keys:</strong></p>
<ul>
<li>Choose curve <span class="math inline">\(E_p\)</span> and point <span class="math inline">\(P_0 \in E_p\)</span> of large order</li>
<li>Secret <span class="math inline">\(x\)</span>, compute <span class="math inline">\(P_a = xP_0\)</span></li>
<li><strong>Public</strong>: <span class="math inline">\((E_p, P_0, P_a)\)</span> | <strong>Private</strong>: <span class="math inline">\(x\)</span></li>
</ul>
<p><strong>Encryption:</strong> For message <span class="math inline">\(m_i \in E_p\)</span></p>
<ul>
<li>Choose random <span class="math inline">\(k\)</span></li>
<li><span class="math inline">\(\gamma = kP_0\)</span>, <span class="math inline">\(\delta = kP_a + m_i\)</span></li>
<li>Send <span class="math inline">\((\gamma, \delta)\)</span></li>
</ul>
<p><strong>Decryption:</strong> <span class="math inline">\(m_i = \delta - x\gamma\)</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-120-contents" aria-controls="callout-120" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text - ElGamal EC
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-120" class="callout-120-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Key generation</strong></p>
<p>Each entity (A) creates a key pair (public and private) as follows:</p>
<ul>
<li>A chooses an elliptic curve <span class="math inline">\(E_p\)</span> with <span class="math inline">\(p\)</span>, a large prime number (len(<span class="math inline">\(p\)</span>) bits) and a point <span class="math inline">\(P_0 \in E_p\)</span>.</li>
<li>A generates a random number <span class="math inline">\(x\)</span>, such that <span class="math inline">\(1 \leq x \leq p\)</span> and computes <span class="math inline">\(P_a = xP_0\)</span> (multiplication by a scalar on <span class="math inline">\(E_p\)</span>, for which efficient algorithms exist).</li>
<li>The public key of A is <span class="math inline">\((E_p, P_0, P_a)\)</span>, the private key of A is <span class="math inline">\(x\)</span>.</li>
</ul>
<p><strong>Encryption</strong></p>
<p>Entity B obtains <span class="math inline">\((E_p, P_0, P_a)\)</span>, the authentic public key of A.</p>
<ul>
<li>B transforms its plaintext into a series of integers <span class="math inline">\(m_i\)</span>, such that <span class="math inline">\(m_i \in E_p\)</span> for all <span class="math inline">\(i\)</span>.</li>
<li>For each message <span class="math inline">\(m_i\)</span>:
<ul>
<li>B generates a <strong>unique</strong> random number <span class="math inline">\(k\)</span>, such that <span class="math inline">\(1 \leq k \leq p\)</span>.</li>
<li>B computes <span class="math inline">\(\gamma := kP_0\)</span> and <span class="math inline">\(\delta := kP_a + m_i\)</span> and sends the ciphertext <span class="math inline">\(c := (\gamma, \delta)\)</span>.</li>
</ul></li>
</ul>
<p><strong>Decryption</strong></p>
<ul>
<li>A uses its private key <span class="math inline">\(x\)</span> to compute: <span class="math inline">\(x\gamma = xkP_0 = kP_a\)</span>.</li>
<li>A retrieves the plaintext by computing: <span class="math inline">\(\delta - kP_a = kP_a + m_i - kP_a = m_i\)</span>.</li>
</ul>
<p>The security of the scheme relies on <strong>ECDLP</strong>!</p>
<p>It is also necessary to <strong>authenticate</strong> the exchanged public parts to avoid the previously described man-in-the-middle attacks.</p>
<p>The properties of the protocol are identical to the <span class="math inline">\(\mathbb{Z}_p^*\)</span> case.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-121-contents" aria-controls="callout-121" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision - ElGamal EC
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-121" class="callout-121-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Principle</strong>: same as ElGamal on <span class="math inline">\(E_p\)</span></p>
<p><strong>Operations</strong>: + and scalar multiplication on points</p>
<p><strong>Security</strong>: ECDLP</p>
<p><strong>Authentication</strong>: necessary against MitM</p>
<p><strong>Advantage</strong>: short keys</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="cryptographic-hash-functions-and-macs" class="level1">
<h1>Cryptographic Hash Functions and MACs</h1>
<section id="one-way-functions-owf" class="level2">
<h2 class="anchored" data-anchor-id="one-way-functions-owf">One-Way Functions (OWF)</h2>
<p>A function <span class="math inline">\(f\)</span> is one-way if <span class="math inline">\(f(x) = y\)</span> is easy to compute, but finding <span class="math inline">\(x\)</span> from <span class="math inline">\(y\)</span> is computationally impossible for the majority of values.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>Squares modulo composite: <span class="math inline">\(f(x) = x^2 \bmod n\)</span> with <span class="math inline">\(n = pq\)</span></li>
<li>DES construction: <span class="math inline">\(y = E_k(x) \oplus x\)</span> with <span class="math inline">\(k\)</span> fixed and known</li>
</ul>
<p><strong>Note:</strong> OWF ≠ OWHF (hash functions impose compression and 2nd-preimage resistance).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-122-contents" aria-controls="callout-122" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-122" class="callout-122-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A <strong>function f is called one-way</strong> (one-way function or <strong>OWF</strong>) if for <span class="math inline">\(x \in X\)</span> we can easily compute <span class="math inline">\(f(x) = y\)</span> but for the vast majority of <span class="math inline">\(y \in Y\)</span> it is <strong>computationally impossible</strong> to find an <span class="math inline">\(x\)</span> such that <span class="math inline">\(f(x) = y\)</span>.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>computing squares modulo a composite: <span class="math inline">\(f(x) = x^2 \bmod n\)</span> with <span class="math inline">\(n = pq\)</span> (p and q unknown) is a <strong>one-way function</strong> because the inverse is difficult (see the basic problem <strong>SQROOTP</strong>).</li>
<li>we can construct a one-way function based on DES or any other block encryption system <span class="math inline">\(E\)</span> as follows: <span class="math inline">\(y = f(x) = E_k(x) \oplus x\)</span>, <span class="math inline">\(\forall x\)</span>, with <span class="math inline">\(k\)</span> a fixed and known key. We can consider that <span class="math inline">\(E_k(x) \oplus x\)</span> has (pseudo)random behavior by construction of <span class="math inline">\(E\)</span>. Computing the inverse amounts to finding an <span class="math inline">\(x\)</span> such that: <span class="math inline">\(x = E_k^{-1}(x \oplus y)\)</span>, which is considered difficult given the properties of <span class="math inline">\(E\)</span>. Note that <span class="math inline">\(f(x) = E_k(x)\)</span> would not be sufficient to make an OWF because, with the key known, DES is reversible.</li>
</ul>
<p><strong>OWF ≠ OWHF</strong>: Note that an OWHF as a hash function imposes additional restrictions on the source and image domains as well as on 2nd-preimage resistance that are not necessarily satisfied by OWFs.</p>
<p><strong>Example</strong>: <span class="math inline">\(f(x) = x^2 \bmod n\)</span> with <span class="math inline">\(n = pq\)</span> (p and q unknown) is not an OWHF because given <span class="math inline">\(x\)</span>, <span class="math inline">\(-x\)</span> is a trivial collision.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-123-contents" aria-controls="callout-123" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-123" class="callout-123-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>OWF</strong>: easy in one direction (<span class="math inline">\(f(x) \to y\)</span>), impossible in the other (<span class="math inline">\(y \to x\)</span>).</p>
<p>Examples: modular squares, <span class="math inline">\(E_k(x) \oplus x\)</span>.</p>
<p>OWF ≠ OWHF (hash functions = more constraints).</p>
</div>
</div>
</div>
</section>
<section id="hash-functions-definitions" class="level2">
<h2 class="anchored" data-anchor-id="hash-functions-definitions">Hash Functions: Definitions</h2>
<p>A hash function <span class="math inline">\(h\)</span> has two essential properties:</p>
<ul>
<li><strong>Compression</strong>: transforms data of arbitrary length into fixed-length output</li>
<li><strong>Ease of computation</strong>: <span class="math inline">\(h(x)\)</span> is fast to compute</li>
</ul>
<p><strong>Classification:</strong></p>
<ul>
<li><strong>Unkeyed</strong> (no key): MDC (Manipulation Detection Code)</li>
<li><strong>Keyed</strong> (with key): MAC (Message Authentication Code)</li>
</ul>
<p><strong>Security properties:</strong></p>
<ol type="1">
<li><strong>Preimage resistance</strong>: given <span class="math inline">\(y\)</span>, impossible to find <span class="math inline">\(x\)</span> such that <span class="math inline">\(h(x) = y\)</span></li>
<li><strong>2nd-preimage resistance</strong> (weak collision): given <span class="math inline">\(x\)</span>, impossible to find <span class="math inline">\(x' \neq x\)</span> such that <span class="math inline">\(h(x) = h(x')\)</span></li>
<li><strong>Collision resistance</strong> (strong collision): impossible to find any <span class="math inline">\(x \neq x'\)</span> with <span class="math inline">\(h(x) = h(x')\)</span></li>
</ol>
<p><strong>Terminology:</strong></p>
<ul>
<li><strong>OWHF</strong> (weak one-way): satisfies (1) and (2)</li>
<li><strong>CRHF</strong> (strong one-way): satisfies (2) and (3)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-124-contents" aria-controls="callout-124" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-124" class="callout-124-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A <strong>hash function</strong> is a function <span class="math inline">\(h\)</span> having the following properties:</p>
<ul>
<li><strong>compression</strong>: the function <span class="math inline">\(h\)</span> maps a set <span class="math inline">\(X\)</span> composed of bit strings of finite but arbitrary length to a set <span class="math inline">\(Y\)</span> composed of bit strings of finite and fixed length (and normally smaller than the size of <span class="math inline">\(X\)</span>) with <span class="math inline">\(h(x) = y\)</span>, and <span class="math inline">\(x \in X\)</span>, <span class="math inline">\(y \in Y\)</span>.</li>
<li><strong>easy to compute</strong>: given <span class="math inline">\(h\)</span> and <span class="math inline">\(x \in X\)</span>, <span class="math inline">\(h(x)\)</span> is easy to compute.</li>
</ul>
<p>A hash function is called <strong>“keyed”</strong> (keyed hash function) if a key is involved in the computation of the function (<span class="math inline">\(h_k(x) = y\)</span>); otherwise it is called <strong>“unkeyed”</strong> (unkeyed hash function).</p>
<p>Hash functions have many computer applications including structured archiving facilitating search. On the security side we will study two main categories:</p>
<ul>
<li><strong>manipulation detection codes</strong> (<strong>MDC</strong>) or message integrity codes (<strong>MIC</strong>): these are unkeyed functions allowing to provide an integrity service under certain conditions. The result of such a function is called <strong>MDC-value</strong> or simply <strong>digest</strong>.</li>
<li><strong>message authentication codes</strong> (<strong>MAC</strong>) which are keyed functions allowing to authenticate the source of the message and ensure its integrity without using additional (encryption) mechanisms.</li>
</ul>
<p><strong>Some basic properties of hash functions:</strong></p>
<ul>
<li><strong>1) preimage resistance</strong>: given a <span class="math inline">\(y \in Y\)</span>, it is computationally impossible to find a preimage <span class="math inline">\(x \in X\)</span> satisfying <span class="math inline">\(h(x) = y\)</span>.</li>
<li><strong>2) 2nd-preimage resistance</strong>: given an <span class="math inline">\(x \in X\)</span> and its image <span class="math inline">\(y \in Y\)</span>, with <span class="math inline">\(h(x) = y\)</span>, it is computationally impossible to find an <span class="math inline">\(x' \neq x\)</span> such that <span class="math inline">\(h(x) = h(x')\)</span>. Also called <strong>weak collision resistance</strong>.</li>
<li><strong>3) collision resistance</strong>: it is computationally impossible to find two distinct preimages <span class="math inline">\(x, x' \in X\)</span> for which <span class="math inline">\(h(x) = h(x')\)</span> (no restriction on the choice of values). Also called <strong>strong collision resistance</strong>.</li>
</ul>
<p>A <strong>one-way hash function</strong> (<strong>OWHF</strong>) is an MDC satisfying 1) and 2). Also called: <strong>weak one-way hash function</strong>.</p>
<p>A <strong>collision resistant hash function</strong> (<strong>CRHF</strong>) is an MDC satisfying properties 2) and 3). (Note that 3) ⇒ 2)). Also called: <strong>strong one-way hash function</strong>.</p>
<p><strong>OWF ≠ OWHF</strong>: Note that an OWHF as a hash function imposes additional restrictions on the source and image domains as well as on 2nd-preimage resistance that are not necessarily satisfied by OWFs.</p>
<p><strong>Example</strong>: <span class="math inline">\(f(x) = x^2 \bmod n\)</span> with <span class="math inline">\(n = pq\)</span> (p and q unknown) is not an OWHF because given <span class="math inline">\(x\)</span>, <span class="math inline">\(-x\)</span> is a trivial collision.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-125-contents" aria-controls="callout-125" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-125" class="callout-125-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Hash function</strong>: compression + easy computation</p>
<p><strong>MDC</strong> (unkeyed) for integrity</p>
<p><strong>MAC</strong> (keyed) for authentication</p>
<p><strong>Properties</strong></p>
<ol type="1">
<li>preimage resistance</li>
<li>2nd-preimage resistance</li>
<li>collision resistance</li>
</ol>
<p><strong>OWHF</strong> = (1)+(2)</p>
<p><strong>CRHF</strong> = (2)+(3).</p>
</div>
</div>
</div>
</section>
<section id="message-authentication-codes-macs" class="level2">
<h2 class="anchored" data-anchor-id="message-authentication-codes-macs">Message Authentication Codes (MACs)</h2>
<p>A MAC is a family of functions <span class="math inline">\(h_k\)</span> parameterized by a secret key <span class="math inline">\(k\)</span>:</p>
<p><strong>Properties:</strong></p>
<ol type="1">
<li><strong>Compression</strong>: arbitrary input → fixed output</li>
<li><strong>Easy to compute</strong>: with known <span class="math inline">\(k\)</span>, <span class="math inline">\(h_k(x)\)</span> is fast</li>
<li><strong>Computation-resistance</strong>: without <span class="math inline">\(k\)</span>, impossible to compute valid pairs <span class="math inline">\((x, h_k(x))\)</span></li>
</ol>
<p><strong>Implications:</strong></p>
<ul>
<li>Key non-recovery: impossible to recover <span class="math inline">\(k\)</span> from pairs <span class="math inline">\((x_i, h_k(x_i))\)</span></li>
<li>Preimage and collision resistance for anyone not possessing <span class="math inline">\(k\)</span></li>
</ul>
<p><strong>Usage:</strong> Source authentication + message integrity without directly revealing secrets.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-126-contents" aria-controls="callout-126" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-126" class="callout-126-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A <strong>Message Authentication Code</strong> (<strong>MAC</strong>) is a family of functions <span class="math inline">\(h_k\)</span> parameterized by a secret key <span class="math inline">\(k\)</span> having the following properties:</p>
<ul>
<li><strong>1) compression</strong>: as for generic hash functions but applied to <span class="math inline">\(h_k\)</span>.</li>
<li><strong>2) easy to compute</strong>: from a function <span class="math inline">\(h_k\)</span>, and a known key <span class="math inline">\(k\)</span>, we can easily compute <span class="math inline">\(h_k(x)\)</span>. The result is called a <strong>MAC-value</strong> or simply a <strong>MAC</strong>.</li>
<li><strong>3) computational resistance</strong> (computation-resistance): without knowledge of the symmetric key <span class="math inline">\(k\)</span>, it is (computationally) impossible to compute pairs <span class="math inline">\((x, h_k(x))\)</span> from 0 or several known pairs <span class="math inline">\((x_i, h_k(x_i))\)</span> for any <span class="math inline">\(x \neq x_i\)</span>.</li>
</ul>
<p>Property 3) implies that the pairs <span class="math inline">\((x_i, h_k(x_i))\)</span> cannot be used to compute the key <span class="math inline">\(k\)</span> (<strong>key non-recovery</strong>). However the key non-recovery property does not imply computation-resistance because chosen/known-plaintext attacks could lead to forged pairs <span class="math inline">\((x, h_k(x))\)</span>.</p>
<p>The impossibility of computing pairs <span class="math inline">\((x, h_k(x))\)</span> also translates to preimage and collision resistance (cf.&nbsp;previous slide) for any entity not possessing the key <span class="math inline">\(k\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-127-contents" aria-controls="callout-127" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-127" class="callout-127-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>MAC</strong> = hash with key <span class="math inline">\(k\)</span></p>
<p>Without <span class="math inline">\(k\)</span>: impossible to forge <span class="math inline">\((x, h_k(x))\)</span> or recover <span class="math inline">\(k\)</span></p>
<p>Guarantees source authentication + integrity.</p>
</div>
</div>
</div>
</section>
<section id="attacks-on-mdcs" class="level2">
<h2 class="anchored" data-anchor-id="attacks-on-mdcs">Attacks on MDCs</h2>
<section id="nd-preimage-resistance-attack" class="level3">
<h3 class="anchored" data-anchor-id="nd-preimage-resistance-attack">2nd-Preimage Resistance Attack</h3>
<p><strong>Problem:</strong> Given <span class="math inline">\(h(x) = y\)</span>, find <span class="math inline">\(x'\)</span> such that <span class="math inline">\(h(x') = h(x)\)</span>.</p>
<p><strong>Probabilistic analysis:</strong></p>
<p>For an <span class="math inline">\(m\)</span>-bit digest (<span class="math inline">\(n = 2^m\)</span> possible outputs), the probability of having at least one collision after <span class="math inline">\(k\)</span> attempts is:</p>
<p><span class="math display">\[P(\text{collision}) \approx 1 - (1-1/n)^k \approx k/n\]</span></p>
<p>For <span class="math inline">\(P = 0.5\)</span>: <span class="math inline">\(k = n/2 = 2^{m-1}\)</span></p>
<p><strong>Conclusion:</strong> For an <span class="math inline">\(m\)</span>-bit digest, approximately <span class="math inline">\(2^{m-1}\)</span> attempts are needed to find a 2nd-preimage with probability 0.5.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-128-contents" aria-controls="callout-128" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-128" class="callout-128-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Problem</strong>: given <span class="math inline">\(h(x) = y\)</span>, find <span class="math inline">\(x'\)</span> such that <span class="math inline">\(h(x')=h(x)\)</span>.</p>
<p><strong>Practical example</strong>: we have a text with an associated digest bearing a digital signature; we want to create a fake text bearing the same signature (without control over the original text). What are our chances from a probabilistic point of view?</p>
<p>Let a hash function <span class="math inline">\(h\)</span> with <span class="math inline">\(n\)</span> possible outputs and a given value <span class="math inline">\(h(x)\)</span>. If <span class="math inline">\(h\)</span> is applied to <span class="math inline">\(k\)</span> random values, what must be the value of <span class="math inline">\(k\)</span> so that the probability of having at least one <span class="math inline">\(y\)</span> such that <span class="math inline">\(h(x) = h(y)\)</span> is 0.5?</p>
<p>For the first value of <span class="math inline">\(y\)</span>, the probability that <span class="math inline">\(h(x) = h(y)\)</span> is <span class="math inline">\(1/n\)</span>. Conversely, the probability that <span class="math inline">\(h(x) \neq h(y)\)</span> is <span class="math inline">\(1-1/n\)</span>. For <span class="math inline">\(k\)</span> values, the probability of having no collision is: <span class="math inline">\((1-1/n)^k\)</span>, i.e.:</p>
<p><span class="math display">\[\left(1 - \frac{1}{n}\right)^k = 1 - \frac{k}{n} + \frac{1}{2!}\left(\frac{k}{n}\right)^2 - \frac{1}{3!}\left(\frac{k}{n}\right)^3 + \ldots\]</span></p>
<p>which for very large <span class="math inline">\(n\)</span> can be approximated by <span class="math inline">\(1 - k/n\)</span>. Therefore, the complementary probability of having at least one collision is about <span class="math inline">\(k/n\)</span>; which gives us <span class="math inline">\(k = n/2\)</span> for a probability of 0.5.</p>
<p><strong>Conclusion</strong>: for an <span class="math inline">\(m\)</span>-bit digest, the number of attempts needed to find a <span class="math inline">\(y\)</span> such that <span class="math inline">\(h(x) = h(y)\)</span> with a probability of 0.5 is <span class="math inline">\(2^{m-1}\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-129-contents" aria-controls="callout-129" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-129" class="callout-129-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To break 2nd-preimage resistance with <span class="math inline">\(m\)</span>-bit digest: <span class="math inline">\(2^{m-1}\)</span> attempts (prob 0.5).</p>
</div>
</div>
</div>
</section>
<section id="collision-resistance-attack-birthday-paradox" class="level3">
<h3 class="anchored" data-anchor-id="collision-resistance-attack-birthday-paradox">Collision Resistance Attack: Birthday Paradox</h3>
<p><strong>Problem:</strong> Find two distinct values <span class="math inline">\(x, x'\)</span> such that <span class="math inline">\(h(x) = h(x')\)</span>.</p>
<p><strong>Birthday paradox:</strong> In a group of 23 people, probability &gt; 0.5 of having two people with the same birthday.</p>
<p><strong>Mathematical result:</strong></p>
<p>For <span class="math inline">\(n\)</span> possible outputs, the probability of collision after <span class="math inline">\(k\)</span> computations:</p>
<p><span class="math display">\[P(\text{at least 1 collision}) = 1 - e^{-k(k-1)/(2n)}\]</span></p>
<p>For <span class="math inline">\(P \geq 0.5\)</span>: <span class="math inline">\(k \approx 1.17\sqrt{n}\)</span></p>
<p><strong>Cryptographic consequence:</strong> For an <span class="math inline">\(m\)</span>-bit digest (<span class="math inline">\(n = 2^m\)</span> outputs), approximately <span class="math inline">\(2^{m/2}\)</span> computations are needed to find a collision with probability &gt; 0.5.</p>
<p><strong>Practical example:</strong> Modification of a contract into 237 variations to find a fraudulent version having the same digest as the legitimate version.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-130-contents" aria-controls="callout-130" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-130" class="callout-130-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Problem</strong>: find two values <span class="math inline">\(x, x'\)</span> distinct such that <span class="math inline">\(h(x) = h(x')\)</span>.</p>
<p><strong>Practical example</strong>: We have to have someone sign a text and we want to apply this signature to a falsified text (we control the original text). What are our chances of finding two original texts satisfying this criterion?</p>
<p>The <strong>birthday paradox</strong> is a classic probabilistic problem that shows that in a gathering of only 23 people, there is already a 50% chance of having two people with the same birthday.</p>
<p>Let <span class="math inline">\(y_1, y_2,..., y_n\)</span> all the possible outputs of a hash function. How many <span class="math inline">\(h(x_i)\)</span>: <span class="math inline">\(h(x_1), h(x_2),...,h(x_k)\)</span> must we compute to have a probability of collision equal to or greater than 0.5?</p>
<p>The first choice for <span class="math inline">\(h(x_1)\)</span> is arbitrary (prob = 1), the second <span class="math inline">\(h(x_2) \neq h(x_1)\)</span> has a probability of <span class="math inline">\(1 - 1/n\)</span>, the third of <span class="math inline">\(1 - 2/n\)</span>, etc. This gives us a probability of having no collisions equal to:</p>
<p><span class="math display">\[P_{\text{no collision}} = \prod_{i=1}^{k-1}\left(1 - \frac{i}{n}\right)\]</span></p>
<p>We easily prove (series expansion of <span class="math inline">\(e^{-x}\)</span>) that for <span class="math inline">\(0 \leq x \leq 1\)</span>: <span class="math inline">\(1-x \leq e^{-x}\)</span> and therefore:</p>
<p><span class="math display">\[P_{\text{no coll}} \leq \prod_{i=1}^{k-1}\left(1 - \frac{i}{n}\right) \leq \prod_{i=1}^{k-1} e^{-i/n} = e^{-k(k-1)/(2n)}\]</span></p>
<p>The probability of having at least one collision is <span class="math inline">\(P_{\text{at least1}} = 1 - P_{\text{no-coll}}\)</span>. To know the value of <span class="math inline">\(k\)</span> for which <span class="math inline">\(P_{\text{at least1}}\)</span> is greater than 0.5, it suffices to calculate:</p>
<p><span class="math display">\[\frac{1}{2} \leq 1 - e^{-k(k-1)/(2n)}\]</span></p>
<p>If <span class="math inline">\(k\)</span> is large, we replace <span class="math inline">\(k(k-1)\)</span> by <span class="math inline">\(k^2\)</span> and we obtain after simple calculations:</p>
<p><span class="math display">\[k \geq \sqrt{2\ln(2) \cdot n} \approx 1.17\sqrt{n}\]</span></p>
<p>Taking <span class="math inline">\(n = 365\)</span> for the birthday, we get <span class="math inline">\(k = 22.3\)</span>, which confirms the statement of the problem.</p>
<p><strong>Consequence for hash functions</strong>: Let a hash function with <span class="math inline">\(2^m\)</span> possible outputs. If <span class="math inline">\(h\)</span> is applied to <span class="math inline">\(k = 2^{m/2}\)</span> inputs we have a probability greater than 0.5 of obtaining <span class="math inline">\(h(x_i) = h(x_j)\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-131-contents" aria-controls="callout-131" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-131" class="callout-131-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Birthday paradox</strong>: to break collision resistance with <span class="math inline">\(m\)</span>-bit digest: <span class="math inline">\(2^{m/2}\)</span> attempts (prob &gt; 0.5).</p>
<p>Example: 23 people suffice for identical birthdays.</p>
</div>
</div>
</div>
</section>
</section>
<section id="computational-resistance-recap" class="level2">
<h2 class="anchored" data-anchor-id="computational-resistance-recap">Computational Resistance: Recap</h2>
<p>For a hash function with <span class="math inline">\(n\)</span>-bit digest and MAC key of <span class="math inline">\(t\)</span> bits:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Property</th>
<th>Difficulty</th>
<th>Recommended Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>OWHF</strong></td>
<td>Preimage</td>
<td><span class="math inline">\(2^n\)</span></td>
<td><span class="math inline">\(n \geq 128\)</span> bits</td>
</tr>
<tr class="even">
<td></td>
<td>2nd-preimage</td>
<td><span class="math inline">\(2^{n-1}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>CRHF</strong></td>
<td>Collision</td>
<td><span class="math inline">\(2^{n/2}\)</span></td>
<td><span class="math inline">\(n \geq 256\)</span> bits</td>
</tr>
<tr class="even">
<td><strong>MAC</strong></td>
<td>Key recovery</td>
<td><span class="math inline">\(2^t\)</span></td>
<td><span class="math inline">\(t \geq 256\)</span> bits</td>
</tr>
<tr class="odd">
<td></td>
<td>Computation</td>
<td><span class="math inline">\(\min(2^t, 2^n)\)</span></td>
<td><span class="math inline">\(n \geq 128\)</span> bits</td>
</tr>
</tbody>
</table>
<p><strong>Practical implications:</strong></p>
<ul>
<li>For integrity only (OWHF): 128 bits sufficient</li>
<li>For collision resistance (CRHF): minimum 256 bits</li>
<li>MACs: 256-bit key, 128-bit digest minimum</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-132-contents" aria-controls="callout-132" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-132" class="callout-132-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(n\)</span>: size of the MDC-value or MAC-value resulting from the application of the hash function</p>
<p><span class="math inline">\(t\)</span>: size of the MAC key</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 22%">
<col style="width: 16%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>Hash Fct. Type</th>
<th>Characteristic</th>
<th>Computational Difficulty</th>
<th>Attack Goal</th>
<th>Recommended digest/key size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>OWHF</strong></td>
<td>preimage resistance</td>
<td><span class="math inline">\(2^n\)</span></td>
<td>find a preimage</td>
<td><span class="math inline">\(n \geq 128\)</span> bits</td>
</tr>
<tr class="even">
<td></td>
<td>2nd-preimage resistance</td>
<td><span class="math inline">\(2^{n-1}\)</span></td>
<td>find <span class="math inline">\(x'\)</span> with <span class="math inline">\(h(x') = h(x)\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>CRHF</strong></td>
<td>collision resistance</td>
<td><span class="math inline">\(2^{n/2}\)</span></td>
<td>find a collision</td>
<td><span class="math inline">\(n \geq 256\)</span> bits</td>
</tr>
<tr class="even">
<td><strong>MAC</strong></td>
<td>key non-recovery</td>
<td><span class="math inline">\(2^t\)</span></td>
<td>find the key</td>
<td><span class="math inline">\(n \geq 128\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td>computation resistance</td>
<td><span class="math inline">\(\min(2^t,2^n)\)</span></td>
<td>produce a <span class="math inline">\((x, h_k(x))\)</span></td>
<td><span class="math inline">\(t \geq 256\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-133-contents" aria-controls="callout-133" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-133" class="callout-133-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Efforts</strong>: preimage <span class="math inline">\(2^n\)</span>, 2nd-preimage <span class="math inline">\(2^{n-1}\)</span>, collision <span class="math inline">\(2^{n/2}\)</span>.</p>
<p><strong>Sizes</strong>: OWHF ≥128 bits, CRHF ≥256 bits, MAC key ≥256 bits.</p>
</div>
</div>
</div>
</section>
<section id="mdcs-based-on-encryption-systems" class="level2">
<h2 class="anchored" data-anchor-id="mdcs-based-on-encryption-systems">MDCs Based on Encryption Systems</h2>
<p><strong>Principle:</strong> Use a symmetric encryption algorithm (DES, AES) to construct an MDC.</p>
<p><strong>Challenges to solve:</strong></p>
<ul>
<li>Break the reversibility of symmetric algorithms</li>
<li>Increase the nominal width (DES = 64 bits insufficient for CRHF)</li>
</ul>
<p><strong>Operation:</strong></p>
<ul>
<li>Sequential processing of blocks</li>
<li>Chaining operations with XOR</li>
<li>Combination of <span class="math inline">\(n\)</span> boxes for digests of size <span class="math inline">\(n \times\)</span> nominal width</li>
</ul>
<p><strong>Classical models:</strong></p>
<ol type="1">
<li><strong>Matyas-Meyer-Oseas</strong>: <span class="math inline">\(H_i = E_{m_i}(H_{i-1}) \oplus H_{i-1}\)</span></li>
<li><strong>Davies-Meyer</strong>: <span class="math inline">\(H_i = E_{m_i}(H_{i-1}) \oplus m_i\)</span></li>
<li><strong>Miyaguchi-Preneel</strong>: <span class="math inline">\(H_i = E_{m_i}(H_{i-1}) \oplus H_{i-1} \oplus m_i\)</span></li>
</ol>
<p><strong>Practical examples:</strong></p>
<ul>
<li><strong>MDC-2</strong>: uses 2 DES boxes → 128-bit digest</li>
<li><strong>MDC-4</strong>: uses 4 DES boxes → 128-bit digest</li>
</ul>
<p><strong>Limitation:</strong> Security strongly dependent on the underlying algorithm.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-134-contents" aria-controls="callout-134" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-134" class="callout-134-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Idea</strong>: use a known symmetric encryption system to construct an MDC.</p>
<p><strong>Problems to solve</strong>:</p>
<ul>
<li>we must “break” the reversibility of symmetric algorithms to make them OWHF or CRHF.</li>
<li>The “nominal width” of some encryption systems (eg. DES) is 64 bits, which is not sufficient to build CRHF.</li>
</ul>
<p><strong>Operating principle</strong>:</p>
<ul>
<li>the text blocks are sequentially processed by the encryption “box”.</li>
<li>compression is based on chaining operations with the blocks resulting from previous iterations and logical functions (fundamentally XOR). This also makes the process irreversible.</li>
<li>If necessary, <span class="math inline">\(n\)</span> encryption boxes will be combined to obtain digest lengths <span class="math inline">\(n\)</span> times greater than the nominal width of the boxes used.</li>
</ul>
<p><strong>Attention</strong>: the security of these algorithms is strongly dependent on the properties of the underlying encryption boxes.</p>
<p><strong>Examples</strong>:</p>
<ul>
<li>The models of <strong>Matyas-Meyer-Oseas</strong>, <strong>Davies-Meyer</strong> and <strong>Miyaguchi-Preneel</strong>.</li>
<li><strong>MDC-2</strong> and <strong>MDC-4</strong> using respectively 2 and 4 DES boxes. Digest = 128 bits.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-135-contents" aria-controls="callout-135" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-135" class="callout-135-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>MDCs from symmetric crypto: break reversibility + chaining XOR.</p>
<p>Models: Matyas-Meyer-Oseas, Davies-Meyer, Miyaguchi-Preneel.</p>
<p>MDC-2/4 with DES → 128 bits.</p>
</div>
</div>
</div>
</section>
<section id="customized-mdcs" class="level2">
<h2 class="anchored" data-anchor-id="customized-mdcs">Customized MDCs</h2>
<p>Functions specifically designed for digest generation, optimized for speed and security.</p>
<p><strong>Construction elements:</strong></p>
<ul>
<li>Padding + adding the message length</li>
<li>Predefined constants to increase dispersion</li>
<li>Successive rounds with logical operations and rotations</li>
<li>Chaining of outputs between rounds</li>
<li>Every bit of the digest depends on every input bit</li>
</ul>
<p><strong>Main algorithms:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Year</th>
<th>Digest</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>MD5</strong></td>
<td>1992</td>
<td>128 bits</td>
<td>❌ Broken</td>
</tr>
<tr class="even">
<td><strong>SHA-0</strong></td>
<td>1993</td>
<td>160 bits</td>
<td>❌ Collisions in <span class="math inline">\(2^{39}\)</span></td>
</tr>
<tr class="odd">
<td><strong>SHA-1</strong></td>
<td>1995</td>
<td>160 bits</td>
<td>⚠️ Collisions in <span class="math inline">\(2^{63}\)</span></td>
</tr>
<tr class="even">
<td><strong>SHA-2</strong></td>
<td>-</td>
<td>224-512 bits</td>
<td>✓ Currently secure</td>
</tr>
<tr class="odd">
<td><strong>SHA-3</strong> (Keccak)</td>
<td>2012</td>
<td>224-512 bits</td>
<td>✓ Current standard</td>
</tr>
</tbody>
</table>
<p><strong>Attack evolution:</strong></p>
<ul>
<li>2004: Full collisions on MD5 (X. Wang)</li>
<li>2005: SHA-1 theoretically broken (<span class="math inline">\(2^{63}\)</span> operations)</li>
<li>2008: Creation of fraudulent CA certificates via MD5</li>
<li>2012: SHA-3 adopted as new standard</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-136-contents" aria-controls="callout-136" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-136" class="callout-136-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>These are functions designed exclusively to generate integrity codes (digests) with a main concern for speed and security.</p>
<p>Their operation is based on the following elements:</p>
<ul>
<li>initialization operations (<strong>padding</strong> + adding the length).</li>
<li>a set of <strong>predefined constants</strong> chosen specifically to increase dispersion.</li>
<li>a set of “steps” (<strong>rounds</strong>) that will sequentially apply to all the original data blocks. These rounds will perform a combination of logical operations and rotations on the data and constants.</li>
<li><strong>chaining</strong> operations involving the outputs of previous rounds.</li>
</ul>
<p>In these functions, every bit of the digest is a function of every bit of the inputs.</p>
<p>The most famous are:</p>
<ul>
<li><strong>MD5</strong>: R. Rivest, 1992; RFC 1321. Digest = 128 bits. <strong>Broken!</strong></li>
<li><strong>SHA-0</strong>: NIST, 1993. Digest = 160 bits. Collisions in <span class="math inline">\(2^{39}\)</span> operations instead of <span class="math inline">\(2^{80}\)</span></li>
<li><strong>SHA-1</strong>: NIST, 1995. Digest = 160 bits. Revision of SHA-0 with additional bit rotation. Collisions in <span class="math inline">\(2^{63}\)</span> operations (instead of <span class="math inline">\(2^{80}\)</span>).</li>
<li><strong>SHA-2</strong>: NIST (FIPS 190-3). Includes: SHA-224, SHA-256, SHA-384 and SHA-512. Digest sizes range from 224 to 512 bits.</li>
<li><strong>SHA-3</strong>: Keccak Algorithm (digest size variable from 224 to 512 bits)</li>
</ul>
<p><strong>Latest Developments</strong>:</p>
<ul>
<li>X.Wang et al.&nbsp;culminated in 2004 a long work aiming to find collisions in the MD5 algorithm. They publish two pairs of collisions for 1024-bit messages.</li>
<li>In 2005, X.Wang et al.&nbsp;prove at the CRYPTO’05 conference that the number of operations needed to find collisions on SHA-1 (current standard for secure hash functions) is only <span class="math inline">\(2^{63}\)</span>.</li>
<li>These attacks target the search for arbitrary collisions but during CRYPTO’06 researchers from the University of Graz in Austria propose a method to partially control the content of collisions.</li>
<li>In December 2008 it is shown that controlled collisions on MD5 can be generated and thus create an illicit Certification Authority allowing to forge certificates accepted by any browser.</li>
<li>These results rely on <strong>analytical</strong> approaches (as opposed to brute force!)</li>
<li>The selection process for SHA-1’s successor is similar to the one that designated AES as a block encryption standard. NIST decided (October 2012) that <strong>Keccak</strong> would be the base algorithm for <strong>SHA-3</strong>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-137-contents" aria-controls="callout-137" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-137" class="callout-137-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Customized MDCs</strong></p>
<ul>
<li>MD5 (broken)</li>
<li>SHA-0 (broken)</li>
<li>SHA-1 (weak)</li>
<li>SHA-2 (secure)</li>
<li>SHA-3/Keccak (current standard).</li>
</ul>
<p>Construction: padding + constants + rounds + chaining.</p>
</div>
</div>
</div>
</section>
<section id="macs-based-on-encryption-systems" class="level2">
<h2 class="anchored" data-anchor-id="macs-based-on-encryption-systems">MACs Based on Encryption Systems</h2>
<p><strong>CBC-MAC:</strong> Uses a block cipher algorithm in CBC mode.</p>
<p><strong>Operation:</strong></p>
<ul>
<li>CBC mode with IV = 0</li>
<li>Elimination of intermediate ciphertexts</li>
<li>Only the last encrypted block is kept as MAC</li>
</ul>
<p><strong>With DES:</strong></p>
<ul>
<li>Key length: 56 bits (112 in optional Triple-DES)</li>
<li>MAC length: 64 bits</li>
</ul>
<p><strong>Advantages:</strong></p>
<ul>
<li>Reuse of existing encryption infrastructure</li>
<li>Acceptable performance</li>
</ul>
<p><strong>Limitations:</strong></p>
<ul>
<li>Security limited by block size (64 bits for DES)</li>
<li>Vulnerable if used incorrectly (ex: without variable IV)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-138-contents" aria-controls="callout-138" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-138" class="callout-138-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CBC-MAC algorithm based on DES-CBC with IV = 0 and elimination of intermediate ciphertexts</strong></p>
<ul>
<li>key length = 56 bits (112 in case of using the optional part)</li>
<li>MAC-value length = 64 bits</li>
</ul>
<p>The diagram shows the sequential processing of message blocks <span class="math inline">\(M_1, M_2, M_3\)</span> with the encryption algorithm <span class="math inline">\(E\)</span> and the key <span class="math inline">\(k\)</span>. The intermediate ciphertexts <span class="math inline">\(C_1, C_2\)</span> are eliminated. Only the last block <span class="math inline">\(C_3\)</span> constitutes the MAC.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-139-contents" aria-controls="callout-139" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-139" class="callout-139-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CBC-MAC</strong>: CBC mode + IV=0, only last block kept. DES: key 56/112 bits, MAC 64 bits.</p>
</div>
</div>
</div>
</section>
<section id="nested-macs-and-hmacs" class="level2">
<h2 class="anchored" data-anchor-id="nested-macs-and-hmacs">Nested MACs and HMACs</h2>
<p><strong>Nested MAC (NMAC):</strong> Composition of two MAC families <span class="math inline">\(G\)</span> and <span class="math inline">\(H\)</span>:</p>
<p><span class="math display">\[\text{NMAC}_{k,l}(x) = g_k(h_l(x))\]</span></p>
<p><strong>Security:</strong> Depends on two criteria:</p>
<ul>
<li><span class="math inline">\(G\)</span> resistant to collisions</li>
<li><span class="math inline">\(H\)</span> resistant to specific MAC attacks</li>
</ul>
<p><strong>HMAC (FIPS 198 standard, 2002):</strong> Nested MAC using unkeyed MDCs (SHA-1, SHA-256).</p>
<p><strong>Construction:</strong></p>
<ul>
<li>Constants: <code>ipad = 0x363636...36</code> and <code>opad = 0x5C5C5C...5C</code> (512 bits)</li>
<li>Key <span class="math inline">\(k\)</span> of 512 bits</li>
</ul>
<p><span class="math display">\[\text{HMAC-256}_k(x) = \text{SHA-256}((k \oplus \text{opad}) \parallel \text{SHA-256}((k \oplus \text{ipad}) \parallel x))\]</span></p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Most widely used MACs in practice</li>
<li>Attacks on SHA more difficult with secret key</li>
<li>Excellent performance</li>
<li>Standardized and widely supported</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-140-contents" aria-controls="callout-140" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-140" class="callout-140-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A <strong>Nested MAC</strong> or <strong>NMAC</strong> is a composition of 2 families of MAC functions <span class="math inline">\(G\)</span> and <span class="math inline">\(H\)</span> parameterized by keys <span class="math inline">\(k\)</span> and <span class="math inline">\(l\)</span> such that:</p>
<p><span class="math display">\[G \circ H = \{ g \circ h \text{ with } g \in G \text{ and } h \in H \} \text{ with } g \circ h_{(k,l)}(x) = g_k(h_l(x))\]</span></p>
<p>The security of an NMAC depends on two criteria:</p>
<ul>
<li>The family of functions <span class="math inline">\(G\)</span> is collision resistant.</li>
<li>The family of functions <span class="math inline">\(H\)</span> is resistant to specific attacks for MACs, i.e.: It is impossible to find a pair <span class="math inline">\((x,y)\)</span> and a fixed but unknown key <span class="math inline">\(m\)</span>, such that: <span class="math inline">\(\text{MAC}_m(x) = y\)</span>.</li>
</ul>
<p>An <strong>HMAC</strong> (FIPS 198, 2002) is a Nested MAC using at its base dedicated unkeyed MDCs like SHA-1 or SHA-256.</p>
<p>An HMAC uses two 512-bit constants called <code>ipad</code> and <code>opad</code> such that:</p>
<ul>
<li><code>opad := 363636 ... 36</code></li>
<li><code>ipad := 5C5C5C ... 5C</code></li>
</ul>
<p>and a key <span class="math inline">\(k\)</span> of 512 bits.</p>
<p>The operating scheme of HMAC-256 (based on SHA-256) is as follows:</p>
<p><span class="math display">\[\text{HMAC-256}_k(x) := \text{SHA-256}((k \oplus \text{opad}) \parallel \text{SHA-256}((k \oplus \text{ipad}) \parallel x))\]</span></p>
<p><strong>HMACs</strong> are the most used MACs. The attacks mentioned on the functions of the SHA family are more difficult to carry out on an HMAC because of the key <span class="math inline">\(k\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-141-contents" aria-controls="callout-141" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-141" class="callout-141-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>HMAC</strong>: double hash with derived keys (<code>ipad</code>/<code>opad</code>). <span class="math inline">\(\text{HMAC}_k(x) = H((k \oplus \text{opad}) \parallel H((k \oplus \text{ipad}) \parallel x))\)</span>. Standard, secure, performant.</p>
</div>
</div>
</div>
</section>
<section id="hash-functions-applications" class="level2">
<h2 class="anchored" data-anchor-id="hash-functions-applications">Hash Functions Applications</h2>
<section id="data-integrity" class="level3">
<h3 class="anchored" data-anchor-id="data-integrity">Data Integrity</h3>
<p><strong>Three main approaches:</strong></p>
<ol type="1">
<li><strong>MAC only:</strong>
<ul>
<li><span class="math inline">\(A \to B: X, \text{MAC}_k(X)\)</span></li>
<li>Authentication + integrity guaranteed</li>
<li>Requires shared key</li>
</ul></li>
<li><strong>MDC + Encryption:</strong>
<ul>
<li><span class="math inline">\(A \to B: E_k(X, \text{MDC}(X))\)</span></li>
<li>Confidentiality + integrity</li>
<li>Shared symmetric key</li>
</ul></li>
<li><strong>MDC + Authentic channel:</strong>
<ul>
<li><span class="math inline">\(A \to B: X\)</span> (normal channel)</li>
<li><span class="math inline">\(A \to B: \text{MDC}(X)\)</span> (authentic channel)</li>
<li>Channel separation</li>
</ul></li>
</ol>
<p><strong>Limitations:</strong> These simple protocols offer no protection against replay attacks.</p>
<p><strong>Solution:</strong> add timestamps or sequence numbers.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-142-contents" aria-controls="callout-142" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-142" class="callout-142-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>MAC Only</strong>: <span class="math display">\[A \to B: X, \text{MAC}_k(X)\]</span> If <span class="math inline">\(B\)</span> computes on its side <span class="math inline">\(\text{MAC}_k(X)\)</span> and obtains the same value ⇒ the message comes from <span class="math inline">\(A\)</span>.</p>
<p><strong>MDC + symmetric encryption</strong> (key <span class="math inline">\(k\)</span> known to <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) <span class="math display">\[A \to B: X, E_k(\text{MDC}(X))\]</span> <span class="math inline">\(B\)</span> computes <span class="math inline">\(\text{MDC}(X)\)</span> and then <span class="math inline">\(E_k(\text{MDC}(X))\)</span>. If equal ⇒ message comes from <span class="math inline">\(A\)</span>.</p>
<p><strong>As 2) with confidentiality of <span class="math inline">\(X\)</span> added</strong>: <span class="math display">\[A \to B: E_k(X,\text{MDC}(X))\]</span></p>
<p><strong>MDC + digital signature</strong>: <span class="math display">\[A \to B: X, \text{Sig}_{\text{priv-A}}(\text{MDC}(X))\]</span> <span class="math inline">\(B\)</span> computes <span class="math inline">\(\text{MDC}(X)\)</span> and verifies <span class="math inline">\(\text{Sig}_{\text{priv-A}}(\text{MDC}(X))\)</span> with an authentic copy of <code>pub-A</code>. If equality ⇒ <span class="math inline">\(A\)</span> is the origin of the message. This solution additionally offers <strong>origin non-repudiation</strong>.</p>
<p>These simple protocols offer no support for uniqueness nor for the timeliness of received messages and are exposed to <strong>replay attacks</strong>! They require mechanisms taking into account time or the transaction context (cf.&nbsp;entity authentication).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-143-contents" aria-controls="callout-143" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-143" class="callout-143-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Integrity</strong>: MAC only, MDC+crypto, MDC+signature.</p>
<p>⚠️ Vulnerable to replay without timestamps/nonces.</p>
</div>
</div>
</div>
</section>
<section id="blockchains-and-proof-of-work" class="level3">
<h3 class="anchored" data-anchor-id="blockchains-and-proof-of-work">Blockchains and Proof of Work</h3>
<p><strong>Bitcoin and blockchains:</strong> Use of hash functions to chain transaction blocks.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Public and visible transactions</li>
<li>Blocks chained via cryptographic hash functions</li>
<li>Mining = solving a cryptographic puzzle (proof of work)</li>
</ul>
<p><strong>Proof of Work:</strong></p>
<ul>
<li>Find a nonce such that <span class="math inline">\(\text{hash}(\text{block} \parallel \text{nonce}) &lt; \text{target}\)</span></li>
<li>Computationally expensive puzzle, rapid validation</li>
<li>First miner to solve receives bitcoin reward</li>
</ul>
<p><strong>Security:</strong></p>
<ul>
<li>Blockchain = public, decentralized, immutable ledger</li>
<li>Falsification would require effort &gt; all honest miners</li>
<li>Protection based on CRHF properties</li>
</ul>
<p><strong>Bitcoin statistics (October 2025):</strong></p>
<ul>
<li>Difficulty: 150.84 T</li>
<li>Target: <span class="math inline">\(\approx 2^{177}\)</span> (pseudo-collision on 79 bits)</li>
<li>Hashrate: ~1.1 ZH/sec (<span class="math inline">\(1.1 \times 10^{21}\)</span> hash/sec)</li>
<li>Average block generation time: 10 minutes</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-144-contents" aria-controls="callout-144" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-144" class="callout-144-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Bitcoin transactions are published and visible by all participants. They are encapsulated in blocks chained using cryptographic hash functions.</p>
<p><strong>Mining</strong> consists of iteratively adding new blocks containing current transactions.</p>
<p>Generating a valid block requires solving a <strong>cryptographic puzzle</strong> (proof of work) very costly in computation time (finding pseudo-collisions in cryptographic hash functions). Validation remains very efficient.</p>
<p>The first miner able to generate a valid block will receive a monetary reward (in bitcoins). The mining process is open to all miners but only the first is rewarded.</p>
<p>The resulting chain of blocks (<strong>blockchain</strong>) then becomes a public ledger, decentralized and <strong>immutable</strong> protecting all past transactions. Falsification/modification of data protected by the blockchain would require computational effort greater than that performed by all honest miners.</p>
<p><strong>Bitcoin Statistics 13/10/2025</strong>:</p>
<ul>
<li><strong>Difficulty</strong>: 150.84 T</li>
<li><strong>Target</strong>: <span class="math inline">\(2^{224} / \text{Difficulty} = \approx 2^{177}\)</span>. The valid digest to generate a block must be less than <span class="math inline">\(2^{177}\)</span>, which means a pseudo-collision on the 79 most significant bits. The variation on the inputs depends on the <strong>nonce</strong>.</li>
<li><strong>Hashrate</strong>: ~ 1.1 ZH/sec (<span class="math inline">\(1.1 \times 10^{21}\)</span> hashes /sec)</li>
<li><strong>Hash functions executed to obtain a block</strong>: ~ <span class="math inline">\(660 \times 10^{21}\)</span></li>
<li><strong>Average block generation time</strong>: 10 min</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-145-contents" aria-controls="callout-145" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-145" class="callout-145-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Blockchain</strong>: chaining of blocks via hash.</p>
<p><strong>Proof of Work</strong>: find nonce for hash &lt; target.</p>
<p>Security = effort &gt; all miners.</p>
<p>Bitcoin: ~10 min/block, <span class="math inline">\(10^{21}\)</span> hash/sec.</p>
</div>
</div>
</div>
</section>
<section id="other-applications" class="level3">
<h3 class="anchored" data-anchor-id="other-applications">Other Applications</h3>
<p><strong>1. Authentication:</strong></p>
<ul>
<li>Data origin authentication (DOA)</li>
<li>Transaction authentication (DOA + temporal parameters)</li>
</ul>
<p><strong>2. Virus checking:</strong></p>
<ul>
<li>Creator publishes <span class="math inline">\(\text{digest} = h(\text{software})\)</span> via secure channel</li>
<li>Users verify integrity by recalculating the digest</li>
</ul>
<p><strong>3. Public key distribution:</strong></p>
<ul>
<li>Publish <span class="math inline">\(h(\text{public key})\)</span> instead of the complete key</li>
<li>Simplified authenticity verification</li>
</ul>
<p><strong>4. Document timestamping:</strong></p>
<ul>
<li>Timestamp applied to digest rather than complete document</li>
<li>Reduction of data to sign</li>
</ul>
<p><strong>5. One-time password (S-Key):</strong></p>
<ul>
<li>Hash chain: <span class="math inline">\(x_1 = h(x_0), x_2 = h(x_1), \ldots, x_n = h(x_{n-1})\)</span></li>
<li>System stores <span class="math inline">\(x_n\)</span>, user provides <span class="math inline">\(x_{n-1}\)</span></li>
<li>Verification: <span class="math inline">\(h(x_{n-1}) = x_n\)</span></li>
<li>After validation, system stores <span class="math inline">\(x_{n-1}\)</span> for next time</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-146-contents" aria-controls="callout-146" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-146" class="callout-146-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Authentication</strong>:</p>
<ul>
<li>data origin authentication (DOA)</li>
<li>transaction authentication (= DOA + time-variant parameters)</li>
</ul>
<p><strong>Virus checking</strong>:</p>
<ul>
<li>The creator of software creates a digest = <span class="math inline">\(h(x)\)</span> with <span class="math inline">\(x\)</span> being the original and distributes it via a secure channel (eg. CD-ROM).</li>
</ul>
<p><strong>Distribution of public keys</strong>:</p>
<ul>
<li>Allows controlling the authenticity of a public key.</li>
</ul>
<p><strong>Timestamp on a document</strong>:</p>
<ul>
<li>The document on which we want to perform the timestamp is first submitted to a hash function. The timestamp (with the signature of the corresponding entity) then applies only to the digest.</li>
</ul>
<p><strong>One-time password (S-Key)</strong> (identification mechanism):</p>
<ul>
<li>From a secret seed <span class="math inline">\(x_0\)</span>, we create a chain of hash-values: <span class="math inline">\(x_1 = h(x_0)\)</span>, <span class="math inline">\(x_2 = h(x_1)\)</span>, … <span class="math inline">\(x_n = h(x_{n-1})\)</span>.</li>
<li>The system stores <span class="math inline">\(x_n\)</span> and the user enters <span class="math inline">\(x_{n-1}\)</span>. If <span class="math inline">\(h(x_{n-1}) == x_n\)</span> ⇒ OK.</li>
<li>The system then stores <span class="math inline">\(x_{n-1}\)</span> and so on.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-147-contents" aria-controls="callout-147" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-147" class="callout-147-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Applications</strong></p>
<ul>
<li>authentication</li>
<li>virus checking</li>
<li>public key distribution</li>
<li>timestamping</li>
<li>one-time passwords (hash chain)</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="randomized-hash-functions-unix-example" class="level2">
<h2 class="anchored" data-anchor-id="randomized-hash-functions-unix-example">Randomized Hash Functions: UNIX Example</h2>
<p><strong>Problem:</strong> Deterministic hash functions always produce the same result for the same password.</p>
<p><strong>Risks:</strong></p>
<ul>
<li>Detection of identical passwords</li>
<li>Offline dictionary attacks (pre-computed codebooks)</li>
<li>Rainbow tables</li>
</ul>
<p><strong>UNIX solution: Salt</strong></p>
<ul>
<li>Addition of a 12-bit pseudo-random element (salt) before hashing</li>
<li>Different salt for each user</li>
<li>4096 possibilities (<span class="math inline">\(2^{12}\)</span>) for each password</li>
</ul>
<p><strong>Advantages:</strong></p>
<ul>
<li>Prevents detection of duplicates</li>
<li>Pre-computed codebooks become ineffective</li>
<li>Each password requires 4096 dictionary entries</li>
</ul>
<p><strong>UNIX implementation:</strong></p>
<ul>
<li>File <code>/etc/passwd</code> globally accessible</li>
<li>Format: <code>username:hash(salt+password):uid:gid:...</code></li>
<li>Hash based on modified DES (25 iterations)</li>
<li>Salt stored in clear (first 2 characters of hash)</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code>root:Jw87u9bebeb9i:0:1:Operator:/:/bin/csh
pp:1Qhw.oihEtHK6:359:355:PP:/net/spp_telecom/pp:/bin/cs</code></pre>
<p><strong>Limitations:</strong></p>
<ul>
<li>Effective protection against pre-computed dictionaries</li>
<li>Online attacks limited by the system (number of attempts)</li>
<li>Offline attacks possible if file compromised</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Original Text">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-148-contents" aria-controls="callout-148" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-148" class="callout-148-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>UNIX keeps its passwords in a globally accessible file (or possibly distributed by NIS). The stored information corresponds to the result produced by a hash function.</p>
<p><strong>Example (fictional)</strong>:</p>
<pre><code>root:Jw87u9bebeb9i:0:1:Operator:/:/bin/csh
pp:1Qhw.oihEtHK6:359:355:PP:/net/spp_telecom/pp:/bin/cs</code></pre>
<p><strong>Problems</strong>:</p>
<ul>
<li>the hash function being deterministic, it produces the same result for identical passwords.</li>
<li>one could create “books” (codebooks) containing the result of applying the hash function to given inputs (eg. a dictionary) and easily compare them (off-line) with the strings stored by UNIX (<strong>brute force dictionary attack</strong>).</li>
</ul>
<p><strong>Solution</strong>:</p>
<ul>
<li>Add a (pseudo) random element of <strong>12 bits</strong> different for each password (called <strong>salt</strong>) before computing the hash function and during verification.</li>
<li>This element allows adding a random factor of <strong>4096 possibilities</strong> for each password and prevents detection of duplicates.</li>
</ul>
<p>The operating scheme uses DES with 25 iterations, the password as key, and the salt to modify the E-boxes. The final 64-bit result is converted to 11 ASCII characters.</p>
<p>User awareness (not visiting dubious sites) decreases the effectiveness of this technique in malware transmission.</p>
<p>Dictionary attacks are normally less effective <strong>online</strong> because operating systems limit the number of unsuccessful authentication attempts.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Quick Revision">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-149-contents" aria-controls="callout-149" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-149" class="callout-149-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>UNIX salt</strong>: 12 random bits added to password before hash.</p>
<p>4096 possible variations.</p>
<p>Prevents pre-computed codebooks and duplicate detection.</p>
</div>
</div>
</div>
</section>
</section>
<section id="digital-signatures" class="level1">
<h1>Digital Signatures</h1>
<section id="introduction-and-definitions" class="level2">
<h2 class="anchored" data-anchor-id="introduction-and-definitions">Introduction and Definitions</h2>
<p>A <strong>digital signature</strong> is a string of data associating a message with an originating entity, the digital equivalent of a handwritten signature.</p>
<p><strong>Classification:</strong></p>
<ul>
<li><strong>With appendix</strong>: requires the original message for verification (ElGamal, DSS)</li>
<li><strong>With message recovery</strong>: allows reconstruction of the message (RSA, Rabin)</li>
</ul>
<p>Signatures primarily use <strong>asymmetric cryptography</strong> to explicitly identify an entity.</p>
<p><strong>arbitrated digital signatures</strong>: symmetric technology + Trusted Third Parties (TTP)</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-150-contents" aria-controls="callout-150" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-150" class="callout-150-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Digital signature</strong>: string of data allowing to associate a message (in digital form) with an originating entity.</p>
<p><strong>Digital signature scheme</strong>: generation algorithm + verification algorithm.</p>
<p><strong>Signature process</strong>: message formatting + signature generation algorithm.</p>
<p><strong>Verification process</strong>: verification algorithm + (message reconstruction).</p>
<p><strong>Classification of digital signatures</strong>:</p>
<ul>
<li><strong>Digital signatures with appendix</strong> which require the presence of the original message to verify the validity of the signature. These are the most commonly used. Examples: ElGamal, DSS.</li>
<li><strong>Digital signatures with message recovery</strong> which offer, in addition, the possibility to reconstruct the message from the signature. Examples: RSA, Rabin.</li>
</ul>
<p>Digital signatures are mostly based on <strong>asymmetric crypto</strong> because the concept of a shared key is not suitable for the need to identify an entity explicitly.</p>
<p>Commitments similar to those obtained with a public key signature (such as origin non-repudiation) can however be obtained with symmetric technology and trusted third parties (TTP). These methods are called: <strong>arbitrated digital signatures</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-151-contents" aria-controls="callout-151" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-151" class="callout-151-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Digital signature</strong> = string associating message + entity</p>
<p><strong>Two types</strong></p>
<ul>
<li>with appendix (requires original message)</li>
<li>with recovery (reconstructs the message)</li>
</ul>
<p>Based on asymmetric crypto</p>
</div>
</div>
</div>
<hr>
</section>
<section id="formal-framework-signatures-with-appendix" class="level2">
<h2 class="anchored" data-anchor-id="formal-framework-signatures-with-appendix">Formal Framework: Signatures with Appendix</h2>
<p><strong>Working spaces:</strong></p>
<ul>
<li><span class="math inline">\(M\)</span>: message space</li>
<li><span class="math inline">\(M_h\)</span>: hashed messages where <span class="math inline">\(m_h = H(m)\)</span> with <span class="math inline">\(H\)</span> a hash function</li>
<li><span class="math inline">\(S\)</span>: space of possible signatures</li>
</ul>
<p><strong>Operation:</strong></p>
<p>Each entity A defines:</p>
<ul>
<li><span class="math inline">\(S_A : M_h \rightarrow S\)</span> (signature function, uses private key)</li>
<li><span class="math inline">\(V_A : M_h \times S \rightarrow \{\text{true}, \text{false}\}\)</span> (verification, uses public key)</li>
</ul>
<p>With <span class="math inline">\(V_A(m_h, s) = \text{true}\)</span> if and only if <span class="math inline">\(S_A(m_h) = s\)</span></p>
<p><strong>Essential properties:</strong></p>
<ul>
<li><span class="math inline">\(S_A\)</span> and <span class="math inline">\(V_A\)</span> easy to compute with the correct keys</li>
<li>Impossible to find a valid <span class="math inline">\((m', s')\)</span> without A’s private key</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-152-contents" aria-controls="callout-152" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-152" class="callout-152-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We assume that each entity has a private key to sign messages and an authentic copy of the public keys of correspondents.</p>
<p><strong>Notation:</strong> - M: Message space - <span class="math inline">\(M_h\)</span>: <span class="math inline">\(m_h = H(m)\)</span> with <span class="math inline">\(m \in M\)</span>, <span class="math inline">\(m_h \in M_h\)</span> and <span class="math inline">\(H\)</span> a hash function - S: Space of values that can be obtained by a signature process</p>
<p><strong>Description:</strong></p>
<p>Each entity defines an injective function <span class="math inline">\(S_A : M_h \rightarrow S\)</span> (i.e., the signature)</p>
<p>The function <span class="math inline">\(S_A\)</span> gives rise to a function <span class="math inline">\(V_A\)</span>: <span class="math inline">\(V_A : M_h \times S \rightarrow \{\text{true}, \text{false}\}\)</span> (i.e., the verification)</p>
<p>such that <span class="math inline">\(\forall m_h \in M_h\)</span>, <span class="math inline">\(s \in S\)</span>, we have: <span class="math inline">\(V_A(m_h, s) = \text{true}\)</span> if <span class="math inline">\(S_A(m_h) = s\)</span> and <span class="math inline">\(V_A(m_h, s) = \text{false}\)</span> otherwise</p>
<p>The operations <span class="math inline">\(S_A\)</span> require the private key of A while the operations <span class="math inline">\(V_A\)</span> use the public key of A.</p>
<p><strong>Some simple properties:</strong></p>
<ul>
<li>The operations <span class="math inline">\(S_A\)</span> and <span class="math inline">\(V_A\)</span> must be easy to compute (having the corresponding keys)</li>
<li>It is impossible (computationally) for an entity not having the private key of A to find an <span class="math inline">\(m'\)</span> and an <span class="math inline">\(s'\)</span> with <span class="math inline">\(m' \in M\)</span> and <span class="math inline">\(s' \in S\)</span> such that <span class="math inline">\(V_A(m'_h, s') = \text{true}\)</span> with <span class="math inline">\(m'_h = H(m')\)</span>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-153-contents" aria-controls="callout-153" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-153" class="callout-153-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Signature: <span class="math inline">\(S_A(m_h) = s\)</span> (private key).</p>
<p>Verification: <span class="math inline">\(V_A(m_h, s)\)</span> (public key).</p>
<p>Impossible to forge without private key.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="formal-framework-signatures-with-recovery" class="level2">
<h2 class="anchored" data-anchor-id="formal-framework-signatures-with-recovery">Formal Framework: Signatures with Recovery</h2>
<p><strong>Additional spaces:</strong></p>
<ul>
<li><span class="math inline">\(M_S\)</span>: space on which the signature is applied</li>
<li><span class="math inline">\(R : M \rightarrow M_S\)</span>: redundancy function (injective, invertible, public)</li>
<li><span class="math inline">\(M_R = \text{Im}(R)\)</span>: image of <span class="math inline">\(R\)</span></li>
</ul>
<p><strong>Operation:</strong></p>
<ul>
<li>Signature: <span class="math inline">\(S_A : M_S \rightarrow S\)</span> (injective)</li>
<li>Verification: <span class="math inline">\(V_A : S \rightarrow M_S\)</span> with <span class="math inline">\(V_A \circ S_A = \text{Identity}\)</span></li>
</ul>
<p><strong>Generation:</strong></p>
<ol type="1">
<li>Compute <span class="math inline">\(m_R = R(m)\)</span> and <span class="math inline">\(s = S_A(m_R)\)</span></li>
<li>Publish <span class="math inline">\(s\)</span> as A’s signature on <span class="math inline">\(m\)</span></li>
</ol>
<p><strong>Verification:</strong></p>
<ol type="1">
<li>Compute <span class="math inline">\(m_R = V_A(s)\)</span> with public key</li>
<li>Verify <span class="math inline">\(m_R \in M_R\)</span> (reject otherwise)</li>
<li>Reconstruct <span class="math inline">\(m = R^{-1}(m_R)\)</span></li>
</ol>
<p><strong>Redundancy function:</strong></p>
<p>Essential for security. If <span class="math inline">\(M_R = M_S\)</span>, it becomes trivial to forge signatures.</p>
<p><strong>Example:</strong> <span class="math inline">\(R(m) = m \parallel m\)</span> (concatenation). Forgery probability: <span class="math inline">\((1/2)^n\)</span> for an <span class="math inline">\(n\)</span>-bit message.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-154-contents" aria-controls="callout-154" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-154" class="callout-154-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Notation:</strong> in addition to the previous definitions, we have:</p>
<p><span class="math inline">\(M_S\)</span>: The space of elements on which a signature can be applied.</p>
<p><span class="math inline">\(R\)</span>: An injective function: <span class="math inline">\(M \rightarrow M_S\)</span>, called the redundancy function. It must be invertible and public.</p>
<p><span class="math inline">\(M_R = \text{Im}(R)\)</span></p>
<p><strong>Description:</strong></p>
<p>Each entity defines an injective function <span class="math inline">\(S_A : M_S \rightarrow S\)</span> (i.e., the signature)</p>
<p>The function <span class="math inline">\(S_A\)</span> gives rise to a function <span class="math inline">\(V_A : S \rightarrow M_S\)</span> (i.e., the verification) such that <span class="math inline">\(V_A \circ S_A = \text{Identity}\)</span> on <span class="math inline">\(M_S\)</span></p>
<p>Note that verification is performed without the private key of A</p>
<p><strong>Signature generation:</strong> 1. Compute <span class="math inline">\(m_R = R(m)\)</span> and <span class="math inline">\(s = S_A(m_R)\)</span> 2. Make <span class="math inline">\(s\)</span> public as A’s signature on <span class="math inline">\(m\)</span>. This allows other entities to verify the signature and reconstruct <span class="math inline">\(m\)</span>.</p>
<p><strong>Verification:</strong> 1. Compute <span class="math inline">\(m_R = V_A(s)\)</span> (with A’s public key) 2. Verify that <span class="math inline">\(m_R \in M_R\)</span> (otherwise reject the signature) 3. Reconstruct <span class="math inline">\(m\)</span> by computing: <span class="math inline">\(R^{-1}(m_R)\)</span></p>
<p><strong>Properties:</strong></p>
<ul>
<li>The operations <span class="math inline">\(S_A\)</span> and <span class="math inline">\(V_A\)</span> must be easy to compute (having the corresponding keys)</li>
<li>It is impossible (computationally) for an entity not having the private key of A to find an <span class="math inline">\(s' \in S\)</span> such that <span class="math inline">\(V_A(s') \in M_R\)</span></li>
</ul>
<p><strong>Remarks on the redundancy function:</strong></p>
<ul>
<li>The choice of a redundancy function is <strong>essential for the security</strong> of the system.</li>
<li>If <span class="math inline">\(M_R = M_S\)</span> and <span class="math inline">\(R\)</span> and <span class="math inline">\(S_A\)</span> are bijections respectively from <span class="math inline">\(M\)</span> to <span class="math inline">\(M_R\)</span> and from <span class="math inline">\(M_S\)</span> to <span class="math inline">\(S\)</span>, then <span class="math inline">\(M\)</span> and <span class="math inline">\(S\)</span> have identical size and, consequently, it is trivial to forge messages bearing A’s signature.</li>
</ul>
<p><strong>Example of redundancy function:</strong> let <span class="math inline">\(M = \{m : m \in \{0,1\}^n\}\)</span> (n message size) and <span class="math inline">\(M_S = \{t : t \in \{0,1\}^{2n}\}\)</span>. Let <span class="math inline">\(R : M \rightarrow M_S\)</span> such that <span class="math inline">\(R(m) = m \parallel m\)</span> (<span class="math inline">\(\parallel\)</span> being the concatenation of 2 messages). The probability of falling on such a message when trying to forge a message from a signature is: <span class="math inline">\(|M_R| / |M_S| = (1/2)^n\)</span>, which is negligible for large messages.</p>
<p><strong>Attention!</strong>: A redundancy function suitable for one digital signature scheme may cause vulnerabilities in another different one!</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-155-contents" aria-controls="callout-155" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-155" class="callout-155-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>With recovery:</strong> Redundancy function <span class="math inline">\(R(m) = m_R\)</span>.</p>
<p>Signature <span class="math inline">\(s = S_A(m_R)\)</span>.</p>
<p>Verification: <span class="math inline">\(m_R = V_A(s)\)</span>, reconstruct <span class="math inline">\(m = R^{-1}(m_R)\)</span>.</p>
<p>Redundancy crucial for security.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="rsa-signature" class="level2">
<h2 class="anchored" data-anchor-id="rsa-signature">RSA Signature</h2>
<p><strong>Key generation:</strong></p>
<ul>
<li>Choose two large prime numbers <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span></li>
<li>Compute <span class="math inline">\(n = pq\)</span> and <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span></li>
<li>Choose <span class="math inline">\(e\)</span> with <span class="math inline">\(\text{gcd}(e, \phi(n)) = 1\)</span></li>
<li>Compute <span class="math inline">\(d\)</span> such that <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span></li>
<li><strong>Public key</strong>: <span class="math inline">\((n, e)\)</span>; <strong>Private key</strong>: <span class="math inline">\(d\)</span></li>
</ul>
<p><strong>Signature:</strong></p>
<ol type="1">
<li>Compute <span class="math inline">\(m_R = R(m)\)</span> (redundancy function)</li>
<li>Compute <span class="math inline">\(s = m_R^d \bmod n\)</span></li>
<li>Send <span class="math inline">\(s\)</span></li>
</ol>
<p><strong>Verification:</strong></p>
<ol type="1">
<li>Compute <span class="math inline">\(m'_R = s^e \bmod n\)</span></li>
<li>Verify <span class="math inline">\(m'_R \in M_R\)</span> (reject otherwise)</li>
<li>Reconstruct <span class="math inline">\(m = R^{-1}(m'_R)\)</span></li>
</ol>
<p><strong>Variant with appendix:</strong></p>
<ul>
<li><strong>Signature</strong>: <span class="math inline">\(m_h = H(m)\)</span>, then <span class="math inline">\(s = m_h^d \bmod n\)</span></li>
<li><strong>Verification</strong>: <span class="math inline">\(m'_h = s^e \bmod n\)</span>, accept if <span class="math inline">\(m'_h = H(m)\)</span></li>
</ul>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Signature slower than verification (<span class="math inline">\(d\)</span> large, <span class="math inline">\(e\)</span> small)</li>
<li>Differentiate signature/encryption keys</li>
<li>Vulnerable to the same attacks as RSA encryption</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-156-contents" aria-controls="callout-156" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-156" class="callout-156-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Key generation:</strong></p>
<ul>
<li>Each entity (A) creates a key pair (public and private) as follows:</li>
<li>A chooses the size of the modulus <span class="math inline">\(n\)</span> (e.g., size<span class="math inline">\((n) = 1024\)</span> or size<span class="math inline">\((n) = 2048\)</span>).</li>
<li>A generates two prime numbers <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> of large size <span class="math inline">\((n/2)\)</span>.</li>
<li>A computes <span class="math inline">\(n := pq\)</span> and <span class="math inline">\(\phi(n) = (p-1)(q-1)\)</span>.</li>
<li>A generates the verification exponent <span class="math inline">\(e\)</span>, with <span class="math inline">\(1 &lt; e &lt; \phi(n)\)</span> such that <span class="math inline">\(\text{gcd}(e, \phi(n)) = 1\)</span>.</li>
<li>A computes the signature exponent <span class="math inline">\(d\)</span>, such that: <span class="math inline">\(ed \equiv 1 \pmod{\phi(n)}\)</span> using the extended Euclidean algorithm or fast exponentiation.</li>
<li>The pair <span class="math inline">\((n,e)\)</span> is A’s public key; <span class="math inline">\(d\)</span> is A’s private key.</li>
</ul>
<p><strong>Signature:</strong></p>
<ul>
<li>A computes the redundancy function of the message <span class="math inline">\(m\)</span>: <span class="math inline">\(m_R := R(m)\)</span>.</li>
<li>A computes the signature: <span class="math inline">\(s := m_R^d \bmod n\)</span> and sends <span class="math inline">\(s\)</span> to B.</li>
</ul>
<p><strong>Verification:</strong></p>
<ul>
<li>Entity B obtains <span class="math inline">\((n,e)\)</span>, the authentic public key of A.</li>
<li>B computes <span class="math inline">\(m'_R = s^e \bmod n\)</span>, verifies <span class="math inline">\(m'_R \in M_R\)</span> and rejects the signature if <span class="math inline">\(m'_R \notin M_R\)</span></li>
<li>B retrieves the correctly signed message by A by computing: <span class="math inline">\(m = R^{-1}(m'_R)\)</span>.</li>
</ul>
<p><strong>Remarks:</strong></p>
<p>The proof of operation is identical to that of the encryption process. The order of exponentiation has no influence since: <span class="math display">\[ed \equiv de \equiv 1 \pmod{\phi(n)}\]</span></p>
<p>The process can also be used to produce <strong>signatures with appendix</strong> with the following modifications:</p>
<p><strong>Signature:</strong> - A uses a hash function <span class="math inline">\(H\)</span> and computes <span class="math inline">\(m_h := H(m)\)</span>. - A computes the signature of <span class="math inline">\(m_h\)</span>: <span class="math inline">\(s := m_h^d \bmod n\)</span> and sends the pair <span class="math inline">\((m,s)\)</span> to B.</p>
<p><strong>Verification:</strong> - B computes <span class="math inline">\(m'_h = s^e \bmod n\)</span> and <span class="math inline">\(H(m)\)</span> and verifies the equality <span class="math inline">\(m'_h = H(m)\)</span>. - If the equality is verified, B accepts the signature <span class="math inline">\(s\)</span> of A on the message M.</p>
<p>The signature computation is <strong>slower</strong> than verification because of the difference in size between the exponent <span class="math inline">\(d\)</span> (size<span class="math inline">\((d) \approx\)</span> size<span class="math inline">\((\phi(n))\)</span>) and <span class="math inline">\(e\)</span>.</p>
<p>The risks and attacks mentioned in the encryption process also apply to the signature.</p>
<p>It is advisable to <strong>differentiate the key pairs for encryption and signature</strong> since they require distinct storage, backup and update policies.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-157-contents" aria-controls="callout-157" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-157" class="callout-157-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>RSA signature:</strong> <span class="math inline">\(s = m_R^d \bmod n\)</span> (private).</p>
<p>Verify: <span class="math inline">\(m'_R = s^e \bmod n\)</span> (public).</p>
<p>With appendix: <span class="math inline">\(s = H(m)^d \bmod n\)</span>.</p>
<p>Signature slow, verification fast.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="blind-signatures" class="level2">
<h2 class="anchored" data-anchor-id="blind-signatures">Blind Signatures</h2>
<p><strong>Principle:</strong> A sends information to B for signature. From the response, A can compute B’s signature on a different message that B has never seen.</p>
<p><strong>Exploitation of the multiplicative property of RSA:</strong></p>
<p><span class="math display">\[(m_1 m_2)^e \equiv m_1^e m_2^e \equiv c_1 c_2 \pmod{n}\]</span></p>
<p><strong>Blinding functions:</strong></p>
<p>Let <span class="math inline">\(k\)</span> be an integer with <span class="math inline">\(\text{gcd}(n,k) = 1\)</span>:</p>
<ul>
<li><strong>Blinding</strong>: <span class="math inline">\(f(m) = m \cdot k^e \bmod n\)</span></li>
<li><strong>Unblinding</strong>: <span class="math inline">\(g(m) = k^{-1} \cdot m \bmod n\)</span></li>
</ul>
<p>Result: <span class="math inline">\(g(S_B(f(m))) = g(S_B(mk^e \bmod n)) = g(m^dk \bmod n) = m^d \bmod n = S_B(m)\)</span></p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li>A → B: <span class="math inline">\(m' = f(m)\)</span> (blinded message)</li>
<li>A ← B: <span class="math inline">\(s' = S_B(m')\)</span> (signature of blinded message)</li>
<li>A computes <span class="math inline">\(g(s')\)</span> and obtains <span class="math inline">\(S_B(m)\)</span> (signature of original message)</li>
</ol>
<p><strong>Applications:</strong> Anonymous electronic cash, electronic voting systems.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-158-contents" aria-controls="callout-158" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-158" class="callout-158-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Scheme invented by Chaum.</strong></p>
<p><strong>Idea:</strong> A sends information to B for signature. B returns to A the signed information. From this signature, A can compute B’s signature on another message chosen beforehand by A. This allows A to have a signature of B on a message that B has never seen (hence the name blind signature…).</p>
<p>In fact it is a vulnerability based on the <strong>multiplicative property of RSA</strong>: <span class="math inline">\((m_1m_2)^e \equiv m_1^e m_2^e \equiv c_1 c_2 \pmod{n}\)</span> which was exploited to make a new signature scheme.</p>
<p><strong>Algorithm:</strong> Let <span class="math inline">\(S_B\)</span> be the RSA signature of B with <span class="math inline">\((n,e)\)</span> and <span class="math inline">\(d\)</span>, respectively the public and private keys of B. Let <span class="math inline">\(k\)</span> be a fixed integer with <span class="math inline">\(\text{gcd}(n,k) = 1\)</span>:</p>
<p><span class="math inline">\(f : \mathbb{Z}_n \rightarrow \mathbb{Z}_n\)</span> with <span class="math inline">\(f(m) = m \cdot k^e \bmod n\)</span> (blinding function)</p>
<p><span class="math inline">\(g : \mathbb{Z}_n \rightarrow \mathbb{Z}_n\)</span> with <span class="math inline">\(g(m) = k^{-1} \cdot m \bmod n\)</span> (unblinding function)</p>
<p>which gives:</p>
<p><span class="math display">\[g(S_B(f(m))) = g(S_B(mk^e \bmod n)) = g(m^dk \bmod n) = m^d \bmod n = S_B(m)\]</span></p>
<p><strong>Protocol:</strong></p>
<ul>
<li>A → B: <span class="math inline">\(m' = f(m)\)</span></li>
<li>A ← B: <span class="math inline">\(s' = S_B(m')\)</span></li>
<li>A computes <span class="math inline">\(g(s')\)</span> and obtains the desired signature using (*).</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-159-contents" aria-controls="callout-159" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-159" class="callout-159-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Blind signature:</strong> Exploits RSA multiplicativity.</p>
<p>Blinding <span class="math inline">\(f(m) = m \cdot k^e\)</span></p>
<p>Unblinding <span class="math inline">\(g(m) = k^{-1} \cdot m\)</span>.</p>
<p>B signs <span class="math inline">\(f(m)\)</span>, A obtains <span class="math inline">\(S_B(m)\)</span> without B seeing <span class="math inline">\(m\)</span>.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="rabin-signature" class="level2">
<h2 class="anchored" data-anchor-id="rabin-signature">Rabin Signature</h2>
<p><strong>Key generation:</strong></p>
<ul>
<li>Generate two large prime numbers <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span></li>
<li>Compute <span class="math inline">\(n = pq\)</span></li>
<li><strong>Public key</strong>: <span class="math inline">\(n\)</span>; <strong>Private key</strong>: <span class="math inline">\((p, q)\)</span></li>
</ul>
<p><strong>Signature:</strong></p>
<ol type="1">
<li>Compute <span class="math inline">\(m_R = R(m)\)</span> (redundancy function)</li>
<li>Compute <span class="math inline">\(s = \sqrt{m_R} \bmod n\)</span> (square root mod <span class="math inline">\(n\)</span>)</li>
<li>Send <span class="math inline">\(s\)</span> (one of the 4 square roots)</li>
</ol>
<p><strong>Verification:</strong></p>
<ol type="1">
<li>Compute <span class="math inline">\(m'_R = s^2 \bmod n\)</span></li>
<li>Verify <span class="math inline">\(m'_R \in M_R\)</span> (reject otherwise)</li>
<li>Reconstruct <span class="math inline">\(m = R^{-1}(m'_R)\)</span></li>
</ol>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Based on the SQROOTP problem (square roots mod composite)</li>
<li><strong>Provably secure</strong>: equivalent to factorization</li>
<li>Vulnerable to active chosen-ciphertext attacks</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-160-contents" aria-controls="callout-160" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-160" class="callout-160-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Key generation:</strong></p>
<ul>
<li>Each entity (A) creates a key pair (public and private) as follows:</li>
<li>A generates two random prime numbers <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> of large size (len<span class="math inline">\((pq) \geq 1024\)</span>).</li>
<li>A computes <span class="math inline">\(n := pq\)</span>.</li>
<li>The public key of A is <span class="math inline">\(n\)</span>, the private key of A is <span class="math inline">\((p,q)\)</span>.</li>
</ul>
<p><strong>Signature:</strong></p>
<ul>
<li>A computes the redundancy function of the message <span class="math inline">\(m\)</span>: <span class="math inline">\(m_R := R(m)\)</span>.</li>
<li>A uses its private key to compute the signature: <span class="math inline">\(s := m_R^{1/2} \bmod n\)</span> using efficient algorithms to compute square roots mod <span class="math inline">\(p\)</span> and mod <span class="math inline">\(q\)</span>.</li>
<li>A sends <span class="math inline">\(s\)</span> to B (<span class="math inline">\(s\)</span> is one of the 4 obtained square roots).</li>
</ul>
<p><strong>Verification:</strong></p>
<ul>
<li>Entity B obtains <span class="math inline">\(n\)</span>, the authentic public key of A.</li>
<li>B computes <span class="math inline">\(m'_R = s^2 \bmod n\)</span>, verifies <span class="math inline">\(m'_R \in M_R\)</span> and rejects the signature if <span class="math inline">\(m'_R \notin M_R\)</span></li>
<li>B retrieves the correctly signed message by A by computing: <span class="math inline">\(m = R^{-1}(m'_R)\)</span>.</li>
</ul>
<p><strong>Remarks:</strong></p>
<p>The Rabin procedure is based on the <strong>impossibility of finding square roots modulo a composite of unknown factorization</strong> (SQROOTP problem).</p>
<p>The main interest of this algorithm lies in the fact that it has been <strong>proven to be equivalent to factorization</strong> (SQROOTP ⇔ FACTP). This algorithm therefore belongs to the <strong>provably secure</strong> category for any passive attack.</p>
<p><strong>Active attacks</strong> can, in some cases, compromise the security of the algorithm. More precisely, if we mount the following chosen ciphertext attack (we ask A to decrypt a chosen ciphertext):</p>
<ul>
<li>The attacker M generates an <span class="math inline">\(m\)</span> and sends to A the ciphertext <span class="math inline">\(c = m^2 \bmod n\)</span>.</li>
<li>A responds with a root <span class="math inline">\(m_x\)</span> among the 4 possible <span class="math inline">\(m_1, m_2, m_3, m_4\)</span>.</li>
<li>If <span class="math inline">\(m \not\equiv m_x \pmod{n}\)</span> (probability 0.5), M repeats with a new <span class="math inline">\(m\)</span>.</li>
<li>Otherwise, A computes <span class="math inline">\(\text{gcd}(m - m_x, n)\)</span> and thus obtains one of the two factors of <span class="math inline">\(n\)</span>…</li>
</ul>
<p>This attack could be avoided if the procedure required sufficient redundancy in the plaintexts allowing A to identify without ambiguity which of the possible solutions is the original plaintext. In this case, A would always respond with <span class="math inline">\(m\)</span> and discard the other solutions that do not have the predefined level of redundancy.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-161-contents" aria-controls="callout-161" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-161" class="callout-161-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Rabin:</strong> <span class="math inline">\(s = \sqrt{m_R} \bmod n\)</span>.</p>
<p>Verify: <span class="math inline">\(m'_R = s^2 \bmod n\)</span>.</p>
<p><strong>Provably secure</strong> (equivalent to factorization).</p>
<p>Vulnerable to active chosen-ciphertext attacks.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="elgamal-signature" class="level2">
<h2 class="anchored" data-anchor-id="elgamal-signature">ElGamal Signature</h2>
<p><strong>Key generation:</strong></p>
<ul>
<li>Generate prime <span class="math inline">\(p\)</span> and generator <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span></li>
<li>Generate random secret <span class="math inline">\(a\)</span>, compute <span class="math inline">\(y = \alpha^a \bmod p\)</span></li>
<li><strong>Public key</strong>: <span class="math inline">\((p, \alpha, y)\)</span>; <strong>Private key</strong>: <span class="math inline">\(a\)</span></li>
</ul>
<p><strong>Signature:</strong></p>
<ol type="1">
<li>Compute <span class="math inline">\(m_h = H(m)\)</span></li>
<li>Generate random <span class="math inline">\(k\)</span> with <span class="math inline">\(\text{gcd}(k, p-1) = 1\)</span></li>
<li>Compute <span class="math inline">\(r = \alpha^k \bmod p\)</span></li>
<li>Compute <span class="math inline">\(s = k^{-1}(m_h - ar) \bmod (p-1)\)</span></li>
<li>Signature: <span class="math inline">\((r, s)\)</span></li>
</ol>
<p><strong>Verification:</strong></p>
<ol type="1">
<li>Verify <span class="math inline">\(1 \leq r \leq p-2\)</span> (reject otherwise)</li>
<li>Compute <span class="math inline">\(v_1 = y^r r^s \bmod p\)</span></li>
<li>Compute <span class="math inline">\(v_2 = \alpha^{H(m)} \bmod p\)</span></li>
<li>Accept if <span class="math inline">\(v_1 = v_2\)</span></li>
</ol>
<p><strong>Proof:</strong> If <span class="math inline">\(s \equiv k^{-1}(m_h - ar) \pmod{p-1}\)</span>, then <span class="math inline">\(m_h \equiv ar + ks \pmod{p-1}\)</span></p>
<p>So <span class="math inline">\(v_2 = \alpha^{m_h} \equiv \alpha^{ar+ks} \equiv (\alpha^a)^r (\alpha^k)^s \equiv y^r r^s = v_1 \pmod{p}\)</span></p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Works only with appendix (hash)</li>
<li>Base of DSA (Digital Signature Algorithm)</li>
<li><span class="math inline">\(k\)</span> must be unique for each signature</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-162-contents" aria-controls="callout-162" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-162" class="callout-162-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Key generation:</strong></p>
<ul>
<li>Each entity (A) creates a key pair (public and private) as follows:</li>
<li>A generates a prime number <span class="math inline">\(p\)</span> (len<span class="math inline">\((p) \geq 1024\)</span> bits) and a generator <span class="math inline">\(\alpha\)</span> of <span class="math inline">\(\mathbb{Z}_p^*\)</span>.</li>
<li>A generates a random number <span class="math inline">\(a\)</span>, such that <span class="math inline">\(1 \leq a \leq p-2\)</span> and computes <span class="math inline">\(y := \alpha^a \bmod p\)</span>.</li>
<li>The public key of A is <span class="math inline">\((p, \alpha, y)\)</span>, the private key of A is <span class="math inline">\(a\)</span>.</li>
</ul>
<p><strong>Signature:</strong></p>
<ul>
<li>A uses a hash function <span class="math inline">\(H\)</span> and computes <span class="math inline">\(m_h := H(m)\)</span>.</li>
<li>A generates a random number <span class="math inline">\(k\)</span> (<span class="math inline">\(1 \leq k \leq p-2\)</span> and <span class="math inline">\(\text{gcd}(k,p-1) = 1\)</span>) and computes <span class="math inline">\(k^{-1} \bmod (p-1)\)</span></li>
<li>A computes <span class="math inline">\(r := \alpha^k \bmod p\)</span> and then <span class="math inline">\(s := k^{-1}(m_h - ar) \bmod (p-1)\)</span></li>
<li>The signature of A on the message <span class="math inline">\(m\)</span> is the pair <span class="math inline">\((r,s)\)</span>.</li>
</ul>
<p><strong>Verification:</strong></p>
<ul>
<li>Entity B obtains <span class="math inline">\((p, \alpha, \alpha^a \bmod p)\)</span>, the authentic public key of A.</li>
<li>B verifies that <span class="math inline">\(1 \leq r \leq p-2\)</span>, otherwise rejects the signature.</li>
<li>B computes <span class="math inline">\(v_1 := y^r r^s \bmod p\)</span>.</li>
<li>B computes <span class="math inline">\(H(m)\)</span> and <span class="math inline">\(v_2 := \alpha^{H(m)} \bmod p\)</span></li>
<li>B accepts the signature iff <span class="math inline">\(v_1 = v_2\)</span>.</li>
</ul>
<p><strong>Remarks:</strong></p>
<p><strong>Proof that the scheme works:</strong> If <span class="math inline">\(s \equiv k^{-1}(m_h - ar) \pmod{p-1}\)</span>, we have: <span class="math display">\[m_h \equiv (ar + ks) \pmod{p-1}\]</span> and <span class="math display">\[v_2 = \alpha^{H(m)} \bmod p\]</span></p>
<p>if, as we wish to show <span class="math inline">\(m_h = H(m)\)</span>, by reducing exponents mod <span class="math inline">\((p-1)\)</span>, we can rewrite <span class="math inline">\(v_2\)</span>: <span class="math display">\[v_2 \equiv \alpha^{ar+ks} \pmod{p}\]</span></p>
<p>On the other hand: <span class="math display">\[v_1 = y^r r^s \equiv \alpha^{ar} \alpha^{ks} \equiv \alpha^{ar+ks} \pmod{p}\]</span> Q.E.D.</p>
<p>By construction, the ElGamal scheme works <strong>only with appendix</strong> (result of applying a hash function). The Nyberg-Rueppel scheme introduces a variation allowing message recovery.</p>
<p>The <strong>Digital Signature Algorithm (DSA)</strong>, approved by the US National Institute of Standards and Technology has become the most commonly used signature standard. It is built on the basis of a direct derivative of the ElGamal scheme with the SHA-1 hash function.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-163-contents" aria-controls="callout-163" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-163" class="callout-163-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>ElGamal:</strong> <span class="math inline">\((r,s)\)</span> with <span class="math inline">\(r = \alpha^k \bmod p\)</span>, <span class="math inline">\(s = k^{-1}(m_h - ar) \bmod (p-1)\)</span>.</p>
<p>Verify: <span class="math inline">\(y^r r^s \stackrel{?}{=} \alpha^{H(m)} \bmod p\)</span>.</p>
<p>Base of DSA.</p>
<p><span class="math inline">\(k\)</span> unique crucial.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="signatures-and-cryptocurrencies" class="level2">
<h2 class="anchored" data-anchor-id="signatures-and-cryptocurrencies">Signatures and Cryptocurrencies</h2>
<p>Cryptocurrencies massively use digital signatures to authenticate transactions.</p>
<p><strong>Bitcoin and Ethereum:</strong></p>
<ul>
<li>Use <strong>ECDSA</strong> (Elliptic Curve Digital Signature Algorithm)</li>
<li>Derivative of ElGamal on elliptic curves</li>
<li>Security based on ECDLP</li>
</ul>
<p><strong>Transaction process:</strong></p>
<p>Each spending/transmission requires:</p>
<ul>
<li>Signature with the <strong>current holder’s private key</strong></li>
<li>The holder was the recipient of the previous transaction</li>
<li>Each transaction forms an authentication chain</li>
</ul>
<p><strong>ECDSA advantages:</strong></p>
<ul>
<li>Shorter keys for equivalent security</li>
<li>More efficient computations</li>
<li>Suitable for blockchain constraints</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-164-contents" aria-controls="callout-164" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-164" class="callout-164-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Most cryptocurrencies are based on asymmetric cryptography. Bitcoin e.g.&nbsp;uses digital signatures to authenticate its transactions.</p>
<p>The spending or transmission of bitcoins requires the signature with the private key of the holder (who was in turn the recipient of the previous transaction).</p>
<p>Bitcoin and Ethereum use the <strong>ECDSA (Elliptic Curve Digital Signature Algorithm)</strong> algorithm derived from the ElGamal signature algorithm on elliptic curves whose security relies on ECDLP.</p>
<p>[Image: Diagram showing the Bitcoin transaction chain with signatures]</p>
<p>Source Image: Bitcoin: A Peer-to-Peer Electronic Cash System. Satoshi Nakamoto</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-165-contents" aria-controls="callout-165" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-165" class="callout-165-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Cryptocurrencies:</strong> Bitcoin/Ethereum use <strong>ECDSA</strong> (ElGamal on elliptic curves).</p>
<p>Each transaction signed with holder’s private key.</p>
<p>Security based on ECDLP.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="summary-table-of-schemes" class="level2">
<h2 class="anchored" data-anchor-id="summary-table-of-schemes">Summary Table of Schemes</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Class</th>
<th>Scheme</th>
<th>Message Recovery</th>
<th>Base Problem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Classical Signatures</strong></td>
<td>RSA</td>
<td>Yes</td>
<td>RSAP</td>
</tr>
<tr class="even">
<td></td>
<td>Rabin</td>
<td>Yes</td>
<td>SQROOTP</td>
</tr>
<tr class="odd">
<td></td>
<td>ElGamal</td>
<td>No</td>
<td>DLP</td>
</tr>
<tr class="even">
<td></td>
<td>DSS</td>
<td>No</td>
<td>DLP</td>
</tr>
<tr class="odd">
<td><strong>One-time Signatures</strong></td>
<td>Lamport</td>
<td>No</td>
<td>depends on OWF</td>
</tr>
<tr class="even">
<td></td>
<td>Bos-Chaum</td>
<td>No</td>
<td>depends on OWF</td>
</tr>
<tr class="odd">
<td><strong>Undeniable Signatures</strong></td>
<td>Chaum-van Antwerpen</td>
<td>No</td>
<td>DLP</td>
</tr>
<tr class="even">
<td><strong>Fail-Stop Signatures</strong></td>
<td>van Heyst-Pedersen</td>
<td>No</td>
<td>DLP</td>
</tr>
<tr class="odd">
<td><strong>Blind Signatures</strong></td>
<td>Chaum</td>
<td>Yes</td>
<td>RSAP</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-166-contents" aria-controls="callout-166" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-166" class="callout-166-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>[Complete table with all above information]</p>
<p>The operation of One-time, Undeniable and Fail-Stop signature schemes can be consulted in [Men97].</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-167-contents" aria-controls="callout-167" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-167" class="callout-167-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Classical signatures:</strong></p>
<ul>
<li>RSA/Rabin (recovery)</li>
<li>ElGamal/DSS (appendix)</li>
</ul>
<p><strong>Specialized:</strong></p>
<ul>
<li>One-time</li>
<li>Undeniable</li>
<li>Fail-stop</li>
<li>Blind</li>
</ul>
<p>Base problems: RSAP, SQROOTP, DLP, depends on OWF.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="types-of-attacks" class="level2">
<h2 class="anchored" data-anchor-id="types-of-attacks">Types of Attacks</h2>
<p><strong>Criteria for “breaking” a scheme:</strong></p>
<ul>
<li><strong>Total Break</strong>: Compute the private key or efficient generation algorithm</li>
<li><strong>Selective forgery</strong>: Generate signature for fixed message/class</li>
<li><strong>Existential forgery</strong>: Forge at least one signature (without message control)</li>
</ul>
<p><strong>Basic attacks:</strong></p>
<ul>
<li><strong>Key-only</strong>: Only the public key is known</li>
<li><strong>Known-messages</strong>: Access to signatures of known messages</li>
<li><strong>Chosen-messages</strong>: Attacker chooses messages to be signed</li>
<li><strong>Adaptive chosen-messages</strong>: Choice depends on previous responses</li>
</ul>
<p>These attacks are equivalent to attacks on encryption systems (known/chosen-plaintext/ciphertext) but applied to messages.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-168-contents" aria-controls="callout-168" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-168" class="callout-168-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Criteria for “breaking” a digital signature scheme:</strong></p>
<ul>
<li><strong>Total Break</strong>: Compute the signer’s private key or an efficient (polynomial) algorithm to generate signatures.</li>
<li><strong>Selective forgery</strong>: The adversary is able to generate a valid signature for a fixed message (or class of messages).</li>
<li><strong>Existential forgery</strong>: The adversary is able to forge a signature for (at least) one message (which they do not control).</li>
</ul>
<p><strong>Basic attacks:</strong></p>
<ul>
<li><strong>Key-only attacks</strong>: The adversary only has knowledge of the signer’s public key.</li>
<li><strong>Message-based attacks</strong>: The adversary has access to signatures corresponding to:
<ul>
<li>known-messages</li>
<li>chosen-messages</li>
<li>adaptive chosen-messages</li>
</ul></li>
</ul>
<p>Equivalent to x-ciphertext attacks but with messages!</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-169-contents" aria-controls="callout-169" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Quick Revision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-169" class="callout-169-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Breaking signature:</strong></p>
<ul>
<li>Total break (private key)</li>
<li>selective forgery (fixed message)</li>
<li>existential (one message)</li>
</ul>
<p><strong>Attacks:</strong></p>
<ul>
<li>key-only</li>
<li>known/chosen/adaptive-chosen-messages.</li>
</ul>
</div>
</div>
</div>
<p>Here is the <strong>exact English translation</strong> of your document, preserving all content, structure, formatting, and technical terminology:</p>
<hr>
</section>
</section>
<section id="authentication" class="level1">
<h1>Authentication</h1>
<section id="authentication-of-data-origin-and-entities" class="level2">
<h2 class="anchored" data-anchor-id="authentication-of-data-origin-and-entities">Authentication of Data Origin and Entities</h2>
<section id="authentication-methods" class="level3">
<h3 class="anchored" data-anchor-id="authentication-methods">Authentication Methods</h3>
<p>Authentication of origin ensures that a message genuinely comes from the claimed sender.</p>
<p><strong>Symmetric Methods:</strong></p>
<ul>
<li><strong>MAC alone</strong>: <code>A → B: X, MACk(X)</code> – B verifies using the shared key <em>k</em></li>
<li><strong>MDC + encryption</strong>: <code>A → B: X, Ek(MDC(X))</code> or <code>A → B: Ek(X, MDC(X))</code></li>
</ul>
<p><strong>Asymmetric Method:</strong></p>
<ul>
<li><strong>MDC + signature</strong>: <code>A → B: X, Sigpriv-A(MDC(X))</code> – Also provides non-repudiation</li>
</ul>
<p><strong>Limitations:</strong> These simple protocols do not protect against replay attacks or ensure message freshness. Time- or context-aware mechanisms are required.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-170-contents" aria-controls="callout-170" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-170" class="callout-170-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Authentication of Data Origin</strong></p>
<p><strong>1) MAC with a symmetric key <em>k</em> known to A and B:</strong> <code>A → B: X, MACk(X)</code> If B computes <code>MACk(X)</code> independently and obtains the same value ⇒ the message originates from A.</p>
<p><strong>2) MDC + symmetric encryption (key <em>k</em> known to A and B):</strong> <code>A → B: X, Ek(MDC(X))</code> B computes <code>MDC(X)</code> then <code>Ek(MDC(X))</code>. If equal ⇒ message comes from A.</p>
<p><strong>3) As 2) with confidentiality of X:</strong> <code>A → B: Ek(X, MDC(X))</code></p>
<p><strong>4) MDC + digital signature:</strong> <code>A → B: X, Sigpriv-A(MDC(X))</code> B computes <code>MDC(X)</code> and verifies <code>Sigpriv-A(MDC(X))</code> using an authentic copy of <em>pub-A</em>. If equal ⇒ A is the originator. This solution also provides <strong>non-repudiation of origin</strong>.</p>
<p>These simple protocols offer no support for <strong>uniqueness</strong> or <strong>freshness (timeliness)</strong> of received messages and are vulnerable to <strong>replay attacks</strong>. They require mechanisms accounting for time or transaction context.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-171-contents" aria-controls="callout-171" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-171" class="callout-171-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>4 Methods</strong></p>
<ul>
<li>MAC alone</li>
<li>MDC + encryption</li>
<li>MDC + confidential encryption</li>
<li>MDC + signature</li>
</ul>
<p><strong>Warning:</strong> Vulnerable to replay attacks without temporal mechanisms</p>
</div>
</div>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Sender A] --&gt;|X, MAC/Signature| B[Receiver B]
    B --&gt;|Verifies| C{Authentic?}
    C --&gt;|Yes| D[Accept]
    C --&gt;|No| E[Reject]

    style A fill:#e1f5ff
    style B fill:#e1f5ff
    style D fill:#d4edda
    style E fill:#f8d7da
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
<section id="entity-authentication-introduction" class="level3">
<h3 class="anchored" data-anchor-id="entity-authentication-introduction">Entity Authentication – Introduction</h3>
<section id="objectives-of-a-robust-protocol" class="level4">
<h4 class="anchored" data-anchor-id="objectives-of-a-robust-protocol">Objectives of a Robust Protocol</h4>
<p>Entity authentication (or identification) aims to prove an entity’s identity in real time.</p>
<p><strong>Required Properties:</strong></p>
<ol type="1">
<li>If A and B are honest and A authenticates, B must accept A’s identity.</li>
<li>B cannot reuse A’s information to impersonate A to C.</li>
<li>Negligible probability that entity C successfully impersonates A.</li>
<li>Property 3 holds even if C has observed or participated in prior protocol instances.</li>
</ol>
<p><strong>Basic Elements:</strong></p>
<ul>
<li><strong>Something known</strong>: passwords, PINs, keys</li>
<li><strong>Something possessed</strong>: smart cards, password generators</li>
<li><strong>Something inherent</strong>: biometrics (fingerprints, retina, DNA)</li>
</ul>
<p><strong>Classification:</strong></p>
<ul>
<li><strong>Weak authentication</strong>: Reveals the secret (userid/password)</li>
<li><strong>Strong authentication</strong>: Proves possession of the secret without revealing it</li>
<li><strong>Zero-knowledge</strong>: Strong authentication without revealing any information about the secret</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-172-contents" aria-controls="callout-172" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-172" class="callout-172-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Entity Authentication (Entity Identification)</strong></p>
<p><strong>Objectives of a Robust Identification Protocol:</strong></p>
<ol type="1">
<li>If A and B are “honest”: if A can authenticate to B, B must accept A’s identity.</li>
<li>B cannot reuse information provided by A to identify as A to C.</li>
<li>The probability that a third party C successfully impersonates A to B is negligible.</li>
<li>Point 3) remains true even if:
<ul>
<li>C has observed a large (polynomial) number of identification protocol instances between A and B</li>
<li>C has participated (possibly impersonating someone else) in prior protocol executions with A or B</li>
<li>Multiple protocol instances (possibly initiated by C) may run simultaneously without compromising the identification process</li>
</ul></li>
</ol>
<p><strong>Terminology</strong>: The user (A) is called the <strong>claimant</strong> (the one claiming to be A), and the system (B) is the <strong>verifier</strong>.</p>
<p><strong>Basic Authentication Elements:</strong></p>
<ul>
<li><strong>Something known</strong>: passwords, PINs, private or secret keys, etc.</li>
<li><strong>Something possessed</strong>: passport, smart card, password generators, etc.</li>
<li><strong>Something inherent to the individual</strong>: biometric properties like fingerprints, retina, DNA, etc.</li>
</ul>
<p><strong>Weak Authentication</strong>: The user presents a pair (userid, password) to the system. The userid is the claimed identity, and the password is the corroborating evidence.</p>
<p><strong>Strong Authentication</strong>: The secret used to corroborate identity is not explicitly revealed. The user provides proof of possession of the secret.</p>
<p><strong>Zero-Knowledge Authentication</strong>: Strong authentication protocols that additionally prove identity without revealing any information (not even a hint) about the secret itself. This involves proving an assertion without disclosing any details.</p>
<p><strong>Weak authentication protocols</strong> satisfy points 1) and 3). <strong>Strong authentication protocols</strong> satisfy (at least partially) points 2) and 4) as well.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-173-contents" aria-controls="callout-173" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-173" class="callout-173-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>3 Levels</strong>: Weak (reveals secret) &lt; Strong (proof of possession) &lt; Zero-knowledge (no info revealed)</p>
<p><strong>4 Objectives</strong></p>
<ul>
<li>Acceptance if honest</li>
<li>Non-reusability</li>
<li>Impersonation resistance</li>
<li>Observation resistance</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="attacks-and-countermeasures" class="level2">
<h2 class="anchored" data-anchor-id="attacks-and-countermeasures">Attacks and Countermeasures</h2>
<section id="dictionary-attacks" class="level3">
<h3 class="anchored" data-anchor-id="dictionary-attacks">Dictionary Attacks</h3>
<section id="principle-and-countermeasures" class="level4">
<h4 class="anchored" data-anchor-id="principle-and-countermeasures">Principle and Countermeasures</h4>
<p>A dictionary attack systematically tests probable passwords against a cryptographic system.</p>
<p><strong>Attack Methods:</strong></p>
<ul>
<li><strong>Offline</strong>: The attacker obtains the hashed password database or captures exchanges</li>
<li><strong>Online</strong>: Direct attempts against the system (typically rate-limited)</li>
</ul>
<p><strong>Vulnerability Example:</strong></p>
<ul>
<li><code>A → B: A</code></li>
<li><code>A ← B: R</code> (random challenge)</li>
<li><code>A → B: Ep(R)</code></li>
</ul>
<p>The pair <code>(R, Ep(R))</code> enables an offline dictionary attack.</p>
<p><strong>Countermeasures:</strong></p>
<ul>
<li>Limit online attempts</li>
<li>Salting (adding a random element)</li>
<li>Use slow key derivation functions</li>
<li>Strong authentication avoiding password transmission</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-174-contents" aria-controls="callout-174" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-174" class="callout-174-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Dictionary Attacks</strong></p>
<p>A dictionary attack uses a database containing dictionary words from one or more languages (including variants) as input to an encryption or hashing system to obtain secret keys or passwords.</p>
<p>This attack is highly effective for obtaining poor-quality passwords, even today, with large databases containing word variations and complex mnemonic rules to “crack” higher-entropy passwords.</p>
<p><strong>A dictionary attack can be mounted:</strong></p>
<ul>
<li>By obtaining the system’s password database (encrypted or hashed)</li>
<li>From one or more authentication exchange instances following a passive attack (network packet observation). For example:
<ul>
<li><code>A → B: A</code> (A sends its identity)</li>
<li><code>A ← B: R</code> (R = random number, challenge)</li>
<li><code>A → B: Ep(R)</code> (A encrypts R with its password)</li>
</ul></li>
</ul>
<p>The pair <code>(R, Ep(R))</code> enables an <strong>offline</strong> dictionary attack.</p>
<p>Dictionary attacks are typically less effective <strong>online</strong> because operating systems limit the number of failed authentication attempts.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-175-contents" aria-controls="callout-175" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-175" class="callout-175-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Offline</strong> (via DB or capture) &gt; <strong>Online</strong> (system-limited)</p>
<p><strong>Protection</strong>: Salting, attempt limiting, strong authentication</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="plaintext-equivalence" class="level3">
<h3 class="anchored" data-anchor-id="plaintext-equivalence">Plaintext Equivalence</h3>
<section id="concept-and-risks" class="level4">
<h4 class="anchored" data-anchor-id="concept-and-risks">Concept and Risks</h4>
<p>A string is <strong>plaintext-equivalent</strong> to a password if it grants the same access as the password itself.</p>
<p><strong>Vulnerability Example:</strong></p>
<p>If the system stores <code>H(p)</code> and the protocol is: <code>A → B: H(p)</code></p>
<p>Then <code>H(p)</code> is plaintext-equivalent to <code>p</code> because the attacker can use it directly.</p>
<p><strong>Counterexample (Classic UNIX):</strong></p>
<p>The system stores <code>H(p)</code> but the protocol transmits <code>p</code>. The stored hash is thus not plaintext-equivalent.</p>
<p><strong>Security Principle:</strong> Server-stored information must be neither plaintext-equivalent to passwords nor exposed to offline dictionary attacks.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-176-contents" aria-controls="callout-176" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-176" class="callout-176-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Plaintext Equivalence</strong></p>
<p>A data string is <strong>plaintext-equivalent</strong> to a password if it can be used to obtain the same access level as the password.</p>
<p><strong>Example:</strong> If system B stores a list of all hashed passwords in the following authentication process: <code>A → B: H(p)</code> (A sends B the hash of the password)</p>
<p>The string <code>H(p)</code> is <strong>plaintext-equivalent</strong> to the password <code>p</code>.</p>
<p>This is equivalent to saying that applying a hash function for password storage provides no additional security for the system.</p>
<p><strong>Counterexample:</strong> In the classic UNIX authentication system, the password hash stored in <code>/etc/passwd</code> is <strong>not</strong> plaintext-equivalent to the password because it is <code>p</code> (not <code>H(p)</code>) that is exchanged between client and server.</p>
<p>This property is essential because password databases are typically protected by logical mechanisms that are often compromised by server OS vulnerabilities.</p>
<p>If these central databases contain passwords in cleartext or plaintext-equivalent information, the consequences of an attack are devastating.</p>
<p><strong>The ideal case</strong> is that server-stored information is neither plaintext-equivalent to passwords nor exposed to offline dictionary attacks.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-177-contents" aria-controls="callout-177" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-177" class="callout-177-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Plaintext-equivalent</strong>: Data usable like the original password</p>
<p><strong>Danger</strong>: If the system transmits <code>H(p)</code> and stores <code>H(p)</code> → <code>H(p)</code> is plaintext-equivalent</p>
<p><strong>Good Design</strong>: System transmits <code>p</code>, stores <code>H(p)</code> → not plaintext-equivalent</p>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="weak-authentication" class="level2">
<h2 class="anchored" data-anchor-id="weak-authentication">Weak Authentication</h2>
<section id="fixed-passwords" class="level3">
<h3 class="anchored" data-anchor-id="fixed-passwords">Fixed Passwords</h3>
<section id="storage-and-protection" class="level4">
<h4 class="anchored" data-anchor-id="storage-and-protection">Storage and Protection</h4>
<p>Fixed-password systems exhibit significant vulnerabilities.</p>
<p><strong>Storage Techniques:</strong></p>
<ul>
<li><strong>Cleartext</strong>: Protected by OS access control (vulnerable to OS flaws, backups)</li>
<li><strong>Encrypted or hashed</strong>: Vulnerable to offline attacks (guessing, dictionary, collisions)</li>
</ul>
<p><strong>Major Problem:</strong> The password can be replayed after observation on an unprotected network.</p>
<p><strong>Protection Techniques:</strong></p>
<ul>
<li>Strict creation rules (minimum entropy)</li>
<li>Rate-limiting and attempt restrictions</li>
<li><strong>Salting</strong>: Adding a random element before hashing</li>
<li>Restrict password file dissemination</li>
</ul>
<p><strong>Typical Password Entropy:</strong> Low (~40 bits for an 8-character random password, much less for common words).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-178-contents" aria-controls="callout-178" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-178" class="callout-178-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Weak Authentication – Fixed Password</strong></p>
<p>Weak authentication systems are divided into two main categories:</p>
<ul>
<li><strong>Fixed password</strong>: The password does not depend on time or the number of protocol executions. This includes systems where the password is changed by user decision or system security measures.</li>
<li><strong>Variable password</strong>: Password modification based on time and/or execution count is part of the identification protocol.</li>
</ul>
<p><strong>Storage Techniques for Fixed-Password Systems:</strong></p>
<ul>
<li><strong>Cleartext password storage</strong> in a file protected by the OS’s access control mechanisms.
<ul>
<li>Problems: OS vulnerabilities, “super-user” privileges, backups, etc.</li>
</ul></li>
<li><strong>Encrypted or hashed password storage</strong> (possibly making the file publicly accessible, cf.&nbsp;UNIX example).
<ul>
<li>Problems: offline attacks, i.e., guessing attacks, brute-force dictionary attacks, collision identification, etc.</li>
</ul></li>
</ul>
<p><strong>Most serious fixed-password problem</strong>: It can be replayed after eavesdropping on an unprotected network.</p>
<p><strong>Fixed-Password System Protection Techniques:</strong></p>
<ul>
<li>Strict rules for password creation, maintenance, and updates, considering the low entropy of user-chosen passwords</li>
<li>Slowing the identification process and limiting failed attempts to counter “online brute-force attacks”</li>
<li><strong>Salting</strong> (cf.&nbsp;UNIX example)</li>
<li>Restrict or avoid dissemination of password files, even when encrypted</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-179-contents" aria-controls="callout-179" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-179" class="callout-179-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>2 Types</strong>: Fixed password (static) vs.&nbsp;Variable password (changes per instance)</p>
<p><strong>Storage</strong>: Cleartext (highly vulnerable) vs.&nbsp;Encrypted/Hashed (offline attacks)</p>
<p><strong>Protections</strong>: Strict rules, attempt limiting, salting, non-dissemination</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="variable-passwords" class="level3">
<h3 class="anchored" data-anchor-id="variable-passwords">Variable Passwords</h3>
<section id="one-time-passwords-and-generators" class="level4">
<h4 class="anchored" data-anchor-id="one-time-passwords-and-generators">One-Time Passwords and Generators</h4>
<p>Variable passwords change with each authentication, reducing replay risk.</p>
<p><strong>Lamport Scheme (S/Key):</strong></p>
<pre><code>Initialization:
  A generates secret w, chooses t
  A → B: wt = Ht(w)
  B stores: wstored := wt, n := t-1

Identification (t-n)th:
  A → B: A, n, wn = Hn(w)
  B tests: H(wn) == wstored
  If OK: n := n-1, wstored := wn</code></pre>
<p><strong>Attacks if B is not authenticated:</strong></p>
<ul>
<li><strong>Pre-play attack</strong>: C obtains <code>wn</code> before A and replays it</li>
<li><strong>Small <code>n</code> attack</strong>: C requests an <code>n</code> &lt; current n</li>
</ul>
<p><strong>Hardware Generators (SecureID):</strong></p>
<ul>
<li>Card generates a code every 30–60 seconds</li>
<li>Based on a secret key shared with the system</li>
<li>Vulnerable to pre-play but with limited time window</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-180-contents" aria-controls="callout-180" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-180" class="callout-180-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Weak Authentication: Variable Password</strong></p>
<p>The two best-known variable-password identification techniques are <strong>one-time passwords</strong> and <strong>hardware random number generators</strong>.</p>
<p><strong>One-Time Passwords – Lamport Scheme (S/Key):</strong></p>
<p><strong>Initialization:</strong></p>
<ul>
<li>A generates a secret w</li>
<li>A constant t (~1000, number of identifications) and a OWF H are chosen</li>
<li><code>A → B: wt = Ht(w)</code> (H applied t times to w)</li>
<li>B stores: <code>wstored := wt</code>, <code>n := t-1</code></li>
</ul>
<p><strong>Messages for the (t-n)th identification:</strong></p>
<ul>
<li><code>A → B: A</code> (A’s identity)</li>
<li><code>A → B: n</code> (current iteration for A)</li>
<li><code>A → B: wn = Hn(w)</code></li>
<li>B tests: <code>H(wn) == wstored</code>. If OK ⇒ <code>n := n - 1</code> and <code>wstored := wn</code></li>
</ul>
<p><strong>End:</strong> When n == 0, A chooses a new w and restarts…</p>
<p><strong>Attacks:</strong> <strong>B must be authenticated!</strong> Otherwise, C impersonates B and:</p>
<ul>
<li>obtains the current password wn and can replay it (<strong>pre-play attack</strong>)</li>
<li>provides an n &lt; current n and can thus generate all Hm&gt;n(wn) (<strong>small n attack</strong>)</li>
</ul>
<p><strong>Hardware Random Number Generators:</strong></p>
<ul>
<li>These are smart cards that periodically (~every 30 or 60 seconds) generate different numbers used to identify (along with a PIN and user identity information) the cardholder.</li>
<li>Generation is based on a secret key present on the card and known to the system.</li>
<li>The best-known is <strong>SecureID</strong> by RSA Security.</li>
<li>It has been adopted by many banks for Internet tele-banking authentication.</li>
<li>It is also vulnerable to pre-play attacks, but the replay window is limited to the change frequency (30 or 60 seconds).</li>
</ul>
<p><strong>Conclusions on Weak Authentication:</strong></p>
<ul>
<li>Fixed passwords offer very low security.</li>
<li>Variable passwords are a significant step toward strong authentication but require additional precautions.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-181-contents" aria-controls="callout-181" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-181" class="callout-181-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Lamport</strong>: wn+1 = H(wn), authentication via hash chain verification</p>
<p><strong>Hardware</strong>: Synchronized generator (30–60s), limited pre-play window</p>
<p><strong>Warning</strong>: Requires B’s authentication to prevent pre-play and small-n attacks</p>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="strong-authentication" class="level2">
<h2 class="anchored" data-anchor-id="strong-authentication">Strong Authentication</h2>
<section id="symmetric" class="level3">
<h3 class="anchored" data-anchor-id="symmetric">Symmetric</h3>
<section id="basic-protocols" class="level4">
<h4 class="anchored" data-anchor-id="basic-protocols">Basic Protocols</h4>
<section id="challenge-response" class="level5">
<h5 class="anchored" data-anchor-id="challenge-response">Challenge-Response</h5>
<p>Strong authentication uses cryptography to prove secret possession without revealing it.</p>
<p><strong>Basic Unilateral Authentication:</strong></p>
<pre><code>A → B: A
A ← B: R (random challenge)
A → B: Ek-AB(R)
B verifies by decrypting</code></pre>
<p>Session key: <code>K := R</code></p>
<p><strong>Improvements:</strong></p>
<ul>
<li>Add B’s identity: <code>Es(B, ra)</code> for key confirmation</li>
<li>Add timestamp: <code>Es(B, ta, ra)</code> for freshness (requires synchronized clocks)</li>
<li>Use MAC instead of encryption: <code>Hk-AB(R)</code> (faster)</li>
</ul>
<p><strong>Vulnerabilities:</strong></p>
<ul>
<li>Man-in-the-Middle if no mutual authentication</li>
<li>Chosen-plaintext attacks possible</li>
<li>Replay if challenges are poorly managed</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-182-contents" aria-controls="callout-182" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-182" class="callout-182-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Strong Authentication: Symmetric Solutions</strong></p>
<p>Strong authentication protocols use symmetric or asymmetric cryptographic techniques.</p>
<p><strong>Unilateral Authentication with Shared Symmetric Key:</strong></p>
<pre><code>A → B: A (A sends its identity)
A ← B: R (R = random number, challenge)
A → B: Ek-AB(R) (A encrypts R with the shared key)</code></pre>
<p>B decrypts <code>Ek-AB(R)</code> and identifies A if it finds R.</p>
<p><strong>Remarks:</strong></p>
<ul>
<li>B must ensure the challenge R is random and not repeated.</li>
<li>This protocol is a significant improvement over password authentication because varying challenges prevent Eve from replaying protocol parts.</li>
<li>Eve can attempt an <strong>offline known-plaintext attack</strong> from a (typically small) number of pairs (R, Ek-AB(R)), but most encryption systems are secure in this regard (DES is vulnerable only after 2^47 pairs).</li>
<li>C can impersonate B and choose challenges R to mount a <strong>chosen-plaintext attack</strong> (DES vulnerability is also 2^47, but other systems are more sensitive to such attacks).</li>
<li>C could mount an <strong>Active Man-in-the-Middle</strong> attack by impersonating B since B is not authenticated, but must convince A to start the protocol.</li>
<li>A <strong>MDC</strong>: <code>H(k-AB,R)</code> or a <strong>MAC</strong>: <code>Hk-AB(R)</code> can replace <code>Ek-AB(R)</code> to speed up identification.</li>
<li>After initial identification, a secure (at least authenticated) channel must be established using cryptographic protection to prevent C from injecting packets while impersonating A.</li>
</ul>
<p>Protocols of this type, where one entity must respond based on a challenge from the other, are called <strong>challenge-and-response protocols</strong> and are the most common form of strong authentication.</p>
<p><strong>Unilateral Authentication with Shared Symmetric Key, 2nd Variant:</strong></p>
<pre><code>A → B: A, Ek-AB(timestamp)</code></pre>
<p>Requires synchronized clocks between A and B.</p>
<p><strong>Advantage:</strong> One fewer message and stateless protocol</p>
<p><strong>But:</strong></p>
<ul>
<li>Clock synchronization is difficult to achieve in practice, and “drifts” can be exploited by an adversary.</li>
<li>Moreover, if B’s clock is “advanced,” some past identification instances may become valid again.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-183-contents" aria-controls="callout-183" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-183" class="callout-183-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Challenge-Response</strong>: B sends challenge R, A responds with E_k(R)</p>
<p><strong>Alternative</strong>: MAC instead of encryption (faster)</p>
<p><strong>With Timestamp</strong>: One fewer message but requires clock synchronization</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="mutual-authentication" class="level4">
<h4 class="anchored" data-anchor-id="mutual-authentication">Mutual Authentication</h4>
<section id="robust-protocols-and-reflection-attacks" class="level5">
<h5 class="anchored" data-anchor-id="robust-protocols-and-reflection-attacks">Robust Protocols and Reflection Attacks</h5>
<p>Bilateral authentication requires precautions against reflection attacks.</p>
<p><strong>Vulnerable (Naive) Protocol:</strong></p>
<pre><code>A → B: A, R2
A ← B: R1, Ek-AB(R2)
A → B: Ek-AB(R1)</code></pre>
<p><strong>Reflection Attack:</strong> C can start two instances and use B’s response to its own request to complete authentication.</p>
<p><strong>Robust Protocol:</strong></p>
<pre><code>(1) A → B: A, R2
(2) A ← B: Ek-AB(R1, R2, A)
(3) A → B: Ek-AB(R2, R1)</code></pre>
<p><strong>Protections:</strong></p>
<ul>
<li>Inclusion of A’s identity in (2) to prevent reflection attacks</li>
<li>Asymmetry in challenge order (R1,R2) vs.&nbsp;(R2,R1)</li>
<li>Inclusion of challenges in the encrypted message</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-184-contents" aria-controls="callout-184" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-184" class="callout-184-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Strong Authentication: Symmetric Solutions (Mutual Authentication)</strong></p>
<p><strong>Bilateral Authentication with Shared Symmetric Key (Intuitive Solution):</strong></p>
<pre><code>A → B: A, R2
A ← B: R1, Ek-AB(R2)
A → B: Ek-AB(R1)</code></pre>
<p>At first glance, the protocol seems robust, but observe what an adversary C can do by starting two identification processes:</p>
<pre><code>C → B: A, R2 (C pretends to be A)
C ← B: R1, Ek-AB(R2) (B responds)</code></pre>
<p>At this point, C starts a second instance:</p>
<pre><code>C → B: A, R1
C ← B: R3, Ek-AB(R1) (C cannot proceed further but...)</code></pre>
<p>Successfully completes the first identification instance with:</p>
<pre><code>C → B: Ek-AB(R1) (and it’s done!)</code></pre>
<p>Because C returns to B the same R it received from B, such attacks are called <strong>reflection attacks</strong>.</p>
<p>Since the key is shared, C could have achieved the same result (even more discreetly) by executing the second instance with A (pretending to be B).</p>
<p><strong>Bilateral Authentication with Shared Symmetric Key (Robust Solution):</strong></p>
<pre><code>(1) A → B: A, R2
(2) A ← B: Ek-AB(R1, R2, A)
(3) A → B: Ek-AB(R2, R1)</code></pre>
<p>The presence of <strong>A</strong> in (2) adds extra security in case obvious reflection attacks are not detected by the protocol. Otherwise, if A initiates authentication with what it believes to be B but is actually C:</p>
<pre><code>A → C: A, R2 (*)</code></pre>
<p>Then C starts a new authentication instance with A using the same R2:</p>
<pre><code>C → A: B, R2</code></pre>
<p>If A does not see R2 as an obvious reflection, it responds:</p>
<pre><code>C ← A: Ek-AB(R1, R2) (As in (2) but without the 'A')</code></pre>
<p>Which C uses to complete its protocol (*). However, if A responds with B inside the packet as recommended in the protocol:</p>
<pre><code>A → C: Ek-AB(R1, R2, B)</code></pre>
<p>This can no longer be used by C to continue (*) because it would require A instead of B.</p>
<p>Note also that including R1 in the encrypted part protects against <strong>chosen plaintext attack</strong> risks from the previous solution.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-185-contents" aria-controls="callout-185" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-185" class="callout-185-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Reflection Attack</strong>: Use one session’s response to authenticate another</p>
<p><strong>Protection</strong>: Include identities + asymmetry in challenges (R1,R2) vs.&nbsp;(R2,R1)</p>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="asymmetric" class="level3">
<h3 class="anchored" data-anchor-id="asymmetric">Asymmetric</h3>
<section id="public-key-protocols" class="level4">
<h4 class="anchored" data-anchor-id="public-key-protocols">Public-Key Protocols</h4>
<p>Asymmetry avoids secret sharing but requires precautions against chosen-ciphertext attacks.</p>
<p><strong>Vulnerable Protocol:</strong></p>
<pre><code>A → B: A
A ← B: Epub-A(R)
A → B: R</code></pre>
<p><strong>Problem:</strong> B can make A decrypt anything.</p>
<p><strong>Robust Protocol:</strong></p>
<pre><code>A → B: A
A ← B: H(R), B, Epub-A(B, R)
A → B: R (after verifying H(R) and B)</code></pre>
<p><strong>Protection:</strong> Structure the encrypted text and prove plaintext knowledge via <code>H(R)</code>.</p>
<p><strong>Mutual Authentication (Needham-Schroeder):</strong></p>
<pre><code>(1) A → B: Epub-B(r1, A)
(2) A ← B: Epub-A(r1, r2)
(3) A → B: Epub-B(r2)</code></pre>
<p>The presence of A in (1) prevents chosen-ciphertext attacks.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-186-contents" aria-controls="callout-186" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-186" class="callout-186-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Strong Authentication: Asymmetric Solutions</strong></p>
<p><strong>Unilateral Authentication with Asymmetric Key (Intuitive Solution…):</strong></p>
<pre><code>A → B: A
A ← B: Epub-A(R) (B encrypts with A’s public key)
A → B: R (A returns R after decryption)</code></pre>
<p><strong>Remarks:</strong></p>
<ul>
<li>B must know A’s authentic key to avoid man-in-the-middle attacks.</li>
<li>But especially: B can mount <strong>chosen-ciphertext attacks</strong> (i.e., B can make A decrypt anything!).</li>
</ul>
<p><strong>Unilateral Authentication with Asymmetric Key (Robust Solution):</strong></p>
<p>Idea: Structure the text encrypted with pub-A and show that B knows the plaintext:</p>
<pre><code>A → B: A
A ← B: H(R), B, Epub-A(B, R) (H(R) proves B knows R)</code></pre>
<p>A decrypts <code>Epub-A(B, R)</code> and obtains B’ and R’. A aborts the protocol if <code>h(R') ≠ h(R)</code> or <code>B' ≠ B</code>, otherwise:</p>
<pre><code>A → B: R</code></pre>
<p>B identifies A if it matches the initial R.</p>
<p>A dual protocol can be imagined using A’s signature with priv-A (instead of encryption with pub-A), but the same structural precautions apply to prevent A from signing a “malicious” message generated by B.</p>
<p><strong>Bilateral Authentication with Asymmetric Key. Robust Solution by Needham and Schroeder:</strong></p>
<pre><code>(1) A → B: Epub-B(r1, A)
(2) A ← B: Epub-A(r1, r2)
(3) A → B: Epub-B(r2)</code></pre>
<p>Note that the presence of A in (1) thwarts chosen-ciphertext attacks.</p>
<p>The protocol can be strengthened by adding a “witness” <code>H(r1)</code> in (1).</p>
<p><strong>Final Remarks on Classical Authentication:</strong></p>
<ul>
<li>Entity authentication is a highly complex process full of unexpected pitfalls.</li>
<li>Some protocols, like the one proposed by ISO in 1988 for authentication in distributed directories, have flaws very similar to those highlighted here.</li>
<li>When identification occurs within a session, it is imperative that all session packets be authenticated (e.g., by establishing a secure channel with session key establishment).</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-187-contents" aria-controls="callout-187" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-187" class="callout-187-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Vulnerability</strong>: Chosen-ciphertext attacks if no structure</p>
<p><strong>Protection</strong>: Include H(R), B’s identity in the encrypted message; A verifies before revealing R</p>
<p><strong>Needham-Schroeder</strong>: 3 messages with identity inclusion to prevent chosen-ciphertext</p>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="zero-knowledge-proofs" class="level2">
<h2 class="anchored" data-anchor-id="zero-knowledge-proofs">Zero-Knowledge Proofs</h2>
<section id="concepts" class="level3">
<h3 class="anchored" data-anchor-id="concepts">Concepts</h3>
<section id="definitions-and-principles" class="level4">
<h4 class="anchored" data-anchor-id="definitions-and-principles">Definitions and Principles</h4>
<p>Zero-knowledge proofs allow proving possession of a secret without revealing any information about it.</p>
<p><strong>Required Properties:</strong></p>
<ul>
<li><strong>Completeness</strong>: If A and B are honest, B accepts A’s proof</li>
<li><strong>Soundness</strong>: If C succeeds in deceiving B, then C holds A’s secret (or equivalent)</li>
<li><strong>Zero-knowledge</strong>: B learns nothing about A’s secret</li>
</ul>
<p><strong>Generic Structure:</strong></p>
<pre><code>(1) A → B: witness
(2) A ← B: challenge
(3) A → B: response</code></pre>
<p><strong>ZKIP Types:</strong></p>
<ul>
<li><strong>Computational ZKIP</strong>: A polynomial-time observer cannot distinguish a real proof from a simulation</li>
<li><strong>Perfect ZKIP</strong>: No probabilistic difference between real proof and simulation (guaranteed by information theory)</li>
</ul>
<p><strong>Principle:</strong></p>
<ul>
<li>A commits to a class of questions (1)</li>
<li>B chooses a question from this class (2)</li>
<li>A answers using its secret (3)</li>
<li>Repeat to reduce guessing probability.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-188-contents" aria-controls="callout-188" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-188" class="callout-188-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Zero-Knowledge Proofs: Definitions</strong></p>
<p>Problem with “classical” authentication methods: B (or even an observer) can obtain information about A’s secret:</p>
<ul>
<li>In weak authentication methods (password-based), the secret is fully revealed.</li>
<li>In classical challenge-and-response methods, B can obtain [plaintext/ciphertext] pairs useful for cryptanalysis.</li>
</ul>
<p><strong>Definition:</strong> An interactive protocol is a <strong>proof of knowledge</strong> if it has the following two characteristics:</p>
<ul>
<li><strong>Completeness</strong>: If A and B are “honest,” B accepts the proof provided by A.</li>
<li><strong>Soundness</strong>: If a “dishonest” entity C can “deceive” B, then C holds A’s secret (or polynomially equivalent information). This is equivalent to requiring secret possession for proof success.</li>
</ul>
<p>A proof of knowledge is called a <strong>zero-knowledge interactive proof (ZKIP)</strong> if it additionally has the property that A can convince B of a fact without revealing any information about its secret.</p>
<p>A protocol is a <strong>computational ZKIP</strong> if an observer capable of probabilistic polynomial-time tests cannot distinguish a genuine proof (where A responds) from a simulated proof (e.g., by a random generator).</p>
<p>A protocol is a <strong>perfect ZKIP</strong> if there is no probabilistic difference between the real proof and the simulated proof. The absence of information in the proof is guaranteed by Shannon’s information theory, not computational criteria.</p>
<p><strong>Generic ZKIP Structure:</strong></p>
<pre><code>(1) A → B: witness
(2) A ← B: challenge
(3) A → B: response</code></pre>
<ul>
<li><strong>(1)</strong> A chooses a random secret number and sends B proof of possession of this secret. This constitutes a commitment from A and defines a class of questions to which A claims to know the answers.</li>
<li><strong>(2)</strong> The challenge sent by B randomly selects a question from this class.</li>
<li><strong>(3)</strong> A responds (using its secret).</li>
</ul>
<p>If necessary, the protocol is repeated to minimize the probability of an “impostor” guessing the correct answers by chance.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-189-contents" aria-controls="callout-189" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-189" class="callout-189-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>3 Properties</strong>: Completeness (accepts if honest), Soundness (requires secret), Zero-knowledge (no info revealed)</p>
<p><strong>Structure</strong>: Witness → Challenge → Response (repeat n times)</p>
<p><strong>Perfect ZK</strong>: Indistinguishable from simulation even with infinite resources</p>
</div>
</div>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">sequenceDiagram
    participant A as Prover A
    participant B as Verifier B

    Note over A: Generates witness&lt;br/&gt;with secret s
    A-&gt;&gt;B: (1) Witness
    Note over B: Chooses random&lt;br/&gt;challenge
    B-&gt;&gt;A: (2) Challenge
    Note over A: Computes response&lt;br/&gt;with secret s
    A-&gt;&gt;B: (3) Response
    Note over B: Verifies&lt;br/&gt;Accepts/Rejects

    Note over A,B: Repeat n times for&lt;br/&gt;security 1/2^n
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="zkip-intuitive-example-ali-babas-cave" class="level3">
<h3 class="anchored" data-anchor-id="zkip-intuitive-example-ali-babas-cave">ZKIP – Intuitive Example (Ali Baba’s Cave)</h3>
<section id="concept-illustration" class="level4">
<h4 class="anchored" data-anchor-id="concept-illustration">Concept Illustration</h4>
<p>This example intuitively illustrates the zero-knowledge principle.</p>
<p><strong>Scenario:</strong></p>
<ul>
<li>A knows the secret passage between y and z in a cave</li>
<li>B wants to verify this knowledge without learning how to traverse</li>
</ul>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li>B stands at entrance E</li>
<li>A chooses to go to y or z (witness)</li>
<li>B enters and stops at point x</li>
<li>B asks A to return from the right or left (challenge)</li>
<li>A uses the secret to comply (if needed)</li>
</ol>
<p><strong>Repetition:</strong> n times. If A does not know the secret: success probability = <span class="math inline">\(2^{-n}\)</span></p>
<p><strong>Properties:</strong></p>
<ul>
<li>B confirms A can traverse but learns nothing about how</li>
<li>B cannot convince a third party B’ (A and B could have agreed on sequences)</li>
<li>Inspired by the “cut-and-choose” technique</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-190-contents" aria-controls="callout-190" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-190" class="callout-190-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>ZKIP: Intuitive Example</strong></p>
<p>This example is described in [Qui89] (Quisquater et al., “How to Explain Zero-Knowledge Protocols to Your Children”, Crypto’89). Suppose A knows a passage between y and z (the secret).</p>
<pre><code>    E
    |
    x
   / \
  y   z</code></pre>
<p><strong>(1)</strong> B stands at the cave entrance at point E.</p>
<p><strong>(2)</strong> A chooses a direction and goes to points y or z (witness choice).</p>
<p><strong>(3)</strong> Once A is inside the cave, B enters and stops at point x.</p>
<p><strong>(4)</strong> B asks A to return to point x from the right or left (the challenge).</p>
<p><strong>(5)</strong> Using the secret to move from y to z (or vice versa) if necessary, A complies with B’s instructions.</p>
<p><strong>Repeat steps 1 to 5 n times.</strong> If A does not know the secret, it has a <span class="math inline">\(2^{-n}\)</span> probability of successfully deceiving B (guessing “correctly”).</p>
<p>In this example, B sees that A can traverse the yz passage at will but obtains no information on how to do so, even if the protocol is executed millions of times.</p>
<p>Moreover, B cannot convince B’ that A knows the secret (as would be the case if A encrypted information using a private key, for example). B’ might suspect A and B of agreeing on the sequences (right/left).</p>
<p>Such protocols are inspired by the <strong>“cut-and-choose”</strong> technique, where A and B fairly share a pie as follows: - A cuts the pie. - B chooses a piece. - A takes the remaining piece.</p>
<p>The first ZKIP was published in 1985 by S. Goldwasser [Gol85]. The application of the cut-and-choose paradigm to cryptographic protocols is due to Rabin [Rab78].</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-191-contents" aria-controls="callout-191" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-191" class="callout-191-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Cave</strong>: A enters randomly (y or z), B asks for exit (left/right)</p>
<p><strong>Cheating Probability</strong>: <span class="math inline">\(2^{-n}\)</span> after n repetitions</p>
<p><strong>ZK</strong>: B verifies knowledge but learns no secret, cannot convince third party</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="zkip-graph-isomorphism" class="level3">
<h3 class="anchored" data-anchor-id="zkip-graph-isomorphism">ZKIP – Graph Isomorphism</h3>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-192-contents" aria-controls="callout-192" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>ZKIP – Graph Isomorphism
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-192" class="callout-192-contents callout-collapse collapse">
<section id="formal-protocol" class="level4 callout-body-container callout-body">
<h4 class="anchored" data-anchor-id="formal-protocol">Formal Protocol</h4>
<p>Zero-knowledge proofs can be constructed on hard mathematical problems.</p>
<p><strong>Context:</strong> Two graphs <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span> are isomorphic if there exists a permutation <span class="math inline">\(\pi\)</span> such that for every edge <span class="math inline">\(\{u,v\} \in E_1\)</span>, <span class="math inline">\(\{\pi(u), \pi(v)\} \in E_2\)</span>.</p>
<p><strong>Property:</strong> Finding the permutation <span class="math inline">\(\pi\)</span> between two ~1000-node graphs is computationally hard (no known polynomial algorithm).</p>
<p><strong>Protocol:</strong></p>
<pre><code>Init: A chooses G1 and creates G2 = π(G1) with π secret
(1) A → B: H (A creates H = φ(G2) randomly)
(2) A ← B: i ∈ {1,2}
(3) A → B: ψ such that H = ψ(Gi)
    If i=2: ψ := φ
    If i=1: ψ := φ ∘ π
(4) B verifies H = ψ(Gi)
(5) Repeat n times</code></pre>
<p><strong>Perfect Zero-Knowledge Verification:</strong> Protocol transcripts are indistinguishable (probabilistic distribution) from those produced by a simulator.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-193-contents" aria-controls="callout-193" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-193" class="callout-193-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>ZKIP: Graph Isomorphism</strong></p>
<p>Two graphs <span class="math inline">\(G_1 = (V_1,E_1)\)</span> and <span class="math inline">\(G_2=(V_2,E_2)\)</span> are <strong>isomorphic</strong> if there exists a permutation <span class="math inline">\(\pi\)</span> such that <span class="math inline">\(\{u,v\} \in E_1\)</span> if and only if <span class="math inline">\(\{\pi(u), \pi(v)\} \in E_2\)</span>.</p>
<p><strong>Example:</strong> <span class="math inline">\(G_1 = (V, E_1)\)</span> and <span class="math inline">\(G_2=(V, E_2)\)</span> with <span class="math inline">\(V = \{1,2,3,4\}\)</span>, <span class="math inline">\(E_1= \{12,13,23,24\}\)</span>, and <span class="math inline">\(E_2 = \{12,13,14,34\}\)</span> are isomorphic with the permutation <span class="math inline">\(G_1 \to G_2 : \{4,1,3,2\}\)</span>:</p>
<pre><code>G1:  1---2    G2:  4---1
     |\ /|         |\ /|
     | X |         | X |
     |/ \|         |/ \|
     3---4         3---2</code></pre>
<p>From a graph <span class="math inline">\(G_1\)</span>, one can easily (in polynomial time) find a permutation <span class="math inline">\(\pi\)</span> such that <span class="math inline">\(G_2 = \pi(G_1)\)</span>.</p>
<p>However, no polynomial-time algorithm is known to determine if two sufficiently large graphs (~1000 nodes) are isomorphic (i.e., find the permutation <span class="math inline">\(\pi\)</span> from <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span>).</p>
<p><strong>ZKIP Based on Graph Isomorphism:</strong></p>
<p><strong>(Initialization)</strong> A chooses a sufficiently large graph <span class="math inline">\(G_1\)</span> and invents a permutation <span class="math inline">\(\pi\)</span> (the secret) to compute a second graph <span class="math inline">\(G_2 = \pi(G_1)\)</span>. <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span> are made public.</p>
<pre><code>(1) A → B: H</code></pre>
<p>A chooses a random permutation <span class="math inline">\(\phi\)</span> such that <span class="math inline">\(H = \phi(G_2)\)</span> and sends H to B (the witness).</p>
<pre><code>(2) A ← B: i</code></pre>
<p>B chooses an integer <span class="math inline">\(i \in \{1,2\}\)</span> and sends it to A (the challenge).</p>
<pre><code>(3) A → B: ψ</code></pre>
<p>A computes <span class="math inline">\(\psi\)</span> such that <span class="math inline">\(H = \psi(G_i)\)</span>: - If <span class="math inline">\(i = 2\)</span>: <span class="math inline">\(\psi := \phi\)</span> - If <span class="math inline">\(i = 1\)</span>: <span class="math inline">\(\psi := \phi \circ \pi\)</span></p>
<p><strong>(4)</strong> B checks if <span class="math inline">\(H = \psi(G_i)\)</span> and accepts the step as correct.</p>
<p><strong>(5)</strong> Repeat (1) to (4) enough times to minimize “guessing” risks.</p>
<p><strong>Property Verification:</strong></p>
<ul>
<li><strong>Completeness</strong>: The protocol is accepted if A knows the secret (i.e., the permutation <span class="math inline">\(\pi\)</span> between the two graphs).</li>
<li><strong>Soundness</strong>: If C tries to impersonate A without knowing <span class="math inline">\(\pi\)</span>, it can fix a j and provide a correct permutation <span class="math inline">\(\psi(G_j)\)</span> but cannot find a correct permutation for both graphs. It must guess the challenge provided by B.</li>
<li><strong>Zero-Knowledge</strong>: A succeeds in convincing B that the two graphs are isomorphic but learns nothing about <span class="math inline">\(\pi\)</span>. B only sees a random graph H isomorphic to <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span> and a permutation between H and <span class="math inline">\(G_1\)</span> or between H and <span class="math inline">\(G_2\)</span>.</li>
<li><strong>Perfect Zero-Knowledge</strong>: This means B could generate such information alone (using a random generator and polynomial computations). It can be proven that the transcripts provided by the protocol are indistinguishable (from a probabilistic distribution perspective) from those produced by a simulator.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-194-contents" aria-controls="callout-194" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-194" class="callout-194-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Problem</strong>: Finding permutation between two isomorphic graphs = hard</p>
<p><strong>Protocol</strong>: A creates random H, B asks for permutation to G1 or G2, A responds</p>
<p><strong>Perfect ZK</strong>: Transcripts indistinguishable from a simulator</p>
</div>
</div>
</div>
<hr>
</section>
<section id="zkip-fiat-shamir-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="zkip-fiat-shamir-algorithm">ZKIP – Fiat-Shamir Algorithm</h3>
<section id="practical-protocol" class="level4">
<h4 class="anchored" data-anchor-id="practical-protocol">Practical Protocol</h4>
<p>Fiat-Shamir is an efficient and practical ZKIP based on the square root modulo composite problem.</p>
<p><strong>Initialization:</strong></p>
<ul>
<li>Trusted third party T chooses <span class="math inline">\(n = pq\)</span> (keeps p,q secret)</li>
<li>A chooses secret <span class="math inline">\(s\)</span> with <span class="math inline">\(\gcd(s,n) = 1\)</span></li>
<li>A computes <span class="math inline">\(v = s^2 \bmod n\)</span> and distributes v (certified public key)</li>
</ul>
<p><strong>Protocol:</strong></p>
<pre><code>(1) A → B: x = r² mod n
    (A chooses random r, witness)

(2) A ← B: e ∈ {0,1}
    (B sends challenge)

(3) A → B: y = r·sᵉ mod n
    (A computes response with secret s)

B rejects if y = 0
B accepts if y² ≡ x·vᵉ (mod n)</code></pre>
<p><strong>Repetition:</strong> Multiple times for security <span class="math inline">\(2^{-nk}\)</span></p>
<p><strong>Properties:</strong></p>
<ul>
<li><strong>Soundness</strong>: An impostor can easily answer e=0, but for e=1, it must compute <span class="math inline">\(\sqrt{x} \bmod n\)</span> (hard by SQROOTP)</li>
<li><strong>Perfect Zero-Knowledge</strong>: The pairs (x,y) can be simulated by B by choosing y randomly and computing <span class="math inline">\(x = y^2\)</span> or <span class="math inline">\(y^2/v\)</span></li>
<li>B cannot impersonate A because it cannot predict challenges</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-195-contents" aria-controls="callout-195" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-195" class="callout-195-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>ZKIP: Fiat-Shamir Algorithm</strong></p>
<p><strong>Goal:</strong> Allow A to identify itself by proving knowledge of a secret s (associated with A via authentic public information) to B without revealing any information about s.</p>
<p>This is a protocol serving as the basis for real and efficient implementations.</p>
<p><strong>Algorithm:</strong></p>
<p><strong>(Initialization):</strong></p>
<ol type="a">
<li><p>A trusted third party T chooses and publishes an n such that <span class="math inline">\(n = pq\)</span> and keeps p and q secret.</p></li>
<li><p>A chooses a secret s with <span class="math inline">\(1 \leq s \leq n -1\)</span> and <span class="math inline">\(\gcd(s,n) = 1\)</span>, computes <span class="math inline">\(v = s^2 \bmod n\)</span>, and distributes v as a public key certified by T.</p></li>
</ol>
<pre><code>(1) A → B: x = r² mod n</code></pre>
<p>A chooses a random r and sends a witness <span class="math inline">\(r^2\)</span>.</p>
<pre><code>(2) A ← B: e ∈ {0,1}</code></pre>
<p>B sends its challenge.</p>
<pre><code>(3) A → B: y = r·sᵉ mod n</code></pre>
<p>A computes the response using the secret s.</p>
<p>B rejects the proof if <span class="math inline">\(y = 0\)</span> (an impostor could falsify the proof with <span class="math inline">\(r = 0\)</span>) and accepts the proof if <span class="math inline">\(y^2 \equiv x \cdot v^e \pmod{n}\)</span>.</p>
<p>Steps (1) to (3) are repeated until a sufficient confidence margin is reached.</p>
<p><strong>Property Verification:</strong></p>
<ul>
<li><p><strong>Completeness</strong>: If A knows s, the protocol accepts the identification proof.</p></li>
<li><p><strong>Soundness</strong>: In the simple case, an impostor could only answer <span class="math inline">\(e = 0\)</span>. Otherwise, it could choose a random r and send <span class="math inline">\(x = r^2/v\)</span> in (1) and respond to the challenge <span class="math inline">\(e = 1\)</span> with a correct answer <span class="math inline">\(y = r\)</span>. For <span class="math inline">\(e = 0\)</span>, it would need to compute the square root of x mod n (n composite with unknown factorization), which is hard by SQROOTP. Proof success thus requires secret possession.</p></li>
<li><p><strong>Zero-Knowledge</strong>: B cannot obtain any information about s because when <span class="math inline">\(e = 1\)</span>, it is hidden by a random number (blinding factor).</p></li>
<li><p><strong>Perfect Zero-Knowledge</strong>: The pairs (x,y) obtained from A can also be simulated by B by choosing a random y and computing <span class="math inline">\(x = y^2\)</span> or <span class="math inline">\(y^2/v \bmod n\)</span>. It can be proven that these pairs have an identical probabilistic distribution to those provided by A (who computes them differently!).</p></li>
</ul>
<p>Note that, despite this last property, B is unable to impersonate A to B’ because it cannot predict the challenge values e.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-196-contents" aria-controls="callout-196" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-196" class="callout-196-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Secret</strong>: <span class="math inline">\(s\)</span> such that <span class="math inline">\(v = s^2 \bmod n\)</span> (public key)</p>
<p><strong>Protocol</strong>: Witness <span class="math inline">\(r^2\)</span>, challenge <span class="math inline">\(e \in \{0,1\}\)</span>, response <span class="math inline">\(y = r \cdot s^e\)</span></p>
<p><strong>Verification</strong>: <span class="math inline">\(y^2 \equiv x \cdot v^e \pmod{n}\)</span></p>
<p><strong>Perfect ZK</strong>: Pairs (x,y) simulatable by B</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="zkip-practical-implementations" class="level3">
<h3 class="anchored" data-anchor-id="zkip-practical-implementations">ZKIP – Practical Implementations</h3>
<section id="efficient-protocols" class="level4">
<h4 class="anchored" data-anchor-id="efficient-protocols">Efficient Protocols</h4>
<p>Practical implementations improve Fiat-Shamir’s efficiency.</p>
<p><strong>Feige-Fiat-Shamir (FSS):</strong></p>
<ul>
<li>Uses multiple witnesses and challenges (k values) per iteration</li>
<li>Cheating probability: <span class="math inline">\(2^{-nk}\)</span> for n iterations</li>
<li>Reduces required exchanges</li>
</ul>
<p><strong>Guillou-Quisquater (GQ):</strong></p>
<ul>
<li>Based on Fiat-Shamir but with expanded challenge domain</li>
<li>Reduces guessing probability without increasing exchanges</li>
<li>Better efficiency/security trade-off</li>
</ul>
<p><strong>Schnorr:</strong></p>
<ul>
<li>Based on discrete logarithm difficulty (DLP)</li>
<li>Very large challenge domain</li>
<li><strong>Identification in just 3 exchanges</strong></li>
<li>Sometimes sacrifices perfect zero-knowledge for efficiency</li>
</ul>
<p><strong>Advantages:</strong> More efficient than RSA, implementable on low-capacity devices (smart cards).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-197-contents" aria-controls="callout-197" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-197" class="callout-197-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>ZKIP: Common Implementations</strong></p>
<p><strong>Feige-Fiat-Shamir (FSS):</strong></p>
<ul>
<li>Based on the Fiat-Shamir protocol but using multiple witnesses and challenges (sets of k values) per iteration; for n iterations, this gives a probability of <span class="math inline">\(2^{-nk}\)</span> of guessing all responses.</li>
</ul>
<p><strong>Guillou-Quisquater (GQ):</strong></p>
<ul>
<li>Also based on Fiat-Shamir but increasing the challenge choice, which reduces the guessing probability without increasing the number of transferred instances and protocol steps.</li>
</ul>
<p><strong>Schnorr:</strong></p>
<ul>
<li>Based on the difficulty of computing discrete logarithms (DLP)</li>
<li>It also uses a very large challenge domain, allowing identification in <strong>just 3 message exchanges</strong>.</li>
</ul>
<p>These protocols are significantly more efficient than RSA and can be implemented on low-computing-capacity devices (smart cards).</p>
<p>They satisfy completeness and soundness properties, but the zero-knowledge property is sometimes sacrificed (as in Schnorr’s case) to increase efficiency.</p>
<p>For a detailed description of these protocols, refer to [Men97] or [Sti95].</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-198-contents" aria-controls="callout-198" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-198" class="callout-198-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>FSS</strong>: Multiple witnesses/challenges → probability <span class="math inline">\(2^{-nk}\)</span></p>
<p><strong>GQ</strong>: Expanded challenge domain → fewer exchanges</p>
<p><strong>Schnorr</strong>: DLP + large challenges → <strong>3 exchanges only</strong></p>
<p><strong>All</strong>: More efficient than RSA, suitable for smart cards</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="zkip-mafia-attack-and-final-remarks" class="level3">
<h3 class="anchored" data-anchor-id="zkip-mafia-attack-and-final-remarks">ZKIP – Mafia Attack and Final Remarks</h3>
<section id="vulnerabilities-and-countermeasures" class="level4">
<h4 class="anchored" data-anchor-id="vulnerabilities-and-countermeasures">Vulnerabilities and Countermeasures</h4>
<p>Even robust ZKIP protocols can be vulnerable to sophisticated attacks.</p>
<p><strong>Mafia Attack (1989, Adi Shamir):</strong></p>
<p>Scenario: C (attacker) and D (accomplice) collaborate so D impersonates A to B.</p>
<pre><code>A ↔ C: ZKIP Instance     D ↔ B: ZKIP Instance</code></pre>
<p>C relays A’s messages to D (accomplice), who uses them to authenticate to B. The attack is transparent to A and B.</p>
<p><strong>Countermeasures:</strong></p>
<ul>
<li><strong>Faraday cages</strong> (blocking radio communications)</li>
<li><strong>Strong synchronization</strong> to prevent side exchanges</li>
<li><strong>Distance bounding protocols</strong> limiting response delay</li>
</ul>
<p><strong>General Recommendations:</strong></p>
<ul>
<li>Choose proven solutions over inventing new ones</li>
<li>Verify objectives are met</li>
<li>Analyze practically (reflection attacks, redundancy, etc.)</li>
<li>Analyze formally (BAN logic, model checking)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-199-contents" aria-controls="callout-199" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-199" class="callout-199-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>ZKIP: Final Remarks</strong></p>
<p>ZKIPs offer a very high level of cryptographic security. They allow identifications while minimizing the chances of a hypothetical impostor and, most importantly, protecting the secret information of “honest” users.</p>
<p>In 1989 (SECURICOM’89), Adi Shamir said about ZKIPs: “I could go to a Mafia-owned store a million times in a row, and they still wouldn’t be able to impersonate me”…</p>
<p><strong>And yet</strong>: A participates in a ZKIP with C (Mafia); simultaneously, D (C’s accomplice) participates in another ZKIP pretending to be A to B (an “honest” verifier).</p>
<pre><code>(1) A → C: t1 (witness that C forwards via radio to D)
(1') D → B: t1
(2') D ← B: d1 (B sends the challenge to D; D forwards it to C...)
(2) A ← C: d1 (C resumes the challenge in its dialogue with A)
(3) A → C: r1 (the response using its secret, which C sends to D)
(3') D → B: r1 (B accepts r1 and so on!)</code></pre>
<p><strong>Solutions:</strong></p>
<ul>
<li>Conduct identifications in Faraday cages…</li>
<li>Use strong synchronization algorithms to prevent side exchanges.</li>
</ul>
<p><strong>Authentication: Summary – Attacks and Protections</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 39%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Attack</th>
<th>Description</th>
<th>Protection</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>replay</td>
<td>replay a previous identification instance</td>
<td>zero-knowledge, challenge-and-response, one-time password (beware of pre-play!)</td>
</tr>
<tr class="even">
<td>known/chosen-plaintext</td>
<td>obtain plaintext/ciphertext pairs</td>
<td>zero-knowledge</td>
</tr>
<tr class="odd">
<td>chosen-ciphertext</td>
<td>make A decrypt (or sign) carefully chosen information</td>
<td>zero-knowledge, ch.&nbsp;&amp; resp. + knowledge witness + structure (redundancy!)</td>
</tr>
<tr class="even">
<td>reflection</td>
<td>return the same number received</td>
<td>include target entity in messages, asymmetry in messages</td>
</tr>
<tr class="odd">
<td>interleaving</td>
<td>use messages from multiple simultaneous protocol instances</td>
<td>include target entity in messages, introduce cryptographic chaining between messages of the same identification instance</td>
</tr>
<tr class="even">
<td>collusion</td>
<td>collusion between participants</td>
<td>Faraday cage, strong synchronization</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-200-contents" aria-controls="callout-200" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-200" class="callout-200-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Mafia Attack</strong>: Relay messages via accomplice → transparent fraudulent authentication</p>
<p><strong>Protections</strong>: Faraday cage, strong synchronization, distance bounding</p>
<p><strong>Attack Table</strong>: replay, chosen-plaintext/ciphertext, reflection, interleaving, collusion</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="summary-attacks-and-protections" class="level2">
<h2 class="anchored" data-anchor-id="summary-attacks-and-protections">Summary – Attacks and Protections</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 39%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Attack</th>
<th>Description</th>
<th>Protection</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>replay</td>
<td>replay a previous identification instance</td>
<td>zero-knowledge, challenge-and-response, one-time password (beware of pre-play!)</td>
</tr>
<tr class="even">
<td>known/chosen-plaintext</td>
<td>obtain plaintext/ciphertext pairs</td>
<td>zero-knowledge</td>
</tr>
<tr class="odd">
<td>chosen-ciphertext</td>
<td>make A decrypt (or sign) carefully chosen information</td>
<td>zero-knowledge, ch.&nbsp;&amp; resp. + knowledge witness + structure (redundancy!)</td>
</tr>
<tr class="even">
<td>reflection</td>
<td>return the same number received</td>
<td>include target entity in messages, asymmetry in messages</td>
</tr>
<tr class="odd">
<td>interleaving</td>
<td>use messages from multiple simultaneous protocol instances</td>
<td>include target entity in messages, introduce cryptographic chaining between messages of the same identification instance</td>
</tr>
<tr class="even">
<td>collusion</td>
<td>collusion between participants</td>
<td>Faraday cage, strong synchronization</td>
</tr>
</tbody>
</table>
<p>Here is the <strong>exact English translation</strong> of your <em>Key Establishment Protocols (KEP)</em> document, preserving all content, structure, technical terms, and formatting:</p>
<hr>
</section>
</section>
<section id="key-establishment-protocols-kep" class="level1">
<h1>Key Establishment Protocols (KEP)</h1>
<section id="kep-definition-and-properties" class="level2">
<h2 class="anchored" data-anchor-id="kep-definition-and-properties">KEP Definition and Properties</h2>
<section id="definitions-and-classification" class="level3">
<h3 class="anchored" data-anchor-id="definitions-and-classification">Definitions and Classification</h3>
<p><strong>Key Establishment Protocol (KEP):</strong> A mechanism enabling entities to share a secret for their cryptographic exchanges.</p>
<p><strong>Two Types:</strong></p>
<ul>
<li><strong>Key Transport Protocol (KTP):</strong> One entity creates and transmits the key.</li>
<li><strong>Key Agreement Protocol (KAP):</strong> Entities jointly derive the key.</li>
</ul>
<p><strong>Temporal Classification:</strong></p>
<ul>
<li><strong>Pre-distribution:</strong> Keys determined in advance.</li>
<li><strong>Dynamic Key Establishment (DKE):</strong> Keys change with each execution.</li>
</ul>
<table border="1" cellspacing="0" cellpadding="6">
<tbody><tr>
<th colspan="3" style="text-align: center;">
Key Establishment Protocols
</th>
</tr>
<tr>
<th colspan="2" style="text-align: center;">
Key Agreement
</th>
<th>
Key Transport
</th>
</tr>
<tr>
<td>
Symmetric + pre-dist.
</td>
<td>
Symmetric + DKE
</td>
<td>
Symmetric + DKE
</td>
</tr>
<tr>
<td>
Asymmetric + pre-dist.
</td>
<td>
Asymmetric + DKE
</td>
<td>
Asymmetric + DKE
</td>
</tr>
</tbody></table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-201-contents" aria-controls="callout-201" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-201" class="callout-201-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A <strong>key establishment protocol (KEP)</strong> is one that provides the involved entities with a <strong>shared secret</strong> (a key) to serve as the basis for subsequent cryptographic exchanges.</p>
<p>The two variants of KEPs are <strong>key transport protocols (KTP)</strong> and <strong>key agreement protocols (KAP)</strong>.</p>
<ul>
<li>A <strong>key transport protocol (KTP)</strong> is a mechanism allowing one entity to <strong>create a secret key and transfer it</strong> to its correspondent(s).</li>
<li>A <strong>key agreement protocol (KAP)</strong> is a mechanism allowing two (or more) entities to <strong>derive a key</strong> from information specific to each entity.</li>
</ul>
<p><strong>Key pre-distribution schemes</strong> are those where the keys used are entirely <strong>determined a priori</strong> (e.g., from initial calculations).</p>
<p><strong>Dynamic key establishment schemes (DKE)</strong> are those where the keys <strong>change for each protocol execution</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-202-contents" aria-controls="callout-202" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-202" class="callout-202-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>KEP:</strong> Protocols to establish a shared secret.</p>
<ul>
<li><strong>KTP:</strong> Key transport</li>
<li><strong>KAP:</strong> Mutual key agreement</li>
<li><strong>Pre-distribution</strong> vs.&nbsp;<strong>DKE</strong> (dynamic)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="kep-properties" class="level3">
<h3 class="anchored" data-anchor-id="kep-properties">KEP Properties</h3>
<p><strong>Authentication Properties:</strong></p>
<ul>
<li><strong>Implicit key authentication:</strong> Assurance that only the correspondent can access the key (without proof of possession).</li>
<li><strong>Key confirmation:</strong> Assurance that the correspondent effectively possesses the key.</li>
<li><strong>Explicit key authentication:</strong> Implicit + confirmation.</li>
<li><strong>Authenticated KEP:</strong> A KEP providing key authentication.</li>
</ul>
<p><strong>Temporal Security Properties:</strong></p>
<ul>
<li><strong>Perfect Forward Secrecy (PFS):</strong> Compromise of long-term keys does not reveal past session keys.</li>
<li><strong>Future Secrecy:</strong> Future keys are protected even if long-term keys are compromised (by a passive attacker).</li>
<li><strong>Deniability/Repudiability:</strong> Inability to prove participation to a third party (like Zero-Knowledge).</li>
</ul>
<p><strong>Types of Attacks:</strong></p>
<ul>
<li><strong>Passive attack:</strong> Recording and analyzing exchanges.</li>
<li><strong>Active attack:</strong> Modifying or injecting messages.</li>
<li><strong>Known-key attack:</strong> Exploiting a compromised session key to attack future keys.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-203-contents" aria-controls="callout-203" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-203" class="callout-203-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Key Establishment Protocol Properties:</strong></p>
<ul>
<li><p><strong>Implicit key authentication</strong> (or key authentication): A property by which an entity is assured that only its correspondent(s) can access a secret key. However, this does not specify anything about actually possessing the key.</p></li>
<li><p><strong>Key confirmation:</strong> A property allowing an entity to be sure that its correspondents are in possession of the generated session keys.</p></li>
<li><p><strong>Explicit key authentication:</strong> = implicit key authentication + key confirmation.</p></li>
<li><p>An <strong>authenticated KEP</strong> is a KEP capable of providing key authentication.</p></li>
</ul>
<p><strong>Attacks:</strong></p>
<ul>
<li><p>A <strong>passive attack</strong> attempts to break a cryptographic system by <strong>recording and analyzing</strong> exchanges.</p></li>
<li><p>An <strong>active attack</strong> involves an adversary who <strong>modifies or injects</strong> messages.</p></li>
<li><p>A protocol is said to be vulnerable to a <strong>known-key attack</strong> if, when a previous session key is compromised, it becomes possible to: (a) compromise future keys via a passive attack and/or (b) mount active attacks aiming at identity impersonation.</p></li>
</ul>
<p><strong>Modern Properties:</strong></p>
<ul>
<li><p><strong>Perfect Forward Secrecy (PFS)</strong> is a characteristic that guarantees the <strong>confidentiality of past session keys</strong> even if long-term keys (e.g., the recipient’s private key) are compromised.</p></li>
<li><p><strong>Future Secrecy:</strong> The protocol guarantees the <strong>security of future exchanges</strong> (future session keys are protected) even if long-term keys are compromised by a passive attacker.</p></li>
<li><p><strong>Deniability / Repudiability:</strong> Similar to Zero-Knowledge authentication protocols, this allows entities to ensure exchange authentication without providing information that would allow proving their participation in the cryptographic exchange to a third party.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-204-contents" aria-controls="callout-204" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-204" class="callout-204-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Authentication:</strong></p>
<ul>
<li><strong>Implicit:</strong> Only the correspondent can access the key</li>
<li><strong>Key confirmation:</strong> Proof of possession</li>
<li><strong>Explicit:</strong> Implicit + confirmation</li>
</ul>
<p><strong>Security:</strong></p>
<ul>
<li><strong>PFS:</strong> Past keys protected if compromise occurs</li>
<li><strong>Future Secrecy:</strong> Future keys protected</li>
<li><strong>Deniability:</strong> Participation not provable</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="kap" class="level2">
<h2 class="anchored" data-anchor-id="kap">KAP</h2>
<section id="symmetric-1" class="level3">
<h3 class="anchored" data-anchor-id="symmetric-1">Symmetric</h3>
<section id="with-pre-distribution" class="level4">
<h4 class="anchored" data-anchor-id="with-pre-distribution">with Pre-distribution</h4>
<p><strong>Trivial Case:</strong></p>
<p>For <span class="math inline">\(n\)</span> users with a Key Distribution Center (KDC):</p>
<ol type="1">
<li>KDC generates <span class="math inline">\(\frac{n(n-1)}{2}\)</span> different keys (one per user pair).</li>
<li>KDC distributes <span class="math inline">\(n-1\)</span> keys to each user via a confidential channel.</li>
</ol>
<p><strong>Advantages:</strong></p>
<ul>
<li>Information-theoretically secure against user collusion.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><span class="math inline">\(O(n^2)\)</span> storage complexity for the KDC.</li>
<li><span class="math inline">\(O(n)\)</span> keys per user.</li>
<li>Not scalable.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-205-contents" aria-controls="callout-205" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-205" class="callout-205-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric KAP with Pre-distribution – Trivial Case</strong></p>
<p>Given <span class="math inline">\(n\)</span> users with a <strong>Key Distribution Center (KDC)</strong>.</p>
<p>A trivial symmetric KAP with pre-distribution can be constructed as follows:</p>
<ol type="1">
<li><p>The KDC generates <span class="math inline">\(n(n-1)/2\)</span> different keys (one different key for each user pair).</p></li>
<li><p>The KDC then distributes the keys via a <strong>confidential and authentic channel</strong>, giving <span class="math inline">\(n-1\)</span> keys to each user.</p></li>
</ol>
<p>If the KDC generates the keys in a truly <strong>random</strong> manner, this system is <strong>information-theoretically secure against user collusion</strong> (even if <span class="math inline">\(n-2\)</span> users collude, they cannot find the key of the other two) by protocol construction.</p>
<p><strong>Problem with this protocol:</strong></p>
<ul>
<li><span class="math inline">\(O(n^2)\)</span> <strong>key storage</strong> for the KDC.</li>
<li><span class="math inline">\(O(n)\)</span> <strong>secret keys exchanged</strong> for each entity.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-206-contents" aria-controls="callout-206" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-206" class="callout-206-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Trivial symmetric KAP:</strong></p>
<ul>
<li><span class="math inline">\(n(n-1)/2\)</span> keys for <span class="math inline">\(n\)</span> users</li>
<li>Information-theoretically secure</li>
<li>Problem: <span class="math inline">\(O(n^2)\)</span> storage</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="with-dynamic-key-establishment-dke" class="level4">
<h4 class="anchored" data-anchor-id="with-dynamic-key-establishment-dke">with Dynamic Key Establishment (DKE)</h4>
<section id="simple-example" class="level5">
<h5 class="anchored" data-anchor-id="simple-example">Simple Example</h5>
<p><strong>Initialization:</strong> A and B share a long-term key <span class="math inline">\(S\)</span>.</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: r_a\)</span> (random number)</li>
<li><span class="math inline">\(A \leftarrow B: r_b\)</span> (random number)</li>
<li>Session key: <span class="math inline">\(K := E_S(r_a \oplus r_b)\)</span></li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li>❌ Entity authentication</li>
<li>✅ Implicit key authentication</li>
<li>❌ Key confirmation</li>
<li>❌ Perfect Forward Secrecy</li>
</ul>
</section>
<section id="akep2-authenticated-key-exchange-protocol-2" class="level5">
<h5 class="anchored" data-anchor-id="akep2-authenticated-key-exchange-protocol-2">AKEP2 (Authenticated Key Exchange Protocol 2)</h5>
<p><strong>Initialization:</strong> A and B share <span class="math inline">\(S\)</span> (for MAC) and <span class="math inline">\(S'\)</span> (for session key).</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: r_a\)</span></li>
<li><span class="math inline">\(A \leftarrow B: T = (B,A,r_a,r_b), h_S(T)\)</span></li>
<li><span class="math inline">\(A \rightarrow B: (A, r_b), h_S(A,r_b)\)</span></li>
<li>Session key: <span class="math inline">\(K := h'_{S'}(r_b)\)</span></li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li>✅ Mutual entity authentication</li>
<li>✅ Implicit key authentication</li>
<li>❌ Key confirmation</li>
<li>❌ Perfect Forward Secrecy</li>
</ul>
<p><strong>Note:</strong> The key depends only on <span class="math inline">\(B\)</span> and the long-term key <span class="math inline">\(S'\)</span>!</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-207-contents" aria-controls="callout-207" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-207" class="callout-207-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric KAP with Dynamic Key Establishment</strong></p>
<p>These methods allow the involved entities to derive <strong>short-term keys</strong> (typically session keys) from <strong>long-term secrets</strong>, which, for these protocols, are symmetric keys.</p>
<p><strong>Intuitive Example:</strong></p>
<p>(Initialization): A and B share a long-term symmetric key <span class="math inline">\(S\)</span>.</p>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: r_a\)</span>; A generates a random number and sends it to B.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: r_b\)</span>; B does the same.</p></li>
</ol>
<p>A and B compute the session key: <span class="math inline">\(K := E_S(r_a \oplus r_b)\)</span>.</p>
<p><strong>Properties:</strong> - <strong>Entity authentication:</strong> NO: By protocol construction, the <span class="math inline">\(r_i\)</span> can be sent by any entity. - <strong>Implicit key authentication:</strong> YES: Only entities sharing the long-term symmetric key <span class="math inline">\(S\)</span> can access the session key <span class="math inline">\(K\)</span>. - <strong>Key confirmation:</strong> NO: Since the <span class="math inline">\(r_i\)</span> are random, they can be modified by an adversary, preventing A and B from agreeing on the session key <span class="math inline">\(K\)</span>. This would not be detected by the protocol. - <strong>Perfect Forward Secrecy:</strong> NO: If the long-term key <span class="math inline">\(S\)</span> is compromised, all previous session keys can be easily computed by an adversary who recorded all exchanges.</p>
<p><strong>Authenticated Key Exchange Protocol 2 (AKEP2)</strong></p>
<p>(Init.): A and B share two long-term symmetric keys <span class="math inline">\(S\)</span> and <span class="math inline">\(S'\)</span>. <span class="math inline">\(S\)</span> is used to generate MACs <span class="math inline">\(h_S()\)</span> (to ensure integrity and entity authentication), and <span class="math inline">\(S'\)</span> is used for session key <span class="math inline">\(K\)</span> generation.</p>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: r_a\)</span>; A generates a random number and sends it to B.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: T = (B,A,r_a,r_b), h_S(T)\)</span>; B does the same + identities + MAC of everything.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: (A, r_b), h_S(A,r_b)\)</span>; A verifies the identities and the <span class="math inline">\(r_a\)</span> provided by B; then sends identity + <span class="math inline">\(r_b\)</span> + MAC of everything.</p></li>
</ol>
<p>The key is bilaterally computed using a dedicated MAC <span class="math inline">\(h'_{S'}()\)</span>: <span class="math inline">\(K := h'_{S'}(r_b)\)</span>.</p>
<p><strong>Properties:</strong> - <strong>Entity authentication:</strong> YES (mutual, provided by MACs). - <strong>Implicit key authentication:</strong> YES. - <strong>Key confirmation:</strong> NO (no evidence that the key <span class="math inline">\(S'\)</span> is known to the correspondent). - <strong>Perfect Forward Secrecy:</strong> NO (if the key <span class="math inline">\(S'\)</span> is compromised, previous session keys <span class="math inline">\(K\)</span> are also compromised).</p>
<p>The key depends only on B (and the long-term key <span class="math inline">\(S'\)</span>), but the protocol can be easily modified so that the key also depends on A, making it a “true” KAP.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-208-contents" aria-controls="callout-208" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-208" class="callout-208-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric KAP with DKE:</strong></p>
<ul>
<li><strong>Simple:</strong> <span class="math inline">\(K := E_S(r_a \oplus r_b)\)</span> – no PFS</li>
<li><strong>AKEP2:</strong> Uses MACs for authentication + key derived as <span class="math inline">\(K := h'_{S'}(r_b)\)</span></li>
<li>No PFS if <span class="math inline">\(S'\)</span> is compromised</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="asymmetric-with-pre-distribution" class="level3">
<h3 class="anchored" data-anchor-id="asymmetric-with-pre-distribution">Asymmetric with Pre-distribution</h3>
<section id="diffie-hellman" class="level4">
<h4 class="anchored" data-anchor-id="diffie-hellman">Diffie-Hellman</h4>
<p><strong>Initialization:</strong> Public prime <span class="math inline">\(p\)</span> and generator <span class="math inline">\(\alpha \in \mathbb{Z}_p^*\)</span>.</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: \alpha^x \mod p\)</span> (A chooses secret <span class="math inline">\(x\)</span>)</li>
<li><span class="math inline">\(A \leftarrow B: \alpha^y \mod p\)</span> (B chooses secret <span class="math inline">\(y\)</span>)</li>
<li>Shared key: <span class="math inline">\(K := \alpha^{xy} \mod p\)</span></li>
</ol>
<ul>
<li>A computes <span class="math inline">\(K := (\alpha^y)^x \mod p\)</span></li>
<li>B computes <span class="math inline">\(K := (\alpha^x)^y \mod p\)</span></li>
</ul>
<p><strong>Security:</strong></p>
<ul>
<li>Based on the Diffie-Hellman Problem (DHP): Impossible to compute <span class="math inline">\(\alpha^{xy}\)</span> from <span class="math inline">\(\alpha^x\)</span> and <span class="math inline">\(\alpha^y\)</span>.</li>
<li>Proven result: DHP <span class="math inline">\(\equiv\)</span> DLP.</li>
</ul>
<p><strong>Man-in-the-Middle (MIM) Attack:</strong></p>
<p>Adversary C intercepts and replaces:</p>
<ul>
<li><span class="math inline">\(\alpha^x\)</span> with <span class="math inline">\(\alpha^{x'}\)</span> to B</li>
<li><span class="math inline">\(\alpha^y\)</span> with <span class="math inline">\(\alpha^{y'}\)</span> to A</li>
<li>C establishes two keys: <span class="math inline">\(\alpha^{xy'}\)</span> with A and <span class="math inline">\(\alpha^{x'y}\)</span> with B</li>
</ul>
<p><strong>Properties (Unauthenticated DH):</strong></p>
<ul>
<li>❌ Entity authentication</li>
<li>❌ Implicit key authentication (vulnerable to MIM)</li>
<li>❌ Key confirmation</li>
</ul>
<p><strong>Symmetric Key Generation:</strong></p>
<p>DH keys are not bit secure.</p>
<p>Solution: Apply a MDC (SHA, MD5) to the entire key <span class="math inline">\(K\)</span>:</p>
<p><span class="math display">\[K_{sym} := \text{SHA-256}(K)\]</span></p>
<p>Result: KAP with Dynamic Key Establishment.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-209-contents" aria-controls="callout-209" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-209" class="callout-209-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Asymmetric KAP with Pre-Distribution – Diffie-Hellman</strong></p>
<p>Published in 1976, this is the <strong>precursor of asymmetric protocols</strong>.</p>
<p>It allows two entities that have never met to construct a <strong>shared key</strong> by exchanging messages over a <strong>non-confidential channel</strong>.</p>
<p><strong>Protocol:</strong></p>
<p>Initialization: A prime number <span class="math inline">\(p\)</span> is generated, and a generator <span class="math inline">\(\alpha\)</span> of <span class="math inline">\(\mathbb{Z}_p^*\)</span>, such that <span class="math inline">\(\alpha \in \mathbb{Z}_{p-1}\)</span>. Both numbers are made public.</p>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: \alpha^x \mod p\)</span>; A chooses a secret <span class="math inline">\(x \in \mathbb{Z}_{p-1}\)</span> and sends the public part.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: \alpha^y \mod p\)</span>; B chooses a secret <span class="math inline">\(y \in \mathbb{Z}_{p-1}\)</span> and sends the public part.</p></li>
</ol>
<p>A computes the secret key: <span class="math inline">\(K := (\alpha^y)^x \mod p\)</span>, and B does the same: <span class="math inline">\(K := (\alpha^x)^y \mod p\)</span>.</p>
<p>The <strong>security</strong> of this scheme lies in the impossibility of finding <span class="math inline">\(\alpha^{xy} \mod p\)</span> from <span class="math inline">\(\alpha^x \mod p\)</span> and <span class="math inline">\(\alpha^y \mod p\)</span> (<strong>Diffie-Hellman Problem: DHP</strong>).</p>
<p><strong>Proven result:</strong> DHP <span class="math inline">\(\equiv\)</span> DLP.</p>
<p>Diffie-Hellman is <strong>secure</strong> (as much as DHP) against <strong>passive attacks</strong>. In other words, an adversary limited to observing messages cannot find the key <span class="math inline">\(K\)</span>.</p>
<p>This is no longer true for <strong>active attacks</strong>; let’s see what C can do by modifying messages:</p>
<p>C exchanges secret keys with A and B, respectively: <span class="math inline">\(\alpha^{xy'} \mod p\)</span> and <span class="math inline">\(\alpha^{x'y} \mod p\)</span> (C controls <span class="math inline">\(x'\)</span> and <span class="math inline">\(y'\)</span>). If C re-encrypts each packet it receives with the corresponding public key, the attack will be transparent to A and B.</p>
<p>This attack is called <strong>Man-in-the-Middle (MIM)</strong> and applies to all asymmetric protocols.</p>
<p>It is due to the <strong>lack of authentication of public keys</strong>, i.e., when A “talks” to B, it must use the <strong>authentic</strong> public key of B.</p>
<p><strong>Characteristics of Diffie-Hellman (unauthenticated):</strong></p>
<ul>
<li><strong>Entity Authentication:</strong> NO.</li>
<li><strong>Implicit key authentication:</strong> NO (due to the MIM attack).</li>
<li><strong>Key confirmation:</strong> NO (due to the MIM risk, A cannot be sure that B possesses the shared secret key).</li>
</ul>
<p><strong>Generating Symmetric Keys from a Diffie-Hellman Shared Key:</strong></p>
<p>The quantities manipulated in DH (notably <span class="math inline">\(K\)</span>) are 512–1024 bits in size (depending on the prime <span class="math inline">\(p\)</span> used).</p>
<p>An intuitive approach to generate smaller symmetric keys (64–128 bits) would be to take a subset of bits from the key <span class="math inline">\(K\)</span>.</p>
<p>Unfortunately, it can be proven that DH keys are not <strong>bit secure</strong>, meaning that subsets of bits (especially the Least Significant Bits) can be computed with an effort not proportional to that required to compute the entire key.</p>
<p>To generate keys securely, it is recommended to <strong>apply a MDC</strong> (like SHA or MD5) to the entire key (possibly chaining MDC applications to obtain successive symmetric keys).</p>
<p>This method yields a KAP with Dynamic Key Establishment.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-210-contents" aria-controls="callout-210" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-210" class="callout-210-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Diffie-Hellman:</strong></p>
<ul>
<li><span class="math inline">\(K := \alpha^{xy} \mod p\)</span> computed independently by A and B</li>
<li>Secure against passive attacks (DHP <span class="math inline">\(\equiv\)</span> DLP)</li>
<li>Vulnerable to MIM without authentication</li>
<li>Generate symmetric keys: <span class="math inline">\(K_{sym} := \text{SHA}(K)\)</span></li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="asymmetric-with-dke" class="level3">
<h3 class="anchored" data-anchor-id="asymmetric-with-dke">Asymmetric with DKE</h3>
<section id="station-to-station-protocol-sts" class="level4">
<h4 class="anchored" data-anchor-id="station-to-station-protocol-sts">Station to Station Protocol (STS)</h4>
<p><strong>Authenticated Diffie-Hellman</strong> with digital signatures.</p>
<p><strong>Initialization:</strong> Public prime <span class="math inline">\(p\)</span> and generator <span class="math inline">\(\alpha\)</span>. A and B have authentic copies of each other’s public keys.</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: \alpha^x \mod p\)</span></li>
<li><span class="math inline">\(A \leftarrow B: \alpha^y \mod p, E_k(S_B(\alpha^x, \alpha^y))\)</span>
<ul>
<li>B computes <span class="math inline">\(k := (\alpha^x)^y \mod p\)</span></li>
<li>B signs and encrypts the public parts</li>
</ul></li>
<li><span class="math inline">\(A \rightarrow B: E_k(S_A(\alpha^y, \alpha^x))\)</span>
<ul>
<li>A decrypts, verifies B’s signature</li>
<li>A signs and encrypts in reverse order</li>
</ul></li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li>✅ Mutual entity authentication (via signatures)</li>
<li>✅ Implicit key authentication (DHP + signatures prevent MIM)</li>
<li>✅ Key confirmation (encryption proves possession of <span class="math inline">\(k\)</span>)</li>
<li>✅ Explicit key authentication (authentication + key confirmation)</li>
<li>✅ <strong>Perfect Forward Secrecy</strong> (compromise of signature private key does not reveal past session keys)</li>
</ul>
<p><strong>Efficient Variant:</strong> Replace <span class="math inline">\(E_k(S_B(...))\)</span> with <span class="math inline">\((sig, h_k(sig))\)</span> using MAC instead of symmetric encryption.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-211-contents" aria-controls="callout-211" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-211" class="callout-211-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Asymmetric KAP with DKE – Station to Station Protocol</strong></p>
<p>(Notation) <span class="math inline">\(S_A\)</span>: Signature with A’s private key.</p>
<p>(Initialization): (a) Choose a prime <span class="math inline">\(p\)</span> and a generator <span class="math inline">\(\alpha\)</span> of <span class="math inline">\(\mathbb{Z}_p^*\)</span>, such that <span class="math inline">\(\alpha \in \mathbb{Z}_{p-1}\)</span>. Both numbers are made public (and optionally associated with the participants’ public keys).</p>
<ol start="2" type="a">
<li>Participants have access to authentic copies of the correspondents’ public keys. Certificates may be exchanged if needed in (2) and (3).</li>
</ol>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: \alpha^x \mod p\)</span>; A generates a secret <span class="math inline">\(x\)</span> and sends the public part.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: \alpha^y \mod p, E_k(S_B(\alpha^x, \alpha^y))\)</span>; B generates a secret <span class="math inline">\(y\)</span> and computes the key: <span class="math inline">\(k := (\alpha^x)^y \mod p\)</span> + signs and encrypts the public parts.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: E_k(S_A(\alpha^y, \alpha^x))\)</span>; A decrypts by computing <span class="math inline">\(k := (\alpha^y)^x \mod p\)</span>, verifies B’s signature and the public parts; if OK, A signs + encrypts in reverse order.</p></li>
</ol>
<p>B decrypts and verifies A’s signature on the public parts. If OK =&gt; END.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li><strong>Entity Authentication:</strong> YES (mutual, provided by signatures).</li>
<li><strong>Implicit key authentication:</strong> YES, keys are protected by DHP. The MIM attack is made impossible by signatures.</li>
<li><strong>Key confirmation:</strong> YES, both entities prove possession of the key by encrypting quantities with it.</li>
<li><strong>Explicit key authentication:</strong> YES: implicit key authentication + key confirmation.</li>
<li><strong>Perfect Forward Secrecy:</strong> YES. The only long-term key is the one used for signing/verification. If this key is compromised, past session keys are protected because they are not explicitly exchanged but rather computed via DH.</li>
</ul>
<p>Obviously, once the signature key is compromised (private key theft), the stated properties no longer hold for future exchanges.</p>
<p>The protocol additionally provides <strong>anonymity</strong> since the parties’ identities are protected by <span class="math inline">\(k\)</span>.</p>
<p><strong>Variant:</strong> In (2), compute <span class="math inline">\(sig := S_B(\alpha^x, \alpha^y)\)</span>, and send <span class="math inline">\((sig, h_k(sig))\)</span> instead of <span class="math inline">\(E_k(S_B(\alpha^x, \alpha^y))\)</span>. Same for (3), observing the protocol’s asymmetries.</p>
<p>More efficient solution as it uses a <strong>MAC</strong> rather than symmetric encryption.</p>
<p>Robust and efficient algorithm chosen as the base for key generation in <strong>IPv6</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-212-contents" aria-controls="callout-212" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-212" class="callout-212-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Station to Station (STS):</strong></p>
<ul>
<li>DH + digital signatures</li>
<li>✅ PFS: Past session keys protected</li>
<li>✅ Explicit key authentication</li>
<li>Used in IPv6</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="off-the-record-otr-and-signal-protocols" class="level4">
<h4 class="anchored" data-anchor-id="off-the-record-otr-and-signal-protocols">Off-The-Record (OTR) and Signal Protocols</h4>
<section id="off-the-record-otr" class="level5">
<h5 class="anchored" data-anchor-id="off-the-record-otr">Off-The-Record (OTR)</h5>
<p>Protocol (2004) for instant messaging with <strong>repudiability</strong>.</p>
<p><strong>SIGMA Technique (SIGn-and-MAC):</strong></p>
<ul>
<li>DH signatures + ephemeral authentication via MAC</li>
<li>Key Derivation Function (KDF) generates two keys: <span class="math inline">\(K_e\)</span> (AES-CTR encryption) and <span class="math inline">\(K_m\)</span> (MAC)</li>
<li>Key change per conversation</li>
<li><strong>Revelation of previous MAC keys</strong> to ensure repudiability</li>
</ul>
<p><strong>Simplified Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: \alpha^x \mod p\)</span></li>
<li><span class="math inline">\(A \leftarrow B: \alpha^y \mod p, S_B(\alpha^x, \alpha^y), \text{MAC}_{K_m}(B)\)</span>
<ul>
<li>B computes <span class="math inline">\(k := (\alpha^x)^y \mod p\)</span></li>
<li><span class="math inline">\((K_m, K_e) := \text{KDF}(k)\)</span></li>
</ul></li>
<li><span class="math inline">\(A \rightarrow B: S_A(\alpha^y, \alpha^x), \text{MAC}_{K_m}(A)\)</span></li>
</ol>
<p>Messages encrypted with <span class="math inline">\(K_e\)</span>.</p>
</section>
<section id="signal-protocol" class="level5">
<h5 class="anchored" data-anchor-id="signal-protocol">Signal Protocol</h5>
<p>Evolution of OTR for social networks (WhatsApp, Facebook Messenger).</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Ephemeral asymmetric and symmetric keys</li>
<li>DH on elliptic curves</li>
<li>✅ PFS</li>
<li>✅ Future Secrecy</li>
<li>✅ Repudiability</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-213-contents" aria-controls="callout-213" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-213" class="callout-213-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Off-The-Record (OTR) Protocol</strong></p>
<p>Protocol designed in 2004 to provide authentication and confidentiality services in instant messaging exchanges while preserving the “<strong>repudiable</strong>” nature of an “off-the-record” conversation.</p>
<p>The protocol also satisfies <strong>PFS</strong> and <strong>Future Secrecy</strong> properties in case of long-term key compromise.</p>
<p>It follows the same principles as the Station-to-Station protocol, adding <strong>ephemeral authentication via a MAC</strong> to the DH parameter signatures. This dual technique is called <strong>SIGMA</strong> (SIGn-and-MAC).</p>
<p>It uses a <strong>Key Derivation Function (KDF)</strong> to generate an encryption key (<span class="math inline">\(K_e\)</span>) preserving message confidentiality with AES CTR-mode and a MAC key (<span class="math inline">\(K_m\)</span>) ensuring message origin authenticity.</p>
<p>Each conversation involves a <strong>key change</strong> (new DH parameter exchange) with an additional <strong>plaintext exchange of the MAC keys</strong> (<span class="math inline">\(K_m\)</span>) used in the previous exchange to ensure repudiability!</p>
<p><strong>Schematic OTR Protocol Exchanges:</strong></p>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: \alpha^x \mod p\)</span>; A generates a secret <span class="math inline">\(x\)</span> and sends the public part.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: \alpha^y \mod p, S_B(\alpha^x, \alpha^y), \text{MAC}_{K_m}(B)\)</span></p></li>
</ol>
<p>B generates a secret <span class="math inline">\(y\)</span>, computes the session key <span class="math inline">\(k := (\alpha^x)^y \mod p\)</span>, and signs the DH public parts. It then generates keys <span class="math inline">\(K_e\)</span> and <span class="math inline">\(K_m\)</span> via the KDF: <span class="math inline">\((K_m, K_e) := \text{KDF}(k)\)</span>.</p>
<ol start="3" type="1">
<li><span class="math inline">\(A \rightarrow B: S_A(\alpha^y, \alpha^x), \text{MAC}_{K_m}(A)\)</span>; A does the same.</li>
</ol>
<p>Messages are then encrypted with key <span class="math inline">\(K_e\)</span>.</p>
<p>Numerous evolutions of the original OTR protocol have addressed vulnerabilities and improved efficiency.</p>
<p><strong>The Signal Protocol</strong></p>
<p>The Signal protocol is an evolution of the OTR protocol targeting message exchange protection in <strong>social networks</strong>. It also uses ephemeral asymmetric and symmetric keys to ensure <strong>PFS</strong>, <strong>Future Secrecy</strong>, and <strong>repudiability</strong> with DH computations on elliptic curves.</p>
<p>Signal is used to protect messaging platforms such as <strong>WhatsApp</strong> and <strong>Facebook Messenger</strong>, among others.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-214-contents" aria-controls="callout-214" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-214" class="callout-214-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>OTR/Signal:</strong></p>
<ul>
<li>SIGMA: signature + MAC</li>
<li>KDF: generates <span class="math inline">\(K_e\)</span> (encryption) and <span class="math inline">\(K_m\)</span> (MAC)</li>
<li>Reveals old MAC keys → repudiability</li>
<li>✅ PFS, ✅ Future Secrecy</li>
<li>Used in: WhatsApp, Facebook Messenger</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="secure-remote-password-srp" class="level4">
<h4 class="anchored" data-anchor-id="secure-remote-password-srp">Secure Remote Password (SRP)</h4>
<p>Asymmetric KAP protocol <strong>based on password</strong>, resistant to dictionary attacks.</p>
<p><strong>Initialization:</strong></p>
<ul>
<li><span class="math inline">\(m := 2p+1\)</span> (safe prime), <span class="math inline">\(\alpha\)</span> generator of <span class="math inline">\(\mathbb{Z}_p^*\)</span></li>
<li><span class="math inline">\(P\)</span>: A’s password, <span class="math inline">\(x := H(P)\)</span> with <span class="math inline">\(H\)</span> a CRHF</li>
<li>B stores the <strong>verifier</strong>: <span class="math inline">\(v := \alpha^x \mod m\)</span> (not the password!)</li>
</ul>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: \gamma := \alpha^r \mod m\)</span> (A generates secret <span class="math inline">\(r\)</span>)</li>
<li><span class="math inline">\(A \leftarrow B: \delta := (v + \alpha^t) \mod m, u\)</span> (B generates random <span class="math inline">\(t, u\)</span>)</li>
<li>A computes <span class="math inline">\(k := (\delta - v)^{r+ux} \mod m\)</span></li>
<li>B computes <span class="math inline">\(k := (\gamma v^u)^t \mod m\)</span></li>
<li>Key confirmation</li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li>✅ Protects passwords from dictionary attacks</li>
<li>✅ <strong>Verifier-based:</strong> B does not store passwords</li>
<li>✅ All KEP properties</li>
<li>Included in SSL/TLS, EAP</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-215-contents" aria-controls="callout-215" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-215" class="callout-215-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Asymmetric KAP with DKE – Secure Remote Password Protocol</strong></p>
<ol type="a">
<li>Let <span class="math inline">\(m\)</span> be a safe prime with <span class="math inline">\(m := 2p+1\)</span> and <span class="math inline">\(p\)</span> prime.</li>
<li>Let <span class="math inline">\(\alpha\)</span> be a generator of <span class="math inline">\(\mathbb{Z}_p^*\)</span>, such that <span class="math inline">\(\alpha \in \mathbb{Z}_{p-1}\)</span>.</li>
<li>Let <span class="math inline">\(P\)</span> be A’s password and <span class="math inline">\(x := H(P)\)</span> with <span class="math inline">\(H\)</span> a CRHF.</li>
<li>B stores in its password database the <strong>verifier</strong> <span class="math inline">\(v := \alpha^x \mod m\)</span>.</li>
</ol>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: \gamma := \alpha^r \mod m\)</span>; A generates a secret random number <span class="math inline">\(r\)</span>.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: \delta := (v + \alpha^t) \mod m, u\)</span>; B generates a secret random number <span class="math inline">\(t\)</span> and another random number <span class="math inline">\(u\)</span>.</p></li>
</ol>
<p>A computes the symmetric key: <span class="math inline">\(k := (\delta - v)^{r+ux} \mod m\)</span>.</p>
<p>B computes the symmetric key: <span class="math inline">\(k := (\gamma v^u)^t \mod m\)</span>.</p>
<p>A and B prove knowledge of <span class="math inline">\(k\)</span> (key confirmation) in a subsequent exchange.</p>
<ul>
<li>SRP <strong>protects passwords</strong> from dictionary attacks.</li>
<li>B does not store passwords but <strong>verification values</strong> (verifier-based).</li>
<li>SRP also satisfies <strong>all KEP properties</strong> and is included in many standards (SSL/TLS, EAP, etc.).</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-216-contents" aria-controls="callout-216" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-216" class="callout-216-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>SRP:</strong></p>
<ul>
<li>Password-based KAP</li>
<li>B stores verifier <span class="math inline">\(v := \alpha^x\)</span> (not password)</li>
<li>Resistant to dictionary attacks</li>
<li>✅ All KEP properties</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="attacks-on-dh-and-pfs" class="level3">
<h3 class="anchored" data-anchor-id="attacks-on-dh-and-pfs">Attacks on DH and PFS</h3>
<p><strong>Logjam Attack (2015):</strong></p>
<p>Active attack enabling:</p>
<ol type="1">
<li><strong>Downgrade:</strong> Man-in-the-Middle forces use of 512-bit DH group.</li>
<li><strong>Discrete logarithm computation</strong> with Number Field Sieve:
<ul>
<li>One-week precomputation for a fixed prime <span class="math inline">\(p\)</span>.</li>
<li>~1-minute individual computation after precomputation.</li>
</ul></li>
<li><strong>Precomputation reuse:</strong> Many servers use the same <span class="math inline">\(p\)</span>.</li>
</ol>
<p><strong>Consequence:</strong></p>
<p>State-level actors can compromise PFS on widespread 1024-bit groups.</p>
<p><strong>Solutions:</strong></p>
<ul>
<li>Use groups <span class="math inline">\(\geq\)</span> 2048 bits.</li>
<li>Diversify the primes <span class="math inline">\(p\)</span> used.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-217-contents" aria-controls="callout-217" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-217" class="callout-217-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Recent Attacks on Diffie-Hellman and PFS</strong></p>
<p>In 2015, a group of researchers published a series of attacks on the TLS/SSL protocol allowing:</p>
<ul>
<li><p>Performing a <strong>downgrade</strong> via an active attack called <strong>Logjam</strong>, whereby a man-in-the-middle successfully reduces the Diffie-Hellman group size to <strong>512 bits</strong> for the shared secret key establishment.</p></li>
<li><p>Subsequently computing the <strong>discrete logarithms</strong> of <span class="math inline">\(\alpha^x \mod p\)</span> and <span class="math inline">\(\alpha^y \mod p\)</span> using the <strong>Number Field Sieve</strong> technique.</p></li>
<li><p>For a group based on a fixed prime <span class="math inline">\(p\)</span>, they perform a <strong>precomputation phase</strong> lasting approximately <strong>one week</strong>.</p></li>
<li><p>Once this initial phase is complete, individual logarithm computations take only <strong>about one minute</strong>!</p></li>
<li><p>A statistical observation shows that a significant percentage of servers rely on the <strong>same group</strong> (same prime <span class="math inline">\(p\)</span>), allowing the same precomputation phase to be used to compromise multiple servers.</p></li>
<li><p>One of the conclusions of this research is that <strong>major actors with state-level resources</strong> would currently be able to break PFS when it is based on (very common today…) <strong>1024-bit groups</strong>.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-218-contents" aria-controls="callout-218" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-218" class="callout-218-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Logjam (2015):</strong></p>
<ul>
<li>Downgrade → DH 512 bits</li>
<li>Precomputation (1 week) + individual computation (1 min)</li>
<li>Reuse if same <span class="math inline">\(p\)</span></li>
<li>⚠️ States can break PFS on 1024-bit groups</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="ktp" class="level2">
<h2 class="anchored" data-anchor-id="ktp">KTP</h2>
<section id="symmetric-2" class="level3">
<h3 class="anchored" data-anchor-id="symmetric-2">Symmetric</h3>
<section id="trivial-case" class="level4">
<h4 class="anchored" data-anchor-id="trivial-case">Trivial Case</h4>
<p><strong>Initialization:</strong> A and B share long-term key <span class="math inline">\(S\)</span>.</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: E_S(r_a)\)</span></li>
<li>Session key: <span class="math inline">\(K := r_a\)</span></li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li>❌ Entity authentication</li>
<li>✅ Implicit key authentication</li>
<li>❌ Key confirmation (improvement: <span class="math inline">\(E_S(B, r_a)\)</span>)</li>
<li>❌ Perfect Forward Secrecy</li>
</ul>
<p><strong>Timestamp Variant:</strong> <span class="math inline">\(A \rightarrow B: E_S(B, t_a, r_a)\)</span> (requires synchronized clocks).</p>
</section>
<section id="shamirs-no-key-protocol" class="level4">
<h4 class="anchored" data-anchor-id="shamirs-no-key-protocol">Shamir’s No-Key Protocol</h4>
<p>DH equivalent in key transport.</p>
<p><strong>Initialization:</strong> Public prime <span class="math inline">\(p\)</span>, A and B generate secrets <span class="math inline">\(a, b \in \mathbb{Z}_{p-1}\)</span> with <span class="math inline">\(\gcd(a,p-1)=1\)</span> and <span class="math inline">\(\gcd(b,p-1)=1\)</span>.</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: K^a \mod p\)</span> (A chooses key <span class="math inline">\(K\)</span> and hides it with <span class="math inline">\(^a\)</span>)</li>
<li><span class="math inline">\(A \leftarrow B: (K^a)^b \mod p\)</span> (B exponentiates with <span class="math inline">\(b\)</span>)</li>
<li><span class="math inline">\(A \rightarrow B: (K^{ab})^{a^{-1}} \mod p = K^b \mod p\)</span> (A undoes <span class="math inline">\(^a\)</span>)</li>
<li>B computes <span class="math inline">\(K\)</span> by exponentiating with <span class="math inline">\(b^{-1} \mod (p-1)\)</span></li>
</ol>
<p><strong>Problem:</strong> Vulnerable to Man-in-the-Middle (like DH).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-219-contents" aria-controls="callout-219" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-219" class="callout-219-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric Key Transport Protocol – Trivial Case</strong></p>
<p>(Init.) A and B share a long-term symmetric key <span class="math inline">\(S\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: E_S(r_a)\)</span>; A generates a random number and encrypts it with <span class="math inline">\(S\)</span>.</li>
</ol>
<p>The session key used by both entities is <span class="math inline">\(K := r_a\)</span>.</p>
<p><strong>Properties:</strong></p>
<ul>
<li><strong>Entity Authentication:</strong> NO.</li>
<li><strong>Implicit Key Authentication:</strong> YES (only A and B have access to the key).</li>
<li><strong>Key Confirmation:</strong> NO. B cannot be sure that A possesses the key because <span class="math inline">\(r_a\)</span> is a random number. By adding redundancy (e.g., B’s identity), B can achieve unilateral key confirmation (and thus, explicit key authentication):</li>
</ul>
<p>(1)’ : <span class="math inline">\(A \rightarrow B: E_S(B, r_a)\)</span></p>
<ul>
<li><strong>Perfect Forward Secrecy:</strong> NO.</li>
</ul>
<p>If B cannot judge the freshness of (1) from <span class="math inline">\(r_a\)</span> alone, it can ask A to include a timestamp, provided synchronized clocks are available:</p>
<p>(1)’’ : <span class="math inline">\(A \rightarrow B: E_S(B, t_a, r_a)\)</span></p>
<p><strong>Symmetric KTP: Shamir’s No-Key Protocol</strong></p>
<p>Number Theory Reminder: If <span class="math inline">\(p\)</span> is prime and <span class="math inline">\(r \equiv t \mod p-1\)</span>, then <span class="math inline">\(a^r \equiv a^t \mod p\)</span> <span class="math inline">\(\forall a \in \mathbb{Z}\)</span>, and thus: <span class="math inline">\(r \cdot r^{-1} \equiv 1 \mod p-1\)</span> implies <span class="math inline">\(a^{r \cdot r^{-1}} \equiv a \mod p\)</span>.</p>
<p>(Init.) (a) Choose and publish a prime <span class="math inline">\(p\)</span> for which it is difficult (by DLP) to compute discrete logarithms in <span class="math inline">\(\mathbb{Z}_p\)</span>.</p>
<ol start="2" type="a">
<li><p>A (resp. B) generates a secret number <span class="math inline">\(a\)</span> (resp. <span class="math inline">\(b\)</span>), such that <span class="math inline">\(\{a,b\} \in \mathbb{Z}_{p-1}\)</span> and <span class="math inline">\(\gcd(a,p-1) = 1\)</span> and <span class="math inline">\(\gcd(b,p-1) = 1\)</span> (so that inverses exist).</p></li>
<li><p>For the following, A precomputes <span class="math inline">\(a^{-1} \mod p-1\)</span> and B precomputes <span class="math inline">\(b^{-1} \mod p-1\)</span>.</p></li>
</ol>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: K^a \mod p\)</span>; A chooses a key <span class="math inline">\(K \in \mathbb{Z}_p\)</span> and hides it with <span class="math inline">\(^a\)</span>.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: (K^a)^b \mod p\)</span>; B exponentiates in turn with <span class="math inline">\(b\)</span>.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: (K^{ab})^{a^{-1}} \mod p\)</span>; A undoes the exponentiation with <span class="math inline">\(a^{-1} \mod p-1\)</span>; but the key remains protected by <span class="math inline">\(^b\)</span>.</p></li>
</ol>
<p>B only needs to compute <span class="math inline">\(K\)</span> by exponentiating with <span class="math inline">\(b^{-1} \mod p-1\)</span>.</p>
<p>This protocol is the key transport equivalent of Diffie-Hellman (in DH, the key is not transported but bilaterally computed). It suffers from the same problems (notably Man-in-the-Middle) as the latter.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-220-contents" aria-controls="callout-220" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-220" class="callout-220-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric KTP:</strong></p>
<ul>
<li>Trivial: <span class="math inline">\(K := r_a\)</span> with <span class="math inline">\(E_S(r_a)\)</span></li>
<li>Shamir: Transport via successive exponentiations</li>
<li>No PFS</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="asymmetric-1" class="level3">
<h3 class="anchored" data-anchor-id="asymmetric-1">Asymmetric</h3>
<section id="needham-schroeder" class="level4">
<h4 class="anchored" data-anchor-id="needham-schroeder">Needham-Schroeder</h4>
<p><strong>Initialization:</strong> A and B have authentic copies of each other’s public keys.</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: E_{pub_B}(k_1, A)\)</span></li>
<li><span class="math inline">\(A \leftarrow B: E_{pub_A}(k_1, k_2)\)</span></li>
<li><span class="math inline">\(A \rightarrow B: E_{pub_B}(k_2)\)</span></li>
<li>Session key: <span class="math inline">\(K := H(k_1, k_2)\)</span></li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li>✅ Entity authentication + implicit key authentication + key confirmation</li>
<li>❌ Perfect Forward Secrecy (keys entirely determined by exchanged quantities)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-221-contents" aria-controls="callout-221" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-221" class="callout-221-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Asymmetric Key Transport Protocol – Needham-Schroeder Public Key Protocol</strong></p>
<p>(Notation): <span class="math inline">\(E_{pub_E}(X)\)</span> means encrypting with entity E’s public key.</p>
<p>(Init): A and B possess an authentic copy (possibly a certificate) of the other’s public key.</p>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: E_{pub_B}(k_1, A)\)</span>; A generates a random number <span class="math inline">\(k_1\)</span> + A + Encrypt.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: E_{pub_A}(k_1, k_2)\)</span>; B does the same for <span class="math inline">\(k_2\)</span> + concatenates with <span class="math inline">\(k_1\)</span> + Encrypt.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: E_{pub_B}(k_2)\)</span>; A verifies if <span class="math inline">\(k_1\)</span> matches, if yes, encrypts <span class="math inline">\(k_2\)</span>; B verifies if <span class="math inline">\(k_2\)</span> matches with (2).</p></li>
</ol>
<p>The key is generated using a cryptographic hash function: <span class="math inline">\(K := H(k_1, k_2)\)</span>.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li><strong>Entity Authentication</strong> + <strong>implicit key authentication</strong> + <strong>key confirmation:</strong> YES.</li>
<li><strong>Perfect Forward Secrecy:</strong> NO: The keys are entirely determined by the exchanged quantities.</li>
</ul>
<p>A similar protocol (only (3) changes) can be used for entity authentication.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-222-contents" aria-controls="callout-222" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-222" class="callout-222-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Asymmetric Needham-Schroeder:</strong></p>
<ul>
<li><span class="math inline">\(K := H(k_1, k_2)\)</span> with encrypted exchanges</li>
<li>✅ Full authentication</li>
<li>❌ No PFS</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="hybrid" class="level3">
<h3 class="anchored" data-anchor-id="hybrid">Hybrid</h3>
<section id="encrypted-key-exchange-eke" class="level4">
<h4 class="anchored" data-anchor-id="encrypted-key-exchange-eke">Encrypted Key Exchange (EKE)</h4>
<p><strong>Hybrid protocol</strong> (symmetric + asymmetric) resistant to dictionary attacks.</p>
<p><strong>Initialization:</strong> A and B share password <span class="math inline">\(p\)</span>.</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow B: A, E_p(pub_A)\)</span> (A generates key pair, sends public key encrypted)</li>
<li><span class="math inline">\(A \leftarrow B: E_p(E_{pub_A}(k))\)</span> (B generates session key <span class="math inline">\(k\)</span>, double encryption)</li>
<li><span class="math inline">\(A \rightarrow B: E_k(r_a)\)</span> (Key confirmation)</li>
<li><span class="math inline">\(A \leftarrow B: E_k(r_a, r_b)\)</span></li>
<li><span class="math inline">\(A \rightarrow B: E_k(r_b)\)</span></li>
</ol>
<p><strong>Advantages:</strong></p>
<ul>
<li>Robust even if password <span class="math inline">\(p\)</span> is weak.</li>
<li>Eve cannot guess without also “breaking” the asymmetric algorithm.</li>
</ul>
<p><strong>Properties:</strong></p>
<ul>
<li>✅ Entity authentication + implicit + confirmation</li>
<li>✅ Perfect Forward Secrecy <strong>if</strong> <span class="math inline">\(pub_A/priv_A\)</span> is regenerated each time</li>
<li>❌ No PFS if long-term keys</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-223-contents" aria-controls="callout-223" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-223" class="callout-223-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Hybrid KTP: Encrypted Key Exchange (EKE)</strong></p>
<p>This protocol uses <strong>symmetric and asymmetric schemes</strong> to minimize the risk of cryptanalysis via dictionary attacks inherent to symmetric systems.</p>
<p>(Init.): A and B share a symmetric secret <span class="math inline">\(p\)</span> (password).</p>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow B: A, E_p(pub_A)\)</span>; A generates a public/private key pair and sends the public part to B encrypted with <span class="math inline">\(p\)</span>.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: E_p(E_{pub_A}(k))\)</span>; B generates a session key <span class="math inline">\(k\)</span> and sends it encrypted.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: E_k(r_a)\)</span>; A generates a random number and sends it encrypted with <span class="math inline">\(k\)</span>.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: E_k(r_a, r_b)\)</span>; B generates <span class="math inline">\(r_b\)</span> and sends it with <span class="math inline">\(r_a\)</span> encrypted with <span class="math inline">\(k\)</span>.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: E_k(r_b)\)</span>; Confirmation from A. If <span class="math inline">\(r_b =\)</span> OK =&gt; END.</p></li>
<li><p>and (2) are responsible for <strong>key transport</strong>; (3) to (5) for <strong>key confirmation</strong>.</p></li>
</ol>
<p>This protocol is <strong>robust even if the password</strong> <span class="math inline">\(p\)</span> shared between A and B is of poor quality. Indeed, Eve cannot attempt to guess without also “breaking” the asymmetric algorithm.</p>
<p><strong>Properties:</strong></p>
<ul>
<li><strong>Entity Authentication</strong> + <strong>implicit key authentication</strong> + <strong>key confirmation:</strong> YES.</li>
<li><strong>Perfect Forward Secrecy:</strong> YES if the <span class="math inline">\(pub_A/priv_A\)</span> pair is regenerated for each protocol instance. NO if <span class="math inline">\(pub_A/priv_A\)</span> is a long-term key.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-224-contents" aria-controls="callout-224" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-224" class="callout-224-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>EKE (Hybrid):</strong></p>
<ul>
<li>Password + asymmetric crypto</li>
<li>Robust even with weak password</li>
<li>PFS if keys regenerated each time</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="symmetric-with-key-distribution-center-kdc" class="level3">
<h3 class="anchored" data-anchor-id="symmetric-with-key-distribution-center-kdc">Symmetric with Key Distribution Center (KDC)</h3>
<section id="symmetric-needham-schroeder" class="level4">
<h4 class="anchored" data-anchor-id="symmetric-needham-schroeder">Symmetric Needham-Schroeder</h4>
<p>Protocol with <strong>Key Distribution Center (KDC)</strong>.</p>
<p><strong>Initialization:</strong> A shares <span class="math inline">\(K_{AT}\)</span> with T (KDC), B shares <span class="math inline">\(K_{BT}\)</span> with T.</p>
<p><strong>Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow T: A, B, r_a\)</span></li>
<li><span class="math inline">\(A \leftarrow T: E_{K_{AT}}(r_a, B, k_{AB}, E_{K_{BT}}(k_{AB}, A))\)</span></li>
<li><span class="math inline">\(A \rightarrow B: E_{K_{BT}}(k_{AB}, A)\)</span></li>
<li><span class="math inline">\(A \leftarrow B: E_{k_{AB}}(r_b)\)</span></li>
<li><span class="math inline">\(A \rightarrow B: E_{k_{AB}}(r_b - 1)\)</span></li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li>✅ Entity authentication of A to B</li>
<li>❌ Entity authentication of B to A (A never saw <span class="math inline">\(r_b\)</span>)</li>
<li>✅ Implicit key authentication</li>
<li>❌ Key confirmation (only B knows A possesses the key)</li>
<li>❌ Perfect Forward Secrecy</li>
</ul>
<p><strong>Vulnerabilities:</strong></p>
<ul>
<li><strong>Replay attacks:</strong> A can replay (3) without B’s control.</li>
<li><strong>Known-key attack:</strong> If an old key <span class="math inline">\(k\)</span> is compromised, an adversary can make B accept it.</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li><p><strong>Key confirmation and mutual entity authentication:</strong></p>
<p>Replace 3. and 4. with:</p>
<ol start="3" type="1">
<li><span class="math inline">\(A \rightarrow B: E_{k_{AB}}(r_a'), E_{K_{BT}}(k_{AB}, A)\)</span></li>
<li><span class="math inline">\(A \leftarrow B: E_{k_{AB}}(r_a' - 1, r_b)\)</span></li>
</ol></li>
<li><p><strong>Exchange freshness:</strong></p>
<p>Add timestamp in 3.: <span class="math inline">\(E_{K_{BT}}(k_{AB}, A, t)\)</span></p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-225-contents" aria-controls="callout-225" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-225" class="callout-225-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric KTP with Key Distribution Center – Symmetric Needham-Schroeder</strong></p>
<p>(Notation): Let T be the <strong>Key Distribution Center</strong>.</p>
<p>(Init.): A and T share the symmetric key <span class="math inline">\(K_{AT}\)</span>. B and T share <span class="math inline">\(K_{BT}\)</span>.</p>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow T: A, B, r_a\)</span>; A generates a random number <span class="math inline">\(r_a\)</span> and sends it to T with the identities.</p></li>
<li><p><span class="math inline">\(A \leftarrow T: E_{K_{AT}}(r_a, B, k_{AB}, E_{K_{BT}}(k_{AB}, A))\)</span>; T generates <span class="math inline">\(k_{AB}\)</span> and sends it encrypted.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: E_{K_{BT}}(k_{AB}, A)\)</span>; A forwards the packet to B.</p></li>
<li><p><span class="math inline">\(A \leftarrow B: E_{k_{AB}}(r_b)\)</span>; Confirmation from B using <span class="math inline">\(k_{AB}\)</span> and a random number <span class="math inline">\(r_b\)</span>.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: E_{k_{AB}}(r_b - 1)\)</span>; Confirmation from A.</p></li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li><strong>Entity Authentication:</strong>
<ul>
<li>A to B: YES.</li>
<li>B to A: NO: A never saw <span class="math inline">\(r_b\)</span> (it could be <span class="math inline">\(E_{k'}(r_b')\)</span>).</li>
</ul></li>
<li><strong>Implicit Key Authentication:</strong> YES (keys are always protected by <span class="math inline">\(K_{AT}\)</span> and <span class="math inline">\(K_{BT}\)</span>). However, in case of a known-key attack, this no longer holds for B.</li>
<li><strong>Key Confirmation:</strong> Only B is assured that A possesses the key due to the flaw described in entity authentication.</li>
<li><strong>Perfect Forward Secrecy:</strong> NO. If either <span class="math inline">\(K_{AT}\)</span> or <span class="math inline">\(K_{BT}\)</span> is compromised, session keys <span class="math inline">\(k\)</span> immediately become visible.</li>
</ul>
<p><strong>Solution to achieve key confirmation and mutual entity authentication:</strong></p>
<p>Replace (3) and (4) with:</p>
<p>(3’) <span class="math inline">\(A \rightarrow B: E_{k_{AB}}(r_a'), E_{K_{BT}}(k_{AB}, A)\)</span></p>
<p>(4’) <span class="math inline">\(A \leftarrow B: E_{k_{AB}}(r_a' - 1, r_b)\)</span></p>
<p>Provided the <span class="math inline">\(r_i\)</span> are carefully controlled by the participants.</p>
<p>However: Beware of <strong>reflection attacks</strong>!</p>
<p><strong>Problem:</strong> A can replay (3) as many times as desired, without any control from B. This problem worsens if an old key <span class="math inline">\(k\)</span> is compromised:</p>
<p><strong>Vulnerable to known-key attack:</strong> If a previously used session key <span class="math inline">\(k\)</span> is obtained by an adversary C, it can easily make B accept it by replaying (3) and computing the challenge sent by B in (5). In this case, the properties of entity authentication, implicit key authentication, and key confirmation of A to B are also compromised.</p>
<p><strong>Solution:</strong> Add a <strong>timestamp</strong> in (3) attesting to the freshness of the exchanges:</p>
<p>(3’’) <span class="math inline">\(A \rightarrow B: E_{K_{BT}}(k_{AB}, A, t)\)</span> (this is the solution adopted by <strong>Kerberos</strong>).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-226-contents" aria-controls="callout-226" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-226" class="callout-226-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric Needham-Schroeder:</strong></p>
<ul>
<li>KDC generates and distributes <span class="math inline">\(k_{AB}\)</span></li>
<li>Vulnerable to replay and known-key attacks</li>
<li>Solution: Add timestamp</li>
<li>Basis for Kerberos</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="kerberos" class="level4">
<h4 class="anchored" data-anchor-id="kerberos">Kerberos</h4>
<p><strong>Authentication and key distribution protocol</strong> based on Needham-Schroeder with corrections.</p>
<p><strong>Architecture:</strong></p>
<ul>
<li><strong>Authentication Server (AS):</strong> Issues tickets for TGS.</li>
<li><strong>Ticket Granting Server (TGS):</strong> Issues tickets for services.</li>
<li><strong>Tickets:</strong> Encrypted structures containing session keys.</li>
</ul>
<p><strong>Simplified Protocol:</strong></p>
<p><strong>Phase 1: TGT (Ticket Granting Ticket) Request</strong></p>
<ol type="1">
<li><span class="math inline">\(A \rightarrow AS: A, TGS, r_a\)</span></li>
<li><span class="math inline">\(A \leftarrow AS: E_{K_A}(k_{AT}, r_a), Ticket_{AT} := E_{K_T}(A, TGS, t_1, t_2, k_{AT})\)</span></li>
</ol>
<p><strong>Phase 2: Ticket Request for Service B</strong></p>
<ol start="3" type="1">
<li><span class="math inline">\(A \rightarrow TGS: Authenticator_{AT} := E_{k_{AT}}(A, t), Ticket_{AT}, B, r_a'\)</span></li>
<li><span class="math inline">\(A \leftarrow TGS: E_{k_{AT}}(k_{AB}, r_a'), Ticket_{AB} := E_{K_B}(A, B, t_1, t_2, k_{AB})\)</span></li>
</ol>
<p><strong>Phase 3: Authentication with B</strong></p>
<ol start="5" type="1">
<li><span class="math inline">\(A \rightarrow B: Authenticator_{AB} := E_{k_{AB}}(A, t), Ticket_{AB}, r_a'', [request]\)</span></li>
<li><span class="math inline">\(A \leftarrow B: E_{k_{AB}}(r_a''), [response]\)</span></li>
</ol>
<p><strong>Properties:</strong></p>
<ul>
<li>✅ Entity authentication (all entities)</li>
<li>✅ Implicit key authentication</li>
<li>⚠️ Partial key confirmation (not between A and AS)</li>
<li>❌ Perfect Forward Secrecy</li>
</ul>
<p><strong>Vulnerabilities:</strong></p>
<ul>
<li><strong>Password guessing attacks</strong> on <span class="math inline">\(E_{K_A}(k_{AT}, r_a)\)</span> (Solution: pre-authentication)</li>
<li><strong>Replay attacks</strong> if <span class="math inline">\(r_a\)</span> is poorly controlled</li>
<li>Requires clock synchronization</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-227-contents" aria-controls="callout-227" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-227" class="callout-227-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Symmetric KTP with Key Distribution Center – Kerberos</strong></p>
<p>Kerberos is a protocol for <strong>entity authentication</strong> and <strong>key distribution</strong> within a user network.</p>
<p>Originally, Kerberos was designed as a replacement solution to address security issues (weak authentication, cleartext transactions, etc.) inherent to UNIX environments.</p>
<p>Kerberos was created at MIT as part of the ATHENA project.</p>
<p>The first three versions were unstable. <strong>Version 4</strong> achieved considerable success in both industrial and academic environments and remains predominant. <strong>Version 5</strong>, although safer and better structured, is more complex and less performant, which has slowed its deployment.</p>
<p>Kerberos also defines a mode of collaboration between domains belonging to distinct administrative authorities (the <strong>realms</strong>). This allows users from one domain to use resources from another domain “without leaving” the secure Kerberos environment.</p>
<p>For inter-realm transactions, symmetric cryptography constitutes a significant obstacle as it requires confidential channels for key pre-distribution.</p>
<p><strong>Kerberos Version 5</strong></p>
<p>(Notation): - A and B want to establish a secure transaction; in the Kerberos environment, this typically involves a <strong>client</strong> and a <strong>server</strong> providing services. - The Kerberos KDC is subdivided into two functional entities: the <strong>Authentication Server (AS)</strong> and the <strong>Ticket Granting Server (TGS)</strong>. Both access the password database. - The <span class="math inline">\(r_a^{(n)}\)</span> are random numbers, <span class="math inline">\(t\)</span> is a timestamp, <span class="math inline">\(t_1\)</span> and <span class="math inline">\(t_2\)</span> indicate a validity time window.</p>
<p>(Initialization): A and B share a secret key with AS, namely: <span class="math inline">\(K_A\)</span> and <span class="math inline">\(K_B\)</span> (for clients, this is a OWF of the password). TGS also has a secret key <span class="math inline">\(K_T\)</span>.</p>
<ol type="1">
<li><p><span class="math inline">\(A \rightarrow AS: A, TGS, r_a\)</span></p></li>
<li><p><span class="math inline">\(A \leftarrow AS: E_{K_A}(k_{AT}, r_a), Ticket_{AT} := E_{K_T}(A, TGS, t_1, t_2, k_{AT})\)</span>; AS generates <span class="math inline">\(k_{AT}\)</span>.</p></li>
<li><p><span class="math inline">\(A \rightarrow TGS: Authenticator_{AT} := E_{k_{AT}}(A, t), Ticket_{AT}, B, r_a'\)</span></p></li>
<li><p><span class="math inline">\(A \leftarrow TGS: E_{k_{AT}}(k_{AB}, r_a'), Ticket_{AB} := E_{K_B}(A, B, t_1, t_2, k_{AB})\)</span>; TGS generates <span class="math inline">\(k_{AB}\)</span>.</p></li>
<li><p><span class="math inline">\(A \rightarrow B: Authenticator_{AB} := E_{k_{AB}}(A, t), Ticket_{AB}, r_a'', [request]\)</span></p></li>
<li><p><span class="math inline">\(A \leftarrow B: E_{k_{AB}}(r_a''), [response]\)</span>; [request] and [response] optionally encrypted with <span class="math inline">\(k_{AB}\)</span>.</p></li>
<li><ul>
<li>(2): TGT request.</li>
</ul></li>
<li><ul>
<li>(4): Ticket request for B.</li>
</ul></li>
<li><ul>
<li>(6): Authentication and key establishment between A and B.</li>
</ul></li>
</ol>
<p><strong>Kerberos Characteristics</strong></p>
<p><strong>Properties:</strong></p>
<ul>
<li><strong>Entity Authentication:</strong> YES, for all involved entities.</li>
<li><strong>Implicit Key Authentication:</strong> YES: All generated keys are protected by keys shared between the AS and all participants.</li>
<li><strong>Key Confirmation:</strong>
<ul>
<li>Between A and AS: NO: AS has no proof that A possesses the key <span class="math inline">\(K_A\)</span>.</li>
<li>Between A and TGS: YES for <span class="math inline">\(k_{AT}\)</span> (redundant quantities encrypted with <span class="math inline">\(k_{AT}\)</span> are exchanged between A and TGS); NO for <span class="math inline">\(k_{AB}\)</span> (TGS has no proof from A).</li>
<li>Between A and B: YES: Exchange of redundant quantities encrypted with <span class="math inline">\(k_{AB}\)</span>.</li>
</ul></li>
<li><strong>Perfect Forward Secrecy:</strong> NO: All keys are explicitly transferred.</li>
</ul>
<p><strong>Problems:</strong></p>
<ul>
<li><p>Initial keys (like <span class="math inline">\(K_A\)</span>) depend (directly) on user-chosen passwords. This makes the protocol vulnerable to password theft or:</p>
<ul>
<li><strong>Password guessing attacks:</strong> <span class="math inline">\(E_{K_A}(k_{AT}, r_a)\)</span> in (2) helps crack A’s password. <strong>Solution:</strong> Pre-authentication in (1): <span class="math inline">\(E_{K_A}(t)\)</span> with <span class="math inline">\(t =\)</span> timestamp (optional in v5).</li>
</ul></li>
<li><p>The ticket validity window can lead to <strong>replay attacks</strong> if the <span class="math inline">\(r_a^{(n)}\)</span> are not properly controlled by the participants.</p></li>
<li><p><strong>Clock synchronization</strong> is necessary! This is not always easy in heterogeneous environments.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-228-contents" aria-controls="callout-228" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-228" class="callout-228-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Kerberos:</strong></p>
<ul>
<li>AS issues TGT, TGS issues service tickets</li>
<li>Tickets contain session keys</li>
<li>Authentication via authenticators</li>
<li>Vulnerable: password guessing, replay</li>
<li>Solution: pre-authentication, timestamps</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="ssltls" class="level2">
<h2 class="anchored" data-anchor-id="ssltls">SSL/TLS</h2>
<p>SSL/TLS: Secure Socket Layer / Transport Layer Security</p>
<p>Protocol for securing communications between the transport (TCP) and application layers.</p>
<p><strong>Provided Services:</strong></p>
<ul>
<li>Confidentiality, integrity, flow authentication</li>
<li>Server identification (client optional)</li>
</ul>
<p><strong>Algorithms Used:</strong></p>
<ul>
<li><strong>Public-key cryptography</strong> (RSA, DH, DSA): Key exchange</li>
<li><strong>MACs:</strong> Flow authentication</li>
<li><strong>Symmetric cryptography</strong> (DES, AES, IDEA): Flow encryption</li>
</ul>
<p><strong>Properties:</strong></p>
<ul>
<li>✅ Entity authentication (server + optional client via certificates)</li>
<li>✅ Implicit key authentication</li>
<li>✅ Key confirmation</li>
<li>⚠️ Perfect Forward Secrecy: Depends on the exchange protocol (DH → yes, RSA → no)</li>
</ul>
<p><strong>Remarks:</strong></p>
<ul>
<li>TLS keys are derived by hashing from random values and the <em>pre_master_secret</em>.</li>
<li>SSL/TLS is the de facto standard for web security (HTTPS).</li>
<li>Trust relies on root certificates embedded in browsers.</li>
<li>Major vulnerabilities stem from randomness, implementations, and hash functions.</li>
<li>Notable attacks: renegotiation (2009), Heartbleed (2014).</li>
</ul>
<section id="ssltls-architecture" class="level3">
<h3 class="anchored" data-anchor-id="ssltls-architecture">SSL/TLS Architecture</h3>
<p><strong>Three Components:</strong></p>
<ol type="1">
<li><strong>SSL Record Protocol:</strong> Encapsulation above TCP (fragmentation + compression + encryption)</li>
<li><strong>SSL Handshake Protocol:</strong> Authentication + parameter negotiation</li>
<li><strong>SSL State Machine:</strong> Session and connection state variables</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-229-contents" aria-controls="callout-229" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-229" class="callout-229-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Secure Socket Layer (SSL) / Transport Level Security (TLS)</strong></p>
<p>Located between the transport layer (TCP) and application layer protocols (not only HTTP but also SMTP, FTP, etc.!).</p>
<p>It is a <strong>meta key establishment protocol</strong> highly configurable, allowing many modes of operation and negotiation options.</p>
<p>Provides <strong>confidentiality</strong>, <strong>integrity</strong>, <strong>data flow authentication</strong>, and <strong>server identification</strong> (and optionally client identification) services.</p>
<p><strong>Uses the following algorithm families:</strong></p>
<ul>
<li><strong>Public-key cryptography</strong> (RSA, Diffie-Hellman, DSA, etc.) for symmetric key exchange.</li>
<li><strong>MACs</strong> for data flow authentication.</li>
<li><strong>Symmetric cryptography</strong> (DES, IDEA, AES, etc.) for data flow encryption.</li>
</ul>
<p>The use of <strong>CAs</strong> to certify the association between entities and public keys is strongly recommended… but not mandatory!</p>
<p><strong>Properties:</strong> - <strong>Entity authentication</strong> via certificates (server and optionally client). - <strong>Implicit Key Authentication</strong> and <strong>Key Confirmation</strong> are guaranteed. - <strong>Perfect Forward Secrecy</strong> depends on the protocol chosen for key exchange.</p>
<p><strong>SSL/TLS Overview</strong></p>
<p>SSL is a “mini-stack” of protocols with functionalities from the session, presentation, and application layers.</p>
<p>SSL consists of three fundamental blocks:</p>
<ul>
<li><strong>SSL record protocol</strong> allowing encapsulation of higher-level protocols above TCP (fragmentation + compression + encryption).</li>
<li><strong>SSL handshake protocol</strong> responsible for participant authentication and encryption parameter negotiation.</li>
<li><strong>SSL state machine</strong>. Unlike HTTP, SSL is a <strong>stateful</strong> protocol; it therefore requires a set of variables determining the state of a session and a connection.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="ssl-handshake-protocol" class="level3">
<h3 class="anchored" data-anchor-id="ssl-handshake-protocol">SSL Handshake Protocol</h3>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Diagram">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-230-contents" aria-controls="callout-230" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Diagram
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-230" class="callout-230-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Phase 1: Hello</strong></p>
<ul>
<li><strong>Client Hello:</strong> Version, random, session ID, accepted algorithms</li>
<li><strong>Server Hello:</strong> Version, random, session ID, selected algorithms</li>
<li><strong>Server Certificate</strong> (optional): Server certificate + CA path</li>
<li><strong>Server Key Exchange</strong> (optional): Server public key information</li>
<li><strong>Certificate Request</strong> (optional): Client certificate request</li>
</ul>
<p><strong>Phase 2: Client Authentication and Key Exchange</strong></p>
<ul>
<li><strong>Client Certificate</strong> (optional): Client certificate + CA path</li>
<li><strong>Client Key Exchange:</strong> Generates <code>pre_master_secret</code>, sends encrypted with server’s public key</li>
<li><strong>Certificate Verify</strong> (optional): Explicit client certificate verification</li>
</ul>
<p><strong>Phase 3: Finalization</strong></p>
<ul>
<li><strong>Finish</strong> (client): First message protected with negotiated parameters</li>
<li><strong>Finish</strong> (server): Same for the server</li>
</ul>
<p><strong>Phase 4: Application</strong></p>
<ul>
<li>Data protected with derived keys</li>
</ul>
</div>
</div>
</div>
</section>
<section id="ssltls-key-generation" class="level3">
<h3 class="anchored" data-anchor-id="ssltls-key-generation">SSL/TLS Key Generation</h3>
<p><strong>Cascading Derivation:</strong></p>
<p><span class="math display">\[master\_secret = MD5(pre\_master\_secret + SHA('A' + pre\_master\_secret + ClientRandom + ServerRandom))\]</span> <span class="math display">\[+ MD5(pre\_master\_secret + SHA('BB' + ...)) + ...\]</span></p>
<p><span class="math display">\[key\_block = MD5(master\_secret + SHA('A' + master\_secret + ServerRandom + ClientRandom)) + ...\]</span></p>
<p><strong>Partition of the key_block:</strong></p>
<ul>
<li><code>client_write_MAC_secret[hash_size]</code></li>
<li><code>server_write_MAC_secret[hash_size]</code></li>
<li><code>client_write_key[key_material]</code></li>
<li><code>server_write_key[key_material]</code></li>
<li><code>client_write_IV[IV_size]</code></li>
<li><code>server_write_IV[IV_size]</code></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-231-contents" aria-controls="callout-231" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-231" class="callout-231-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Simplified SSL/TLS Handshake Protocol</strong></p>
<p>[Handshake diagram with 4 phases: Hello, Key Exchange, Finish, Application Data]</p>
<p><strong>SSL/TLS: Key Generation</strong></p>
<pre><code>master_secret =
 MD5(pre_master_secret + SHA('A' + pre_master_secret +
 ClientHello.random + ServerHello.random)) +
 MD5(pre_master_secret + SHA('BB' + pre_master_secret +
 ClientHello.random + ServerHello.random)) +
 MD5(pre_master_secret + SHA('CCC' + pre_master_secret +
 ClientHello.random + ServerHello.random));

key_block =
 MD5(master_secret + SHA('A' + master_secret +
 ServerHello.random +
 ClientHello.random)) +
 MD5(master_secret + SHA('BB' + master_secret +
 ServerHello.random +
 ClientHello.random)) +
 MD5(master_secret + SHA('CCC' + master_secret +
 ServerHello.random +
 ClientHello.random)) + [...];

 until enough output has been generated. Then the key_block is
 partitioned as follows:

 client_write_MAC_secret[CipherSpec.hash_size]
 server_write_MAC_secret[CipherSpec.hash_size]
 client_write_key[CipherSpec.key_material]
 server_write_key[CipherSpec.key_material]
 client_write_IV[CipherSpec.IV_size] /* non-export ciphers */
 server_write_IV[CipherSpec.IV_size] /* non-export ciphers */</code></pre>
<p><strong>SSL/TLS: Final Remarks</strong></p>
<ul>
<li><p>Secret keys are the result of applying hash functions (MD5, SHA) to the random numbers from the Hello records and the <code>pre_master_secret</code>.</p></li>
<li><p>TLS/SSL has become the <strong>de facto standard</strong> for web security (the basis of <strong>https</strong>).</p></li>
<li><p>SSL clients (Explorer, Firefox, Opera, Chrome, etc.) contain “hard-coded” certificates corresponding to a few root certification authorities (Verisign, Thawte, Microsoft, RSA, etc.) allowing verification of certificates presented by some servers, but SSL is designed to rely on a <strong>global certification network</strong> that currently does not exist.</p></li>
<li><p>The most common <strong>security flaws</strong> in SSL concern key randomness generation as well as the most common implementation defects: buffer overflows, SQL injection, etc. The weakness of hash functions (MD5, SHA) is also a risk factor.</p></li>
<li><p>In November 2009, an attack was discovered allowing a Man-in-the-Middle to inject content (chosen plaintext) into an authentic flow following a <strong>renegotiation</strong> of parameters provided for in the protocol. This is a flaw in the protocol that required a patch in all implementations.</p></li>
<li><p>The <strong>Heartbleed</strong> vulnerability based on a buffer overflow seriously disrupted the Internet community upon its discovery in April 2014.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-232-contents" aria-controls="callout-232" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-232" class="callout-232-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>SSL/TLS:</strong></p>
<ul>
<li>Meta-protocol between TCP and application</li>
<li>Handshake: negotiation + authentication</li>
<li>Keys derived: <code>master_secret</code> → <code>key_block</code></li>
<li>HTTPS standard</li>
<li>Flaws: randomness, Heartbleed, renegotiation</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="final-remarks-on-keps" class="level2">
<h2 class="anchored" data-anchor-id="final-remarks-on-keps">Final Remarks on KEPs</h2>
<p><strong>Before choosing a KEP:</strong></p>
<ol type="1">
<li><strong>Define objectives:</strong> Confidentiality, authentication, non-repudiation.</li>
<li><strong>Define security level:</strong> Key confirmation, PFS, future secrecy.</li>
<li><strong>Establish constraints:</strong> Users, machines, network, attackers.</li>
</ol>
<p><strong>Best Practices:</strong></p>
<ul>
<li>✅ Choose a proven and robust solution.</li>
<li>❌ Avoid inventing “from scratch.”</li>
<li>✅ Verify that properties are satisfied.</li>
</ul>
<p><strong>Protocol Verification:</strong></p>
<p>Two complementary approaches:</p>
<ul>
<li><strong>Practical Analysis:</strong> “On paper” and “on machine”
<ul>
<li>Control random numbers (reflection attacks)</li>
<li>Redundancy of encrypted/signed quantities</li>
<li>Classic pitfalls</li>
</ul></li>
<li><strong>Formal Analysis:</strong> Dedicated logics (BAN logic, etc.)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-233-contents" aria-controls="callout-233" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-233" class="callout-233-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Key Establishment Protocols: Final Remarks</strong></p>
<p>Key establishment protocols are a <strong>cornerstone</strong> of any security solution. Before choosing (designing) a KEP, it is therefore essential to:</p>
<ul>
<li><strong>Define the objectives</strong> (confidentiality, entity/data authentication, non-repudiation, etc.).</li>
<li><strong>Define the desired security level</strong> based on the studied properties (key confirmation, perfect forward secrecy, etc.).</li>
<li><strong>Establish a list of constraints</strong> related to the environment (users, machines, network, potential attackers, etc.).</li>
</ul>
<p>Based on these criteria, we can:</p>
<ul>
<li><strong>Choose a proven and robust solution</strong> (better than inventing one from scratch!).</li>
<li><strong>Verify that the objectives are met</strong> and the properties satisfied.</li>
</ul>
<p><strong>Protocol verification</strong> is a complex and delicate process; moreover, published solutions are not always correct. Two approaches are possible (and necessary):</p>
<ul>
<li><p><strong>Practical analysis.</strong> Analyze protocol flaws “on paper” and “on machine,” considering classic pitfalls: control of random numbers to avoid reflection attacks, redundancy of encrypted/signed quantities, etc.</p></li>
<li><p><strong>Formal analysis</strong> with logics specifically designed for this purpose (such as <strong>BAN logic</strong>).</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-234-contents" aria-controls="callout-234" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-234" class="callout-234-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>KEP – Best Practices:</strong></p>
<ol type="1">
<li>Define objectives and constraints</li>
<li>Choose a proven solution</li>
<li>Verify properties (practical + formal)</li>
<li>Avoid pitfalls: reflection, redundancy, randomness control</li>
</ol>
</div>
</div>
</div>
<p>Here is the <strong>exact English translation</strong> of your <em>Trusted Third Parties and Certification</em> document, preserving all content, structure, technical terms, and formatting:</p>
<hr>
</section>
</section>
<section id="trusted-third-parties-ttp-and-certification" class="level1">
<h1>Trusted Third Parties (TTP) and Certification</h1>
<section id="ttp" class="level2">
<h2 class="anchored" data-anchor-id="ttp">TTP</h2>
<section id="ttp-operating-modes" class="level3">
<h3 class="anchored" data-anchor-id="ttp-operating-modes">TTP Operating Modes</h3>
<p><strong>Three Operational Modes:</strong></p>
<ul>
<li><strong>In-line:</strong> TTP acts as an intermediary, relaying all exchanges in real time (e.g., Proxies, Secure Gateways).</li>
<li><strong>On-line:</strong> TTP participates in real time, but A and B communicate directly (e.g., KDC).</li>
<li><strong>Off-line:</strong> TTP does not participate in real-time exchanges but makes information available <em>a priori</em> (e.g., CA).</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[A] --&gt;|in-line| TTP[TTP]
    TTP --&gt;|in-line| B[B]

    A2[A] ---|on-line| TTP2[TTP on-line]
    A2 &lt;--&gt;|direct| B2[B]

    A3[A] -.-&gt;|prior exchange| TTP3[TTP off-line]
    B3[B] -.-&gt;|prior exchange| TTP3
    A3 &lt;--&gt;|direct| B3
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Comparison:</strong></p>
<ul>
<li><strong>Off-line:</strong> Facilitates exchanges, no need for permanent availability.</li>
<li><strong>In-line/On-line:</strong> Requires permanent availability.</li>
<li><strong>Off-line:</strong> Revocation of privileges is more complex.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-235-contents" aria-controls="callout-235" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-235" class="callout-235-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>TTP: Operating Modes</strong></p>
<ul>
<li><p><strong>In-line:</strong> The TTP acts as an <strong>intermediary</strong> to relay exchanges between A and B in real time. Examples: Proxies, Secure Gateways.</p></li>
<li><p><strong>On-line:</strong> The TTP <strong>participates in real time</strong> in exchanges between A and B, but A and B communicate directly (without passing through the TTP). Example: Key Distribution Center.</p></li>
<li><p><strong>Off-line:</strong> The TTP <strong>does not participate</strong> in real-time exchanges but makes information available <strong>a priori</strong>. Example: Certification Authorities.</p></li>
</ul>
<p><strong>Comparison In-line/On-line/Off-line:</strong> Exchanges are facilitated, and there is no need for permanent TTP availability in off-line mode (unlike the other two), but <strong>privilege revocation</strong> (e.g., when a secret key is compromised) is more complex.</p>
<p>[Diagrams showing the three modes]</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-236-contents" aria-controls="callout-236" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-236" class="callout-236-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>TTP Modes:</strong></p>
<ul>
<li><strong>In-line:</strong> Intermediary relay</li>
<li><strong>On-line:</strong> Real-time participation</li>
<li><strong>Off-line:</strong> Information available <em>a priori</em> (e.g., CA)</li>
<li>Off-line: No availability required but revocation complex</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="key-distribution-centers-kdcs" class="level3">
<h3 class="anchored" data-anchor-id="key-distribution-centers-kdcs">Key Distribution Centers (KDCs)</h3>
<p><strong>Objective:</strong> Solve the <span class="math inline">\(n^2\)</span> key distribution problem.</p>
<p><strong>Principle:</strong></p>
<ul>
<li>Without KDC: <span class="math inline">\(\frac{n(n-1)}{2} \approx n^2\)</span> keys for <span class="math inline">\(n\)</span> entities.</li>
<li>With KDC: Only <span class="math inline">\(n\)</span> keys (each entity shares a key with the KDC).</li>
<li>Session keys dynamically generated by the KDC.</li>
</ul>
<p><strong>Advantages:</strong></p>
<ul>
<li>Scalability: A new entity = only one new key.</li>
<li>Secure channel establishment via tickets (as in Kerberos).</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><strong>Single point of security failure:</strong> KDC compromise → entire system vulnerable.</li>
<li><strong>Single point of operational failure:</strong> KDC unavailability (DoS) → system paralysis.</li>
<li><strong>Performance bottleneck:</strong> Costly operations (encryption, random generation).</li>
</ul>
<p><strong>Solutions:</strong> Mirroring, load balancing.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-237-contents" aria-controls="callout-237" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-237" class="callout-237-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>TTP: Key Distribution Centers (KDCs)</strong></p>
<p><strong>Goal:</strong> Solve the <strong><span class="math inline">\(n^2\)</span> key distribution problem</strong>:</p>
<ul>
<li><p>In a symmetric environment with <span class="math inline">\(n\)</span> entities without an intermediary: <span class="math inline">\(n(n-1)/2 \sim n^2\)</span> different keys are needed for all pairs of entities to share a different key.</p></li>
<li><p>Moreover, such a system is not <strong>scalable</strong> because adding an entity results in the generation of <span class="math inline">\(n\)</span> new keys.</p></li>
</ul>
<p>If each entity shares a key with a KDC, only <strong><span class="math inline">\(n\)</span> keys</strong> are needed for the system to function, and one key suffices for each new entity. The establishment of secure channels is ensured by the generation of session keys and the presence of tickets as in Kerberos.</p>
<p><strong>Problems:</strong></p>
<ul>
<li><p><strong>Single point of security failure:</strong> By construction, the KDC can impersonate all nodes in the network. If it is compromised, the entire system becomes vulnerable.</p></li>
<li><p><strong>Single point of operational failure:</strong> The usual mode of operation of a KDC is on-line (possibly in-line). If it becomes unavailable (e.g., due to a denial-of-service attack), the entire system is paralyzed.</p></li>
<li><p><strong>Performance bottleneck:</strong> KDC operations are often computationally expensive (encryption/decryption, random generation, etc.). Classic solutions (e.g., mirroring) must be considered to distribute the KDC load.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-238-contents" aria-controls="callout-238" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-238" class="callout-238-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>KDC:</strong></p>
<ul>
<li>Solves <span class="math inline">\(n^2\)</span> problem → <span class="math inline">\(n\)</span> keys</li>
<li>Scalable: +1 entity = +1 key</li>
<li>Risks: Single point of failure (security + operational), bottleneck</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="certification-authorities-cas" class="level3">
<h3 class="anchored" data-anchor-id="certification-authorities-cas">Certification Authorities (CAs)</h3>
<p><strong>Role:</strong> Authenticate the association between an <strong>entity</strong> and its <strong>public key</strong>.</p>
<p><strong>Operation:</strong></p>
<ol type="1">
<li>CA verifies identity (passport, etc.).</li>
<li>CA creates and signs a <strong>certificate</strong> containing this association.</li>
<li>Certificates are accessible to entities (may be cached).</li>
</ol>
<p><strong>Verification:</strong> Requires an authentic copy of the CA’s public key.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>Off-line mode:</strong> Short unavailability is acceptable.</li>
<li>Simpler then safer: No complex protocols needed.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><strong>Asynchronous revocation:</strong> Certificate may become invalid (private key theft).</li>
<li><strong>Solution:</strong> Signed Certificate Revocation Lists (CRLs).</li>
</ul>
<p><strong>CA Compromise:</strong></p>
<p>Serious consequences if the private signing key is compromised.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-239-contents" aria-controls="callout-239" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-239" class="callout-239-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>TTP: Certification Authorities (CAs)</strong></p>
<p>The primary role of a <strong>Certification Authority (CA)</strong> is to <strong>authenticate the association between an entity and its public key</strong> (think of Man-in-the-Middle attacks!).</p>
<p>The CA will <strong>create and sign certificates</strong> containing this association (using proof of identity such as a passport) and make them accessible to the relevant entities.</p>
<p>Once signed, copies of the certificates (<strong>cached certificates</strong>) can be stored in unprotected locations (e.g., on the user’s disk space). However, to verify the signature of the certificates, the relevant entities require an <strong>authentic copy of the CA’s public key</strong>.</p>
<p><strong>Simpler then safer:</strong> There is no need to implement complex protocols in a CA.</p>
<p>The usual mode of operation of a CA is <strong>off-line</strong>, which reduces the impact of short periods of unavailability.</p>
<p><strong>Problem associated with off-line mode:</strong> The validity of cached certificates may be questioned <strong>asynchronously</strong> due to a private key theft.</p>
<p><strong>Remedy:</strong> CAs also publish signed lists of invalid certificates (<strong>Certificate Revocation Lists</strong> or <strong>CRLs</strong>).</p>
<p>Compromising a CA has less obvious but almost as harmful consequences as compromising a KDC, especially if the private key used to sign certificates is also compromised.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-240-contents" aria-controls="callout-240" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-240" class="callout-240-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CA:</strong></p>
<ul>
<li>Authenticates entity ↔︎ public key association</li>
<li>Signs certificates (off-line mode)</li>
<li>CRLs for revocations</li>
<li>Compromise = serious consequences</li>
</ul>
</div>
</div>
</div>
<hr>
<section id="proof-of-possession-pop" class="level4">
<h4 class="anchored" data-anchor-id="proof-of-possession-pop">Proof of Possession (PoP)</h4>
<p><strong>Problem:</strong> Identity verification is not sufficient; possession of the private key must also be verified.</p>
<p><strong>Attack without PoP:</strong></p>
<ol type="1">
<li>A signs a document and sends it to B (notary): <span class="math inline">\(S_{priv_A}(\text{Invention}), S_{priv_{CA_A}}(Cert_A)\)</span>.</li>
<li>C intercepts and requests from <span class="math inline">\(CA_C\)</span> (without PoP) a certificate associating C with <span class="math inline">\(pub_A\)</span>.</li>
<li>C sends to B: <span class="math inline">\(S_{priv_A}(\text{Invention}), S_{priv_{CA_C}}(Cert_C)\)</span>.</li>
<li>C becomes the inventor!</li>
</ol>
<p><strong>Simple PoP Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(CA \rightarrow A: A, r\)</span> (random number + identity).</li>
<li><span class="math inline">\(CA \leftarrow A: S_{priv_A}(A, r)\)</span>.</li>
<li><span class="math inline">\(CA\)</span> verifies the signature with <span class="math inline">\(pub_A\)</span>.</li>
</ol>
<p><strong>Consequences:</strong></p>
<ul>
<li>Introduces <strong>trust levels</strong> for CAs.</li>
<li>Criteria: PoP, CRL updates, signing key security.</li>
<li>Problem exacerbated by uncontrolled CA proliferation.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-241-contents" aria-controls="callout-241" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-241" class="callout-241-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CA: Proof of Possession (PoP)</strong></p>
<p>Verifying the identity of A to create (or modify) a certificate associating A with its public key is not a sufficient criterion. It is also necessary to <strong>verify that A truly possesses the corresponding private key</strong>.</p>
<p>Let A and its CA be <span class="math inline">\(CA_A\)</span>. Let’s see what an active attacker C can do in “collaboration” with a <span class="math inline">\(CA_C\)</span> that does not verify PoP:</p>
<p>A signs a document containing the description of a revolutionary invention and sends it to B (the notary) with its certificate signed by <span class="math inline">\(CA_A\)</span>:</p>
<p><span class="math inline">\(A \rightarrow B: S_{priv_A}(\text{Invention}), S_{priv_{CA_A}}(Cert_A)\)</span></p>
<p>C intercepts this packet, approaches <span class="math inline">\(CA_C\)</span>, and asks it to create a certificate associating its identity C with A’s public key, and sends to B:</p>
<p><span class="math inline">\(C \rightarrow B: S_{priv_A}(\text{Invention}), S_{priv_{CA_C}}(Cert_C)\)</span></p>
<p>C thus becomes the revolutionary inventor…</p>
<p><strong>Simple PoP Verification Protocol:</strong></p>
<p><span class="math inline">\(CA \rightarrow A: A, r\)</span>; <span class="math inline">\(r\)</span>: random number, A to protect A from chosen message attacks.</p>
<p><span class="math inline">\(CA \leftarrow A: S_{priv_A}(A, r)\)</span>; CA only needs to verify the signature with <span class="math inline">\(pub_A\)</span>.</p>
<p>This criterion and other behavioral criteria, such as CRL updates or the security of the signing key, introduce <strong>trust levels</strong> for CAs and for the certificates they sign.</p>
<p>This phenomenon is exacerbated by the <strong>uncontrolled proliferation of CAs</strong>!</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-242-contents" aria-controls="callout-242" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-242" class="callout-242-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PoP (Proof of Possession):</strong></p>
<ul>
<li>Verify possession of private key (not just identity)</li>
<li>Without PoP: Attacker can impersonate identity</li>
<li>Protocol: CA verifies signature on challenge</li>
<li>Introduces trust levels for CAs</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="separation-of-certification-and-revocation" class="level4">
<h4 class="anchored" data-anchor-id="separation-of-certification-and-revocation">Separation of Certification and Revocation</h4>
<p><strong>Problem:</strong> If the same key signs certificates and CRLs, an adversary possessing the CA’s private key can:</p>
<ol type="1">
<li>Publish a CRL revoking victim A’s certificate.</li>
<li>Create a fake certificate associating A with a key controlled by the adversary.</li>
<li>Decrypt confidential transactions for A.</li>
<li>Impersonate A (signatures, authentication).</li>
</ol>
<p><strong>Solution: Separation of Duties</strong></p>
<p>Clear separation of tasks:</p>
<ul>
<li><strong>Certificates</strong> and <strong>CRLs</strong> signed with <strong>different keys</strong>.</li>
<li>By <strong>different functional entities</strong>:
<ul>
<li><strong>Certification Authority (CA)</strong></li>
<li><strong>Revocation Authority (RA)</strong></li>
</ul></li>
<li>Residing on <strong>different machines</strong>.</li>
<li>Subject to <strong>independent security policies</strong>.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-243-contents" aria-controls="callout-243" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-243" class="callout-243-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CA: Certification and Revocation</strong></p>
<p><strong>Problem:</strong> If the same key is used to sign certificates and CRLs, an adversary possessing the private signing key of a CA can attack a “victim” A under the authority of this CA as follows:</p>
<ul>
<li>Publish a CRL containing A’s revoked certificate.</li>
<li>Create a certificate associating A with a public key for which it controls the private key to then:
<ul>
<li>act as a Man-in-the-Middle to decrypt confidential transactions for A;</li>
<li>impersonate A for authenticated transactions or signed documents.</li>
</ul></li>
</ul>
<p><strong>Solution: Separation of duties:</strong> Certification and revocation become clearly differentiated tasks:</p>
<ul>
<li>Certificates and CRLs are signed with <strong>different keys</strong>,</li>
<li>by <strong>different functional entities</strong> (Certification Authority and Revocation Authority);</li>
<li>if possible, residing on <strong>different machines</strong> subject to <strong>independent security criteria (security policies)</strong>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-244-contents" aria-controls="callout-244" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-244" class="callout-244-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Separation of Duties:</strong></p>
<ul>
<li>Certificates ≠ CRLs (different keys)</li>
<li>CA ≠ Revocation Authority</li>
<li>Separate machines and policies</li>
<li>Prevents post-compromise attacks</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="functional-entities-related-to-certification" class="level3">
<h3 class="anchored" data-anchor-id="functional-entities-related-to-certification">Functional Entities Related to Certification</h3>
<p><strong>Name Server:</strong></p>
<ul>
<li>Manages a unique and consistent namespace.</li>
<li>Combined with certification if authentication is required.</li>
<li>Example: <strong>DNSSec</strong> (authenticated DNS for the Internet).</li>
</ul>
<p><strong>Registration Authority (RA):</strong></p>
<ul>
<li>Tasks requiring direct contact with entities.</li>
<li>Identity verification, PoP, certificate requests/modifications.</li>
<li>Detached from CA for geographical reasons.</li>
</ul>
<p><strong>Key Generator:</strong></p>
<ul>
<li>Generates public/private key pairs.</li>
<li><strong>Advantages:</strong> User simplicity, enhanced key security.</li>
<li><strong>Disadvantage:</strong> Private key known to another entity → loss of non-repudiation.</li>
</ul>
<p><strong>Certificate Directory:</strong></p>
<ul>
<li>Read-only access directory for certificates.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-245-contents" aria-controls="callout-245" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-245" class="callout-245-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Functional Entities Related to Certification</strong></p>
<ul>
<li><p><strong>Name Server:</strong> Responsible for managing a <strong>unique and consistent namespace</strong>. When authentication is required, name management must be complemented by the certification of public keys associated with these names.</p>
<p>Example of a pilot solution combining both concepts: <strong>DNSsec</strong>: authenticated name management environment for the Internet.</p></li>
<li><p><strong>Registration Authority:</strong> Entity responsible for performing tasks related to certificate management requiring <strong>direct contact</strong> with the relevant entities. These tasks include verifying the parameters necessary for the initial request or modification of certificates (identity verification, PoP, etc.). Detaching this functionality from the CA is typically due to geographical considerations.</p></li>
<li><p><strong>Key Generator:</strong> Allows delegation of the public/private key pair creation process to a dedicated entity:</p>
<ul>
<li><strong>Advantages:</strong> Simplicity for users; possibility to enhance the security of chosen pairs.</li>
<li><strong>Disadvantage:</strong> Private key known to another entity! Loss of non-repudiation.</li>
</ul></li>
<li><p><strong>Certificate Directory:</strong> The directory allowing users to access (read-only) the certificates of correspondents.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-246-contents" aria-controls="callout-246" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-246" class="callout-246-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certification Entities:</strong></p>
<ul>
<li><strong>Name Server:</strong> Names + DNSSec</li>
<li><strong>RA:</strong> Direct contact, verifications</li>
<li><strong>Key Generator:</strong> Key generation (⚠️ loses non-repudiation)</li>
<li><strong>Certificate Directory:</strong> Read-only certificate access</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="other-ttps" class="level3">
<h3 class="anchored" data-anchor-id="other-ttps">Other TTPs</h3>
<p><strong>Timestamp Agent (TA):</strong></p>
<ul>
<li>Certifies the existence of a document/transaction at a specific time.</li>
<li>Methods:
<ul>
<li>Associate a timestamp with the document (or <span class="math inline">\(h(\text{doc})\)</span>) + sign.</li>
<li>Use an authentication tree.</li>
</ul></li>
</ul>
<p><strong>Notary Agent:</strong></p>
<ul>
<li>Like TA but also: validity, origin, ownership.</li>
<li>Legal support for non-repudiation.</li>
</ul>
<p><strong>Key Escrow Agent (KEA):</strong></p>
<ul>
<li>Access to session secret keys under conditions (judicial warrant).</li>
<li>Requires a dedicated encryption system.</li>
</ul>
<p><strong>Example: Clipper/Capstone</strong></p>
<ul>
<li><strong>Clipper chip</strong> (1993): Symmetric encryption with KEA access.</li>
<li>Controversial, flaws discovered.</li>
<li><strong>Capstone chip:</strong> Successor (Fortezza PCMCIA card).</li>
<li>Military-level security.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-247-contents" aria-controls="callout-247" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-247" class="callout-247-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Other TTPs</strong></p>
<ul>
<li><p><strong>Timestamp agent (TA):</strong> Certifies the existence of a document or the occurrence of a transaction at a well-specified time. To do this, the TA can:</p>
<ul>
<li>associate a timestamp with the document (or with <span class="math inline">\(h(\text{doc})\)</span> where <span class="math inline">\(h\)</span> is a Collision Resistant Hash Function) and sign the whole with its private key, and</li>
<li>use an authentication tree (see page 231).</li>
</ul></li>
<li><p><strong>Notary agent:</strong> Certifies not only the existence of a document at a given time (like the TA) but also its <strong>validity, origin, or ownership</strong> by a given entity. This service provides (legally necessary?) support for non-repudiation.</p></li>
<li><p><strong>Key escrow agent (KEA):</strong> Entity authorized to access session secret keys provided certain conditions (e.g., a court order) are met. This requires a dedicated encryption system. Example: the Clipper key escrow system:</p>
<ul>
<li>Announced in April 1993 by the US administration, amid great controversy, as the large-scale communication encryption solution.</li>
<li>The <strong>Clipper chip</strong> is a symmetric encryption/decryption device that provides access to session keys when the secret keys of two KEAs (typically federal agencies) are input.</li>
<li>The presence of some flaws and the need for asymmetric cryptography led to its successor: the <strong>Capstone chip</strong>, which can be integrated into a PCMCIA card (called <strong>Fortezza</strong> and used for military-level security).</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-248-contents" aria-controls="callout-248" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-248" class="callout-248-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Other TTPs:</strong></p>
<ul>
<li><strong>TA:</strong> Timestamp document existence</li>
<li><strong>Notary:</strong> TA + validity/origin (non-repudiation)</li>
<li><strong>KEA:</strong> Access to keys under legal conditions</li>
<li>Example: Clipper/Fortezza (controversial)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="public-key-authentication" class="level2">
<h2 class="anchored" data-anchor-id="public-key-authentication">Public Key Authentication</h2>
<section id="certificates" class="level3">
<h3 class="anchored" data-anchor-id="certificates">Certificates</h3>
<p><strong>Definition:</strong> Information associating an entity with its public key.</p>
<p><strong>Generic Structure:</strong></p>
<ul>
<li><strong>Serial Number, Version</strong></li>
<li><strong>Issuer:</strong> Identity of the signing CA (global and unique).</li>
<li><strong>Signature Algorithm:</strong> Algorithm used to compute the signature (e.g., MD5+ElGamal, SHA+RSA).</li>
<li><strong>Subject:</strong> Name of the certified entity (global and unique).</li>
<li><strong>Subject Public Key:</strong> Public key.
<ul>
<li>RSA: <span class="math inline">\((n, e)\)</span></li>
<li>DH: <span class="math inline">\((p, \alpha, \alpha^x \mod p)\)</span></li>
</ul></li>
<li><strong>Subject Public Key Algorithm:</strong> RSA, DH, etc.</li>
<li><strong>Validity:</strong> Validity period (UTC).</li>
<li><strong>Signature:</strong> Covers all previous records, ensuring authenticity.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-249-contents" aria-controls="callout-249" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-249" class="callout-249-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Public Key Authenticity: Certificates</strong></p>
<p>A <strong>certificate</strong> is a piece of information associating an entity with its public key. Generically, it consists of the following elements:</p>
<ul>
<li><strong>Serial Number, Version</strong>.</li>
<li><strong>Issuer:</strong> The (global and unique) identity of the signing CA.</li>
<li><strong>Signature Algorithm:</strong> The algorithm used to compute the signature on the certificate. E.g.: MD5 + ElGamal or SHA + RSA.</li>
<li><strong>Subject:</strong> The (global and unique) name of the entity whose public key is certified.</li>
<li><strong>Subject Public Key:</strong> The entity’s public key. For example:
<ul>
<li><span class="math inline">\((n,e)\)</span>: modulus and public exponent for RSA.</li>
<li><span class="math inline">\((p, \alpha^x \mod p)\)</span>: modulus, generator, and public part for Diffie-Hellman.</li>
</ul></li>
<li><strong>Subject Public Key Algorithm:</strong> The algorithm associated with the public key. E.g.: RSA or Diffie-Hellman.</li>
<li><strong>Validity:</strong> The certificate’s validity period, typically expressed in UTC.</li>
<li><strong>Signature:</strong> Contains the signature computed using the Signature Algorithm and the CA’s private key. It covers all previous records and thus guarantees the authenticity of the information they contain.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-250-contents" aria-controls="callout-250" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-250" class="callout-250-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certificate:</strong></p>
<ul>
<li>Issuer (CA) + Subject (entity)</li>
<li>Public key + algorithm</li>
<li>Validity period</li>
<li>CA signature on all fields</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="certificate-revocation-lists-crls" class="level3">
<h3 class="anchored" data-anchor-id="certificate-revocation-lists-crls">Certificate Revocation Lists (CRLs)</h3>
<p><strong>Definition:</strong> Lists of certificates that have become invalid.</p>
<p><strong>Reasons for Revocation:</strong></p>
<ul>
<li>Private key compromised.</li>
<li>Algorithm modification.</li>
<li>Role change (role-based certificate).</li>
<li>Other factors invalidating certificate information.</li>
</ul>
<p><strong>CRL Structure:</strong></p>
<ul>
<li><strong>Issuer, Signature Algorithm</strong></li>
<li><strong>Date of Issue, Date of Next Issue</strong></li>
<li>For each revoked certificate:
<ul>
<li><strong>Serial Number</strong></li>
<li><strong>Revocation Date</strong></li>
</ul></li>
<li><strong>Signature:</strong> On the entire list.</li>
</ul>
<p><strong>Requirements:</strong></p>
<ul>
<li>CAs must publish CRLs <strong>frequently</strong>.</li>
<li><strong>Wide-audience</strong> distribution channels.</li>
<li>Minimize fraud risk.</li>
</ul>
<p><strong>Problem:</strong> Revocation is the Achilles’ heel of public key systems.</p>
<p><strong>Alternative Solutions:</strong></p>
<ul>
<li>Certificates with very short validity (a few minutes).</li>
<li>Periodic re-confirmation by CAs.</li>
<li>⚠️ Return to on-line mode → high availability required.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-251-contents" aria-controls="callout-251" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-251" class="callout-251-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certificate Revocation Lists (CRLs)</strong></p>
<p>These are lists containing certificates that have become <strong>invalid</strong> due to a compromised private key or any other factor affecting the validity of the information contained in a certificate (algorithm change, role change for a role-based certificate, etc.).</p>
<p>A generic CRL has the following elements:</p>
<ul>
<li><strong>Issuer, Signature Algorithm:</strong> As for certificates.</li>
<li><strong>Date of Issue, Date of Next Issue:</strong> Issue date and next issue date.</li>
<li>For each revoked certificate, the following records:
<ul>
<li><strong>Serial Number</strong> of the revoked certificate.</li>
<li><strong>Revocation Date</strong>.</li>
</ul></li>
<li><strong>Signature:</strong> Signature covering the entire list.</li>
</ul>
<p>A CA must publish CRLs with a <strong>very high frequency</strong> and use <strong>wide-audience</strong> distribution channels to reduce the risk of fraud.</p>
<p><strong>Revocation is the Achilles’ heel of any public key system…</strong></p>
<p>A solution: certificates with very short validity periods (a few minutes) requiring periodic re-confirmation by CAs…</p>
<p>…but this brings us back to on-line mode and thus requires high CA availability.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-252-contents" aria-controls="callout-252" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-252" class="callout-252-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CRLs:</strong></p>
<ul>
<li>Lists of invalid certificates (compromise, etc.)</li>
<li>Structure: issuer, dates, serial numbers, signature</li>
<li>Frequent publication required</li>
<li>Achilles’ heel of PKI</li>
<li>Alternative: short-lived certificates (→ on-line)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="authentication-trees" class="level3">
<h3 class="anchored" data-anchor-id="authentication-trees">Authentication Trees</h3>
<p><strong>Principle:</strong> Alternative to certification for authenticating public information.</p>
<p><strong>Construction:</strong> Tree (binary) with hash function + root authentication.</p>
<p>For <span class="math inline">\(n\)</span> values <span class="math inline">\(Y_1, Y_2, ..., Y_n\)</span>:</p>
<ol type="1">
<li>Values placed in leaves.</li>
<li>Edges from leaves labeled <span class="math inline">\(h(Y_i)\)</span>.</li>
<li>Non-terminal nodes labeled <span class="math inline">\(h(h_1 || h_2)\)</span> (|| = concatenation).</li>
<li>Root <span class="math inline">\(R\)</span> authenticated (digital signature).</li>
</ol>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    R["R = h(h2 || h(Y4))"]
    h2["h2 = h(h1 || h(Y3))"]
    h1["h1 = h(h(Y1) || h(Y2))"]
    Y1[Y1] --&gt; hY1["h(Y1)"]
    Y2[Y2] --&gt; hY2["h(Y2)"]
    Y3[Y3] --&gt; hY3["h(Y3)"]
    Y4[Y4] --&gt; hY4["h(Y4)"]
    hY1 --&gt; h1
    hY2 --&gt; h1
    h1 --&gt; h2
    hY3 --&gt; h2
    h2 --&gt; R
    hY4 --&gt; R
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Verification of <span class="math inline">\(Y_1\)</span>:</strong> Provide <span class="math inline">\(h(Y_2), h(Y_3), h(Y_4)\)</span>, compute <span class="math inline">\(h(Y_1), h_1, h_2\)</span>, and verify <span class="math inline">\(h(h_2 || h(Y_4)) = R\)</span>.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Only <span class="math inline">\(R\)</span> requires cryptographic protection.</li>
<li>Balanced trees: Intermediate data <span class="math inline">\(\sim \log_2 n\)</span>.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Modified node → recalculate path to root.</li>
<li>Adding nodes → unbalanced trees recommended.</li>
</ul>
<p><strong>Main Application: Timestamping</strong></p>
<p>TA:</p>
<ul>
<li>Builds tree.</li>
<li>Provides signed timestamp + verification path.</li>
<li>Publishes <span class="math inline">\(R\)</span> daily (newspaper).</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-253-contents" aria-controls="callout-253" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-253" class="callout-253-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Authentication Trees</strong></p>
<p>Authentication trees are an <strong>alternative to certification</strong> for authenticating public information.</p>
<p>They exploit the advantages of a tree structure (typically binary) with the use of hash functions and root authentication.</p>
<p>Given a tree A with <span class="math inline">\(n\)</span> leaves. Let <span class="math inline">\(h\)</span> be a collision-resistant hash function (CRHF). Tree A can be used to authenticate <span class="math inline">\(n\)</span> public values <span class="math inline">\(Y_1, Y_2, ..., Y_n\)</span> by constructing an authentication tree as follows:</p>
<ol type="1">
<li>The values <span class="math inline">\(Y_1, Y_2, ..., Y_n\)</span> are placed in the leaves of the tree.</li>
<li>Each edge from a leaf <span class="math inline">\(Y_i\)</span> is labeled <span class="math inline">\(h(Y_i)\)</span> (<span class="math inline">\(h\)</span> being a CRHF).</li>
<li>Each non-terminal node with underlying edges labeled <span class="math inline">\(h_1\)</span> and <span class="math inline">\(h_2\)</span> is labeled <span class="math inline">\(h(h_1 || h_2)\)</span> (|| denotes concatenation).</li>
</ol>
<p>[Tree diagram]</p>
<p>To verify the authenticity of <span class="math inline">\(Y_1\)</span>, it is necessary to provide the values <span class="math inline">\(h(Y_2), h(Y_3), h(Y_4)\)</span>. Then, it suffices to compute <span class="math inline">\(h(Y_1), h_1\)</span>, and <span class="math inline">\(h_2\)</span> (according to the figure) and accept the authenticity of <span class="math inline">\(Y_1\)</span> if <span class="math inline">\(h(h_2 || h(Y_4)) = R\)</span>. An illicit modification in <span class="math inline">\(Y_1\)</span> would result (by the characteristics of the CRHF) in a different value for <span class="math inline">\(h(h_2 || h(Y_4)) \neq R\)</span>.</p>
<p>Note that only the value <span class="math inline">\(R\)</span> needs to be authenticated (e.g., using a digital signature). The other values are protected by the irreversibility of the CRHF.</p>
<p><strong>Advantage:</strong> Only <span class="math inline">\(R\)</span> requires cryptographic protection for authentication!</p>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>To verify the value <span class="math inline">\(Y_1\)</span>, the values <span class="math inline">\(h(Y_{2,3,4})\)</span> and the value <span class="math inline">\(R\)</span> are needed. To minimize this effect, balanced trees (trees whose paths differ by at most one edge) can be used to reduce the number of intermediate data to <span class="math inline">\(\sim \log_2 n\)</span>.</li>
<li>When a node is modified, the entire path to the root must be recalculated.</li>
<li>When new nodes are added, it is advisable to build unbalanced trees (like the one in the figure) and add nodes via the root.</li>
</ul>
<p><strong>Main application: timestamping:</strong> The timestamping agent (TA) builds such a tree and provides the requester with the timestamp signed with its private key along with the verification path. The TA publishes <span class="math inline">\(R\)</span> daily in a newspaper, preventing it from cheating!</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-254-contents" aria-controls="callout-254" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-254" class="callout-254-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Authentication Trees:</strong></p>
<ul>
<li>Certification alternative via hash + tree</li>
<li>Only root <span class="math inline">\(R\)</span> signed</li>
<li>Verification: path <span class="math inline">\(\sim \log_2 n\)</span> values</li>
<li>Application: timestamping</li>
<li>TA publishes <span class="math inline">\(R\)</span> daily</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="certification-topologies" class="level3">
<h3 class="anchored" data-anchor-id="certification-topologies">Certification Topologies</h3>
<p><strong>Problem:</strong> Communication between users of different CAs → trust question.</p>
<p><strong>Cross-Certification:</strong></p>
<ul>
<li><span class="math inline">\(CA_A\)</span> certifies the public key <span class="math inline">\(pub_{CA_B}\)</span> of <span class="math inline">\(CA_B\)</span>.</li>
<li>Cross-certificate: <span class="math inline">\(CA_A\{CA_B\}\)</span>.</li>
<li>Certification chain: <span class="math inline">\(CA_A\{CA_B\} \rightarrow CA_B\{B\}\)</span>.</li>
<li>A verifies B’s key with an authentic copy of <span class="math inline">\(pub_{CA_A}\)</span>.</li>
</ul>
<p><strong>Strict Hierarchical Model (PEM/X.509):</strong></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    Root[Root CA]
    Root --&gt; CA1[Level 1 CA]
    Root --&gt; CA2[Level 1 CA]
    CA1 --&gt; CA3[Level 2 CA]
    CA1 --&gt; CA4[Level 2 CA]
    CA2 --&gt; CA5[Level 2 CA]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ul>
<li>Any non-local chain starts at the root node.</li>
<li>Root public key assumed to be globally known.</li>
<li><strong>Problem:</strong> Centralization, single point of failure.</li>
</ul>
<p><strong>Graph Model (PGP):</strong></p>
<ul>
<li>Users act as CAs for correspondents.</li>
<li>Decentralized graph structure.</li>
<li>Suitable for closed groups.</li>
<li><strong>Limitations:</strong> Unconnected populations.</li>
</ul>
<p><strong>Hybrid Models:</strong></p>
<ul>
<li>Hierarchy + bidirectional cross-certification.</li>
</ul>
<p><strong>Golden Rule:</strong> Short chains (weakest link!).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-255-contents" aria-controls="callout-255" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-255" class="callout-255-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certification Topologies</strong></p>
<p>When two users belonging to different CAs wish to communicate, a trust problem arises: should one trust a certificate issued by another CA?</p>
<p>The <strong>cross-certification</strong> process allows <span class="math inline">\(CA_A\)</span> to certify the public key <span class="math inline">\(pub_{CA_B}\)</span> of <span class="math inline">\(CA_B\)</span>. The resulting certificate is called a cross-certificate, denoted: <span class="math inline">\(CA_A\{CA_B\}\)</span>.</p>
<p>If A wants to verify the authenticity of B’s public key and there exists a cross-certificate <span class="math inline">\(CA_A\{CA_B\}\)</span>, A will ask B to provide its certificate signed by <span class="math inline">\(CA_B\)</span>, i.e., <span class="math inline">\(CA_B\{B\}\)</span>. The resulting <strong>certification chain</strong>: <span class="math inline">\(CA_A\{CA_B\} \rightarrow CA_B\{B\}\)</span> allows A to verify B’s public key using an authentic copy of <span class="math inline">\(pub_{CA_A}\)</span>.</p>
<p>The trust relationship necessary for cross-certification is not always easy to establish in competitive environments, which is why <strong>hierarchical models</strong> among CAs have been proposed. Example: the strict hierarchical model of PEM/X.509:</p>
<p>[Hierarchy diagram]</p>
<p>In the PEM environment, any non-local certification chain starts at the <strong>root node</strong>, whose public key is assumed to be known worldwide…</p>
<p>Other models, such as the one proposed by <strong>PGP</strong>, are based on a graph structure where the nodes are users who act as CAs to certify the public keys of correspondents. Although well-suited for closed user groups, this model has its limitations when applied to unconnected populations.</p>
<p>Other proposed schemes combine the hierarchical structure with bidirectional cross-certification.</p>
<p><strong>Keep certification chains as short as possible</strong> (a chain is always as vulnerable as its <strong>weakest link</strong>!).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-256-contents" aria-controls="callout-256" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-256" class="callout-256-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certification Topologies:</strong></p>
<ul>
<li><strong>Cross-certification:</strong> <span class="math inline">\(CA_A\{CA_B\} \rightarrow CA_B\{B\}\)</span></li>
<li><strong>Hierarchical</strong> (PEM/X.509): Global root</li>
<li><strong>Graph</strong> (PGP): Users = CAs</li>
<li><strong>Hybrid:</strong> Hierarchy + cross-cert</li>
<li>Rule: Short chains!</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="public-key-infrastructure-pki" class="level2">
<h2 class="anchored" data-anchor-id="public-key-infrastructure-pki">Public Key Infrastructure (PKI)</h2>
<p><strong>Definition:</strong> Integrated infrastructure providing security services based on public-key cryptography.</p>
<section id="main-functional-entities" class="level3">
<h3 class="anchored" data-anchor-id="main-functional-entities">Main Functional Entities</h3>
<p><strong>Certification Authority (CA):</strong></p>
<ul>
<li>Creation and maintenance of certificates.</li>
</ul>
<p><strong>Certificate Repository:</strong></p>
<ul>
<li>Accessible certificate directory (X.500, LDAP, WWW, DNS).</li>
</ul>
<p><strong>Certificate Revocation:</strong></p>
<ul>
<li>Management of compromised/obsolete certificates (CRLs).</li>
</ul>
<p><strong>Key Backup and Recovery:</strong></p>
<ul>
<li>Backup/restoration of lost keys.</li>
<li>Media destruction, password loss, employee departure.</li>
<li>⚠️ Decryption private key (not signature).</li>
</ul>
<p><strong>Automatic Key Update:</strong></p>
<ul>
<li>Key update after validity expiration.</li>
</ul>
<p><strong>Key and Certificate History:</strong></p>
<ul>
<li>Retrieval of obsolete keys to decrypt old documents.</li>
</ul>
<p><strong>Cross-Certification:</strong></p>
<ul>
<li>Validation of certificates from other PKIs (clients, suppliers, partners).</li>
</ul>
<p><strong>Non-Repudiation Support:</strong></p>
<p>Demonstrates the proper execution of an authenticated transaction:</p>
<ul>
<li>Data origin authentication.</li>
<li>Time-stamped data signature.</li>
<li>Signed receipt of delivery.</li>
</ul>
<p><strong>Secure Time Stamping:</strong></p>
<ul>
<li>Time reference accepted by all.</li>
</ul>
<p><strong>Client Software:</strong></p>
<ul>
<li>PKI operations on the client side.</li>
<li>Certificate management, signatures, decryption.</li>
<li>Peripherals (smart cards, biometrics).</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-257-contents" aria-controls="callout-257" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-257" class="callout-257-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Public Key Infrastructure (PKI): Definitions</strong></p>
<p><strong>Definition:</strong> A PKI is an integrated infrastructure enabling the provision of a set of security services based on public-key cryptography.</p>
<p><strong>Functional Entities:</strong></p>
<ul>
<li><p><strong>Certification Authority (CA):</strong> Entity responsible for creating and maintaining certificates.</p></li>
<li><p><strong>Certificate Repository:</strong> Directory making certificates available to users and applications. Technologies used: X.500, LDAP, WWW servers, DNS, etc.</p></li>
<li><p><strong>Certificate Revocation:</strong> Compromised or obsolete certificates (notably CRL management).</p></li>
<li><p><strong>Centralized Key Backup and Recovery:</strong> Entity allowing key loss management due to various events: destruction of the material medium, password loss, employee departure, etc. Note that this procedure mainly applies to the decryption private key (as opposed to the signature private key).</p></li>
<li><p><strong>Automatic Key Update:</strong> After their validity expires.</p></li>
<li><p><strong>Key and Certificate History.</strong> This entity allows the retrieval of obsolete keys that were used to encrypt a document in the past.</p></li>
<li><p><strong>Cross-Certification</strong> with other PKIs (clients, suppliers, partners, etc.). This functionality allows (under certain constraints) the validation of certificates issued by other PKIs.</p></li>
<li><p><strong>Non-Repudiation Support:</strong> Value-added service providing the necessary evidence to demonstrate the execution of an authenticated transaction (data origin authentication, time-stamped data signature, signed receipt of delivery, etc.).</p></li>
<li><p><strong>Secure Time Stamping:</strong> Entity capable of providing a reference time accepted by all PKI participants. Main applications: non-repudiation, arbitration in case of conflicts, etc.</p></li>
<li><p><strong>Client Software:</strong> This functional entity allows all PKI operations on the client side. Examples: user certificate management, document signing, information decryption, management of specific peripherals (smart card readers, biometric devices, etc.).</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-258-contents" aria-controls="callout-258" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-258" class="callout-258-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PKI – Main Entities:</strong></p>
<ul>
<li>CA: Certificate creation/maintenance</li>
<li>Repository: Certificate storage</li>
<li>Revocation: CRLs</li>
<li>Backup/Recovery: Lost keys (decryption)</li>
<li>Cross-cert: Validation of other PKIs</li>
<li>Time stamping: Time reference</li>
<li>Client: User operations</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="advantages-and-disadvantages" class="level3">
<h3 class="anchored" data-anchor-id="advantages-and-disadvantages">Advantages and Disadvantages</h3>
<p><strong>Advantages:</strong></p>
<p><strong>Security:</strong></p>
<ul>
<li>Integrated environment without weak links.</li>
</ul>
<p><strong>All-in-One:</strong></p>
<ul>
<li>Integration of multiple services: strong authentication, signatures, single sign-on, VPNs, B2C/B2B.</li>
<li>Cost savings vs.&nbsp;“case-by-case” solutions.</li>
</ul>
<p><strong>Interoperability:</strong></p>
<ul>
<li>Widespread standards (X.509, PKCS, OCSP).</li>
<li>Compatible applications and devices.</li>
<li>Possible inter-enterprise interoperability.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<p><strong>Implementation Cost:</strong></p>
<ul>
<li>Expensive products.</li>
<li>Rare skills.</li>
</ul>
<p><strong>Complexity:</strong></p>
<ul>
<li>Complex implementation and management.</li>
<li><strong>Alternative:</strong> Outsourcing PKI service.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-259-contents" aria-controls="callout-259" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-259" class="callout-259-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PKI: Main Advantages and Disadvantages</strong></p>
<p><strong>Advantages</strong></p>
<ul>
<li><p><strong>Security:</strong> The integrated nature of a PKI allows the creation of a security environment without weak links.</p></li>
<li><p><strong>All-in-One:</strong> A PKI enables the integration and management of all security parameters for a wide range of services: strong entity authentication, document signing for non-repudiation, single sign-on, virtual private networks (VPNs), secure communications with clients/partners/suppliers (B2C, B2B), etc. The PKI represents a significant cost saving compared to “case-by-case” solutions.</p></li>
<li><p><strong>Intra- and Inter-Enterprise Interoperability:</strong> The main PKI products comply with widely adopted standardization norms (X.509, PKCS, OCSP, etc.). A large number of applications and hardware devices now conform to these standards. The possible compatibility between different PKI providers also allows (with some reservations) inter-enterprise interoperability.</p></li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li><strong>Implementation Cost:</strong> Expensive products, rare skills.</li>
<li><strong>Complexity</strong>…but:
<ul>
<li>Outsourcing the “PKI service” is an alternative.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-260-contents" aria-controls="callout-260" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-260" class="callout-260-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PKI:</strong></p>
<p><strong>✅ Advantages:</strong></p>
<ul>
<li>Integrated security</li>
<li>All-in-one: multi-services</li>
<li>Interoperability (standards)</li>
</ul>
<p><strong>❌ Disadvantages:</strong></p>
<ul>
<li>High cost</li>
<li>Complexity</li>
<li>Solution: Outsourcing</li>
</ul>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>