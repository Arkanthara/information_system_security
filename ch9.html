<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ch9 – ISS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-96c1bb8b336142dcc39f931773fab1b9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-9ee82e006983bafa07c9ac29a901142c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-96c1bb8b336142dcc39f931773fab1b9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ISS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-language" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text">Language</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-language">    
        <li>
    <a class="dropdown-item" href="./index.html">
 <span class="dropdown-text">English</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./fr/index.html">
 <span class="dropdown-text">French</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch1.html">Course</a></li><li class="breadcrumb-item"><a href="./ch9.html">Trusted Third Parties (TTP) and Certification</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Cryptography Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Symmetric Cryptography</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Asymmetric Cryptography (Public Key Cryptography)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cryptographic Hash Functions and MACs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Digital Signatures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Authentication</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Key Establishment Protocols (KEP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch9.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Trusted Third Parties (TTP) and Certification</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./presentations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentations</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#trusted-third-parties-ttp-and-certification" id="toc-trusted-third-parties-ttp-and-certification" class="nav-link active" data-scroll-target="#trusted-third-parties-ttp-and-certification">Trusted Third Parties (TTP) and Certification</a>
  <ul class="collapse">
  <li><a href="#ttp" id="toc-ttp" class="nav-link" data-scroll-target="#ttp">TTP</a>
  <ul class="collapse">
  <li><a href="#ttp-operating-modes" id="toc-ttp-operating-modes" class="nav-link" data-scroll-target="#ttp-operating-modes">TTP Operating Modes</a></li>
  <li><a href="#key-distribution-centers-kdcs" id="toc-key-distribution-centers-kdcs" class="nav-link" data-scroll-target="#key-distribution-centers-kdcs">Key Distribution Centers (KDCs)</a></li>
  <li><a href="#certification-authorities-cas" id="toc-certification-authorities-cas" class="nav-link" data-scroll-target="#certification-authorities-cas">Certification Authorities (CAs)</a></li>
  <li><a href="#functional-entities-related-to-certification" id="toc-functional-entities-related-to-certification" class="nav-link" data-scroll-target="#functional-entities-related-to-certification">Functional Entities Related to Certification</a></li>
  <li><a href="#other-ttps" id="toc-other-ttps" class="nav-link" data-scroll-target="#other-ttps">Other TTPs</a></li>
  </ul></li>
  <li><a href="#public-key-authentication" id="toc-public-key-authentication" class="nav-link" data-scroll-target="#public-key-authentication">Public Key Authentication</a>
  <ul class="collapse">
  <li><a href="#certificates" id="toc-certificates" class="nav-link" data-scroll-target="#certificates">Certificates</a></li>
  <li><a href="#certificate-revocation-lists-crls" id="toc-certificate-revocation-lists-crls" class="nav-link" data-scroll-target="#certificate-revocation-lists-crls">Certificate Revocation Lists (CRLs)</a></li>
  <li><a href="#authentication-trees" id="toc-authentication-trees" class="nav-link" data-scroll-target="#authentication-trees">Authentication Trees</a></li>
  <li><a href="#certification-topologies" id="toc-certification-topologies" class="nav-link" data-scroll-target="#certification-topologies">Certification Topologies</a></li>
  </ul></li>
  <li><a href="#public-key-infrastructure-pki" id="toc-public-key-infrastructure-pki" class="nav-link" data-scroll-target="#public-key-infrastructure-pki">Public Key Infrastructure (PKI)</a>
  <ul class="collapse">
  <li><a href="#main-functional-entities" id="toc-main-functional-entities" class="nav-link" data-scroll-target="#main-functional-entities">Main Functional Entities</a></li>
  <li><a href="#advantages-and-disadvantages" id="toc-advantages-and-disadvantages" class="nav-link" data-scroll-target="#advantages-and-disadvantages">Advantages and Disadvantages</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="ch9.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch1.html">Course</a></li><li class="breadcrumb-item"><a href="./ch9.html">Trusted Third Parties (TTP) and Certification</a></li></ol></nav></header>





<section id="trusted-third-parties-ttp-and-certification" class="level1">
<h1>Trusted Third Parties (TTP) and Certification</h1>
<section id="ttp" class="level2">
<h2 class="anchored" data-anchor-id="ttp">TTP</h2>
<section id="ttp-operating-modes" class="level3">
<h3 class="anchored" data-anchor-id="ttp-operating-modes">TTP Operating Modes</h3>
<p><strong>Three Operational Modes:</strong></p>
<ul>
<li><strong>In-line:</strong> TTP acts as an intermediary, relaying all exchanges in real time (e.g., Proxies, Secure Gateways).</li>
<li><strong>On-line:</strong> TTP participates in real time, but A and B communicate directly (e.g., KDC).</li>
<li><strong>Off-line:</strong> TTP does not participate in real-time exchanges but makes information available <em>a priori</em> (e.g., CA).</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[A] --&gt;|in-line| TTP[TTP]
    TTP --&gt;|in-line| B[B]

    A2[A] ---|on-line| TTP2[TTP on-line]
    A2 &lt;--&gt;|direct| B2[B]

    A3[A] -.-&gt;|prior exchange| TTP3[TTP off-line]
    B3[B] -.-&gt;|prior exchange| TTP3
    A3 &lt;--&gt;|direct| B3
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Comparison:</strong></p>
<ul>
<li><strong>Off-line:</strong> Facilitates exchanges, no need for permanent availability.</li>
<li><strong>In-line/On-line:</strong> Requires permanent availability.</li>
<li><strong>Off-line:</strong> Revocation of privileges is more complex.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>TTP: Operating Modes</strong></p>
<ul>
<li><p><strong>In-line:</strong> The TTP acts as an <strong>intermediary</strong> to relay exchanges between A and B in real time. Examples: Proxies, Secure Gateways.</p></li>
<li><p><strong>On-line:</strong> The TTP <strong>participates in real time</strong> in exchanges between A and B, but A and B communicate directly (without passing through the TTP). Example: Key Distribution Center.</p></li>
<li><p><strong>Off-line:</strong> The TTP <strong>does not participate</strong> in real-time exchanges but makes information available <strong>a priori</strong>. Example: Certification Authorities.</p></li>
</ul>
<p><strong>Comparison In-line/On-line/Off-line:</strong> Exchanges are facilitated, and there is no need for permanent TTP availability in off-line mode (unlike the other two), but <strong>privilege revocation</strong> (e.g., when a secret key is compromised) is more complex.</p>
<p>[Diagrams showing the three modes]</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>TTP Modes:</strong></p>
<ul>
<li><strong>In-line:</strong> Intermediary relay</li>
<li><strong>On-line:</strong> Real-time participation</li>
<li><strong>Off-line:</strong> Information available <em>a priori</em> (e.g., CA)</li>
<li>Off-line: No availability required but revocation complex</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="key-distribution-centers-kdcs" class="level3">
<h3 class="anchored" data-anchor-id="key-distribution-centers-kdcs">Key Distribution Centers (KDCs)</h3>
<p><strong>Objective:</strong> Solve the <span class="math inline">\(n^2\)</span> key distribution problem.</p>
<p><strong>Principle:</strong></p>
<ul>
<li>Without KDC: <span class="math inline">\(\frac{n(n-1)}{2} \approx n^2\)</span> keys for <span class="math inline">\(n\)</span> entities.</li>
<li>With KDC: Only <span class="math inline">\(n\)</span> keys (each entity shares a key with the KDC).</li>
<li>Session keys dynamically generated by the KDC.</li>
</ul>
<p><strong>Advantages:</strong></p>
<ul>
<li>Scalability: A new entity = only one new key.</li>
<li>Secure channel establishment via tickets (as in Kerberos).</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><strong>Single point of security failure:</strong> KDC compromise → entire system vulnerable.</li>
<li><strong>Single point of operational failure:</strong> KDC unavailability (DoS) → system paralysis.</li>
<li><strong>Performance bottleneck:</strong> Costly operations (encryption, random generation).</li>
</ul>
<p><strong>Solutions:</strong> Mirroring, load balancing.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>TTP: Key Distribution Centers (KDCs)</strong></p>
<p><strong>Goal:</strong> Solve the <strong><span class="math inline">\(n^2\)</span> key distribution problem</strong>:</p>
<ul>
<li><p>In a symmetric environment with <span class="math inline">\(n\)</span> entities without an intermediary: <span class="math inline">\(n(n-1)/2 \sim n^2\)</span> different keys are needed for all pairs of entities to share a different key.</p></li>
<li><p>Moreover, such a system is not <strong>scalable</strong> because adding an entity results in the generation of <span class="math inline">\(n\)</span> new keys.</p></li>
</ul>
<p>If each entity shares a key with a KDC, only <strong><span class="math inline">\(n\)</span> keys</strong> are needed for the system to function, and one key suffices for each new entity. The establishment of secure channels is ensured by the generation of session keys and the presence of tickets as in Kerberos.</p>
<p><strong>Problems:</strong></p>
<ul>
<li><p><strong>Single point of security failure:</strong> By construction, the KDC can impersonate all nodes in the network. If it is compromised, the entire system becomes vulnerable.</p></li>
<li><p><strong>Single point of operational failure:</strong> The usual mode of operation of a KDC is on-line (possibly in-line). If it becomes unavailable (e.g., due to a denial-of-service attack), the entire system is paralyzed.</p></li>
<li><p><strong>Performance bottleneck:</strong> KDC operations are often computationally expensive (encryption/decryption, random generation, etc.). Classic solutions (e.g., mirroring) must be considered to distribute the KDC load.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>KDC:</strong></p>
<ul>
<li>Solves <span class="math inline">\(n^2\)</span> problem → <span class="math inline">\(n\)</span> keys</li>
<li>Scalable: +1 entity = +1 key</li>
<li>Risks: Single point of failure (security + operational), bottleneck</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="certification-authorities-cas" class="level3">
<h3 class="anchored" data-anchor-id="certification-authorities-cas">Certification Authorities (CAs)</h3>
<p><strong>Role:</strong> Authenticate the association between an <strong>entity</strong> and its <strong>public key</strong>.</p>
<p><strong>Operation:</strong></p>
<ol type="1">
<li>CA verifies identity (passport, etc.).</li>
<li>CA creates and signs a <strong>certificate</strong> containing this association.</li>
<li>Certificates are accessible to entities (may be cached).</li>
</ol>
<p><strong>Verification:</strong> Requires an authentic copy of the CA’s public key.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>Off-line mode:</strong> Short unavailability is acceptable.</li>
<li>Simpler then safer: No complex protocols needed.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><strong>Asynchronous revocation:</strong> Certificate may become invalid (private key theft).</li>
<li><strong>Solution:</strong> Signed Certificate Revocation Lists (CRLs).</li>
</ul>
<p><strong>CA Compromise:</strong></p>
<p>Serious consequences if the private signing key is compromised.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>TTP: Certification Authorities (CAs)</strong></p>
<p>The primary role of a <strong>Certification Authority (CA)</strong> is to <strong>authenticate the association between an entity and its public key</strong> (think of Man-in-the-Middle attacks!).</p>
<p>The CA will <strong>create and sign certificates</strong> containing this association (using proof of identity such as a passport) and make them accessible to the relevant entities.</p>
<p>Once signed, copies of the certificates (<strong>cached certificates</strong>) can be stored in unprotected locations (e.g., on the user’s disk space). However, to verify the signature of the certificates, the relevant entities require an <strong>authentic copy of the CA’s public key</strong>.</p>
<p><strong>Simpler then safer:</strong> There is no need to implement complex protocols in a CA.</p>
<p>The usual mode of operation of a CA is <strong>off-line</strong>, which reduces the impact of short periods of unavailability.</p>
<p><strong>Problem associated with off-line mode:</strong> The validity of cached certificates may be questioned <strong>asynchronously</strong> due to a private key theft.</p>
<p><strong>Remedy:</strong> CAs also publish signed lists of invalid certificates (<strong>Certificate Revocation Lists</strong> or <strong>CRLs</strong>).</p>
<p>Compromising a CA has less obvious but almost as harmful consequences as compromising a KDC, especially if the private key used to sign certificates is also compromised.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CA:</strong></p>
<ul>
<li>Authenticates entity ↔︎ public key association</li>
<li>Signs certificates (off-line mode)</li>
<li>CRLs for revocations</li>
<li>Compromise = serious consequences</li>
</ul>
</div>
</div>
</div>
<hr>
<section id="proof-of-possession-pop" class="level4">
<h4 class="anchored" data-anchor-id="proof-of-possession-pop">Proof of Possession (PoP)</h4>
<p><strong>Problem:</strong> Identity verification is not sufficient; possession of the private key must also be verified.</p>
<p><strong>Attack without PoP:</strong></p>
<ol type="1">
<li>A signs a document and sends it to B (notary): <span class="math inline">\(S_{priv_A}(\text{Invention}), S_{priv_{CA_A}}(Cert_A)\)</span>.</li>
<li>C intercepts and requests from <span class="math inline">\(CA_C\)</span> (without PoP) a certificate associating C with <span class="math inline">\(pub_A\)</span>.</li>
<li>C sends to B: <span class="math inline">\(S_{priv_A}(\text{Invention}), S_{priv_{CA_C}}(Cert_C)\)</span>.</li>
<li>C becomes the inventor!</li>
</ol>
<p><strong>Simple PoP Protocol:</strong></p>
<ol type="1">
<li><span class="math inline">\(CA \rightarrow A: A, r\)</span> (random number + identity).</li>
<li><span class="math inline">\(CA \leftarrow A: S_{priv_A}(A, r)\)</span>.</li>
<li><span class="math inline">\(CA\)</span> verifies the signature with <span class="math inline">\(pub_A\)</span>.</li>
</ol>
<p><strong>Consequences:</strong></p>
<ul>
<li>Introduces <strong>trust levels</strong> for CAs.</li>
<li>Criteria: PoP, CRL updates, signing key security.</li>
<li>Problem exacerbated by uncontrolled CA proliferation.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CA: Proof of Possession (PoP)</strong></p>
<p>Verifying the identity of A to create (or modify) a certificate associating A with its public key is not a sufficient criterion. It is also necessary to <strong>verify that A truly possesses the corresponding private key</strong>.</p>
<p>Let A and its CA be <span class="math inline">\(CA_A\)</span>. Let’s see what an active attacker C can do in “collaboration” with a <span class="math inline">\(CA_C\)</span> that does not verify PoP:</p>
<p>A signs a document containing the description of a revolutionary invention and sends it to B (the notary) with its certificate signed by <span class="math inline">\(CA_A\)</span>:</p>
<p><span class="math inline">\(A \rightarrow B: S_{priv_A}(\text{Invention}), S_{priv_{CA_A}}(Cert_A)\)</span></p>
<p>C intercepts this packet, approaches <span class="math inline">\(CA_C\)</span>, and asks it to create a certificate associating its identity C with A’s public key, and sends to B:</p>
<p><span class="math inline">\(C \rightarrow B: S_{priv_A}(\text{Invention}), S_{priv_{CA_C}}(Cert_C)\)</span></p>
<p>C thus becomes the revolutionary inventor…</p>
<p><strong>Simple PoP Verification Protocol:</strong></p>
<p><span class="math inline">\(CA \rightarrow A: A, r\)</span>; <span class="math inline">\(r\)</span>: random number, A to protect A from chosen message attacks.</p>
<p><span class="math inline">\(CA \leftarrow A: S_{priv_A}(A, r)\)</span>; CA only needs to verify the signature with <span class="math inline">\(pub_A\)</span>.</p>
<p>This criterion and other behavioral criteria, such as CRL updates or the security of the signing key, introduce <strong>trust levels</strong> for CAs and for the certificates they sign.</p>
<p>This phenomenon is exacerbated by the <strong>uncontrolled proliferation of CAs</strong>!</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PoP (Proof of Possession):</strong></p>
<ul>
<li>Verify possession of private key (not just identity)</li>
<li>Without PoP: Attacker can impersonate identity</li>
<li>Protocol: CA verifies signature on challenge</li>
<li>Introduces trust levels for CAs</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="separation-of-certification-and-revocation" class="level4">
<h4 class="anchored" data-anchor-id="separation-of-certification-and-revocation">Separation of Certification and Revocation</h4>
<p><strong>Problem:</strong> If the same key signs certificates and CRLs, an adversary possessing the CA’s private key can:</p>
<ol type="1">
<li>Publish a CRL revoking victim A’s certificate.</li>
<li>Create a fake certificate associating A with a key controlled by the adversary.</li>
<li>Decrypt confidential transactions for A.</li>
<li>Impersonate A (signatures, authentication).</li>
</ol>
<p><strong>Solution: Separation of Duties</strong></p>
<p>Clear separation of tasks:</p>
<ul>
<li><strong>Certificates</strong> and <strong>CRLs</strong> signed with <strong>different keys</strong>.</li>
<li>By <strong>different functional entities</strong>:
<ul>
<li><strong>Certification Authority (CA)</strong></li>
<li><strong>Revocation Authority (RA)</strong></li>
</ul></li>
<li>Residing on <strong>different machines</strong>.</li>
<li>Subject to <strong>independent security policies</strong>.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CA: Certification and Revocation</strong></p>
<p><strong>Problem:</strong> If the same key is used to sign certificates and CRLs, an adversary possessing the private signing key of a CA can attack a “victim” A under the authority of this CA as follows:</p>
<ul>
<li>Publish a CRL containing A’s revoked certificate.</li>
<li>Create a certificate associating A with a public key for which it controls the private key to then:
<ul>
<li>act as a Man-in-the-Middle to decrypt confidential transactions for A;</li>
<li>impersonate A for authenticated transactions or signed documents.</li>
</ul></li>
</ul>
<p><strong>Solution: Separation of duties:</strong> Certification and revocation become clearly differentiated tasks:</p>
<ul>
<li>Certificates and CRLs are signed with <strong>different keys</strong>,</li>
<li>by <strong>different functional entities</strong> (Certification Authority and Revocation Authority);</li>
<li>if possible, residing on <strong>different machines</strong> subject to <strong>independent security criteria (security policies)</strong>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Separation of Duties:</strong></p>
<ul>
<li>Certificates ≠ CRLs (different keys)</li>
<li>CA ≠ Revocation Authority</li>
<li>Separate machines and policies</li>
<li>Prevents post-compromise attacks</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="functional-entities-related-to-certification" class="level3">
<h3 class="anchored" data-anchor-id="functional-entities-related-to-certification">Functional Entities Related to Certification</h3>
<p><strong>Name Server:</strong></p>
<ul>
<li>Manages a unique and consistent namespace.</li>
<li>Combined with certification if authentication is required.</li>
<li>Example: <strong>DNSSec</strong> (authenticated DNS for the Internet).</li>
</ul>
<p><strong>Registration Authority (RA):</strong></p>
<ul>
<li>Tasks requiring direct contact with entities.</li>
<li>Identity verification, PoP, certificate requests/modifications.</li>
<li>Detached from CA for geographical reasons.</li>
</ul>
<p><strong>Key Generator:</strong></p>
<ul>
<li>Generates public/private key pairs.</li>
<li><strong>Advantages:</strong> User simplicity, enhanced key security.</li>
<li><strong>Disadvantage:</strong> Private key known to another entity → loss of non-repudiation.</li>
</ul>
<p><strong>Certificate Directory:</strong></p>
<ul>
<li>Read-only access directory for certificates.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Functional Entities Related to Certification</strong></p>
<ul>
<li><p><strong>Name Server:</strong> Responsible for managing a <strong>unique and consistent namespace</strong>. When authentication is required, name management must be complemented by the certification of public keys associated with these names.</p>
<p>Example of a pilot solution combining both concepts: <strong>DNSsec</strong>: authenticated name management environment for the Internet.</p></li>
<li><p><strong>Registration Authority:</strong> Entity responsible for performing tasks related to certificate management requiring <strong>direct contact</strong> with the relevant entities. These tasks include verifying the parameters necessary for the initial request or modification of certificates (identity verification, PoP, etc.). Detaching this functionality from the CA is typically due to geographical considerations.</p></li>
<li><p><strong>Key Generator:</strong> Allows delegation of the public/private key pair creation process to a dedicated entity:</p>
<ul>
<li><strong>Advantages:</strong> Simplicity for users; possibility to enhance the security of chosen pairs.</li>
<li><strong>Disadvantage:</strong> Private key known to another entity! Loss of non-repudiation.</li>
</ul></li>
<li><p><strong>Certificate Directory:</strong> The directory allowing users to access (read-only) the certificates of correspondents.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certification Entities:</strong></p>
<ul>
<li><strong>Name Server:</strong> Names + DNSSec</li>
<li><strong>RA:</strong> Direct contact, verifications</li>
<li><strong>Key Generator:</strong> Key generation (⚠️ loses non-repudiation)</li>
<li><strong>Certificate Directory:</strong> Read-only certificate access</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="other-ttps" class="level3">
<h3 class="anchored" data-anchor-id="other-ttps">Other TTPs</h3>
<p><strong>Timestamp Agent (TA):</strong></p>
<ul>
<li>Certifies the existence of a document/transaction at a specific time.</li>
<li>Methods:
<ul>
<li>Associate a timestamp with the document (or <span class="math inline">\(h(\text{doc})\)</span>) + sign.</li>
<li>Use an authentication tree.</li>
</ul></li>
</ul>
<p><strong>Notary Agent:</strong></p>
<ul>
<li>Like TA but also: validity, origin, ownership.</li>
<li>Legal support for non-repudiation.</li>
</ul>
<p><strong>Key Escrow Agent (KEA):</strong></p>
<ul>
<li>Access to session secret keys under conditions (judicial warrant).</li>
<li>Requires a dedicated encryption system.</li>
</ul>
<p><strong>Example: Clipper/Capstone</strong></p>
<ul>
<li><strong>Clipper chip</strong> (1993): Symmetric encryption with KEA access.</li>
<li>Controversial, flaws discovered.</li>
<li><strong>Capstone chip:</strong> Successor (Fortezza PCMCIA card).</li>
<li>Military-level security.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Other TTPs</strong></p>
<ul>
<li><p><strong>Timestamp agent (TA):</strong> Certifies the existence of a document or the occurrence of a transaction at a well-specified time. To do this, the TA can:</p>
<ul>
<li>associate a timestamp with the document (or with <span class="math inline">\(h(\text{doc})\)</span> where <span class="math inline">\(h\)</span> is a Collision Resistant Hash Function) and sign the whole with its private key, and</li>
<li>use an authentication tree (see page 231).</li>
</ul></li>
<li><p><strong>Notary agent:</strong> Certifies not only the existence of a document at a given time (like the TA) but also its <strong>validity, origin, or ownership</strong> by a given entity. This service provides (legally necessary?) support for non-repudiation.</p></li>
<li><p><strong>Key escrow agent (KEA):</strong> Entity authorized to access session secret keys provided certain conditions (e.g., a court order) are met. This requires a dedicated encryption system. Example: the Clipper key escrow system:</p>
<ul>
<li>Announced in April 1993 by the US administration, amid great controversy, as the large-scale communication encryption solution.</li>
<li>The <strong>Clipper chip</strong> is a symmetric encryption/decryption device that provides access to session keys when the secret keys of two KEAs (typically federal agencies) are input.</li>
<li>The presence of some flaws and the need for asymmetric cryptography led to its successor: the <strong>Capstone chip</strong>, which can be integrated into a PCMCIA card (called <strong>Fortezza</strong> and used for military-level security).</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Other TTPs:</strong></p>
<ul>
<li><strong>TA:</strong> Timestamp document existence</li>
<li><strong>Notary:</strong> TA + validity/origin (non-repudiation)</li>
<li><strong>KEA:</strong> Access to keys under legal conditions</li>
<li>Example: Clipper/Fortezza (controversial)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="public-key-authentication" class="level2">
<h2 class="anchored" data-anchor-id="public-key-authentication">Public Key Authentication</h2>
<section id="certificates" class="level3">
<h3 class="anchored" data-anchor-id="certificates">Certificates</h3>
<p><strong>Definition:</strong> Information associating an entity with its public key.</p>
<p><strong>Generic Structure:</strong></p>
<ul>
<li><strong>Serial Number, Version</strong></li>
<li><strong>Issuer:</strong> Identity of the signing CA (global and unique).</li>
<li><strong>Signature Algorithm:</strong> Algorithm used to compute the signature (e.g., MD5+ElGamal, SHA+RSA).</li>
<li><strong>Subject:</strong> Name of the certified entity (global and unique).</li>
<li><strong>Subject Public Key:</strong> Public key.
<ul>
<li>RSA: <span class="math inline">\((n, e)\)</span></li>
<li>DH: <span class="math inline">\((p, \alpha, \alpha^x \mod p)\)</span></li>
</ul></li>
<li><strong>Subject Public Key Algorithm:</strong> RSA, DH, etc.</li>
<li><strong>Validity:</strong> Validity period (UTC).</li>
<li><strong>Signature:</strong> Covers all previous records, ensuring authenticity.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Public Key Authenticity: Certificates</strong></p>
<p>A <strong>certificate</strong> is a piece of information associating an entity with its public key. Generically, it consists of the following elements:</p>
<ul>
<li><strong>Serial Number, Version</strong>.</li>
<li><strong>Issuer:</strong> The (global and unique) identity of the signing CA.</li>
<li><strong>Signature Algorithm:</strong> The algorithm used to compute the signature on the certificate. E.g.: MD5 + ElGamal or SHA + RSA.</li>
<li><strong>Subject:</strong> The (global and unique) name of the entity whose public key is certified.</li>
<li><strong>Subject Public Key:</strong> The entity’s public key. For example:
<ul>
<li><span class="math inline">\((n,e)\)</span>: modulus and public exponent for RSA.</li>
<li><span class="math inline">\((p, \alpha^x \mod p)\)</span>: modulus, generator, and public part for Diffie-Hellman.</li>
</ul></li>
<li><strong>Subject Public Key Algorithm:</strong> The algorithm associated with the public key. E.g.: RSA or Diffie-Hellman.</li>
<li><strong>Validity:</strong> The certificate’s validity period, typically expressed in UTC.</li>
<li><strong>Signature:</strong> Contains the signature computed using the Signature Algorithm and the CA’s private key. It covers all previous records and thus guarantees the authenticity of the information they contain.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certificate:</strong></p>
<ul>
<li>Issuer (CA) + Subject (entity)</li>
<li>Public key + algorithm</li>
<li>Validity period</li>
<li>CA signature on all fields</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="certificate-revocation-lists-crls" class="level3">
<h3 class="anchored" data-anchor-id="certificate-revocation-lists-crls">Certificate Revocation Lists (CRLs)</h3>
<p><strong>Definition:</strong> Lists of certificates that have become invalid.</p>
<p><strong>Reasons for Revocation:</strong></p>
<ul>
<li>Private key compromised.</li>
<li>Algorithm modification.</li>
<li>Role change (role-based certificate).</li>
<li>Other factors invalidating certificate information.</li>
</ul>
<p><strong>CRL Structure:</strong></p>
<ul>
<li><strong>Issuer, Signature Algorithm</strong></li>
<li><strong>Date of Issue, Date of Next Issue</strong></li>
<li>For each revoked certificate:
<ul>
<li><strong>Serial Number</strong></li>
<li><strong>Revocation Date</strong></li>
</ul></li>
<li><strong>Signature:</strong> On the entire list.</li>
</ul>
<p><strong>Requirements:</strong></p>
<ul>
<li>CAs must publish CRLs <strong>frequently</strong>.</li>
<li><strong>Wide-audience</strong> distribution channels.</li>
<li>Minimize fraud risk.</li>
</ul>
<p><strong>Problem:</strong> Revocation is the Achilles’ heel of public key systems.</p>
<p><strong>Alternative Solutions:</strong></p>
<ul>
<li>Certificates with very short validity (a few minutes).</li>
<li>Periodic re-confirmation by CAs.</li>
<li>⚠️ Return to on-line mode → high availability required.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certificate Revocation Lists (CRLs)</strong></p>
<p>These are lists containing certificates that have become <strong>invalid</strong> due to a compromised private key or any other factor affecting the validity of the information contained in a certificate (algorithm change, role change for a role-based certificate, etc.).</p>
<p>A generic CRL has the following elements:</p>
<ul>
<li><strong>Issuer, Signature Algorithm:</strong> As for certificates.</li>
<li><strong>Date of Issue, Date of Next Issue:</strong> Issue date and next issue date.</li>
<li>For each revoked certificate, the following records:
<ul>
<li><strong>Serial Number</strong> of the revoked certificate.</li>
<li><strong>Revocation Date</strong>.</li>
</ul></li>
<li><strong>Signature:</strong> Signature covering the entire list.</li>
</ul>
<p>A CA must publish CRLs with a <strong>very high frequency</strong> and use <strong>wide-audience</strong> distribution channels to reduce the risk of fraud.</p>
<p><strong>Revocation is the Achilles’ heel of any public key system…</strong></p>
<p>A solution: certificates with very short validity periods (a few minutes) requiring periodic re-confirmation by CAs…</p>
<p>…but this brings us back to on-line mode and thus requires high CA availability.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>CRLs:</strong></p>
<ul>
<li>Lists of invalid certificates (compromise, etc.)</li>
<li>Structure: issuer, dates, serial numbers, signature</li>
<li>Frequent publication required</li>
<li>Achilles’ heel of PKI</li>
<li>Alternative: short-lived certificates (→ on-line)</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="authentication-trees" class="level3">
<h3 class="anchored" data-anchor-id="authentication-trees">Authentication Trees</h3>
<p><strong>Principle:</strong> Alternative to certification for authenticating public information.</p>
<p><strong>Construction:</strong> Tree (binary) with hash function + root authentication.</p>
<p>For <span class="math inline">\(n\)</span> values <span class="math inline">\(Y_1, Y_2, ..., Y_n\)</span>:</p>
<ol type="1">
<li>Values placed in leaves.</li>
<li>Edges from leaves labeled <span class="math inline">\(h(Y_i)\)</span>.</li>
<li>Non-terminal nodes labeled <span class="math inline">\(h(h_1 || h_2)\)</span> (|| = concatenation).</li>
<li>Root <span class="math inline">\(R\)</span> authenticated (digital signature).</li>
</ol>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    R["R = h(h2 || h(Y4))"]
    h2["h2 = h(h1 || h(Y3))"]
    h1["h1 = h(h(Y1) || h(Y2))"]
    Y1[Y1] --&gt; hY1["h(Y1)"]
    Y2[Y2] --&gt; hY2["h(Y2)"]
    Y3[Y3] --&gt; hY3["h(Y3)"]
    Y4[Y4] --&gt; hY4["h(Y4)"]
    hY1 --&gt; h1
    hY2 --&gt; h1
    h1 --&gt; h2
    hY3 --&gt; h2
    h2 --&gt; R
    hY4 --&gt; R
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Verification of <span class="math inline">\(Y_1\)</span>:</strong> Provide <span class="math inline">\(h(Y_2), h(Y_3), h(Y_4)\)</span>, compute <span class="math inline">\(h(Y_1), h_1, h_2\)</span>, and verify <span class="math inline">\(h(h_2 || h(Y_4)) = R\)</span>.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Only <span class="math inline">\(R\)</span> requires cryptographic protection.</li>
<li>Balanced trees: Intermediate data <span class="math inline">\(\sim \log_2 n\)</span>.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Modified node → recalculate path to root.</li>
<li>Adding nodes → unbalanced trees recommended.</li>
</ul>
<p><strong>Main Application: Timestamping</strong></p>
<p>TA:</p>
<ul>
<li>Builds tree.</li>
<li>Provides signed timestamp + verification path.</li>
<li>Publishes <span class="math inline">\(R\)</span> daily (newspaper).</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Authentication Trees</strong></p>
<p>Authentication trees are an <strong>alternative to certification</strong> for authenticating public information.</p>
<p>They exploit the advantages of a tree structure (typically binary) with the use of hash functions and root authentication.</p>
<p>Given a tree A with <span class="math inline">\(n\)</span> leaves. Let <span class="math inline">\(h\)</span> be a collision-resistant hash function (CRHF). Tree A can be used to authenticate <span class="math inline">\(n\)</span> public values <span class="math inline">\(Y_1, Y_2, ..., Y_n\)</span> by constructing an authentication tree as follows:</p>
<ol type="1">
<li>The values <span class="math inline">\(Y_1, Y_2, ..., Y_n\)</span> are placed in the leaves of the tree.</li>
<li>Each edge from a leaf <span class="math inline">\(Y_i\)</span> is labeled <span class="math inline">\(h(Y_i)\)</span> (<span class="math inline">\(h\)</span> being a CRHF).</li>
<li>Each non-terminal node with underlying edges labeled <span class="math inline">\(h_1\)</span> and <span class="math inline">\(h_2\)</span> is labeled <span class="math inline">\(h(h_1 || h_2)\)</span> (|| denotes concatenation).</li>
</ol>
<p>[Tree diagram]</p>
<p>To verify the authenticity of <span class="math inline">\(Y_1\)</span>, it is necessary to provide the values <span class="math inline">\(h(Y_2), h(Y_3), h(Y_4)\)</span>. Then, it suffices to compute <span class="math inline">\(h(Y_1), h_1\)</span>, and <span class="math inline">\(h_2\)</span> (according to the figure) and accept the authenticity of <span class="math inline">\(Y_1\)</span> if <span class="math inline">\(h(h_2 || h(Y_4)) = R\)</span>. An illicit modification in <span class="math inline">\(Y_1\)</span> would result (by the characteristics of the CRHF) in a different value for <span class="math inline">\(h(h_2 || h(Y_4)) \neq R\)</span>.</p>
<p>Note that only the value <span class="math inline">\(R\)</span> needs to be authenticated (e.g., using a digital signature). The other values are protected by the irreversibility of the CRHF.</p>
<p><strong>Advantage:</strong> Only <span class="math inline">\(R\)</span> requires cryptographic protection for authentication!</p>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>To verify the value <span class="math inline">\(Y_1\)</span>, the values <span class="math inline">\(h(Y_{2,3,4})\)</span> and the value <span class="math inline">\(R\)</span> are needed. To minimize this effect, balanced trees (trees whose paths differ by at most one edge) can be used to reduce the number of intermediate data to <span class="math inline">\(\sim \log_2 n\)</span>.</li>
<li>When a node is modified, the entire path to the root must be recalculated.</li>
<li>When new nodes are added, it is advisable to build unbalanced trees (like the one in the figure) and add nodes via the root.</li>
</ul>
<p><strong>Main application: timestamping:</strong> The timestamping agent (TA) builds such a tree and provides the requester with the timestamp signed with its private key along with the verification path. The TA publishes <span class="math inline">\(R\)</span> daily in a newspaper, preventing it from cheating!</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Authentication Trees:</strong></p>
<ul>
<li>Certification alternative via hash + tree</li>
<li>Only root <span class="math inline">\(R\)</span> signed</li>
<li>Verification: path <span class="math inline">\(\sim \log_2 n\)</span> values</li>
<li>Application: timestamping</li>
<li>TA publishes <span class="math inline">\(R\)</span> daily</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="certification-topologies" class="level3">
<h3 class="anchored" data-anchor-id="certification-topologies">Certification Topologies</h3>
<p><strong>Problem:</strong> Communication between users of different CAs → trust question.</p>
<p><strong>Cross-Certification:</strong></p>
<ul>
<li><span class="math inline">\(CA_A\)</span> certifies the public key <span class="math inline">\(pub_{CA_B}\)</span> of <span class="math inline">\(CA_B\)</span>.</li>
<li>Cross-certificate: <span class="math inline">\(CA_A\{CA_B\}\)</span>.</li>
<li>Certification chain: <span class="math inline">\(CA_A\{CA_B\} \rightarrow CA_B\{B\}\)</span>.</li>
<li>A verifies B’s key with an authentic copy of <span class="math inline">\(pub_{CA_A}\)</span>.</li>
</ul>
<p><strong>Strict Hierarchical Model (PEM/X.509):</strong></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    Root[Root CA]
    Root --&gt; CA1[Level 1 CA]
    Root --&gt; CA2[Level 1 CA]
    CA1 --&gt; CA3[Level 2 CA]
    CA1 --&gt; CA4[Level 2 CA]
    CA2 --&gt; CA5[Level 2 CA]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ul>
<li>Any non-local chain starts at the root node.</li>
<li>Root public key assumed to be globally known.</li>
<li><strong>Problem:</strong> Centralization, single point of failure.</li>
</ul>
<p><strong>Graph Model (PGP):</strong></p>
<ul>
<li>Users act as CAs for correspondents.</li>
<li>Decentralized graph structure.</li>
<li>Suitable for closed groups.</li>
<li><strong>Limitations:</strong> Unconnected populations.</li>
</ul>
<p><strong>Hybrid Models:</strong></p>
<ul>
<li>Hierarchy + bidirectional cross-certification.</li>
</ul>
<p><strong>Golden Rule:</strong> Short chains (weakest link!).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certification Topologies</strong></p>
<p>When two users belonging to different CAs wish to communicate, a trust problem arises: should one trust a certificate issued by another CA?</p>
<p>The <strong>cross-certification</strong> process allows <span class="math inline">\(CA_A\)</span> to certify the public key <span class="math inline">\(pub_{CA_B}\)</span> of <span class="math inline">\(CA_B\)</span>. The resulting certificate is called a cross-certificate, denoted: <span class="math inline">\(CA_A\{CA_B\}\)</span>.</p>
<p>If A wants to verify the authenticity of B’s public key and there exists a cross-certificate <span class="math inline">\(CA_A\{CA_B\}\)</span>, A will ask B to provide its certificate signed by <span class="math inline">\(CA_B\)</span>, i.e., <span class="math inline">\(CA_B\{B\}\)</span>. The resulting <strong>certification chain</strong>: <span class="math inline">\(CA_A\{CA_B\} \rightarrow CA_B\{B\}\)</span> allows A to verify B’s public key using an authentic copy of <span class="math inline">\(pub_{CA_A}\)</span>.</p>
<p>The trust relationship necessary for cross-certification is not always easy to establish in competitive environments, which is why <strong>hierarchical models</strong> among CAs have been proposed. Example: the strict hierarchical model of PEM/X.509:</p>
<p>[Hierarchy diagram]</p>
<p>In the PEM environment, any non-local certification chain starts at the <strong>root node</strong>, whose public key is assumed to be known worldwide…</p>
<p>Other models, such as the one proposed by <strong>PGP</strong>, are based on a graph structure where the nodes are users who act as CAs to certify the public keys of correspondents. Although well-suited for closed user groups, this model has its limitations when applied to unconnected populations.</p>
<p>Other proposed schemes combine the hierarchical structure with bidirectional cross-certification.</p>
<p><strong>Keep certification chains as short as possible</strong> (a chain is always as vulnerable as its <strong>weakest link</strong>!).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Certification Topologies:</strong></p>
<ul>
<li><strong>Cross-certification:</strong> <span class="math inline">\(CA_A\{CA_B\} \rightarrow CA_B\{B\}\)</span></li>
<li><strong>Hierarchical</strong> (PEM/X.509): Global root</li>
<li><strong>Graph</strong> (PGP): Users = CAs</li>
<li><strong>Hybrid:</strong> Hierarchy + cross-cert</li>
<li>Rule: Short chains!</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="public-key-infrastructure-pki" class="level2">
<h2 class="anchored" data-anchor-id="public-key-infrastructure-pki">Public Key Infrastructure (PKI)</h2>
<p><strong>Definition:</strong> Integrated infrastructure providing security services based on public-key cryptography.</p>
<section id="main-functional-entities" class="level3">
<h3 class="anchored" data-anchor-id="main-functional-entities">Main Functional Entities</h3>
<p><strong>Certification Authority (CA):</strong></p>
<ul>
<li>Creation and maintenance of certificates.</li>
</ul>
<p><strong>Certificate Repository:</strong></p>
<ul>
<li>Accessible certificate directory (X.500, LDAP, WWW, DNS).</li>
</ul>
<p><strong>Certificate Revocation:</strong></p>
<ul>
<li>Management of compromised/obsolete certificates (CRLs).</li>
</ul>
<p><strong>Key Backup and Recovery:</strong></p>
<ul>
<li>Backup/restoration of lost keys.</li>
<li>Media destruction, password loss, employee departure.</li>
<li>⚠️ Decryption private key (not signature).</li>
</ul>
<p><strong>Automatic Key Update:</strong></p>
<ul>
<li>Key update after validity expiration.</li>
</ul>
<p><strong>Key and Certificate History:</strong></p>
<ul>
<li>Retrieval of obsolete keys to decrypt old documents.</li>
</ul>
<p><strong>Cross-Certification:</strong></p>
<ul>
<li>Validation of certificates from other PKIs (clients, suppliers, partners).</li>
</ul>
<p><strong>Non-Repudiation Support:</strong></p>
<p>Demonstrates the proper execution of an authenticated transaction:</p>
<ul>
<li>Data origin authentication.</li>
<li>Time-stamped data signature.</li>
<li>Signed receipt of delivery.</li>
</ul>
<p><strong>Secure Time Stamping:</strong></p>
<ul>
<li>Time reference accepted by all.</li>
</ul>
<p><strong>Client Software:</strong></p>
<ul>
<li>PKI operations on the client side.</li>
<li>Certificate management, signatures, decryption.</li>
<li>Peripherals (smart cards, biometrics).</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Public Key Infrastructure (PKI): Definitions</strong></p>
<p><strong>Definition:</strong> A PKI is an integrated infrastructure enabling the provision of a set of security services based on public-key cryptography.</p>
<p><strong>Functional Entities:</strong></p>
<ul>
<li><p><strong>Certification Authority (CA):</strong> Entity responsible for creating and maintaining certificates.</p></li>
<li><p><strong>Certificate Repository:</strong> Directory making certificates available to users and applications. Technologies used: X.500, LDAP, WWW servers, DNS, etc.</p></li>
<li><p><strong>Certificate Revocation:</strong> Compromised or obsolete certificates (notably CRL management).</p></li>
<li><p><strong>Centralized Key Backup and Recovery:</strong> Entity allowing key loss management due to various events: destruction of the material medium, password loss, employee departure, etc. Note that this procedure mainly applies to the decryption private key (as opposed to the signature private key).</p></li>
<li><p><strong>Automatic Key Update:</strong> After their validity expires.</p></li>
<li><p><strong>Key and Certificate History.</strong> This entity allows the retrieval of obsolete keys that were used to encrypt a document in the past.</p></li>
<li><p><strong>Cross-Certification</strong> with other PKIs (clients, suppliers, partners, etc.). This functionality allows (under certain constraints) the validation of certificates issued by other PKIs.</p></li>
<li><p><strong>Non-Repudiation Support:</strong> Value-added service providing the necessary evidence to demonstrate the execution of an authenticated transaction (data origin authentication, time-stamped data signature, signed receipt of delivery, etc.).</p></li>
<li><p><strong>Secure Time Stamping:</strong> Entity capable of providing a reference time accepted by all PKI participants. Main applications: non-repudiation, arbitration in case of conflicts, etc.</p></li>
<li><p><strong>Client Software:</strong> This functional entity allows all PKI operations on the client side. Examples: user certificate management, document signing, information decryption, management of specific peripherals (smart card readers, biometric devices, etc.).</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PKI – Main Entities:</strong></p>
<ul>
<li>CA: Certificate creation/maintenance</li>
<li>Repository: Certificate storage</li>
<li>Revocation: CRLs</li>
<li>Backup/Recovery: Lost keys (decryption)</li>
<li>Cross-cert: Validation of other PKIs</li>
<li>Time stamping: Time reference</li>
<li>Client: User operations</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
<section id="advantages-and-disadvantages" class="level3">
<h3 class="anchored" data-anchor-id="advantages-and-disadvantages">Advantages and Disadvantages</h3>
<p><strong>Advantages:</strong></p>
<p><strong>Security:</strong></p>
<ul>
<li>Integrated environment without weak links.</li>
</ul>
<p><strong>All-in-One:</strong></p>
<ul>
<li>Integration of multiple services: strong authentication, signatures, single sign-on, VPNs, B2C/B2B.</li>
<li>Cost savings vs.&nbsp;“case-by-case” solutions.</li>
</ul>
<p><strong>Interoperability:</strong></p>
<ul>
<li>Widespread standards (X.509, PKCS, OCSP).</li>
<li>Compatible applications and devices.</li>
<li>Possible inter-enterprise interoperability.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<p><strong>Implementation Cost:</strong></p>
<ul>
<li>Expensive products.</li>
<li>Rare skills.</li>
</ul>
<p><strong>Complexity:</strong></p>
<ul>
<li>Complex implementation and management.</li>
<li><strong>Alternative:</strong> Outsourcing PKI service.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Original Text
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PKI: Main Advantages and Disadvantages</strong></p>
<p><strong>Advantages</strong></p>
<ul>
<li><p><strong>Security:</strong> The integrated nature of a PKI allows the creation of a security environment without weak links.</p></li>
<li><p><strong>All-in-One:</strong> A PKI enables the integration and management of all security parameters for a wide range of services: strong entity authentication, document signing for non-repudiation, single sign-on, virtual private networks (VPNs), secure communications with clients/partners/suppliers (B2C, B2B), etc. The PKI represents a significant cost saving compared to “case-by-case” solutions.</p></li>
<li><p><strong>Intra- and Inter-Enterprise Interoperability:</strong> The main PKI products comply with widely adopted standardization norms (X.509, PKCS, OCSP, etc.). A large number of applications and hardware devices now conform to these standards. The possible compatibility between different PKI providers also allows (with some reservations) inter-enterprise interoperability.</p></li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li><strong>Implementation Cost:</strong> Expensive products, rare skills.</li>
<li><strong>Complexity</strong>…but:
<ul>
<li>Outsourcing the “PKI service” is an alternative.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Quick Review
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PKI:</strong></p>
<p><strong>✅ Advantages:</strong></p>
<ul>
<li>Integrated security</li>
<li>All-in-one: multi-services</li>
<li>Interoperability (standards)</li>
</ul>
<p><strong>❌ Disadvantages:</strong></p>
<ul>
<li>High cost</li>
<li>Complexity</li>
<li>Solution: Outsourcing</li>
</ul>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>